<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <title>geometry-editor</title>
        <style>
            @import url(https://fonts.googleapis.com/css?family=Roboto);body,html{color:#bbc3c7;font-size:16px;font-family:Roboto,sans-serif;height:100vh;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;margin:0}body h1,body h2,body h3,body h4,html h1,html h2,html h3,html h4{font-weight:100}body a,html a{color:#df5236}body a:hover,html a:hover{cursor:pointer}#toolbar{background-color:#2b3134;border-bottom:1px solid #525d64}main #navigation{background-color:#2b3134;border-right:1px solid #525d64}main #inspector{background-color:#2b3134;border-left:1px solid #525d64}main #canvas{background-color:#24292c}#toolbar{height:5rem}#app{height:100%}main{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;height:calc(70% - 5rem)}main #inspector,main #navigation{height:100%;width:17.5rem}main #canvas{height:100%;width:calc(100% - 35rem)}#library{height:30%}#canvas svg ellipse:not(.origin){fill:#839199;stroke:#839199}#canvas svg ellipse:not(.origin).highlight{stroke:red;fill:red}#canvas svg ellipse.origin{stroke:#839199}#canvas svg line.horizontal,#canvas svg line.vertical{stroke:#525d64;opacity:.25}#canvas svg line.highlight{stroke:red}#canvas svg path,#canvas svg polygon,#canvas svg rect{fill-opacity:.5;stroke:#839199}#canvas svg path.currentShading,#canvas svg path.currentSpace,#canvas svg polygon.currentShading,#canvas svg polygon.currentSpace,#canvas svg rect.currentShading,#canvas svg rect.currentSpace{stroke:#6aac15}.input-checkbox label,.input-number label,.input-select label,.input-text label{font-size:.625rem;margin:0 .5rem 0 0;text-transform:uppercase}.input-number,.input-text{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.input-number input,.input-text input{background-color:#2b3134;border:0;border-radius:.35rem;color:#bbc3c7;height:2rem;padding:0 .75rem;-webkit-appearance:none}.input-text input{width:15rem}.input-number input{width:2.5rem}.input-select{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;position:relative}.input-select select{background-color:#2b3134;border:0;color:#bbc3c7;-ms-flex-positive:2;flex-grow:2;height:2rem;padding:0 1.75rem 0 .75rem;-webkit-appearance:none}.input-select svg{pointer-events:none;position:absolute;right:.5rem;top:calc(50% - 3px)}.input-select svg path{fill:#525d64}button{background-color:#2b3134;border:1px solid #525d64;border-radius:.35rem;cursor:pointer;color:#bbc3c7;height:2rem;outline:none;padding:0 .75rem}.overlay{background-color:#24292c;height:100vh;left:0;opacity:.5;position:absolute;top:0;width:100%;z-index:1}.modal{background-color:#3b4348;border:1px solid #525d64;border-radius:1rem;left:50%;min-height:10rem;position:fixed;top:50%;transform:translate(-50%,-50%);width:25rem;z-index:2}.modal header{padding:.5rem;text-align:center;background-color:#2b3134;border-radius:.9rem .9rem 0 0}.modal header h2{display:inline;font-size:.7rem;text-transform:uppercase}.modal header svg.close{cursor:pointer;height:1.25rem;position:absolute;top:.5rem;right:.5rem;width:1.5rem}.modal header svg.close path{fill:#bbc3c7}.modal header svg.close:hover path{fill:#df5236}.modal form{padding:1rem}.modal form label{color:#839199}.modal footer{background-color:#2b3134;border-radius:0 0 .9rem .9rem;padding:.5rem;text-align:right}.modal footer button:last-child{border-color:#df5236}.tabs{border-bottom:1px solid #24292c;border-top:1px solid #24292c;display:-ms-flexbox;display:flex;height:1.75rem;font-size:.625rem}.tabs span{border-right:1px solid #24292c;cursor:pointer;display:inline-block;padding:.5rem;text-transform:uppercase}.tabs .active{background-color:#525d64}#navigation[data-v-9625b82c]{background-color:#343b40;border-right:1px solid #24292c;font-size:.75rem}#navigation #selections[data-v-9625b82c]{display:-ms-flexbox;display:flex;padding:.25rem;-ms-flex-pack:justify;justify-content:space-between}#navigation #breadcrumbs>button[data-v-9625b82c],#navigation #selections>button[data-v-9625b82c]{display:-ms-flexbox;display:flex;line-height:1rem}#navigation #breadcrumbs>button svg[data-v-9625b82c],#navigation #selections>button svg[data-v-9625b82c]{height:1rem;margin:0 .25rem 0 -.1rem;width:1rem}#navigation #breadcrumbs>button svg path[data-v-9625b82c],#navigation #selections>button svg path[data-v-9625b82c]{fill:#bbc3c7}#navigation #navigation-search[data-v-9625b82c]{padding:.5rem 1rem;border-bottom:1px solid #24292c}#navigation #breadcrumbs[data-v-9625b82c],#navigation #story-list>div[data-v-9625b82c],#navigation #subselection-list>div[data-v-9625b82c]{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}#navigation #list[data-v-9625b82c]{height:100%;display:-ms-flexbox;display:flex}#navigation #list #story-list[data-v-9625b82c]{border-right:1px solid #24292c;width:6rem}#navigation #list #subselection-list[data-v-9625b82c]{-ms-flex-positive:2;flex-grow:2}#navigation #list #story-list[data-v-9625b82c],#navigation #list #subselection-list[data-v-9625b82c]{overflow:scroll;height:calc(100% - 5rem)}#navigation #list #story-list>div[data-v-9625b82c],#navigation #list #subselection-list>div[data-v-9625b82c]{border-bottom:1px solid #24292c;cursor:pointer;height:2rem;padding:0 .5rem}#navigation #list #story-list>div span[data-v-9625b82c],#navigation #list #subselection-list>div span[data-v-9625b82c]{display:inline-block;height:1rem;width:1rem}#navigation #list #story-list>div.active[data-v-9625b82c],#navigation #list #subselection-list>div.active[data-v-9625b82c]{color:#6aac15}#navigation #list #story-list>div.active svg[data-v-9625b82c],#navigation #list #subselection-list>div.active svg[data-v-9625b82c]{cursor:pointer;height:1rem}#navigation #list #story-list>div.active svg path[data-v-9625b82c],#navigation #list #subselection-list>div.active svg path[data-v-9625b82c]{fill:#bbc3c7}#navigation #list #story-list>div.active svg:hover path[data-v-9625b82c],#navigation #list #subselection-list>div.active svg:hover path[data-v-9625b82c]{fill:#df5236}#navigation #breadcrumbs[data-v-9625b82c]{background-color:#343b40;border-bottom:1px solid #24292c;border-top:1px solid #24292c;height:2.5rem;-ms-flex-pack:start;justify-content:flex-start;padding:0 1rem}#navigation #breadcrumbs span[data-v-9625b82c]{margin-left:1rem;cursor:pointer}#navigation #breadcrumbs svg[data-v-9625b82c]{margin:0 .25rem;width:.5rem}#navigation #breadcrumbs svg path[data-v-9625b82c]{fill:#525d64}#inspector[data-v-411ce911]{background-color:#343b40;border-left:1px solid #24292c;font-size:.85rem}#inspector .list[data-v-411ce911]{height:calc(100% - 2rem);overflow:scroll}#inspector .list header[data-v-411ce911]{background-color:#2b3134}#inspector .list header>h3[data-v-411ce911]{display:inline-block;margin:1rem}#inspector .list .list-item[data-v-411ce911]{border-top:1px solid #525d64;padding:.5rem 1rem}#inspector .list .list-item h4[data-v-411ce911]{margin:.5rem 0}#inspector .list .list-item span[data-v-411ce911]{display:block;margin-bottom:.25rem}#inspector .list .list-item button[data-v-411ce911]{margin-top:.5rem}#inspector #attributes-list h3[data-v-411ce911],#inspector #attributes-list label[data-v-411ce911]{margin-left:1rem}#inspector #attributes-list label[data-v-411ce911]{font-size:.625rem;text-transform:uppercase}#inspector #attributes-list .input-text[data-v-411ce911]{margin:.25rem 0 .5rem;padding:0 1rem}#inspector #components-list .list-item>div[data-v-411ce911]{border-top:1px solid #525d64;padding:.5rem 0;position:relative}#inspector #components-list .list-item>div svg[data-v-411ce911]{cursor:pointer;height:1rem;position:absolute;right:0;top:calc(50% - .5rem)}#inspector #components-list .list-item>div svg path[data-v-411ce911]{fill:#bbc3c7}#canvas[data-v-266f1716]{background-color:#24292c}#canvas svg[data-v-266f1716]{background-size:cover;background-repeat:no-repeat;height:100%;width:100%}#toolbar section[data-v-73143015]{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:2.5rem;padding:0 2.5rem}#toolbar section.settings[data-v-73143015]{background-color:#343b40;text-align:right}#toolbar section.settings #modal-buttons[data-v-73143015]{margin-right:2rem}#toolbar section.settings #import-export[data-v-73143015]{position:absolute;right:2.5rem}#toolbar section.settings #import-export #import[data-v-73143015]{margin-right:1rem;border:1px solid #6aac15}#toolbar section.settings #import-export #export[data-v-73143015]{border:1px solid #df5236}#toolbar section.settings input[type=file][data-v-73143015]{position:absolute;visibility:hidden}#toolbar section.tools[data-v-73143015]{background-color:#525d64;-ms-flex-pack:end;justify-content:flex-end}#toolbar section>button[data-v-73143015],#toolbar section>div[data-v-73143015]{margin:0 1rem 0 0}#toolbar section>button.active[data-v-73143015],#toolbar section>div.active[data-v-73143015]{border:1px solid #df5236}/*! Huebee v1.0.1
http://huebee.buzz
---------------------------------------------- */.huebee{position:absolute;z-index:1;transform:translateY(0);transition:opacity .15s,transform .15s}.huebee.is-hidden{opacity:0;transform:translateY(10px)}.huebee.is-static-open{position:relative;z-index:auto}.huebee__container{position:absolute;left:0;top:5px;padding:10px;background:#eee;border-radius:5px;box-shadow:0 5px 10px rgba(0,0,0,.3)}.huebee.is-static-open .huebee__container{position:relative;display:inline-block;left:auto;top:auto;box-shadow:none}.huebee__canvas{display:block;cursor:pointer}.huebee__cursor{width:15px;height:15px;position:absolute;left:0;top:0;box-sizing:content-box;border:3px solid #fff;border-radius:5px;pointer-events:none}.huebee__cursor.is-hidden{opacity:0}.huebee__close-button{display:block;position:absolute;width:24px;height:24px;top:-9px;right:-9px;border-radius:12px;background:#222}.huebee__close-button__x{stroke:#fff;stroke-width:3;stroke-linecap:round}.huebee__close-button:hover{background:#fff;cursor:pointer}.huebee__close-button:hover .huebee__close-button__x{stroke:#222}#library[data-v-3afbad56]{background-color:#24292c;border-top:1px solid #3b4348;overflow:scroll;position:relative}#library header[data-v-3afbad56]{display:-ms-flexbox;display:flex;padding:1rem 1.5rem;-ms-flex-pack:justify;justify-content:space-between}#library header .input-select[data-v-3afbad56],#library header .input-text[data-v-3afbad56]{margin:0 1rem;width:10rem}#library table[data-v-3afbad56]{border-spacing:0;width:100%}#library table thead tr[data-v-3afbad56]{height:3rem}#library table thead tr th[data-v-3afbad56]{border-bottom:2px solid #525d64}#library table thead tr th svg[data-v-3afbad56]{height:1rem;width:1rem}#library table thead tr th svg path[data-v-3afbad56]{fill:#525d64}#library table tbody tr[data-v-3afbad56]{height:2rem}#library table tbody tr[data-v-3afbad56]:nth-of-type(odd){background-color:#343b40}#library table tbody tr.current input[data-v-3afbad56]{color:#6aac15}#library table tbody tr.error[data-v-3afbad56],#library table thead tr.error[data-v-3afbad56]{background:rgba(223,82,54,.5)!important}#library table tbody tr .tooltip-error[data-v-3afbad56],#library table thead tr .tooltip-error[data-v-3afbad56]{bottom:3rem;background-color:#24292c;border:1px solid #df5236;color:#bbc3c7;left:3rem;border-radius:.25rem;padding:.5rem 1rem;position:absolute}#library table tbody tr .tooltip-error svg[data-v-3afbad56],#library table thead tr .tooltip-error svg[data-v-3afbad56]{bottom:-.7rem;height:.75rem;left:.5rem;position:absolute;transform:rotate(90deg)}#library table tbody tr .tooltip-error svg path[data-v-3afbad56],#library table thead tr .tooltip-error svg path[data-v-3afbad56]{fill:#df5236}#library table tbody tr td[data-v-3afbad56],#library table tbody tr th[data-v-3afbad56],#library table thead tr td[data-v-3afbad56],#library table thead tr th[data-v-3afbad56]{text-align:left;padding:0 1rem;position:relative}#library table tbody tr td[data-v-3afbad56]:first-child,#library table tbody tr th[data-v-3afbad56]:first-child,#library table thead tr td[data-v-3afbad56]:first-child,#library table thead tr th[data-v-3afbad56]:first-child{padding-left:2.5rem}#library table tbody tr td[data-v-3afbad56]:last-child,#library table tbody tr th[data-v-3afbad56]:last-child,#library table thead tr td[data-v-3afbad56]:last-child,#library table thead tr th[data-v-3afbad56]:last-child{-ms-flex-positive:2;flex-grow:2}#library table tbody tr td.destroy[data-v-3afbad56],#library table tbody tr th.destroy[data-v-3afbad56],#library table thead tr td.destroy[data-v-3afbad56],#library table thead tr th.destroy[data-v-3afbad56]{width:2rem}#library table tbody tr td.destroy svg[data-v-3afbad56],#library table tbody tr th.destroy svg[data-v-3afbad56],#library table thead tr td.destroy svg[data-v-3afbad56],#library table thead tr th.destroy svg[data-v-3afbad56]{cursor:pointer;height:1.25rem;width:1.5rem}#library table tbody tr td.destroy svg path[data-v-3afbad56],#library table tbody tr th.destroy svg path[data-v-3afbad56],#library table thead tr td.destroy svg path[data-v-3afbad56],#library table thead tr th.destroy svg path[data-v-3afbad56]{fill:#bbc3c7}#library table tbody tr td.destroy svg:hover path[data-v-3afbad56],#library table tbody tr th.destroy svg:hover path[data-v-3afbad56],#library table thead tr td.destroy svg:hover path[data-v-3afbad56],#library table thead tr th.destroy svg:hover path[data-v-3afbad56]{fill:#df5236}#library table tbody tr td .input-select[data-v-3afbad56],#library table tbody tr th .input-select[data-v-3afbad56],#library table thead tr td .input-select[data-v-3afbad56],#library table thead tr th .input-select[data-v-3afbad56]{margin:.5rem 0}#library table tbody tr td input[data-v-3afbad56],#library table tbody tr th input[data-v-3afbad56],#library table thead tr td input[data-v-3afbad56],#library table thead tr th input[data-v-3afbad56]{background-color:transparent;border:none;color:#bbc3c7;font-size:1rem}.modal #coordinates .input-number[data-v-21736fdf]{margin:.5rem 0}.modal #coordinates .input-number label[data-v-21736fdf]{width:3.5rem}.modal #coordinates .input-number input[data-v-21736fdf]{width:5rem}.modal #mode[data-v-21736fdf]{display:-ms-flexbox;display:flex;margin-bottom:1rem}.modal #mode button[data-v-21736fdf]{margin-right:.5rem}.modal #mode button.active[data-v-21736fdf]{border:1px solid #df5236}.modal input[type=file][data-v-21736fdf]{position:absolute;visibility:hidden}table[data-v-f4f49402]{border-spacing:0;width:100%}table thead tr[data-v-f4f49402]{height:3rem}table thead tr th[data-v-f4f49402]{border-bottom:2px solid #525d64}table tbody tr[data-v-f4f49402]{height:2rem}table tbody tr[data-v-f4f49402]:nth-of-type(odd){background-color:#343b40}table tbody tr.active[data-v-f4f49402]{color:#df5236}table tbody tr td[data-v-f4f49402],table tbody tr th[data-v-f4f49402],table thead tr td[data-v-f4f49402],table thead tr th[data-v-f4f49402]{text-align:left;padding:0 1rem}table tbody tr td[data-v-f4f49402]:first-child,table tbody tr th[data-v-f4f49402]:first-child,table thead tr td[data-v-f4f49402]:first-child,table thead tr th[data-v-f4f49402]:first-child{padding-left:2.5rem}table tbody tr td[data-v-f4f49402]:last-child,table tbody tr th[data-v-f4f49402]:last-child,table thead tr td[data-v-f4f49402]:last-child,table thead tr th[data-v-f4f49402]:last-child{-ms-flex-positive:2;flex-grow:2}button#saveAssignment.disabled[data-v-f4f49402]{border-color:#525d64;cursor:default}button#saveAssignment.active[data-v-f4f49402]{border-color:#df5236}.modal form #add-field[data-v-7db4da52]{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:2rem;-ms-flex-pack:justify;justify-content:space-between;margin:1rem 0}.modal form .input-select[data-v-7db4da52]{width:15rem}.modal form .input-select label[data-v-7db4da52]{width:1.75rem}.modal form .input-text[data-v-7db4da52]{margin:.5rem 0}.modal .additional-field[data-v-7db4da52]{display:-ms-flexbox;display:flex}.modal .additional-field input[data-v-7db4da52]{border:1px solid #3b4348}.modal .additional-field [data-v-7db4da52]:first-child{margin-right:1rem;width:3rem}.modal .additional-field [data-v-7db4da52]:last-child{-ms-flex-positive:2;flex-grow:2}
/*# sourceMappingURL=app.3bbad0555e52905be314a0dd22120ff6.css.map*/
        </style>
    </head>

    <body>
        <div id=app></div>
        
	<script>!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n=window.webpackJsonp;window.webpackJsonp=function(c,o){for(var p,s,l=0,i=[];l<c.length;l++)s=c[l],r[s]&&i.push.apply(i,r[s]),r[s]=0;for(p in o)e[p]=o[p];for(n&&n(c,o);i.length;)i.shift().call(null,t);if(o[0])return a[0]=0,t(0)};var a={},r={0:0};t.e=function(e,n){if(0===r[e])return n.call(null,t);if(void 0!==r[e])r[e].push(n);else{r[e]=[n];var a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.async=!0,c.src=t.p+"static/js/"+e+"."+{1:"6981210d6cc72441fd4d",2:"b94ab85c2346f0617a4a"}[e]+".js",a.appendChild(c)}},t.m=e,t.c=a,t.p="/"}([]);
//# sourceMappingURL=manifest.7ec48973209c623d88b4.js.map</script>
	<script>webpackJsonp([1,0],[,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(45),o=i(r);e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}},,,function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){/**
	 * vuex v2.1.1
	 * (c) 2016 Evan You
	 * @license MIT
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){w&&(t._devtoolHook=w,w.emit("vuex:init",t),w.on("vuex:travel-to-state",function(e){t.replaceState(e)}),t.subscribe(function(t,e){w.emit("vuex:mutation",t,e)}))}function e(t){function e(){var t=this.$options;t.store?this.$store=t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}var n=Number(t.version.split(".")[0]);if(n>=2){var i=t.config._lifecycleHooks.indexOf("init")>-1;t.mixin(i?{init:e}:{beforeCreate:e})}else{var r=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[e].concat(t.init):e,r.call(this,t)}}}function n(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function i(t){return function(e,n){return"string"!=typeof e?(n=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,n)}}function r(t,e){console.error("[vuex] module namespace not found in "+t+"(): "+e)}function o(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function a(t){return null!==t&&"object"==typeof t}function s(t){return t&&"function"==typeof t.then}function u(t,e){if(!t)throw new Error("[vuex] "+e)}function c(t,e){if(t.update(e),e.modules)for(var n in e.modules){if(!t.getChild(n))return void console.warn("[vuex] trying to add a new module '"+n+"' on hot reloading, manual reload is needed");c(t.getChild(n),e.modules[n])}}function l(t){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var e=t.state;f(t,e,[],t._modules.root,!0),h(t,e)}function h(t,e){var n=t._vm;t.getters={};var i=t._wrappedGetters,r={};o(i,function(e,n){r[n]=function(){return e(t)},Object.defineProperty(t.getters,n,{get:function(){return t._vm[n]},enumerable:!0})});var a=L.config.silent;L.config.silent=!0,t._vm=new L({data:{state:e},computed:r}),L.config.silent=a,t.strict&&y(t),n&&(t._withCommit(function(){n.state=null}),L.nextTick(function(){return n.$destroy()}))}function f(t,e,n,i,r){var o=!n.length,a=t._modules.getNamespace(n);if(a&&(t._modulesNamespaceMap[a]=i),!o&&!r){var s=_(e,n.slice(0,-1)),u=n[n.length-1];t._withCommit(function(){L.set(s,u,i.state)})}var c=i.context=p(t,a);i.forEachMutation(function(e,i){var r=a+i;m(t,r,e,n)}),i.forEachAction(function(e,i){var r=a+i;v(t,r,e,c,n)}),i.forEachGetter(function(e,i){var r=a+i;g(t,r,e,c,n)}),i.forEachChild(function(i,o){f(t,e,n.concat(o),i,r)})}function p(t,e){var n=""===e,i={dispatch:n?t.dispatch:function(n,i,r){var o=x(n,i,r),a=o.payload,s=o.options,u=o.type;return s&&s.root||(u=e+u,t._actions[u])?t.dispatch(u,a):void console.error("[vuex] unknown local action type: "+o.type+", global type: "+u)},commit:n?t.commit:function(n,i,r){var o=x(n,i,r),a=o.payload,s=o.options,u=o.type;return s&&s.root||(u=e+u,t._mutations[u])?void t.commit(u,a,s):void console.error("[vuex] unknown local mutation type: "+o.type+", global type: "+u)}};return Object.defineProperty(i,"getters",{get:n?function(){return t.getters}:function(){return d(t,e)}}),i}function d(t,e){var n={},i=e.length;return Object.keys(t.getters).forEach(function(r){if(r.slice(0,i)===e){var o=r.slice(i);Object.defineProperty(n,o,{get:function(){return t.getters[r]},enumerable:!0})}}),n}function m(t,e,n,i){var r=t._mutations[e]||(t._mutations[e]=[]);r.push(function(e){n(_(t.state,i),e)})}function v(t,e,n,i,r){var o=t._actions[e]||(t._actions[e]=[]);o.push(function(e,o){var a=n({dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:_(t.state,r),rootGetters:t.getters,rootState:t.state},e,o);return s(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(e){throw t._devtoolHook.emit("vuex:error",e),e}):a})}function g(t,e,n,i,r){return t._wrappedGetters[e]?void console.error("[vuex] duplicate getter key: "+e):void(t._wrappedGetters[e]=function(t){return n(_(t.state,r),i.getters,t.state,t.getters)})}function y(t){t._vm.$watch("state",function(){u(t._committing,"Do not mutate vuex store state outside mutation handlers.")},{deep:!0,sync:!0})}function _(t,e){return e.length?e.reduce(function(t,e){return t[e]},t):t}function x(t,e,n){return a(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}function b(t){return L?void console.error("[vuex] already installed. Vue.use(Vuex) should be called only once."):(L=t,void e(L))}var w="undefined"!=typeof window&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__,M=i(function(t,e){var i={};return n(e).forEach(function(e){var n=e.key,o=e.val;i[n]=function(){var e=this.$store.state,n=this.$store.getters;if(t){var i=this.$store._modulesNamespaceMap[t];if(!i)return void r("mapState",t);e=i.state,n=i.context.getters}return"function"==typeof o?o.call(this,e,n):e[o]}}),i}),E=i(function(t,e){var i={};return n(e).forEach(function(e){var n=e.key,r=e.val;r=t+r,i[n]=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.$store.commit.apply(this.$store,[r].concat(t))}}),i}),T=i(function(t,e){var i={};return n(e).forEach(function(e){var n=e.key,r=e.val;r=t+r,i[n]=function(){return r in this.$store.getters||console.error("[vuex] unknown getter: "+r),this.$store.getters[r]}}),i}),S=i(function(t,e){var i={};return n(e).forEach(function(e){var n=e.key,r=e.val;r=t+r,i[n]=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.$store.dispatch.apply(this.$store,[r].concat(t))}}),i}),P=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t},A={state:{},namespaced:{}};A.state.get=function(){return this._rawModule.state||{}},A.namespaced.get=function(){return!!this._rawModule.namespaced},P.prototype.addChild=function(t,e){this._children[t]=e},P.prototype.removeChild=function(t){delete this._children[t]},P.prototype.getChild=function(t){return this._children[t]},P.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},P.prototype.forEachChild=function(t){o(this._children,t)},P.prototype.forEachGetter=function(t){this._rawModule.getters&&o(this._rawModule.getters,t)},P.prototype.forEachAction=function(t){this._rawModule.actions&&o(this._rawModule.actions,t)},P.prototype.forEachMutation=function(t){this._rawModule.mutations&&o(this._rawModule.mutations,t)},Object.defineProperties(P.prototype,A);var C=function(t){var e=this;this.root=new P(t,!1),t.modules&&o(t.modules,function(t,n){e.register([n],t,!1)})};C.prototype.get=function(t){return t.reduce(function(t,e){return t.getChild(e)},this.root)},C.prototype.getNamespace=function(t){var e=this.root;return t.reduce(function(t,n){return e=e.getChild(n),t+(e.namespaced?n+"/":"")},"")},C.prototype.update=function(t){c(this.root,t)},C.prototype.register=function(t,e,n){var i=this;void 0===n&&(n=!0);var r=this.get(t.slice(0,-1)),a=new P(e,n);r.addChild(t[t.length-1],a),e.modules&&o(e.modules,function(e,r){i.register(t.concat(r),e,n)})},C.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),n=t[t.length-1];e.getChild(n).runtime&&e.removeChild(n)};var L,I=function(e){var n=this;void 0===e&&(e={}),u(L,"must call Vue.use(Vuex) before creating a store instance."),u("undefined"!=typeof Promise,"vuex requires a Promise polyfill in this browser.");var i=e.state;void 0===i&&(i={});var r=e.plugins;void 0===r&&(r=[]);var o=e.strict;void 0===o&&(o=!1),this._committing=!1,this._actions=Object.create(null),this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new C(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new L;var a=this,s=this,c=s.dispatch,l=s.commit;this.dispatch=function(t,e){return c.call(a,t,e)},this.commit=function(t,e,n){return l.call(a,t,e,n)},this.strict=o,f(this,i,[],this._modules.root),h(this,i),r.concat(t).forEach(function(t){return t(n)})},R={state:{}};R.state.get=function(){return this._vm.$data.state},R.state.set=function(t){u(!1,"Use store.replaceState() to explicit replace store state.")},I.prototype.commit=function(t,e,n){var i=this,r=x(t,e,n),o=r.type,a=r.payload,s=r.options,u={type:o,payload:a},c=this._mutations[o];return c?(this._withCommit(function(){c.forEach(function(t){t(a)})}),this._subscribers.forEach(function(t){return t(u,i.state)}),void(s&&s.silent&&console.warn("[vuex] mutation type: "+o+". Silent option has been removed. Use the filter functionality in the vue-devtools"))):void console.error("[vuex] unknown mutation type: "+o)},I.prototype.dispatch=function(t,e){var n=x(t,e),i=n.type,r=n.payload,o=this._actions[i];return o?o.length>1?Promise.all(o.map(function(t){return t(r)})):o[0](r):void console.error("[vuex] unknown action type: "+i)},I.prototype.subscribe=function(t){var e=this._subscribers;return e.indexOf(t)<0&&e.push(t),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},I.prototype.watch=function(t,e,n){var i=this;return u("function"==typeof t,"store.watch only accepts a function."),this._watcherVM.$watch(function(){return t(i.state,i.getters)},e,n)},I.prototype.replaceState=function(t){var e=this;this._withCommit(function(){e._vm.state=t})},I.prototype.registerModule=function(t,e){"string"==typeof t&&(t=[t]),u(Array.isArray(t),"module path must be a string or an Array."),this._modules.register(t,e),f(this,this.state,t,this._modules.get(t)),h(this,this.state)},I.prototype.unregisterModule=function(t){var e=this;"string"==typeof t&&(t=[t]),u(Array.isArray(t),"module path must be a string or an Array."),this._modules.unregister(t),this._withCommit(function(){var n=_(e.state,t.slice(0,-1));L.delete(n,t[t.length-1])}),l(this)},I.prototype.hotUpdate=function(t){this._modules.update(t),l(this)},I.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(I.prototype,R),"undefined"!=typeof window&&window.Vue&&b(window.Vue);var N={Store:I,install:b,version:"2.1.1",mapState:M,mapMutations:E,mapGetters:T,mapActions:S};return N})},function(t,e,n){t.exports=!n(13)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(7),r=n(4),o=n(111),a=n(14),s="prototype",u=function(t,e,n){var c,l,h,f=t&u.F,p=t&u.G,d=t&u.S,m=t&u.P,v=t&u.B,g=t&u.W,y=p?r:r[e]||(r[e]={}),_=y[s],x=p?i:d?i[e]:(i[e]||{})[s];p&&(n=e);for(c in n)l=!f&&x&&void 0!==x[c],l&&c in y||(h=l?x[c]:n[c],y[c]=p&&"function"!=typeof x[c]?n[c]:v&&l?o(h,i):g&&x[c]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e[s]=t[s],e}(h):m&&"function"==typeof h?o(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[c]=h,t&u.R&&_&&!_[c]&&a(_,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(19),r=n(50),o=n(39),a=Object.defineProperty;e.f=n(6)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(51),r=n(28);t.exports=function(t){return i(r(t))}},function(t,e,n){t.exports={default:n(100),__esModule:!0}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(10),r=n(22);t.exports=n(6)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(55),r=n(29);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(36)("wks"),r=n(23),o=n(7).Symbol,a="function"==typeof o,s=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};s.store=i},,function(t,e,n){t.exports={default:n(105),__esModule:!0}},function(t,e,n){var i=n(20);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(97),o=i(r);e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){t.exports={}},function(t,e){t.exports=!0},function(t,e,n){var i=n(19),r=n(53),o=n(29),a=n(35)("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n(49)("iframe"),i=o.length,r="<",a=">";for(e.style.display="none",n(113).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+a+"document.F=Object"+r+"/script"+a),t.close(),c=t.F;i--;)delete c[u][o[i]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=i(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:r(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(10).f,r=n(9),o=n(16)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(36)("keys"),r=n(23);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(7),r="__core-js_shared__",o=i[r]||(i[r]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(28);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(20);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(7),r=n(4),o=n(31),a=n(41),s=n(10).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){e.f=n(16)},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(){}function n(t,e){this.x=t||0,this.y=e||0}function i(t,e,r,o,a,s,u,c,l,h){Object.defineProperty(this,"id",{value:fs++}),this.uuid=hs.generateUUID(),this.name="",this.image=void 0!==t?t:i.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:i.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:aa,this.wrapT=void 0!==o?o:aa,this.magFilter=void 0!==a?a:ha,this.minFilter=void 0!==s?s:pa,this.anisotropy=void 0!==l?l:1,this.format=void 0!==u?u:Aa,this.type=void 0!==c?c:da,this.offset=new n(0,0),this.repeat=new n(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:es,this.version=0,this.onUpdate=null}function r(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function o(t,e,n){this.uuid=hs.generateUUID(),this.width=t,this.height=e,this.scissor=new r(0,0,t,e),this.scissorTest=!1,this.viewport=new r(0,0,t,e),n=n||{},void 0===n.minFilter&&(n.minFilter=ha),this.texture=new i(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function a(t,e,n){o.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function s(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}function u(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function c(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function l(t,e,n,r,o,a,s,u,c,l){t=void 0!==t?t:[],e=void 0!==e?e:Ko,i.call(this,t,e,n,r,o,a,s,u,c,l),this.flipY=!1}function h(){this.seq=[],this.map={}}function f(t,e,n){var i=t[0];if(i<=0||i>0)return t;var r=e*n,o=ms[r];if(void 0===o&&(o=new Float32Array(r),ms[r]=o),0!==e){i.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function p(t,e){var n=vs[e];void 0===n&&(n=new Int32Array(e),vs[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocTextureUnit();return n}function d(t,e){t.uniform1f(this.addr,e)}function m(t,e){t.uniform1i(this.addr,e)}function v(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function g(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function y(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function _(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function x(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function b(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function w(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTexture2D(e||ps,i)}function M(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTextureCube(e||ds,i)}function E(t,e){t.uniform2iv(this.addr,e)}function T(t,e){t.uniform3iv(this.addr,e)}function S(t,e){t.uniform4iv(this.addr,e)}function P(t){switch(t){case 5126:return d;case 35664:return v;case 35665:return g;case 35666:return y;case 35674:return _;case 35675:return x;case 35676:return b;case 35678:return w;case 35680:return M;case 5124:case 35670:return m;case 35667:case 35671:return E;case 35668:case 35672:return T;case 35669:case 35673:return S}}function A(t,e){t.uniform1fv(this.addr,e)}function C(t,e){t.uniform1iv(this.addr,e)}function L(t,e){t.uniform2fv(this.addr,f(e,this.size,2))}function I(t,e){t.uniform3fv(this.addr,f(e,this.size,3))}function R(t,e){t.uniform4fv(this.addr,f(e,this.size,4))}function N(t,e){t.uniformMatrix2fv(this.addr,!1,f(e,this.size,4))}function O(t,e){t.uniformMatrix3fv(this.addr,!1,f(e,this.size,9))}function D(t,e){t.uniformMatrix4fv(this.addr,!1,f(e,this.size,16))}function B(t,e,n){var i=e.length,r=p(n,i);t.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTexture2D(e[o]||ps,r[o])}function U(t,e,n){var i=e.length,r=p(n,i);t.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTextureCube(e[o]||ds,r[o])}function F(t){switch(t){case 5126:return A;case 35664:return L;case 35665:return I;case 35666:return R;case 35674:return N;case 35675:return O;case 35676:return D;case 35678:return B;case 35680:return U;case 5124:case 35670:return C;case 35667:case 35671:return E;case 35668:case 35672:return T;case 35669:case 35673:return S}}function k(t,e,n){this.id=t,this.addr=n,this.setValue=P(e.type)}function z(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=F(e.type)}function G(t){this.id=t,h.call(this)}function H(t,e){t.seq.push(e),t.map[e.id]=e}function j(t,e,n){var i=t.name,r=i.length;for(gs.lastIndex=0;;){var o=gs.exec(i),a=gs.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===r){H(n,void 0===c?new k(s,t,e):new z(s,t,e));break}var l=n.map,h=l[s];void 0===h&&(h=new G(s),H(n,h)),n=h}}function X(t,e,n){h.call(this),this.renderer=n;for(var i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r<i;++r){var o=t.getActiveUniform(e,r),a=o.name,s=t.getUniformLocation(e,a);j(o,s,this)}}function V(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Y(t,e,n,r,o,a,s,u,c,l,h,f){i.call(this,null,a,s,u,c,l,r,o,h,f),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:ua,this.minFilter=void 0!==l?l:ua,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function W(t,e){this.min=void 0!==t?t:new n(+(1/0),+(1/0)),this.max=void 0!==e?e:new n(-(1/0),-(1/0))}function q(t,e){function i(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);o=d.createBuffer(),a=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,o),d.bufferData(d.ARRAY_BUFFER,t,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),d.bufferData(d.ELEMENT_ARRAY_BUFFER,e,d.STATIC_DRAW),f=d.createTexture(),p=d.createTexture(),m.bindTexture(d.TEXTURE_2D,f),d.texImage2D(d.TEXTURE_2D,0,d.RGB,16,16,0,d.RGB,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),m.bindTexture(d.TEXTURE_2D,p),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,16,16,0,d.RGBA,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},c=r(s),l={vertex:d.getAttribLocation(c,"position"),uv:d.getAttribLocation(c,"uv")},h={renderType:d.getUniformLocation(c,"renderType"),map:d.getUniformLocation(c,"map"),occlusionMap:d.getUniformLocation(c,"occlusionMap"),opacity:d.getUniformLocation(c,"opacity"),color:d.getUniformLocation(c,"color"),scale:d.getUniformLocation(c,"scale"),rotation:d.getUniformLocation(c,"rotation"),screenPosition:d.getUniformLocation(c,"screenPosition")}}function r(e){var n=d.createProgram(),i=d.createShader(d.FRAGMENT_SHADER),r=d.createShader(d.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return d.shaderSource(i,o+e.fragmentShader),d.shaderSource(r,o+e.vertexShader),d.compileShader(i),d.compileShader(r),d.attachShader(n,i),d.attachShader(n,r),d.linkProgram(n),n}var o,a,s,c,l,h,f,p,d=t.context,m=t.state;this.render=function(r,s,v){if(0!==e.length){var g=new u,y=v.w/v.z,_=.5*v.z,x=.5*v.w,b=16/v.w,w=new n(b*y,b),M=new u(1,1,0),E=new n(1,1),T=new W;T.min.set(v.x,v.y),T.max.set(v.x+(v.z-16),v.y+(v.w-16)),void 0===c&&i(),d.useProgram(c),m.initAttributes(),m.enableAttribute(l.vertex),m.enableAttribute(l.uv),m.disableUnusedAttributes(),d.uniform1i(h.occlusionMap,0),d.uniform1i(h.map,1),d.bindBuffer(d.ARRAY_BUFFER,o),d.vertexAttribPointer(l.vertex,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(l.uv,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),m.disable(d.CULL_FACE),m.setDepthWrite(!1);for(var S=0,P=e.length;S<P;S++){b=16/v.w,w.set(b*y,b);var A=e[S];if(g.set(A.matrixWorld.elements[12],A.matrixWorld.elements[13],A.matrixWorld.elements[14]),g.applyMatrix4(s.matrixWorldInverse),g.applyMatrix4(s.projectionMatrix),M.copy(g),E.x=v.x+M.x*_+_-8,E.y=v.y+M.y*x+x-8,T.containsPoint(E)===!0){m.activeTexture(d.TEXTURE0),m.bindTexture(d.TEXTURE_2D,null),m.activeTexture(d.TEXTURE1),m.bindTexture(d.TEXTURE_2D,f),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGB,E.x,E.y,16,16,0),d.uniform1i(h.renderType,0),d.uniform2f(h.scale,w.x,w.y),d.uniform3f(h.screenPosition,M.x,M.y,M.z),m.disable(d.BLEND),m.enable(d.DEPTH_TEST),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),m.activeTexture(d.TEXTURE0),m.bindTexture(d.TEXTURE_2D,p),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,E.x,E.y,16,16,0),d.uniform1i(h.renderType,1),m.disable(d.DEPTH_TEST),m.activeTexture(d.TEXTURE1),m.bindTexture(d.TEXTURE_2D,f),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),A.positionScreen.copy(M),A.customUpdateCallback?A.customUpdateCallback(A):A.updateLensFlares(),d.uniform1i(h.renderType,2),m.enable(d.BLEND);for(var C=0,L=A.lensFlares.length;C<L;C++){var I=A.lensFlares[C];I.opacity>.001&&I.scale>.001&&(M.x=I.x,M.y=I.y,M.z=I.z,b=I.size*I.scale/v.w,w.x=b*y,w.y=b,d.uniform3f(h.screenPosition,M.x,M.y,M.z),d.uniform2f(h.scale,w.x,w.y),d.uniform1f(h.rotation,I.rotation),d.uniform1f(h.opacity,I.opacity),d.uniform3f(h.color,I.color.r,I.color.g,I.color.b),m.setBlending(I.blending,I.blendEquation,I.blendSrc,I.blendDst),t.setTexture2D(I.texture,1),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0))}}}m.enable(d.CULL_FACE),m.enable(d.DEPTH_TEST),m.setDepthWrite(!0),t.resetGLState()}}}function $(t,e){function n(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);a=d.createBuffer(),c=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,a),d.bufferData(d.ARRAY_BUFFER,t,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),d.bufferData(d.ELEMENT_ARRAY_BUFFER,e,d.STATIC_DRAW),l=r(),h={position:d.getAttribLocation(l,"position"),uv:d.getAttribLocation(l,"uv")},f={uvOffset:d.getUniformLocation(l,"uvOffset"),uvScale:d.getUniformLocation(l,"uvScale"),rotation:d.getUniformLocation(l,"rotation"),scale:d.getUniformLocation(l,"scale"),color:d.getUniformLocation(l,"color"),map:d.getUniformLocation(l,"map"),opacity:d.getUniformLocation(l,"opacity"),modelViewMatrix:d.getUniformLocation(l,"modelViewMatrix"),projectionMatrix:d.getUniformLocation(l,"projectionMatrix"),fogType:d.getUniformLocation(l,"fogType"),fogDensity:d.getUniformLocation(l,"fogDensity"),fogNear:d.getUniformLocation(l,"fogNear"),fogFar:d.getUniformLocation(l,"fogFar"),fogColor:d.getUniformLocation(l,"fogColor"),alphaTest:d.getUniformLocation(l,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var o=n.getContext("2d");o.fillStyle="white",o.fillRect(0,0,8,8),p=new i(n),p.needsUpdate=!0}function r(){var e=d.createProgram(),n=d.createShader(d.VERTEX_SHADER),i=d.createShader(d.FRAGMENT_SHADER);return d.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),d.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),d.compileShader(n),d.compileShader(i),d.attachShader(e,n),d.attachShader(e,i),d.linkProgram(e),e}function o(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var a,c,l,h,f,p,d=t.context,m=t.state,v=new u,g=new s,y=new u;this.render=function(i,r){if(0!==e.length){void 0===l&&n(),d.useProgram(l),m.initAttributes(),m.enableAttribute(h.position),m.enableAttribute(h.uv),m.disableUnusedAttributes(),m.disable(d.CULL_FACE),m.enable(d.BLEND),d.bindBuffer(d.ARRAY_BUFFER,a),d.vertexAttribPointer(h.position,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(h.uv,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),d.uniformMatrix4fv(f.projectionMatrix,!1,r.projectionMatrix.elements),m.activeTexture(d.TEXTURE0),d.uniform1i(f.map,0);var s=0,u=0,_=i.fog;_?(d.uniform3f(f.fogColor,_.color.r,_.color.g,_.color.b),_.isFog?(d.uniform1f(f.fogNear,_.near),d.uniform1f(f.fogFar,_.far),d.uniform1i(f.fogType,1),s=1,u=1):_.isFogExp2&&(d.uniform1f(f.fogDensity,_.density),d.uniform1i(f.fogType,2),s=2,u=2)):(d.uniform1i(f.fogType,0),s=0,u=0);for(var x=0,b=e.length;x<b;x++){var w=e[x];w.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,w.matrixWorld),w.z=-w.modelViewMatrix.elements[14]}e.sort(o);for(var M=[],x=0,b=e.length;x<b;x++){var w=e[x],E=w.material;if(E.visible!==!1){d.uniform1f(f.alphaTest,E.alphaTest),d.uniformMatrix4fv(f.modelViewMatrix,!1,w.modelViewMatrix.elements),w.matrixWorld.decompose(v,g,y),M[0]=y.x,M[1]=y.y;var T=0;i.fog&&E.fog&&(T=u),s!==T&&(d.uniform1i(f.fogType,T),s=T),null!==E.map?(d.uniform2f(f.uvOffset,E.map.offset.x,E.map.offset.y),d.uniform2f(f.uvScale,E.map.repeat.x,E.map.repeat.y)):(d.uniform2f(f.uvOffset,0,0),d.uniform2f(f.uvScale,1,1)),d.uniform1f(f.opacity,E.opacity),d.uniform3f(f.color,E.color.r,E.color.g,E.color.b),d.uniform1f(f.rotation,E.rotation),d.uniform2fv(f.scale,M),m.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst),m.setDepthTest(E.depthTest),m.setDepthWrite(E.depthWrite),E.map?t.setTexture2D(E.map,0):t.setTexture2D(p,0),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0)}}m.enable(d.CULL_FACE),t.resetGLState()}}}function Z(){Object.defineProperty(this,"id",{value:Mc++}),this.uuid=hs.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=po,this.side=ro,this.shading=uo,this.vertexColors=co,this.opacity=1,this.transparent=!1,this.blendSrc=Ao,this.blendDst=Co,this.blendEquation=_o,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Fo,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,
this.overdraw=0,this.visible=!0,this._needsUpdate=!0}function J(t){Z.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function K(t){Z.call(this),this.type="MeshDepthMaterial",this.depthPacking=cs,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Q(t,e){this.min=void 0!==t?t:new u(+(1/0),+(1/0),+(1/0)),this.max=void 0!==e?e:new u(-(1/0),-(1/0),-(1/0))}function tt(t,e){this.center=void 0!==t?t:new u,this.radius=void 0!==e?e:0}function et(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function nt(t,e){this.normal=void 0!==t?t:new u(1,0,0),this.constant=void 0!==e?e:0}function it(t,e,n,i,r,o){this.planes=[void 0!==t?t:new nt,void 0!==e?e:new nt,void 0!==n?n:new nt,void 0!==i?i:new nt,void 0!==r?r:new nt,void 0!==o?o:new nt]}function rt(t,e,i,a){function s(e,n,i,r){var o=e.geometry,a=null,s=E,u=e.customDepthMaterial;if(i&&(s=T,u=e.customDistanceMaterial),u)a=u;else{var c=!1;n.morphTargets&&(o&&o.isBufferGeometry?c=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o&&o.isGeometry&&(c=o.morphTargets&&o.morphTargets.length>0));var l=e.isSkinnedMesh&&n.skinning,h=0;c&&(h|=b),l&&(h|=w),a=s[h]}if(t.localClippingEnabled&&n.clipShadows===!0&&0!==n.clippingPlanes.length){var f=a.uuid,p=n.uuid,d=S[f];void 0===d&&(d={},S[f]=d);var m=d[p];void 0===m&&(m=a.clone(),d[p]=m),a=m}a.visible=n.visible,a.wireframe=n.wireframe;var v=n.side;return F.renderSingleSided&&v==ao&&(v=ro),F.renderReverseSided&&(v===ro?v=oo:v===oo&&(v=ro)),a.side=v,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,i&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function l(t,e,n){if(t.visible!==!1){var i=0!==(t.layers.mask&e.layers.mask);if(i&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(t.frustumCulled===!1||p.intersectsObject(t)===!0)){var r=t.material;r.visible===!0&&(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),x.push(t))}for(var o=t.children,a=0,s=o.length;a<s;a++)l(o[a],e,n)}}var h=t.context,f=t.state,p=new it,d=new c,m=e.shadows,v=new n,g=new n(a.maxTextureSize,a.maxTextureSize),y=new u,_=new u,x=[],b=1,w=2,M=(b|w)+1,E=new Array(M),T=new Array(M),S={},P=[new u(1,0,0),new u(-1,0,0),new u(0,0,1),new u(0,0,-1),new u(0,1,0),new u(0,-1,0)],A=[new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,0,1),new u(0,0,-1)],C=[new r,new r,new r,new r,new r,new r],L=new K;L.depthPacking=ls,L.clipping=!0;for(var I=wc.distanceRGBA,R=ys.clone(I.uniforms),N=0;N!==M;++N){var O=0!==(N&b),D=0!==(N&w),B=L.clone();B.morphTargets=O,B.skinning=D,E[N]=B;var U=new J({defines:{USE_SHADOWMAP:""},uniforms:R,vertexShader:I.vertexShader,fragmentShader:I.fragmentShader,morphTargets:O,skinning:D,clipping:!0});T[N]=U}var F=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=no,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,n){if(F.enabled!==!1&&(F.autoUpdate!==!1||F.needsUpdate!==!1)&&0!==m.length){f.buffers.color.setClear(1,1,1,1),f.disable(h.BLEND),f.setDepthTest(!0),f.setScissorTest(!1);for(var r,a,u=0,c=m.length;u<c;u++){var b=m[u],w=b.shadow;if(void 0!==w){var M=w.camera;if(v.copy(w.mapSize),v.min(g),b&&b.isPointLight){r=6,a=!0;var E=v.x,T=v.y;C[0].set(2*E,T,E,T),C[1].set(0,T,E,T),C[2].set(3*E,T,E,T),C[3].set(E,T,E,T),C[4].set(3*E,0,E,T),C[5].set(E,0,E,T),v.x*=4,v.y*=2}else r=1,a=!1;if(null===w.map){var S={minFilter:ua,magFilter:ua,format:Aa};w.map=new o(v.x,v.y,S),M.updateProjectionMatrix()}w.isSpotLightShadow&&w.update(b),w&&w.isRectAreaLightShadow&&w.update(b);var L=w.map,I=w.matrix;_.setFromMatrixPosition(b.matrixWorld),M.position.copy(_),t.setRenderTarget(L),t.clear();for(var R=0;R<r;R++){if(a){y.copy(M.position),y.add(P[R]),M.up.copy(A[R]),M.lookAt(y);var N=C[R];f.viewport(N)}else y.setFromMatrixPosition(b.target.matrixWorld),M.lookAt(y);M.updateMatrixWorld(),M.matrixWorldInverse.getInverse(M.matrixWorld),I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(M.projectionMatrix),I.multiply(M.matrixWorldInverse),d.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),p.setFromMatrix(d),x.length=0,l(e,n,M);for(var O=0,D=x.length;O<D;O++){var B=x[O],U=i.update(B),k=B.material;if(k&&k.isMultiMaterial)for(var z=U.groups,G=k.materials,H=0,j=z.length;H<j;H++){var X=z[H],V=G[X.materialIndex];if(V.visible===!0){var Y=s(B,V,a,_);t.renderBufferDirect(M,null,U,Y,B,X)}}else{var Y=s(B,k,a,_);t.renderBufferDirect(M,null,U,Y,B,null)}}}}else console.warn("THREE.WebGLShadowMap:",b,"has no shadow.")}var W=t.getClearColor(),q=t.getClearAlpha();t.setClearColor(W,q),F.needsUpdate=!1}}}function ot(t,e){this.origin=void 0!==t?t:new u,this.direction=void 0!==e?e:new u}function at(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||at.DefaultOrder}function st(){this.mask=1}function ut(){function t(){r.setFromEuler(i,!1)}function e(){i.setFromQuaternion(r,void 0,!1)}Object.defineProperty(this,"id",{value:Ec++}),this.uuid=hs.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ut.DefaultUp.clone();var n=new u,i=new at,r=new s,o=new u(1,1,1);i.onChange(t),r.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:i},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new c},normalMatrix:{value:new et}}),this.matrix=new c,this.matrixWorld=new c,this.matrixAutoUpdate=ut.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new st,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}function ct(t,e){this.start=void 0!==t?t:new u,this.end=void 0!==e?e:new u}function lt(t,e,n){this.a=void 0!==t?t:new u,this.b=void 0!==e?e:new u,this.c=void 0!==n?n:new u}function ht(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new u,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new V,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function ft(t){Z.call(this),this.type="MeshBasicMaterial",this.color=new V(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function pt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=hs.generateUUID(),this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function dt(t,e){pt.call(this,new Int8Array(t),e)}function mt(t,e){pt.call(this,new Uint8Array(t),e)}function vt(t,e){pt.call(this,new Uint8ClampedArray(t),e)}function gt(t,e){pt.call(this,new Int16Array(t),e)}function yt(t,e){pt.call(this,new Uint16Array(t),e)}function _t(t,e){pt.call(this,new Int32Array(t),e)}function xt(t,e){pt.call(this,new Uint32Array(t),e)}function bt(t,e){pt.call(this,new Float32Array(t),e)}function wt(t,e){pt.call(this,new Float64Array(t),e)}function Mt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Et(t){for(var e=t.length,n=-(1/0);e--;)t[e]>n&&(n=t[e]);return n}function Tt(){return Tc++}function St(){Object.defineProperty(this,"id",{value:Tt()}),this.uuid=hs.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Pt(){Object.defineProperty(this,"id",{value:Tt()}),this.uuid=hs.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function At(t,e){ut.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Pt,this.material=void 0!==e?e:new ft({color:16777215*Math.random()}),this.drawMode=Ka,this.updateMorphTargets()}function Ct(t,e,n,i,r,o){St.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new Lt(t,e,n,i,r,o)),this.mergeVertices()}function Lt(t,e,n,i,r,o){function a(t,e,n,i,r,o,a,m,v,g,y){var _,x,b=o/v,w=a/g,M=o/2,E=a/2,T=m/2,S=v+1,P=g+1,A=0,C=0,L=new u;for(x=0;x<P;x++){var I=x*w-E;for(_=0;_<S;_++){var R=_*b-M;L[t]=R*i,L[e]=I*r,L[n]=T,l.push(L.x,L.y,L.z),L[t]=0,L[e]=0,L[n]=m>0?1:-1,h.push(L.x,L.y,L.z),f.push(_/v),f.push(1-x/g),A+=1}}for(x=0;x<g;x++)for(_=0;_<v;_++){var N=p+_+S*x,O=p+_+S*(x+1),D=p+(_+1)+S*(x+1),B=p+(_+1)+S*x;c.push(N,O,B),c.push(O,D,B),C+=6}s.addGroup(d,C,y),d+=C,p+=A}Pt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var s=this;i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var c=[],l=[],h=[],f=[],p=0,d=0;a("z","y","x",-1,-1,n,e,t,o,r,0),a("z","y","x",1,-1,n,e,-t,o,r,1),a("x","z","y",1,1,t,n,e,i,o,2),a("x","z","y",1,-1,t,n,-e,i,o,3),a("x","y","z",1,-1,t,e,n,i,r,4),a("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(c),this.addAttribute("position",new bt(l,3)),this.addAttribute("normal",new bt(h,3)),this.addAttribute("uv",new bt(f,2))}function It(t,e,n,i){St.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Rt(t,e,n,i))}function Rt(t,e,n,i){Pt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r,o,a=t/2,s=e/2,u=Math.floor(n)||1,c=Math.floor(i)||1,l=u+1,h=c+1,f=t/u,p=e/c,d=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*p-s;for(r=0;r<l;r++){var _=r*f-a;m.push(_,-y,0),v.push(0,0,1),g.push(r/u),g.push(1-o/c)}}for(o=0;o<c;o++)for(r=0;r<u;r++){var x=r+l*o,b=r+l*(o+1),w=r+1+l*(o+1),M=r+1+l*o;d.push(x,b,M),d.push(b,w,M)}this.setIndex(d),this.addAttribute("position",new bt(m,3)),this.addAttribute("normal",new bt(v,3)),this.addAttribute("uv",new bt(g,2))}function Nt(){ut.call(this),this.type="Camera",this.matrixWorldInverse=new c,this.projectionMatrix=new c}function Ot(t,e,n,i){Nt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Dt(t,e,n,i,r,o){Nt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Bt(t,e,n){function i(t){s=t}function r(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(u=t.UNSIGNED_INT,c=4):n.array instanceof Uint16Array?(u=t.UNSIGNED_SHORT,c=2):(u=t.UNSIGNED_BYTE,c=1)}function o(e,i){t.drawElements(s,i,u,e*c),n.calls++,n.vertices+=i,s===t.TRIANGLES&&(n.faces+=i/3)}function a(i,r,o){var a=e.get("ANGLE_instanced_arrays");return null===a?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(a.drawElementsInstancedANGLE(s,o,u,r*c,i.maxInstancedCount),n.calls++,n.vertices+=o*i.maxInstancedCount,void(s===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*o/3)))}var s,u,c;return{setMode:i,setIndex:r,render:o,renderInstances:a}}function Ut(t,e,n){function i(t){a=t}function r(e,i){t.drawArrays(a,e,i),n.calls++,n.vertices+=i,a===t.TRIANGLES&&(n.faces+=i/3)}function o(i){var r=e.get("ANGLE_instanced_arrays");if(null===r)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var o=i.attributes.position,s=0;o.isInterleavedBufferAttribute?(s=o.data.count,r.drawArraysInstancedANGLE(a,0,s,i.maxInstancedCount)):(s=o.count,r.drawArraysInstancedANGLE(a,0,s,i.maxInstancedCount)),n.calls++,n.vertices+=s*i.maxInstancedCount,a===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*s/3)}var a;return{setMode:i,render:r,renderInstances:o}}function Ft(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new u,color:new V,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":i={position:new u,direction:new u,color:new V,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":i={position:new u,color:new V,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"HemisphereLight":i={direction:new u,skyColor:new V,groundColor:new V};break;case"RectAreaLight":i={color:new V,position:new u,halfWidth:new u,halfHeight:new u}}return t[e.id]=i,i}}}function kt(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}function zt(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),kt(n)),i}function Gt(t){switch(t){case es:return["Linear","( value )"];case ns:return["sRGB","( value )"];case rs:return["RGBE","( value )"];case as:return["RGBM","( value, 7.0 )"];case ss:return["RGBM","( value, 16.0 )"];case us:return["RGBD","( value, 256.0 )"];case is:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Ht(t,e){var n=Gt(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function jt(t,e){var n=Gt(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Xt(t,e){var n;switch(e){case Wo:n="Linear";break;case qo:n="Reinhard";break;case $o:n="Uncharted2";break;case Zo:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Vt(t,e,n){t=t||{};var i=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return i.filter(qt).join("\n")}function Yt(t){var e=[];for(var n in t){var i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join("\n")}function Wt(t,e,n){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=t.getActiveAttrib(e,o),s=a.name;i[s]=t.getAttribLocation(e,s)}return i}function qt(t){return""!==t}function $t(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Zt(t){function e(t,e){var n=_c[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Zt(n)}var n=/#include +<([\w\d.]+)>/g;return t.replace(n,e)}function Jt(t){function e(t,e,n,i){for(var r="",o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r}var n=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(n,e)}function Kt(t,e,n,i){var r=t.context,o=n.extensions,a=n.defines,s=n.__webglShader.vertexShader,u=n.__webglShader.fragmentShader,c="SHADOWMAP_TYPE_BASIC";i.shadowMapType===no?c="SHADOWMAP_TYPE_PCF":i.shadowMapType===io&&(c="SHADOWMAP_TYPE_PCF_SOFT");var l="ENVMAP_TYPE_CUBE",h="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(n.envMap.mapping){case Ko:case Qo:l="ENVMAP_TYPE_CUBE";break;case ia:case ra:l="ENVMAP_TYPE_CUBE_UV";break;case ta:case ea:l="ENVMAP_TYPE_EQUIREC";break;case na:l="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case Qo:case ea:h="ENVMAP_MODE_REFRACTION"}switch(n.combine){case jo:f="ENVMAP_BLENDING_MULTIPLY";break;case Xo:f="ENVMAP_BLENDING_MIX";break;case Vo:f="ENVMAP_BLENDING_ADD"}}var p,d,m=t.gammaFactor>0?t.gammaFactor:1,v=Vt(o,i,t.extensions),g=Yt(a),y=r.createProgram();n.isRawShaderMaterial?(p=[g,"\n"].filter(qt).join("\n"),d=[v,g,"\n"].filter(qt).join("\n")):(p=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,g,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(qt).join("\n"),d=[v,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,g,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+l:"",i.envMap?"#define "+h:"",i.envMap?"#define "+f:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(i.numClippingPlanes-i.numClipIntersection),i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",i.toneMapping!==Yo?"#define TONE_MAPPING":"",i.toneMapping!==Yo?_c.tonemapping_pars_fragment:"",i.toneMapping!==Yo?Xt("toneMapping",i.toneMapping):"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?_c.encodings_pars_fragment:"",i.mapEncoding?Ht("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?Ht("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Ht("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?jt("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(qt).join("\n")),s=Zt(s,i),s=$t(s,i),u=Zt(u,i),u=$t(u,i),n.isShaderMaterial||(s=Jt(s),u=Jt(u));var _=p+s,x=d+u,b=zt(r,r.VERTEX_SHADER,_),w=zt(r,r.FRAGMENT_SHADER,x);r.attachShader(y,b),r.attachShader(y,w),void 0!==n.index0AttributeName?r.bindAttribLocation(y,0,n.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);var M=r.getProgramInfoLog(y),E=r.getShaderInfoLog(b),T=r.getShaderInfoLog(w),S=!0,P=!0;r.getProgramParameter(y,r.LINK_STATUS)===!1?(S=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(y,r.VALIDATE_STATUS),"gl.getProgramInfoLog",M,E,T)):""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==E&&""!==T||(P=!1),P&&(this.diagnostics={runnable:S,material:n,programLog:M,vertexShader:{log:E,prefix:p},fragmentShader:{log:T,prefix:d}}),r.deleteShader(b),r.deleteShader(w);var A;this.getUniforms=function(){return void 0===A&&(A=new X(r,y,t)),A};var C;return this.getAttributes=function(){return void 0===C&&(C=Wt(r,y)),C},this.destroy=function(){r.deleteProgram(y),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Sc++,this.code=e,this.usedTimes=1,this.program=y,this.vertexShader=b,this.fragmentShader=w,this}function Qt(t,e){function n(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var n=e.maxVertexUniforms,i=Math.floor((n-20)/4),r=i;return void 0!==t&&t&&t.isSkinnedMesh&&(r=Math.min(t.skeleton.bones.length,r),r<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")),r}function i(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=es,n===es&&e&&(n=is),n}var r=[],o={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking"];this.getParameters=function(r,a,s,u,c,l){var h=o[r.type],f=n(l),p=t.getPrecision();null!==r.precision&&(p=e.getMaxPrecision(r.precision),p!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",p,"instead."));var d=t.getCurrentRenderTarget(),m={shaderID:h,precision:p,supportsVertexTextures:e.vertexTextures,outputEncoding:i(d?d.texture:null,t.gammaOutput),map:!!r.map,mapEncoding:i(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:i(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(r.envMap.mapping===ia||r.envMap.mapping===ra),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:i(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,combine:r.combine,vertexColors:r.vertexColors,fog:!!s,useFog:r.fog,fogExp:s&&s.isFogExp2,flatShading:r.shading===so,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:f,useVertexTexture:e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numClippingPlanes:u,numClipIntersection:c,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&a.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===ao,flipSided:r.side===oo,depthPacking:void 0!==r.depthPacking&&r.depthPacking};return m},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var r=0;r<a.length;r++)n.push(e[a[r]]);return n.join()},this.acquireProgram=function(e,n,i){for(var o,a=0,s=r.length;a<s;a++){var u=r[a];if(u.code===i){o=u,++o.usedTimes;break}}return void 0===o&&(o=new Kt(t,i,e,n),r.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function te(t,e,n){function i(t){var r=t.target,s=u[r.id];null!==s.index&&o(s.index),a(s.attributes),r.removeEventListener("dispose",i),delete u[r.id];var c=e.get(r);c.wireframe&&o(c.wireframe),e.delete(r);var l=e.get(s);l.wireframe&&o(l.wireframe),e.delete(s),n.memory.geometries--}function r(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function o(e){var n=r(e);void 0!==n&&(t.deleteBuffer(n),s(e))}function a(t){for(var e in t)o(t[e])}function s(t){t.isInterleavedBufferAttribute?e.delete(t.data):e.delete(t)}var u={};return{get:function(t){var e=t.geometry;if(void 0!==u[e.id])return u[e.id];e.addEventListener("dispose",i);var r;return e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Pt).setFromObject(t)),r=e._bufferGeometry),u[e.id]=r,n.memory.geometries++,r}}}function ee(t,e,n){function i(e){var n=l.get(e);e.geometry.isGeometry&&n.updateFromObject(e);var i=n.index,o=n.attributes;null!==i&&r(i,t.ELEMENT_ARRAY_BUFFER);for(var a in o)r(o[a],t.ARRAY_BUFFER);var s=n.morphAttributes;for(var a in s)for(var u=s[a],c=0,h=u.length;c<h;c++)r(u[c],t.ARRAY_BUFFER);return n}function r(t,n){var i=t.isInterleavedBufferAttribute?t.data:t,r=e.get(i);void 0===r.__webglBuffer?o(r,i,n):r.version!==i.version&&a(r,i,n)}function o(e,n,i){e.__webglBuffer=t.createBuffer(),t.bindBuffer(i,e.__webglBuffer);var r=n.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(i,n.array,r);var o=t.FLOAT,a=n.array;a instanceof Float32Array?o=t.FLOAT:a instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):a instanceof Uint16Array?o=t.UNSIGNED_SHORT:a instanceof Int16Array?o=t.SHORT:a instanceof Uint32Array?o=t.UNSIGNED_INT:a instanceof Int32Array?o=t.INT:a instanceof Int8Array?o=t.BYTE:a instanceof Uint8Array&&(o=t.UNSIGNED_BYTE),e.bytesPerElement=a.BYTES_PER_ELEMENT,e.type=o,e.version=n.version,n.onUploadCallback()}function a(e,n,i){t.bindBuffer(i,e.__webglBuffer),n.dynamic===!1?t.bufferData(i,n.array,t.STATIC_DRAW):n.updateRange.count===-1?t.bufferSubData(i,0,n.array):0===n.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,n.updateRange.offset*n.array.BYTES_PER_ELEMENT,n.array.subarray(n.updateRange.offset,n.updateRange.offset+n.updateRange.count)),n.updateRange.count=0),e.version=n.version}function s(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function u(t){return t.isInterleavedBufferAttribute?e.get(t.data):e.get(t)}function c(n){var i=e.get(n);if(void 0!==i.wireframe)return i.wireframe;var o=[],a=n.index,s=n.attributes;if(null!==a)for(var u=a.array,c=0,l=u.length;c<l;c+=3){var h=u[c+0],f=u[c+1],p=u[c+2];o.push(h,f,f,p,p,h)}else for(var u=s.position.array,c=0,l=u.length/3-1;c<l;c+=3){var h=c+0,f=c+1,p=c+2;o.push(h,f,f,p,p,h)}var d=new(Et(o)>65535?xt:yt)(o,1);return r(d,t.ELEMENT_ARRAY_BUFFER),i.wireframe=d,d}var l=new te(t,e,n);return{getAttributeBuffer:s,getAttributeProperties:u,getWireframeAttribute:c,update:i}}function ne(t,e,n,i,r,o,a){function s(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n);
var r=i.getContext("2d");return r.drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function u(t){return hs.isPowerOfTwo(t.width)&&hs.isPowerOfTwo(t.height)}function c(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=hs.nearestPowerOfTwo(t.width),e.height=hs.nearestPowerOfTwo(t.height);var n=e.getContext("2d");return n.drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function l(t){return t.wrapS!==aa||t.wrapT!==aa||t.minFilter!==ua&&t.minFilter!==ha}function h(e){return e===ua||e===ca||e===la?t.NEAREST:t.LINEAR}function f(t){var e=t.target;e.removeEventListener("dispose",f),d(e),P.textures--}function p(t){var e=t.target;e.removeEventListener("dispose",p),m(e),P.textures--}function d(e){var n=i.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}i.delete(e)}function m(e){var n=i.get(e),r=i.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);i.delete(e.texture),i.delete(e)}}function v(e,r){var o=i.get(e);if(e.version>0&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(a.complete!==!1)return void x(o,e,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+r),n.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function g(e,a){var c=i.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",f),c.__image__webglTextureCube=t.createTexture(),P.textures++),n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var l=e&&e.isCompressedTexture,h=e.image[0]&&e.image[0].isDataTexture,p=[],d=0;d<6;d++)l||h?p[d]=h?e.image[d].image:e.image[d]:p[d]=s(e.image[d],r.maxCubemapSize);var m=p[0],v=u(m),g=o(e.format),y=o(e.type);_(t.TEXTURE_CUBE_MAP,e,v);for(var d=0;d<6;d++)if(l)for(var x,b=p[d].mipmaps,w=0,M=b.length;w<M;w++)x=b[w],e.format!==Aa&&e.format!==Pa?n.getCompressedTextureFormats().indexOf(g)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+d,w,g,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+d,w,g,x.width,x.height,0,g,y,x.data);else h?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,g,p[d].width,p[d].height,0,g,y,p[d].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,g,g,y,p[d]);e.generateMipmaps&&v&&t.generateMipmap(t.TEXTURE_CUBE_MAP),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function y(e,r){n.activeTexture(t.TEXTURE0+r),n.bindTexture(t.TEXTURE_CUBE_MAP,i.get(e).__webglTexture)}function _(n,a,s){var u;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===aa&&a.wrapT===aa||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,h(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,h(a.minFilter)),a.minFilter!==ua&&a.minFilter!==ha&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),u=e.get("EXT_texture_filter_anisotropic")){if(a.type===xa&&null===e.get("OES_texture_float_linear"))return;if(a.type===ba&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function x(e,i,a){void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",f),e.__webglTexture=t.createTexture(),P.textures++),n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment);var h=s(i.image,r.maxTextureSize);l(i)&&u(h)===!1&&(h=c(h));var p=u(h),d=o(i.format),m=o(i.type);_(t.TEXTURE_2D,i,p);var v,g=i.mipmaps;if(i.isDepthTexture){var y=t.DEPTH_COMPONENT;if(i.type===xa){if(!A)throw new Error("Float Depth Texture only supported in WebGL2.0");y=t.DEPTH_COMPONENT32F}else A&&(y=t.DEPTH_COMPONENT16);i.format===Ra&&y===t.DEPTH_COMPONENT&&i.type!==ga&&i.type!==_a&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=ga,m=o(i.type)),i.format===Na&&(y=t.DEPTH_STENCIL,i.type!==Ta&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Ta,m=o(i.type))),n.texImage2D(t.TEXTURE_2D,0,y,h.width,h.height,0,d,m,null)}else if(i.isDataTexture)if(g.length>0&&p){for(var x=0,b=g.length;x<b;x++)v=g[x],n.texImage2D(t.TEXTURE_2D,x,d,v.width,v.height,0,d,m,v.data);i.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,d,h.width,h.height,0,d,m,h.data);else if(i.isCompressedTexture)for(var x=0,b=g.length;x<b;x++)v=g[x],i.format!==Aa&&i.format!==Pa?n.getCompressedTextureFormats().indexOf(d)>-1?n.compressedTexImage2D(t.TEXTURE_2D,x,d,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,x,d,v.width,v.height,0,d,m,v.data);else if(g.length>0&&p){for(var x=0,b=g.length;x<b;x++)v=g[x],n.texImage2D(t.TEXTURE_2D,x,d,d,m,v);i.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,d,d,m,h);i.generateMipmaps&&p&&t.generateMipmap(t.TEXTURE_2D),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function b(e,r,a,s){var u=o(r.texture.format),c=o(r.texture.type);n.texImage2D(s,0,u,r.width,r.height,0,u,c,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function w(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function M(e,n){var r=n&&n.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),v(n.depthTexture,0);var o=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Ra)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(n.depthTexture.format!==Na)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}function E(e){var n=i.get(e),r=e.isWebGLRenderTargetCube===!0;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");M(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),w(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),w(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function T(e){var r=i.get(e),o=i.get(e.texture);e.addEventListener("dispose",p),o.__webglTexture=t.createTexture(),P.textures++;var a=e.isWebGLRenderTargetCube===!0,s=u(e);if(a){r.__webglFramebuffer=[];for(var c=0;c<6;c++)r.__webglFramebuffer[c]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(a){n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),_(t.TEXTURE_CUBE_MAP,e.texture,s);for(var c=0;c<6;c++)b(r.__webglFramebuffer[c],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+c);e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),_(t.TEXTURE_2D,e.texture,s),b(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&E(e)}function S(e){var r=e.texture;if(r.generateMipmaps&&u(e)&&r.minFilter!==ua&&r.minFilter!==ha){var o=e&&e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=i.get(r).__webglTexture;n.bindTexture(o,a),t.generateMipmap(o),n.bindTexture(o,null)}}var P=a.memory,A="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=v,this.setTextureCube=g,this.setTextureCubeDynamic=y,this.setupRenderTarget=T,this.updateRenderTargetMipmap=S}function ie(){var t={};return{get:function(e){var n=e.uuid,i=t[n];return void 0===i&&(i={},t[n]=i),i},delete:function(e){delete t[e.uuid]},clear:function(){t={}}}}function re(t,e,n){function i(){var e=!1,n=new r,i=null,o=new r;return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,r,a,s){s===!0&&(e*=a,i*=a,r*=a),n.set(e,i,r,a),o.equals(n)===!1&&(t.clearColor(e,i,r,a),o.copy(n))},reset:function(){e=!1,i=null,o.set(0,0,0,1)}}}function o(){var e=!1,n=null,i=null,r=null;return{setTest:function(e){e?p(t.DEPTH_TEST):d(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case Do:t.depthFunc(t.NEVER);break;case Bo:t.depthFunc(t.ALWAYS);break;case Uo:t.depthFunc(t.LESS);break;case Fo:t.depthFunc(t.LEQUAL);break;case ko:t.depthFunc(t.EQUAL);break;case zo:t.depthFunc(t.GEQUAL);break;case Go:t.depthFunc(t.GREATER);break;case Ho:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}}function a(){var e=!1,n=null,i=null,r=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(e){e?p(t.STENCIL_TEST):d(t.STENCIL_TEST)},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&o===a||(t.stencilFunc(e,n,a),i=e,r=n,o=a)},setOp:function(e,n,i){a===e&&s===n&&u===i||(t.stencilOp(e,n,i),a=e,s=n,u=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,o=null,a=null,s=null,u=null,c=null}}}function s(e,n,i){var r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<i;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}function u(){F.setClear(0,0,0,1),k.setClear(1),z.setClear(0),p(t.DEPTH_TEST),x(Fo),T(!1),S(Zr),p(t.CULL_FACE),p(t.BLEND),v(po)}function c(){for(var t=0,e=H.length;t<e;t++)H[t]=0}function l(n){if(H[n]=1,0===j[n]&&(t.enableVertexAttribArray(n),j[n]=1),0!==X[n]){var i=e.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(n,0),X[n]=0}}function h(e,n,i){H[e]=1,0===j[e]&&(t.enableVertexAttribArray(e),j[e]=1),X[e]!==n&&(i.vertexAttribDivisorANGLE(e,n),X[e]=n)}function f(){for(var e=0,n=j.length;e!==n;++e)j[e]!==H[e]&&(t.disableVertexAttribArray(e),j[e]=0)}function p(e){V[e]!==!0&&(t.enable(e),V[e]=!0)}function d(e){V[e]!==!1&&(t.disable(e),V[e]=!1)}function m(){if(null===Y&&(Y=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)Y.push(n[i]);return Y}function v(e,i,r,o,a,s,u,c){e!==fo?p(t.BLEND):d(t.BLEND),e===W&&c===tt||(e===mo?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===vo?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===go?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),W=e,tt=c),e===yo?(a=a||i,s=s||r,u=u||o,i===q&&a===J||(t.blendEquationSeparate(n(i),n(a)),q=i,J=a),r===$&&o===Z&&s===K&&u===Q||(t.blendFuncSeparate(n(r),n(o),n(s),n(u)),$=r,Z=o,K=s,Q=u)):(q=null,$=null,Z=null,J=null,K=null,Q=null)}function g(t){F.setMask(t)}function y(t){k.setTest(t)}function _(t){k.setMask(t)}function x(t){k.setFunc(t)}function b(t){z.setTest(t)}function w(t){z.setMask(t)}function M(t,e,n){z.setFunc(t,e,n)}function E(t,e,n){z.setOp(t,e,n)}function T(e){et!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),et=e)}function S(e){e!==$r?(p(t.CULL_FACE),e!==nt&&(e===Zr?t.cullFace(t.BACK):e===Jr?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):d(t.CULL_FACE),nt=e}function P(e){e!==it&&(ct&&t.lineWidth(e),it=e)}function A(e,n,i){e?(p(t.POLYGON_OFFSET_FILL),rt===n&&ot===i||(t.polygonOffset(n,i),rt=n,ot=i)):d(t.POLYGON_OFFSET_FILL)}function C(){return at}function L(e){at=e,e?p(t.SCISSOR_TEST):d(t.SCISSOR_TEST)}function I(e){void 0===e&&(e=t.TEXTURE0+st-1),lt!==e&&(t.activeTexture(e),lt=e)}function R(e,n){null===lt&&I();var i=ht[lt];void 0===i&&(i={type:void 0,texture:void 0},ht[lt]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||dt[e]),i.type=e,i.texture=n)}function N(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}}function O(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}}function D(e){ft.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),ft.copy(e))}function B(e){pt.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),pt.copy(e))}function U(){for(var e=0;e<j.length;e++)1===j[e]&&(t.disableVertexAttribArray(e),j[e]=0);V={},Y=null,lt=null,ht={},W=null,et=null,nt=null,F.reset(),k.reset(),z.reset()}var F=new i,k=new o,z=new a,G=t.getParameter(t.MAX_VERTEX_ATTRIBS),H=new Uint8Array(G),j=new Uint8Array(G),X=new Uint8Array(G),V={},Y=null,W=null,q=null,$=null,Z=null,J=null,K=null,Q=null,tt=!1,et=null,nt=null,it=null,rt=null,ot=null,at=null,st=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ut=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),ct=parseFloat(ut)>=1,lt=null,ht={},ft=new r,pt=new r,dt={};return dt[t.TEXTURE_2D]=s(t.TEXTURE_2D,t.TEXTURE_2D,1),dt[t.TEXTURE_CUBE_MAP]=s(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:F,depth:k,stencil:z},init:u,initAttributes:c,enableAttribute:l,enableAttributeAndDivisor:h,disableUnusedAttributes:f,enable:p,disable:d,getCompressedTextureFormats:m,setBlending:v,setColorWrite:g,setDepthTest:y,setDepthWrite:_,setDepthFunc:x,setStencilTest:b,setStencilWrite:w,setStencilFunc:M,setStencilOp:E,setFlipSided:T,setCullFace:S,setLineWidth:P,setPolygonOffset:A,getScissorTest:C,setScissorTest:L,activeTexture:I,bindTexture:R,compressedTexImage2D:N,texImage2D:O,scissor:D,viewport:B,reset:U}}function oe(t,e,n){function i(){if(void 0!==o)return o;var n=e.get("EXT_texture_filter_anisotropic");return o=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==n.precision?n.precision:"highp",s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=n.logarithmicDepthBuffer===!0&&!!e.get("EXT_frag_depth"),c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_TEXTURE_SIZE),f=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),d=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,y=!!e.get("OES_texture_float"),_=g&&y;return{getMaxAnisotropy:i,getMaxPrecision:r,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:_}}function ae(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}}}function se(){function t(){c.value!==i&&(c.value=i,c.needsUpdate=r>0),n.numPlanes=r,n.numIntersection=0}function e(t,e,i,r){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,r!==!0||null===a){var l=i+4*o,h=e.matrixWorldInverse;u.getNormalMatrix(h),(null===a||a.length<l)&&(a=new Float32Array(l));for(var f=0,p=i;f!==o;++f,p+=4)s.copy(t[f]).applyMatrix4(h,u),s.normal.toArray(a,p),a[p+3]=s.constant}c.value=a,c.needsUpdate=!0}return n.numPlanes=o,a}var n=this,i=null,r=0,o=!1,a=!1,s=new nt,u=new et,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==r||o;return o=n,i=e(t,a,0),r=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,u,l,h,f){if(!o||null===n||0===n.length||a&&!u)a?e(null):t();else{var p=a?0:r,d=4*p,m=h.clippingState||null;c.value=m,m=e(n,l,d,f);for(var v=0;v!==d;++v)m[v]=i[v];h.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=p}}}function ue(t){function e(){return null===pt?St:1}function n(){ue.init(),ue.scissor(yt.copy(Ct).multiplyScalar(St)),ue.viewport(xt.copy(Nt).multiplyScalar(St)),ue.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,Z)}function i(){ht=null,gt=null,vt="",mt=-1,ue.reset()}function o(t){t.preventDefault(),i(),n(),ce.clear()}function a(t){var e=t.target;e.removeEventListener("dispose",a),s(e)}function s(t){l(t),ce.delete(t)}function l(t){var e=ce.get(t).program;t.program=void 0,void 0!==e&&fe.releaseProgram(e)}function h(t,e,n,i){var r;if(n&&n.isInstancedBufferGeometry&&(r=Kt.get("ANGLE_instanced_arrays"),null===r))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===i&&(i=0),ue.initAttributes();var o=n.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var u in a){var c=a[u];if(c>=0){var l=o[u];if(void 0!==l){var h=l.normalized,f=l.itemSize,p=he.getAttributeProperties(l),d=p.__webglBuffer,m=p.type,v=p.bytesPerElement;if(l.isInterleavedBufferAttribute){var g=l.data,y=g.stride,_=l.offset;g&&g.isInstancedInterleavedBuffer?(ue.enableAttributeAndDivisor(c,g.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):ue.enableAttribute(c),Zt.bindBuffer(Zt.ARRAY_BUFFER,d),Zt.vertexAttribPointer(c,f,m,h,y*v,(i*y+_)*v)}else l.isInstancedBufferAttribute?(ue.enableAttributeAndDivisor(c,l.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):ue.enableAttribute(c),Zt.bindBuffer(Zt.ARRAY_BUFFER,d),Zt.vertexAttribPointer(c,f,m,h,0,i*f*v)}else if(void 0!==s){var x=s[u];if(void 0!==x)switch(x.length){case 2:Zt.vertexAttrib2fv(c,x);break;case 3:Zt.vertexAttrib3fv(c,x);break;case 4:Zt.vertexAttrib4fv(c,x);break;default:Zt.vertexAttrib1fv(c,x)}}}}ue.disableUnusedAttributes()}function f(t,e){return Math.abs(e[0])-Math.abs(t[0])}function p(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function d(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function m(t,e,n,i,r){var o,a;n.transparent?(o=ot,a=++at):(o=et,a=++nt);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=n,s.z=Vt.z,s.group=r):(s={id:t.id,object:t,geometry:e,material:n,z:Vt.z,group:r},o.push(s))}function v(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),jt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),y(jt)}function g(t){return jt.center.set(0,0,0),jt.radius=.7071067811865476,jt.applyMatrix4(t.matrixWorld),y(jt)}function y(t){if(!kt.intersectsSphere(t))return!1;var e=zt.numPlanes;if(0===e)return!0;var n=lt.clippingPlanes,i=t.center,r=-t.radius,o=0;do if(n[o].distanceToPoint(i)<r)return!1;while(++o!==e);return!0}function _(t,e){if(t.visible!==!1){var n=0!==(t.layers.mask&e.layers.mask);if(n)if(t.isLight)Q.push(t);else if(t.isSprite)t.frustumCulled!==!1&&g(t)!==!0||ut.push(t);else if(t.isLensFlare)ct.push(t);else if(t.isImmediateRenderObject)lt.sortObjects===!0&&(Vt.setFromMatrixPosition(t.matrixWorld),Vt.applyMatrix4(Xt)),m(t,null,t.material,Vt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||v(t)===!0)){var i=t.material;if(i.visible===!0){lt.sortObjects===!0&&(Vt.setFromMatrixPosition(t.matrixWorld),Vt.applyMatrix4(Xt));var r=he.update(t);if(i.isMultiMaterial)for(var o=r.groups,a=i.materials,s=0,u=o.length;s<u;s++){var c=o[s],l=a[c.materialIndex];l.visible===!0&&m(t,r,l,Vt.z,c)}else m(t,r,i,Vt.z,null)}}for(var h=t.children,s=0,u=h.length;s<u;s++)_(h[s],e)}}function x(t,e,n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r],s=a.object,u=a.geometry,c=void 0===i?a.material:i,l=a.group;if(s.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.onBeforeRender(lt,e,n,u,c,l),s.isImmediateRenderObject){w(c);var h=M(n,e.fog,c,s);vt="",s.render(function(t){lt.renderBufferImmediate(t,h,c)})}else lt.renderBufferDirect(n,e.fog,u,c,s,l);s.onAfterRender(lt,e,n,u,c,l)}}function b(t,e,n){var i=ce.get(t),r=fe.getParameters(t,qt,e,zt.numPlanes,zt.numIntersection,n),o=fe.getProgramCode(t,r),s=i.program,u=!0;if(void 0===s)t.addEventListener("dispose",a);else if(s.code!==o)l(t);else{if(void 0!==r.shaderID)return;u=!1}if(u){if(r.shaderID){var c=wc[r.shaderID];i.__webglShader={name:t.type,uniforms:ys.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else i.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=i.__webglShader,s=fe.acquireProgram(t,r,o),i.program=s,t.program=s}var h=s.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var f=0;f<lt.maxMorphTargets;f++)h["morphTarget"+f]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var f=0;f<lt.maxMorphNormals;f++)h["morphNormal"+f]>=0&&t.numSupportedMorphNormals++}var p=i.__webglShader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&t.clipping!==!0||(i.numClippingPlanes=zt.numPlanes,i.numIntersection=zt.numIntersection,p.clippingPlanes=zt.uniform),i.fog=e,i.lightsHash=qt.hash,t.lights&&(p.ambientLightColor.value=qt.ambient,p.directionalLights.value=qt.directional,p.spotLights.value=qt.spot,p.rectAreaLights.value=qt.rectArea,p.pointLights.value=qt.point,p.hemisphereLights.value=qt.hemi,p.directionalShadowMap.value=qt.directionalShadowMap,p.directionalShadowMatrix.value=qt.directionalShadowMatrix,p.spotShadowMap.value=qt.spotShadowMap,p.spotShadowMatrix.value=qt.spotShadowMatrix,p.pointShadowMap.value=qt.pointShadowMap,p.pointShadowMatrix.value=qt.pointShadowMatrix);var d=i.program.getUniforms(),m=X.seqWithValue(d.seq,p);i.uniformsList=m}function w(t){t.side===ao?ue.disable(Zt.CULL_FACE):ue.enable(Zt.CULL_FACE),ue.setFlipSided(t.side===oo),t.transparent===!0?ue.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):ue.setBlending(fo),ue.setDepthFunc(t.depthFunc),ue.setDepthTest(t.depthTest),ue.setDepthWrite(t.depthWrite),ue.setColorWrite(t.colorWrite),ue.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function M(t,e,n,i){bt=0;var r=ce.get(n);if(Gt&&(Ht||t!==gt)){var o=t===gt&&n.id===mt;zt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,r,o)}n.needsUpdate===!1&&(void 0===r.program?n.needsUpdate=!0:n.fog&&r.fog!==e?n.needsUpdate=!0:n.lights&&r.lightsHash!==qt.hash?n.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===zt.numPlanes&&r.numIntersection===zt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(b(n,e,i),n.needsUpdate=!1);var a=!1,s=!1,u=!1,c=r.program,l=c.getUniforms(),h=r.__webglShader.uniforms;if(c.id!==ht&&(Zt.useProgram(c.program),ht=c.id,a=!0,s=!0,u=!0),n.id!==mt&&(mt=n.id,s=!0),a||t!==gt){if(l.set(Zt,t,"projectionMatrix"),te.logarithmicDepthBuffer&&l.setValue(Zt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==gt&&(gt=t,s=!0,u=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var f=l.map.cameraPosition;void 0!==f&&f.setValue(Zt,Vt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&l.setValue(Zt,"viewMatrix",t.matrixWorldInverse),l.set(Zt,lt,"toneMappingExposure"),l.set(Zt,lt,"toneMappingWhitePoint")}if(n.skinning){l.setOptional(Zt,i,"bindMatrix"),l.setOptional(Zt,i,"bindMatrixInverse");var p=i.skeleton;p&&(te.floatVertexTextures&&p.useVertexTexture?(l.set(Zt,p,"boneTexture"),l.set(Zt,p,"boneTextureWidth"),l.set(Zt,p,"boneTextureHeight")):l.setOptional(Zt,p,"boneMatrices"))}return s&&(n.lights&&D(h,u),e&&n.fog&&A(h,e),(n.isMeshBasicMaterial||n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isMeshNormalMaterial||n.isMeshDepthMaterial)&&E(h,n),n.isLineBasicMaterial?T(h,n):n.isLineDashedMaterial?(T(h,n),S(h,n)):n.isPointsMaterial?P(h,n):n.isMeshLambertMaterial?C(h,n):n.isMeshToonMaterial?I(h,n):n.isMeshPhongMaterial?L(h,n):n.isMeshPhysicalMaterial?N(h,n):n.isMeshStandardMaterial?R(h,n):n.isMeshDepthMaterial?n.displacementMap&&(h.displacementMap.value=n.displacementMap,h.displacementScale.value=n.displacementScale,h.displacementBias.value=n.displacementBias):n.isMeshNormalMaterial&&O(h,n),void 0!==h.ltcMat&&(h.ltcMat.value=THREE.UniformsLib.LTC_MAT_TEXTURE),void 0!==h.ltcMag&&(h.ltcMag.value=THREE.UniformsLib.LTC_MAG_TEXTURE),X.upload(Zt,r.uniformsList,h,lt)),l.set(Zt,i,"modelViewMatrix"),l.set(Zt,i,"normalMatrix"),l.setValue(Zt,"modelMatrix",i.matrixWorld),c}function E(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;if(e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){n.isWebGLRenderTarget&&(n=n.texture);var i=n.offset,r=n.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function T(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function S(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function P(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*St,t.scale.value=.5*Tt,t.map.value=e.map,null!==e.map){var n=e.map.offset,i=e.map.repeat;t.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}}function A(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function C(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function L(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function I(t,e){L(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function R(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function N(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,R(t,e)}function O(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,
t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function D(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function B(t){for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n];r.castShadow&&(qt.shadows[e++]=r)}qt.shadows.length=e}function U(t,e){var n,i,r,o,a,s,u,l=0,h=0,f=0,p=e.matrixWorldInverse,d=0,m=0,v=0,g=0,y=0;for(n=0,i=t.length;n<i;n++)if(r=t[n],o=r.color,a=r.intensity,s=r.distance,u=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)l+=o.r*a,h+=o.g*a,f+=o.b*a;else if(r.isDirectionalLight){var _=pe.get(r);_.color.copy(r.color).multiplyScalar(r.intensity),_.direction.setFromMatrixPosition(r.matrixWorld),Vt.setFromMatrixPosition(r.target.matrixWorld),_.direction.sub(Vt),_.direction.transformDirection(p),_.shadow=r.castShadow,r.castShadow&&(_.shadowBias=r.shadow.bias,_.shadowRadius=r.shadow.radius,_.shadowMapSize=r.shadow.mapSize),qt.directionalShadowMap[d]=u,qt.directionalShadowMatrix[d]=r.shadow.matrix,qt.directional[d++]=_}else if(r.isSpotLight){var _=pe.get(r);_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(p),_.color.copy(o).multiplyScalar(a),_.distance=s,_.direction.setFromMatrixPosition(r.matrixWorld),Vt.setFromMatrixPosition(r.target.matrixWorld),_.direction.sub(Vt),_.direction.transformDirection(p),_.coneCos=Math.cos(r.angle),_.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),_.decay=0===r.distance?0:r.decay,_.shadow=r.castShadow,r.castShadow&&(_.shadowBias=r.shadow.bias,_.shadowRadius=r.shadow.radius,_.shadowMapSize=r.shadow.mapSize),qt.spotShadowMap[v]=u,qt.spotShadowMatrix[v]=r.shadow.matrix,qt.spot[v++]=_}else if(r.isRectAreaLight){var _=pe.get(r);_.color.copy(o).multiplyScalar(a/(r.width*r.height)),_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(p),Wt.identity(),Yt.copy(r.matrixWorld),Yt.premultiply(p),Wt.extractRotation(Yt),_.halfWidth.set(.5*r.width,0,0),_.halfHeight.set(0,.5*r.height,0),_.halfWidth.applyMatrix4(Wt),_.halfHeight.applyMatrix4(Wt),qt.rectArea[g++]=_}else if(r.isPointLight){var _=pe.get(r);_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(p),_.color.copy(r.color).multiplyScalar(r.intensity),_.distance=r.distance,_.decay=0===r.distance?0:r.decay,_.shadow=r.castShadow,r.castShadow&&(_.shadowBias=r.shadow.bias,_.shadowRadius=r.shadow.radius,_.shadowMapSize=r.shadow.mapSize),qt.pointShadowMap[m]=u,void 0===qt.pointShadowMatrix[m]&&(qt.pointShadowMatrix[m]=new c),Vt.setFromMatrixPosition(r.matrixWorld).negate(),qt.pointShadowMatrix[m].identity().setPosition(Vt),qt.point[m++]=_}else if(r.isHemisphereLight){var _=pe.get(r);_.direction.setFromMatrixPosition(r.matrixWorld),_.direction.transformDirection(p),_.direction.normalize(),_.skyColor.copy(r.color).multiplyScalar(a),_.groundColor.copy(r.groundColor).multiplyScalar(a),qt.hemi[y++]=_}qt.ambient[0]=l,qt.ambient[1]=h,qt.ambient[2]=f,qt.directional.length=d,qt.spot.length=v,qt.rectArea.length=g,qt.point.length=m,qt.hemi.length=y,qt.hash=d+","+m+","+v+","+g+","+y+","+qt.shadows.length}function F(){var t=bt;return t>=te.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+te.maxTextures),bt+=1,t}function k(t){var e;if(t===oa)return Zt.REPEAT;if(t===aa)return Zt.CLAMP_TO_EDGE;if(t===sa)return Zt.MIRRORED_REPEAT;if(t===ua)return Zt.NEAREST;if(t===ca)return Zt.NEAREST_MIPMAP_NEAREST;if(t===la)return Zt.NEAREST_MIPMAP_LINEAR;if(t===ha)return Zt.LINEAR;if(t===fa)return Zt.LINEAR_MIPMAP_NEAREST;if(t===pa)return Zt.LINEAR_MIPMAP_LINEAR;if(t===da)return Zt.UNSIGNED_BYTE;if(t===wa)return Zt.UNSIGNED_SHORT_4_4_4_4;if(t===Ma)return Zt.UNSIGNED_SHORT_5_5_5_1;if(t===Ea)return Zt.UNSIGNED_SHORT_5_6_5;if(t===ma)return Zt.BYTE;if(t===va)return Zt.SHORT;if(t===ga)return Zt.UNSIGNED_SHORT;if(t===ya)return Zt.INT;if(t===_a)return Zt.UNSIGNED_INT;if(t===xa)return Zt.FLOAT;if(t===ba&&(e=Kt.get("OES_texture_half_float"),null!==e))return e.HALF_FLOAT_OES;if(t===Sa)return Zt.ALPHA;if(t===Pa)return Zt.RGB;if(t===Aa)return Zt.RGBA;if(t===Ca)return Zt.LUMINANCE;if(t===La)return Zt.LUMINANCE_ALPHA;if(t===Ra)return Zt.DEPTH_COMPONENT;if(t===Na)return Zt.DEPTH_STENCIL;if(t===_o)return Zt.FUNC_ADD;if(t===xo)return Zt.FUNC_SUBTRACT;if(t===bo)return Zt.FUNC_REVERSE_SUBTRACT;if(t===Eo)return Zt.ZERO;if(t===To)return Zt.ONE;if(t===So)return Zt.SRC_COLOR;if(t===Po)return Zt.ONE_MINUS_SRC_COLOR;if(t===Ao)return Zt.SRC_ALPHA;if(t===Co)return Zt.ONE_MINUS_SRC_ALPHA;if(t===Lo)return Zt.DST_ALPHA;if(t===Io)return Zt.ONE_MINUS_DST_ALPHA;if(t===Ro)return Zt.DST_COLOR;if(t===No)return Zt.ONE_MINUS_DST_COLOR;if(t===Oo)return Zt.SRC_ALPHA_SATURATE;if((t===Oa||t===Da||t===Ba||t===Ua)&&(e=Kt.get("WEBGL_compressed_texture_s3tc"),null!==e)){if(t===Oa)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Da)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===Ba)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Ua)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===Fa||t===ka||t===za||t===Ga)&&(e=Kt.get("WEBGL_compressed_texture_pvrtc"),null!==e)){if(t===Fa)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===ka)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===za)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Ga)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===Ha&&(e=Kt.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;if((t===wo||t===Mo)&&(e=Kt.get("EXT_blend_minmax"),null!==e)){if(t===wo)return e.MIN_EXT;if(t===Mo)return e.MAX_EXT}return t===Ta&&(e=Kt.get("WEBGL_depth_texture"),null!==e)?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",Wr),t=t||{};var z=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),G=void 0!==t.context?t.context:null,H=void 0!==t.alpha&&t.alpha,j=void 0===t.depth||t.depth,Y=void 0===t.stencil||t.stencil,W=void 0!==t.antialias&&t.antialias,Z=void 0===t.premultipliedAlpha||t.premultipliedAlpha,K=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,Q=[],et=[],nt=-1,ot=[],at=-1,st=new Float32Array(8),ut=[],ct=[];this.domElement=z,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Wo,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var lt=this,ht=null,pt=null,dt=null,mt=-1,vt="",gt=null,yt=new r,_t=null,xt=new r,bt=0,wt=new V(0),Mt=0,Et=z.width,Tt=z.height,St=1,Ct=new r(0,0,Et,Tt),It=!1,Nt=new r(0,0,Et,Tt),kt=new it,zt=new se,Gt=!1,Ht=!1,jt=new tt,Xt=new c,Vt=new u,Yt=new c,Wt=new c,qt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},$t={calls:0,vertices:0,faces:0,points:0};this.info={render:$t,memory:{geometries:0,textures:0},programs:null};var Zt;try{var Jt={alpha:H,depth:j,stencil:Y,antialias:W,premultipliedAlpha:Z,preserveDrawingBuffer:K};if(Zt=G||z.getContext("webgl",Jt)||z.getContext("experimental-webgl",Jt),null===Zt)throw null!==z.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Zt.getShaderPrecisionFormat&&(Zt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),z.addEventListener("webglcontextlost",o,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var Kt=new ae(Zt);Kt.get("WEBGL_depth_texture"),Kt.get("OES_texture_float"),Kt.get("OES_texture_float_linear"),Kt.get("OES_texture_half_float"),Kt.get("OES_texture_half_float_linear"),Kt.get("OES_standard_derivatives"),Kt.get("ANGLE_instanced_arrays"),Kt.get("OES_element_index_uint")&&(Pt.MaxIndex=4294967296);var te=new oe(Zt,Kt,t),ue=new re(Zt,Kt,k),ce=new ie,le=new ne(Zt,Kt,ue,ce,te,k,this.info),he=new ee(Zt,ce,this.info),fe=new Qt(this,te),pe=new Ft;this.info.programs=fe.programs;var de,me,ve,ge,ye=new Ut(Zt,Kt,$t),_e=new Bt(Zt,Kt,$t);n(),this.context=Zt,this.capabilities=te,this.extensions=Kt,this.properties=ce,this.state=ue;var xe=new rt(this,qt,he,te);this.shadowMap=xe;var be=new $(this,ut),we=new q(this,ct);this.getContext=function(){return Zt},this.getContextAttributes=function(){return Zt.getContextAttributes()},this.forceContextLoss=function(){Kt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return te.getMaxAnisotropy()},this.getPrecision=function(){return te.precision},this.getPixelRatio=function(){return St},this.setPixelRatio=function(t){void 0!==t&&(St=t,this.setSize(Nt.z,Nt.w,!1))},this.getSize=function(){return{width:Et,height:Tt}},this.setSize=function(t,e,n){Et=t,Tt=e,z.width=t*St,z.height=e*St,n!==!1&&(z.style.width=t+"px",z.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){ue.viewport(Nt.set(t,e,n,i))},this.setScissor=function(t,e,n,i){ue.scissor(Ct.set(t,e,n,i))},this.setScissorTest=function(t){ue.setScissorTest(It=t)},this.getClearColor=function(){return wt},this.setClearColor=function(t,e){wt.set(t),Mt=void 0!==e?e:1,ue.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,Z)},this.getClearAlpha=function(){return Mt},this.setClearAlpha=function(t){Mt=t,ue.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,Z)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=Zt.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=Zt.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=Zt.STENCIL_BUFFER_BIT),Zt.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=i,this.dispose=function(){ot=[],at=-1,et=[],nt=-1,z.removeEventListener("webglcontextlost",o,!1)},this.renderBufferImmediate=function(t,e,n){ue.initAttributes();var i=ce.get(t);t.hasPositions&&!i.position&&(i.position=Zt.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=Zt.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=Zt.createBuffer()),t.hasColors&&!i.color&&(i.color=Zt.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(Zt.bindBuffer(Zt.ARRAY_BUFFER,i.position),Zt.bufferData(Zt.ARRAY_BUFFER,t.positionArray,Zt.DYNAMIC_DRAW),ue.enableAttribute(r.position),Zt.vertexAttribPointer(r.position,3,Zt.FLOAT,!1,0,0)),t.hasNormals){if(Zt.bindBuffer(Zt.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&n.shading===so)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,u=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,l=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=u,s[o+1]=c,s[o+2]=l,s[o+3]=u,s[o+4]=c,s[o+5]=l,s[o+6]=u,s[o+7]=c,s[o+8]=l}Zt.bufferData(Zt.ARRAY_BUFFER,t.normalArray,Zt.DYNAMIC_DRAW),ue.enableAttribute(r.normal),Zt.vertexAttribPointer(r.normal,3,Zt.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(Zt.bindBuffer(Zt.ARRAY_BUFFER,i.uv),Zt.bufferData(Zt.ARRAY_BUFFER,t.uvArray,Zt.DYNAMIC_DRAW),ue.enableAttribute(r.uv),Zt.vertexAttribPointer(r.uv,2,Zt.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==co&&(Zt.bindBuffer(Zt.ARRAY_BUFFER,i.color),Zt.bufferData(Zt.ARRAY_BUFFER,t.colorArray,Zt.DYNAMIC_DRAW),ue.enableAttribute(r.color),Zt.vertexAttribPointer(r.color,3,Zt.FLOAT,!1,0,0)),ue.disableUnusedAttributes(),Zt.drawArrays(Zt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,i,r,o,a){w(r);var s=M(t,n,r,o),u=!1,c=i.id+"_"+s.id+"_"+r.wireframe;c!==vt&&(vt=c,u=!0);var l=o.morphTargetInfluences;if(void 0!==l){for(var p=[],d=0,m=l.length;d<m;d++){var v=l[d];p.push([v,d])}p.sort(f),p.length>8&&(p.length=8);for(var g=i.morphAttributes,d=0,m=p.length;d<m;d++){var v=p[d];if(st[d]=v[0],0!==v[0]){var y=v[1];r.morphTargets===!0&&g.position&&i.addAttribute("morphTarget"+d,g.position[y]),r.morphNormals===!0&&g.normal&&i.addAttribute("morphNormal"+d,g.normal[y])}else r.morphTargets===!0&&i.removeAttribute("morphTarget"+d),r.morphNormals===!0&&i.removeAttribute("morphNormal"+d)}for(var d=p.length,_=st.length;d<_;d++)st[d]=0;s.getUniforms().setValue(Zt,"morphTargetInfluences",st),u=!0}var y=i.index,x=i.attributes.position,b=1;r.wireframe===!0&&(y=he.getWireframeAttribute(i),b=2);var E;null!==y?(E=_e,E.setIndex(y)):E=ye,u&&(h(r,s,i),null!==y&&Zt.bindBuffer(Zt.ELEMENT_ARRAY_BUFFER,he.getAttributeBuffer(y)));var T=0;null!==y?T=y.count:void 0!==x&&(T=x.count);var S=i.drawRange.start*b,P=i.drawRange.count*b,A=null!==a?a.start*b:0,C=null!==a?a.count*b:1/0,L=Math.max(S,A),I=Math.min(T,S+P,A+C)-1,R=Math.max(0,I-L+1);if(0!==R){if(o.isMesh)if(r.wireframe===!0)ue.setLineWidth(r.wireframeLinewidth*e()),E.setMode(Zt.LINES);else switch(o.drawMode){case Ka:E.setMode(Zt.TRIANGLES);break;case Qa:E.setMode(Zt.TRIANGLE_STRIP);break;case ts:E.setMode(Zt.TRIANGLE_FAN)}else if(o.isLine){var N=r.linewidth;void 0===N&&(N=1),ue.setLineWidth(N*e()),o.isLineSegments?E.setMode(Zt.LINES):E.setMode(Zt.LINE_STRIP)}else o.isPoints&&E.setMode(Zt.POINTS);i&&i.isInstancedBufferGeometry?i.maxInstancedCount>0&&E.renderInstances(i,L,R):E.render(L,R)}},this.render=function(t,e,n,i){if(void 0!==e&&e.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");vt="",mt=-1,gt=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),Xt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),kt.setFromMatrix(Xt),Q.length=0,nt=-1,at=-1,ut.length=0,ct.length=0,Ht=this.localClippingEnabled,Gt=zt.init(this.clippingPlanes,Ht,e),_(t,e),et.length=nt+1,ot.length=at+1,lt.sortObjects===!0&&(et.sort(p),ot.sort(d)),Gt&&zt.beginShadows(),B(Q),xe.render(t,e),U(Q,e),Gt&&zt.endShadows(),$t.calls=0,$t.vertices=0,$t.faces=0,$t.points=0,void 0===n&&(n=null),this.setRenderTarget(n);var r=t.background;if(null===r?ue.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,Z):r&&r.isColor&&(ue.buffers.color.setClear(r.r,r.g,r.b,1,Z),i=!0),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),r&&r.isCubeTexture?(void 0===ve&&(ve=new Ot,ge=new At(new Lt(5,5,5),new J({uniforms:wc.cube.uniforms,vertexShader:wc.cube.vertexShader,fragmentShader:wc.cube.fragmentShader,side:oo,depthTest:!1,depthWrite:!1,fog:!1}))),ve.projectionMatrix.copy(e.projectionMatrix),ve.matrixWorld.extractRotation(e.matrixWorld),ve.matrixWorldInverse.getInverse(ve.matrixWorld),ge.material.uniforms.tCube.value=r,ge.modelViewMatrix.multiplyMatrices(ve.matrixWorldInverse,ge.matrixWorld),he.update(ge),lt.renderBufferDirect(ve,null,ge.geometry,ge.material,ge,null)):r&&r.isTexture&&(void 0===de&&(de=new Dt(-1,1,1,-1,0,1),me=new At(new Rt(2,2),new ft({depthTest:!1,depthWrite:!1,fog:!1}))),me.material.map=r,he.update(me),lt.renderBufferDirect(de,null,me.geometry,me.material,me,null)),t.overrideMaterial){var o=t.overrideMaterial;x(et,t,e,o),x(ot,t,e,o)}else ue.setBlending(fo),x(et,t,e),x(ot,t,e);be.render(t,e),we.render(t,e,xt),n&&le.updateRenderTargetMipmap(n),ue.setDepthTest(!0),ue.setDepthWrite(!0),ue.setColorWrite(!0)},this.setFaceCulling=function(t,e){ue.setCullFace(t),ue.setFlipSided(e===Qr)},this.allocTextureUnit=F,this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),le.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),le.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?le.setTextureCube(e,n):le.setTextureCubeDynamic(e,n)}}(),this.getCurrentRenderTarget=function(){return pt},this.setRenderTarget=function(t){pt=t,t&&void 0===ce.get(t).__webglFramebuffer&&le.setupRenderTarget(t);var e,n=t&&t.isWebGLRenderTargetCube;if(t){var i=ce.get(t);e=n?i.__webglFramebuffer[t.activeCubeFace]:i.__webglFramebuffer,yt.copy(t.scissor),_t=t.scissorTest,xt.copy(t.viewport)}else e=null,yt.copy(Ct).multiplyScalar(St),_t=It,xt.copy(Nt).multiplyScalar(St);if(dt!==e&&(Zt.bindFramebuffer(Zt.FRAMEBUFFER,e),dt=e),ue.scissor(yt),ue.setScissorTest(_t),ue.viewport(xt),n){var r=ce.get(t.texture);Zt.framebufferTexture2D(Zt.FRAMEBUFFER,Zt.COLOR_ATTACHMENT0,Zt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,i,r,o){if((t&&t.isWebGLRenderTarget)===!1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var a=ce.get(t).__webglFramebuffer;if(a){var s=!1;a!==dt&&(Zt.bindFramebuffer(Zt.FRAMEBUFFER,a),s=!0);try{var u=t.texture,c=u.format,l=u.type;if(c!==Aa&&k(c)!==Zt.getParameter(Zt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===da||k(l)===Zt.getParameter(Zt.IMPLEMENTATION_COLOR_READ_TYPE)||l===xa&&(Kt.get("OES_texture_float")||Kt.get("WEBGL_color_buffer_float"))||l===ba&&Kt.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Zt.checkFramebufferStatus(Zt.FRAMEBUFFER)===Zt.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&Zt.readPixels(e,n,i,r,k(c),k(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Zt.bindFramebuffer(Zt.FRAMEBUFFER,dt)}}}}function ce(t,e){this.name="",this.color=new V(t),this.density=void 0!==e?e:25e-5}function le(t,e,n){this.name="",this.color=new V(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function he(){ut.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function fe(t,e,n,i,r){ut.call(this),this.lensFlares=[],this.positionScreen=new u,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)}function pe(t){Z.call(this),this.type="SpriteMaterial",this.color=new V(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function de(t){ut.call(this),this.type="Sprite",this.material=void 0!==t?t:new pe}function me(){ut.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ve(t,e,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new c,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var i=Math.sqrt(4*this.bones.length);i=hs.nextPowerOfTwo(Math.ceil(i)),i=Math.max(i,4),this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new Y(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,Aa,xa)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new c)}}function ge(){ut.call(this),this.type="Bone"}function ye(t,e,n){At.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new c,this.bindMatrixInverse=new c;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,o,a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],r=new ge,i.push(r),r.name=o.name,r.position.fromArray(o.pos),r.quaternion.fromArray(o.rotq),void 0!==o.scl&&r.scale.fromArray(o.scl);for(var a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],o.parent!==-1&&null!==o.parent&&void 0!==i[o.parent]?i[o.parent].add(i[a]):this.add(i[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new ve(i,void 0,n),this.matrixWorld)}function _e(t){Z.call(this),this.type="LineBasicMaterial",this.color=new V(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function xe(t,e,n){return 1===n?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new be(t,e)):(ut.call(this),this.type="Line",this.geometry=void 0!==t?t:new Pt,void(this.material=void 0!==e?e:new _e({color:16777215*Math.random()})))}function be(t,e){xe.call(this,t,e),this.type="LineSegments"}function we(t){Z.call(this),this.type="PointsMaterial",this.color=new V(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Me(t,e){ut.call(this),this.type="Points",this.geometry=void 0!==t?t:new Pt,this.material=void 0!==e?e:new we({color:16777215*Math.random()})}function Ee(){ut.call(this),this.type="Group"}function Te(t,e,n,r,o,a,s,u,c){function l(){requestAnimationFrame(l),t.readyState>=t.HAVE_CURRENT_DATA&&(h.needsUpdate=!0)}i.call(this,t,e,n,r,o,a,s,u,c),this.generateMipmaps=!1;var h=this;l()}function Se(t,e,n,r,o,a,s,u,c,l,h,f){i.call(this,null,a,s,u,c,l,r,o,h,f),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Pe(t,e,n,r,o,a,s,u,c){i.call(this,t,e,n,r,o,a,s,u,c),this.needsUpdate=!0}function Ae(t,e,n,r,o,a,s,u,c,l){if(l=void 0!==l?l:Ra,l!==Ra&&l!==Na)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Ra&&(n=ga),void 0===n&&l===Na&&(n=Ta),i.call(this,null,r,o,a,s,u,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==s?s:ua,this.minFilter=void 0!==u?u:ua,this.flipY=!1,this.generateMipmaps=!1}function Ce(t){function e(t,e){return t-e}Pt.call(this),this.type="WireframeGeometry";var n,i,r,o,a,s,c,l,h=[],f=[0,0],p={},d=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(n=0,r=m.length;n<r;n++){var v=m[n];for(i=0;i<3;i++)f[0]=v[d[i]],f[1]=v[d[(i+1)%3]],f.sort(e),c=f.toString(),void 0===p[c]&&(p[c]={index1:f[0],index2:f[1]})}for(c in p)s=p[c],l=t.vertices[s.index1],h.push(l.x,l.y,l.z),l=t.vertices[s.index2],h.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var g,y,_,x,b,w,M,E;if(l=new u,null!==t.index){for(g=t.attributes.position,y=t.index,_=t.groups,0===_.length&&t.addGroup(0,y.count),o=0,a=_.length;o<a;++o)for(x=_[o],b=x.start,w=x.count,n=b,r=b+w;n<r;n+=3)for(i=0;i<3;i++)f[0]=y.getX(n+i),f[1]=y.getX(n+(i+1)%3),f.sort(e),c=f.toString(),void 0===p[c]&&(p[c]={index1:f[0],index2:f[1]});for(c in p)s=p[c],l.fromBufferAttribute(g,s.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(g,s.index2),h.push(l.x,l.y,l.z)}else for(g=t.attributes.position,n=0,r=g.count/3;n<r;n++)for(i=0;i<3;i++)M=3*n+i,l.fromBufferAttribute(g,M),h.push(l.x,l.y,l.z),E=3*n+(i+1)%3,l.fromBufferAttribute(g,E),h.push(l.x,l.y,l.z)}this.addAttribute("position",new bt(h,3))}function Le(t,e,n){St.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Ie(t,e,n)),this.mergeVertices()}function Ie(t,e,n){Pt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,o=[],a=[],s=[],u=e+1;for(i=0;i<=n;i++){var c=i/n;for(r=0;r<=e;r++){var l=r/e,h=t(l,c);a.push(h.x,h.y,h.z),s.push(l,c)}}for(i=0;i<n;i++)for(r=0;r<e;r++){var f=i*u+r,p=i*u+r+1,d=(i+1)*u+r+1,m=(i+1)*u+r;o.push(f,p,m),o.push(p,d,m)}this.setIndex(o),this.addAttribute("position",new bt(a,3)),this.addAttribute("uv",new bt(s,2)),this.computeVertexNormals()}function Re(t,e,n,i){St.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},this.fromBufferGeometry(new Ne(t,e,n,i)),this.mergeVertices()}function Ne(t,e,i,r){function o(t){for(var n=new u,i=new u,r=new u,o=0;o<e.length;o+=3)f(e[o+0],n),f(e[o+1],i),f(e[o+2],r),a(n,i,r,t)}function a(t,e,n,i){var r,o,a=Math.pow(2,i),s=[];for(r=0;r<=a;r++){s[r]=[];var u=t.clone().lerp(n,r/a),c=e.clone().lerp(n,r/a),l=a-r;for(o=0;o<=l;o++)0===o&&r===a?s[r][o]=u:s[r][o]=u.clone().lerp(c,o/l)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var f=Math.floor(o/2);o%2===0?(h(s[r][f+1]),h(s[r+1][f]),h(s[r][f])):(h(s[r][f+1]),h(s[r+1][f+1]),h(s[r+1][f]))}}function s(t){for(var e=new u,n=0;n<g.length;n+=3)e.x=g[n+0],e.y=g[n+1],e.z=g[n+2],e.normalize().multiplyScalar(t),g[n+0]=e.x,g[n+1]=e.y,g[n+2]=e.z}function c(){for(var t=new u,e=0;e<g.length;e+=3){t.x=g[e+0],t.y=g[e+1],t.z=g[e+2];var n=m(t)/2/Math.PI+.5,i=v(t)/Math.PI+.5;y.push(n,1-i)}p(),l()}function l(){for(var t=0;t<y.length;t+=6){var e=y[t+0],n=y[t+2],i=y[t+4],r=Math.max(e,n,i),o=Math.min(e,n,i);r>.9&&o<.1&&(e<.2&&(y[t+0]+=1),n<.2&&(y[t+2]+=1),i<.2&&(y[t+4]+=1))}}function h(t){g.push(t.x,t.y,t.z)}function f(e,n){var i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function p(){for(var t=new u,e=new u,i=new u,r=new u,o=new n,a=new n,s=new n,c=0,l=0;c<g.length;c+=9,l+=6){t.set(g[c+0],g[c+1],g[c+2]),e.set(g[c+3],g[c+4],g[c+5]),i.set(g[c+6],g[c+7],g[c+8]),o.set(y[l+0],y[l+1]),a.set(y[l+2],y[l+3]),s.set(y[l+4],y[l+5]),r.copy(t).add(e).add(i).divideScalar(3);var h=m(r);d(o,l+0,t,h),d(a,l+2,e,h),d(s,l+4,i,h)}}function d(t,e,n,i){i<0&&1===t.x&&(y[e]=t.x-1),0===n.x&&0===n.z&&(y[e]=i/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function v(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}Pt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},i=i||1,r=r||0;var g=[],y=[];o(r),s(i),c(),this.addAttribute("position",new bt(g,3)),this.addAttribute("normal",new bt(g.slice(),3)),this.addAttribute("uv",new bt(y,2)),this.normalizeNormals()}function Oe(t,e){St.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new De(t,e)),this.mergeVertices()}function De(t,e){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];Ne.call(this,n,i,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Be(t,e){St.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ue(t,e)),this.mergeVertices()}function Ue(t,e){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Ne.call(this,n,i,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Fe(t,e){St.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ke(t,e)),this.mergeVertices()}function ke(t,e){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Ne.call(this,i,r,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ze(t,e){St.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ge(t,e)),this.mergeVertices()}function Ge(t,e){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Ne.call(this,r,o,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function He(t,e,n,i,r,o){St.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new je(t,e,n,i,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function je(t,e,i,r,o){function a(){for(f=0;f<e;f++)s(f);s(o===!1?e:0),l(),c()}function s(n){var o=t.getPointAt(n/e),a=h.normals[n],s=h.binormals[n];for(p=0;p<=r;p++){var u=p/r*Math.PI*2,c=Math.sin(u),l=-Math.cos(u);m.x=l*a.x+c*s.x,m.y=l*a.y+c*s.y,m.z=l*a.z+c*s.z,m.normalize(),y.push(m.x,m.y,m.z),d.x=o.x+i*m.x,d.y=o.y+i*m.y,d.z=o.z+i*m.z,g.push(d.x,d.y,d.z)}}function c(){for(p=1;p<=e;p++)for(f=1;f<=r;f++){var t=(r+1)*(p-1)+(f-1),n=(r+1)*p+(f-1),i=(r+1)*p+f,o=(r+1)*(p-1)+f;x.push(t,n,o),x.push(n,i,o)}}function l(){for(f=0;f<=e;f++)for(p=0;p<=r;p++)v.x=f/e,v.y=p/r,_.push(v.x,v.y)}Pt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:r,closed:o},e=e||64,i=i||1,r=r||8,o=o||!1;var h=t.computeFrenetFrames(e,o);this.tangents=h.tangents,this.normals=h.normals,this.binormals=h.binormals;var f,p,d=new u,m=new u,v=new n,g=[],y=[],_=[],x=[];a(),this.setIndex(x),this.addAttribute("position",new bt(g,3)),this.addAttribute("normal",new bt(y,3)),this.addAttribute("uv",new bt(_,2))}function Xe(t,e,n,i,r,o,a){St.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ve(t,e,n,i,r,o)),this.mergeVertices()}function Ve(t,e,i,r,o,a){function s(t,e,n,i,r){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);r.x=i*(2+u)*.5*o,r.y=i*(2+u)*a*.5,r.z=i*Math.sin(s)*.5}Pt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:o,q:a},t=t||100,e=e||40,i=Math.floor(i)||64,r=Math.floor(r)||8,o=o||2,a=a||3;var c,l,h=[],f=[],p=[],d=[],m=new u,v=new u,g=(new n,new u),y=new u,_=new u,x=new u,b=new u;for(c=0;c<=i;++c){var w=c/i*o*Math.PI*2;for(s(w,o,a,t,g),s(w+.01,o,a,t,y),x.subVectors(y,g),b.addVectors(y,g),_.crossVectors(x,b),b.crossVectors(_,x),_.normalize(),b.normalize(),l=0;l<=r;++l){var M=l/r*Math.PI*2,E=-e*Math.cos(M),T=e*Math.sin(M);m.x=g.x+(E*b.x+T*_.x),m.y=g.y+(E*b.y+T*_.y),m.z=g.z+(E*b.z+T*_.z),f.push(m.x,m.y,m.z),v.subVectors(m,g).normalize(),p.push(v.x,v.y,v.z),d.push(c/i),d.push(l/r)}}for(l=1;l<=i;l++)for(c=1;c<=r;c++){var S=(r+1)*(l-1)+(c-1),P=(r+1)*l+(c-1),A=(r+1)*l+c,C=(r+1)*(l-1)+c;h.push(S,P,C),h.push(P,A,C)}this.setIndex(h),this.addAttribute("position",new bt(f,3)),this.addAttribute("normal",new bt(p,3)),this.addAttribute("uv",new bt(d,2))}function Ye(t,e,n,i,r){St.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new We(t,e,n,i,r))}function We(t,e,n,i,r){Pt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||100,e=e||40,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,a,s=[],c=[],l=[],h=[],f=new u,p=new u,d=new u;for(o=0;o<=n;o++)for(a=0;a<=i;a++){var m=a/i*r,v=o/n*Math.PI*2;p.x=(t+e*Math.cos(v))*Math.cos(m),p.y=(t+e*Math.cos(v))*Math.sin(m),p.z=e*Math.sin(v),c.push(p.x,p.y,p.z),f.x=t*Math.cos(m),f.y=t*Math.sin(m),d.subVectors(p,f).normalize(),l.push(d.x,d.y,d.z),h.push(a/i),h.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=i;a++){var g=(i+1)*o+a-1,y=(i+1)*(o-1)+a-1,_=(i+1)*(o-1)+a,x=(i+1)*o+a;s.push(g,y,x),s.push(y,_,x)}this.setIndex(s),this.addAttribute("position",new bt(c,3)),this.addAttribute("normal",new bt(l,3)),this.addAttribute("uv",new bt(h,2))}function qe(t,e){return"undefined"==typeof t?void(t=[]):(St.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals());
}function $e(t,e){e=e||{};var n=e.font;if((n&&n.isFont)===!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new St;var i=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),qe.call(this,i,e),this.type="TextGeometry"}function Ze(t,e,n,i,r,o,a){St.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Je(t,e,n,i,r,o,a))}function Je(t,e,n,i,r,o,a){Pt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,c,l=o+a,h=0,f=[],p=new u,d=new u,m=[],v=[],g=[],y=[];for(c=0;c<=n;c++){var _=[],x=c/n;for(s=0;s<=e;s++){var b=s/e;p.x=-t*Math.cos(i+b*r)*Math.sin(o+x*a),p.y=t*Math.cos(o+x*a),p.z=t*Math.sin(i+b*r)*Math.sin(o+x*a),v.push(p.x,p.y,p.z),d.set(p.x,p.y,p.z).normalize(),g.push(d.x,d.y,d.z),y.push(b,1-x),_.push(h++)}f.push(_)}for(c=0;c<n;c++)for(s=0;s<e;s++){var w=f[c][s+1],M=f[c][s],E=f[c+1][s],T=f[c+1][s+1];(0!==c||o>0)&&m.push(w,M,T),(c!==n-1||l<Math.PI)&&m.push(M,E,T)}this.setIndex(m),this.addAttribute("position",new bt(v,3)),this.addAttribute("normal",new bt(g,3)),this.addAttribute("uv",new bt(y,2))}function Ke(t,e,n,i,r,o){St.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Qe(t,e,n,i,r,o))}function Qe(t,e,i,r,o,a){Pt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:o,thetaLength:a},t=t||20,e=e||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8,r=void 0!==r?Math.max(1,r):1;var s,c,l,h=[],f=[],p=[],d=[],m=t,v=(e-t)/r,g=new u,y=new n;for(c=0;c<=r;c++){for(l=0;l<=i;l++)s=o+l/i*a,g.x=m*Math.cos(s),g.y=m*Math.sin(s),f.push(g.x,g.y,g.z),p.push(0,0,1),y.x=(g.x/e+1)/2,y.y=(g.y/e+1)/2,d.push(y.x,y.y);m+=v}for(c=0;c<r;c++){var _=c*(i+1);for(l=0;l<i;l++){s=l+_;var x=s,b=s+i+1,w=s+i+2,M=s+1;h.push(x,b,M),h.push(b,w,M)}}this.setIndex(h),this.addAttribute("position",new bt(f,3)),this.addAttribute("normal",new bt(p,3)),this.addAttribute("uv",new bt(d,2))}function tn(t,e,n,i){St.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new en(t,e,n,i)),this.mergeVertices()}function en(t,e,i,r){Pt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=Math.floor(e)||12,i=i||0,r=r||2*Math.PI,r=hs.clamp(r,0,2*Math.PI);var o,a,s,c=[],l=[],h=[],f=1/e,p=new u,d=new n;for(a=0;a<=e;a++){var m=i+a*f*r,v=Math.sin(m),g=Math.cos(m);for(s=0;s<=t.length-1;s++)p.x=t[s].x*v,p.y=t[s].y,p.z=t[s].x*g,l.push(p.x,p.y,p.z),d.x=a/e,d.y=s/(t.length-1),h.push(d.x,d.y)}for(a=0;a<e;a++)for(s=0;s<t.length-1;s++){o=s+a*t.length;var y=o,_=o+t.length,x=o+t.length+1,b=o+1;c.push(y,_,b),c.push(_,x,b)}if(this.setIndex(c),this.addAttribute("position",new bt(l,3)),this.addAttribute("uv",new bt(h,2)),this.computeVertexNormals(),r===2*Math.PI){var w=this.attributes.normal.array,M=new u,E=new u,T=new u;for(o=e*t.length*3,a=0,s=0;a<t.length;a++,s+=3)M.x=w[s+0],M.y=w[s+1],M.z=w[s+2],E.x=w[o+s+0],E.y=w[o+s+1],E.z=w[o+s+2],T.addVectors(M,E).normalize(),w[s+0]=w[o+s+0]=T.x,w[s+1]=w[o+s+1]=T.y,w[s+2]=w[o+s+2]=T.z}}function nn(t,e){St.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new rn(t,e)),this.mergeVertices()}function rn(t,e){function n(t){var n,s,c,l=r.length/3,h=t.extractPoints(e),f=h.shape,p=h.holes;if(Pc.isClockWise(f)===!1)for(f=f.reverse(),n=0,s=p.length;n<s;n++)c=p[n],Pc.isClockWise(c)===!0&&(p[n]=c.reverse());var d=Pc.triangulateShape(f,p);for(n=0,s=p.length;n<s;n++)c=p[n],f=f.concat(c);for(n=0,s=f.length;n<s;n++){var m=f[n];r.push(m.x,m.y,0),o.push(0,0,1),a.push(m.x,m.y)}for(n=0,s=d.length;n<s;n++){var v=d[n],g=v[0]+l,y=v[1]+l,_=v[2]+l;i.push(g,y,_),u+=3}}Pt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var i=[],r=[],o=[],a=[],s=0,u=0;if(Array.isArray(t)===!1)n(t);else for(var c=0;c<t.length;c++)n(t[c]),this.addGroup(s,u,c),s+=u,u=0;this.setIndex(i),this.addAttribute("position",new bt(r,3)),this.addAttribute("normal",new bt(o,3)),this.addAttribute("uv",new bt(a,2))}function on(t,e){function n(t,e){return t-e}Pt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var i,r,o=[],a=Math.cos(hs.DEG2RAD*e),s=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(r=new St,r.fromBufferGeometry(t)):r=t.clone(),r.mergeVertices(),r.computeFaceNormals();for(var l=r.vertices,h=r.faces,f=0,p=h.length;f<p;f++)for(var d=h[f],m=0;m<3;m++)s[0]=d[c[m]],s[1]=d[c[(m+1)%3]],s.sort(n),i=s.toString(),void 0===u[i]?u[i]={index1:s[0],index2:s[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var v=u[i];if(void 0===v.face2||h[v.face1].normal.dot(h[v.face2].normal)<=a){var g=l[v.index1];o.push(g.x,g.y,g.z),g=l[v.index2],o.push(g.x,g.y,g.z)}}this.addAttribute("position",new bt(o,3))}function an(t,e,n,i,r,o,a,s){St.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new sn(t,e,n,i,r,o,a,s)),this.mergeVertices()}function sn(t,e,i,r,o,a,s,c){function l(){var n,a,l=new u,h=new u,b=0,w=(e-t)/i;for(a=0;a<=o;a++){var M=[],E=a/o,T=E*(e-t)+t;for(n=0;n<=r;n++){var S=n/r,P=S*c+s,A=Math.sin(P),C=Math.cos(P);h.x=T*A,h.y=-E*i+_,h.z=T*C,d.push(h.x,h.y,h.z),l.set(A,w,C).normalize(),m.push(l.x,l.y,l.z),v.push(S,1-E),M.push(g++)}y.push(M)}for(n=0;n<r;n++)for(a=0;a<o;a++){var L=y[a][n],I=y[a+1][n],R=y[a+1][n+1],N=y[a][n+1];p.push(L,I,N),p.push(I,R,N),b+=6}f.addGroup(x,b,0),x+=b}function h(i){var o,a,l,h=new n,y=new u,b=0,w=i===!0?t:e,M=i===!0?1:-1;for(a=g,o=1;o<=r;o++)d.push(0,_*M,0),m.push(0,M,0),v.push(.5,.5),g++;for(l=g,o=0;o<=r;o++){var E=o/r,T=E*c+s,S=Math.cos(T),P=Math.sin(T);y.x=w*P,y.y=_*M,y.z=w*S,d.push(y.x,y.y,y.z),m.push(0,M,0),h.x=.5*S+.5,h.y=.5*P*M+.5,v.push(h.x,h.y),g++}for(o=0;o<r;o++){var A=a+o,C=l+o;i===!0?p.push(C,C+1,A):p.push(C+1,C,A),b+=3}f.addGroup(x,b,i===!0?1:2),x+=b}Pt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:c};var f=this;t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,r=Math.floor(r)||8,o=Math.floor(o)||1,a=void 0!==a&&a,s=void 0!==s?s:0,c=void 0!==c?c:2*Math.PI;var p=[],d=[],m=[],v=[],g=0,y=[],_=i/2,x=0;l(),a===!1&&(t>0&&h(!0),e>0&&h(!1)),this.setIndex(p),this.addAttribute("position",new bt(d,3)),this.addAttribute("normal",new bt(m,3)),this.addAttribute("uv",new bt(v,2))}function un(t,e,n,i,r,o,a){an.call(this,0,t,e,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function cn(t,e,n,i,r,o,a){sn.call(this,0,t,e,n,i,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function ln(t,e,n,i){St.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new hn(t,e,n,i))}function hn(t,e,i,r){Pt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var o,a,s=[],c=[],l=[],h=[],f=new u,p=new n;for(c.push(0,0,0),l.push(0,0,1),h.push(.5,.5),a=0,o=3;a<=e;a++,o+=3){var d=i+a/e*r;f.x=t*Math.cos(d),f.y=t*Math.sin(d),c.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(c[o]/t+1)/2,p.y=(c[o+1]/t+1)/2,h.push(p.x,p.y)}for(o=1;o<=e;o++)s.push(o,o+1,0);this.setIndex(s),this.addAttribute("position",new bt(c,3)),this.addAttribute("normal",new bt(l,3)),this.addAttribute("uv",new bt(h,2))}function fn(){J.call(this,{uniforms:ys.merge([bc.lights,{opacity:{value:1}}]),vertexShader:_c.shadow_vert,fragmentShader:_c.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function pn(t){J.call(this,t),this.type="RawShaderMaterial"}function dn(t){this.uuid=hs.generateUUID(),this.type="MultiMaterial",this.materials=Array.isArray(t)?t:[],this.visible=!0}function mn(t){Z.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new V(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function vn(t){mn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function gn(t){Z.call(this),this.type="MeshPhongMaterial",this.color=new V(16777215),this.specular=new V(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function yn(t){gn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function _n(t){Z.call(this,t),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function xn(t){Z.call(this),this.type="MeshLambertMaterial",this.color=new V(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function bn(t){Z.call(this),this.type="LineDashedMaterial",this.color=new V(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function wn(t,e,n){var i=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,r===!1&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)}}function Mn(t){this.manager=void 0!==t?t:Ic}function En(t){this.manager=void 0!==t?t:Ic,this._parser=null}function Tn(t){this.manager=void 0!==t?t:Ic,this._parser=null}function Sn(t){this.manager=void 0!==t?t:Ic}function Pn(t){this.manager=void 0!==t?t:Ic}function An(t){this.manager=void 0!==t?t:Ic}function Cn(t,e){ut.call(this),this.type="Light",this.color=new V(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Ln(t,e,n){Cn.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ut.DefaultUp),this.updateMatrix(),this.groundColor=new V(e)}function In(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new c}function Rn(){In.call(this,new Ot(50,1,.5,500))}function Nn(t,e,n,i,r,o){Cn.call(this,t,e),this.type="SpotLight",this.position.copy(ut.DefaultUp),this.updateMatrix(),this.target=new ut,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Rn}function On(t,e,n,i){Cn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new In(new Ot(90,1,.5,500))}function Dn(){In.call(this,new Dt(-5,5,5,-5,.5,500))}function Bn(t,e){Cn.call(this,t,e),this.type="DirectionalLight",this.position.copy(ut.DefaultUp),this.updateMatrix(),this.target=new ut,this.shadow=new Dn}function Un(t,e){Cn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Fn(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function kn(t,e,n,i){Fn.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function zn(t,e,n,i){Fn.call(this,t,e,n,i)}function Gn(t,e,n,i){Fn.call(this,t,e,n,i)}function Hn(t,e,n,i){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=Rc.convertArray(e,this.TimeBufferType),this.values=Rc.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()}function jn(t,e,n,i){Hn.call(this,t,e,n,i)}function Xn(t,e,n,i){Fn.call(this,t,e,n,i)}function Vn(t,e,n,i){Hn.call(this,t,e,n,i)}function Yn(t,e,n,i){Hn.call(this,t,e,n,i)}function Wn(t,e,n,i){Hn.call(this,t,e,n,i)}function qn(t,e,n){Hn.call(this,t,e,n)}function $n(t,e,n,i){Hn.call(this,t,e,n,i)}function Zn(t,e,n,i){Hn.apply(this,arguments)}function Jn(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=hs.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Kn(t){this.manager=void 0!==t?t:Ic,this.textures={}}function Qn(t){this.manager=void 0!==t?t:Ic}function ti(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function ei(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Ic,this.withCredentials=!1}function ni(t){this.manager=void 0!==t?t:Ic,this.texturePath=""}function ii(t,e,n,i,r){var o=.5*(i-e),a=.5*(r-n),s=t*t,u=t*s;return(2*n-2*i+o+a)*u+(-3*n+3*i-2*o-a)*s+o*t+n}function ri(t,e){var n=1-t;return n*n*e}function oi(t,e){return 2*(1-t)*t*e}function ai(t,e){return t*t*e}function si(t,e,n,i){return ri(t,e)+oi(t,n)+ai(t,i)}function ui(t,e){var n=1-t;return n*n*n*e}function ci(t,e){var n=1-t;return 3*n*n*t*e}function li(t,e){return 3*(1-t)*t*t*e}function hi(t,e){return t*t*t*e}function fi(t,e,n,i,r){return ui(t,e)+ci(t,n)+li(t,i)+hi(t,r)}function pi(){}function di(t,e){this.v1=t,this.v2=e}function mi(){this.curves=[],this.autoClose=!1}function vi(t,e,n,i,r,o,a,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function gi(t){this.points=void 0===t?[]:t}function yi(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}function _i(t,e,n){this.v0=t,this.v1=e,this.v2=n}function xi(t){mi.call(this),this.currentPoint=new n,t&&this.fromPoints(t)}function bi(){xi.apply(this,arguments),this.holes=[]}function wi(){this.subPaths=[],this.currentPath=null}function Mi(t){this.data=t}function Ei(t){this.manager=void 0!==t?t:Ic}function Ti(t){this.manager=void 0!==t?t:Ic}function Si(t,e,n,i){Cn.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function Pi(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ot,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ot,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ai(t,e,n){ut.call(this),this.type="CubeCamera";var i=90,r=1,o=new Ot(i,r,t,e);o.up.set(0,-1,0),o.lookAt(new u(1,0,0)),this.add(o);var s=new Ot(i,r,t,e);s.up.set(0,-1,0),s.lookAt(new u(-1,0,0)),this.add(s);var c=new Ot(i,r,t,e);c.up.set(0,0,1),c.lookAt(new u(0,1,0)),this.add(c);var l=new Ot(i,r,t,e);l.up.set(0,0,-1),l.lookAt(new u(0,-1,0)),this.add(l);var h=new Ot(i,r,t,e);h.up.set(0,-1,0),h.lookAt(new u(0,0,1)),this.add(h);var f=new Ot(i,r,t,e);f.up.set(0,-1,0),f.lookAt(new u(0,0,-1)),this.add(f);var p={format:Pa,magFilter:ha,minFilter:ha};this.renderTarget=new a(n,n,p),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,o,n),n.activeCubeFace=1,t.render(e,s,n),n.activeCubeFace=2,t.render(e,c,n),n.activeCubeFace=3,t.render(e,l,n),n.activeCubeFace=4,t.render(e,h,n),n.texture.generateMipmaps=i,n.activeCubeFace=5,t.render(e,f,n),t.setRenderTarget(null)}}function Ci(){ut.call(this),this.type="AudioListener",this.context=Bc.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Li(t){ut.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ii(t){Li.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Ri(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Ni(t,e,n){this.binding=t,this.valueSize=n;var i,r=Float64Array;switch(e){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Oi(t,e,n){this.path=e,this.parsedPath=n||Oi.parseTrackName(e),this.node=Oi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Di(t){this.uuid=hs.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Bi(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var i=e.tracks,r=i.length,o=new Array(r),a={endingStart:$a,endingEnd:$a},s=0;s!==r;++s){var u=i[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Xa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Ui(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Fi(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function ki(){Pt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function zi(t,e,n,i){this.uuid=hs.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=i===!0}function Gi(t,e){this.uuid=hs.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Hi(t,e,n){Gi.call(this,t,e),this.meshPerAttribute=n||1}function ji(t,e,n){pt.call(this,t,e),this.meshPerAttribute=n||1}function Xi(t,e,n,i){this.ray=new ot(t,e),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vi(t,e){return t.distance-e.distance}function Yi(t,e,n,i){if(t.visible!==!1&&(t.raycast(e,n),i===!0))for(var r=t.children,o=0,a=r.length;o<a;o++)Yi(r[o],e,n,!0)}function Wi(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function qi(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function $i(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Zi(t,e){At.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",r=0,o=n-1,a=n/1;this.createAnimation(i,r,o,a),this.setAnimationWeight(i,1)}function Ji(t){ut.call(this),this.material=t,this.render=function(t){}}function Ki(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var u=new Pt,c=new bt(2*a*3,3);u.addAttribute("position",c),be.call(this,u,new _e({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Qi(t){ut.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new Pt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,r=1,o=32;i<o;i++,r++){var a=i/o*Math.PI*2,s=r/o*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}e.addAttribute("position",new bt(n,3));var u=new _e({fog:!1});this.cone=new be(e,u),this.add(this.cone),this.update()}function tr(t){this.bones=this.getBoneList(t);for(var e=new Pt,n=[],i=[],r=new V(0,0,1),o=new V(0,1,0),a=0;a<this.bones.length;a++){var s=this.bones[a];s.parent&&s.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(r.r,r.g,r.b),i.push(o.r,o.g,o.b))}e.addAttribute("position",new bt(n,3)),e.addAttribute("color",new bt(i,3));var u=new _e({vertexColors:ho,depthTest:!1,depthWrite:!1,transparent:!0});be.call(this,e,u),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function er(t,e){this.light=t,this.light.updateMatrixWorld();var n=new Je(e,4,2),i=new ft({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),At.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function nr(t){ut.call(this),this.light=t,this.light.updateMatrixWorld();var e=new ft({color:t.color,fog:!1}),n=new ft({color:t.color,fog:!1,wireframe:!0}),i=new Pt;i.addAttribute("position",new pt(new Float32Array(18),3)),this.add(new At(i,e)),this.add(new At(i,n)),this.update()}function ir(t,e){ut.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var n=new Ue(e);n.rotateY(.5*Math.PI);var i=new ft({vertexColors:ho,wireframe:!0}),r=n.getAttribute("position"),o=new Float32Array(3*r.count);n.addAttribute("color",new pt(o,3)),this.add(new At(n,i)),this.update()}function rr(t,e,n,i){t=t||10,e=e||10,n=new V(void 0!==n?n:4473924),i=new V(void 0!==i?i:8947848);for(var r=e/2,o=t/e,a=t/2,s=[],u=[],c=0,l=0,h=-a;c<=e;c++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=c===r?n:i;f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3}var p=new Pt;p.addAttribute("position",new bt(s,3)),p.addAttribute("color",new bt(u,3));var d=new _e({vertexColors:ho});be.call(this,p,d)}function or(t,e,n,i,r,o){t=t||10,e=e||16,n=n||8,i=i||64,r=new V(void 0!==r?r:4473924),o=new V(void 0!==o?o:8947848);var a,s,u,c,l,h,f,p=[],d=[];for(c=0;c<=e;c++)u=c/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,p.push(0,0,0),p.push(a,0,s),f=1&c?r:o,d.push(f.r,f.g,f.b),d.push(f.r,f.g,f.b);for(c=0;c<=n;c++)for(f=1&c?r:o,h=t-t/n*c,l=0;l<i;l++)u=l/i*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,p.push(a,0,s),d.push(f.r,f.g,f.b),u=(l+1)/i*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,p.push(a,0,s),d.push(f.r,f.g,f.b);var m=new Pt;m.addAttribute("position",new bt(p,3)),m.addAttribute("color",new bt(d,3));var v=new _e({vertexColors:ho});be.call(this,m,v)}function ar(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new Pt,c=new bt(2*a*3,3);u.addAttribute("position",c),be.call(this,u,new _e({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function sr(t,e){ut.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var n=new Pt;n.addAttribute("position",new bt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new _e({fog:!1});this.add(new xe(n,i)),n=new Pt,n.addAttribute("position",new bt([0,0,0,0,0,1],3)),this.add(new xe(n,i)),this.update()}function ur(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var i=new Pt,r=new _e({color:16777215,vertexColors:lo}),o=[],a=[],s={},u=new V(16755200),c=new V(16711680),l=new V(43775),h=new V(16777215),f=new V(3355443);e("n1","n2",u),e("n2","n4",u),e("n4","n3",u),e("n3","n1",u),e("f1","f2",u),e("f2","f4",u),e("f4","f3",u),e("f3","f1",u),e("n1","f1",u),e("n2","f2",u),e("n3","f3",u),e("n4","f4",u),e("p","n1",c),e("p","n2",c),e("p","n3",c),e("p","n4",c),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",h),e("p","c",f),e("cn1","cn2",f),e("cn3","cn4",f),e("cf1","cf2",f),e("cf3","cf4",f),i.addAttribute("position",new bt(o,3)),i.addAttribute("color",new bt(a,3)),be.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function cr(t,e){void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Pt;r.setIndex(new pt(n,1)),r.addAttribute("position",new pt(i,3)),be.call(this,r,new _e({color:e})),void 0!==t&&this.update(t)}function lr(t,e,n,i,r,o){ut.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===Uc&&(Uc=new Pt,Uc.addAttribute("position",new bt([0,0,0,0,1,0],3)),Fc=new sn(0,.5,1,5,1),Fc.translate(0,-.5,0)),this.position.copy(e),this.line=new xe(Uc,new _e({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new At(Fc,new ft({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,o)}function hr(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Pt;i.addAttribute("position",new bt(e,3)),i.addAttribute("color",new bt(n,3));var r=new _e({vertexColors:ho});be.call(this,i,r)}function fr(){function t(t,o,a,s){e=t,n=a,i=-3*t+3*o-2*a-s,r=2*t-2*o+a+s}var e=0,n=0,i=0,r=0;return{initCatmullRom:function(e,n,i,r,o){t(n,i,o*(i-e),o*(r-n))},initNonuniformCatmullRom:function(e,n,i,r,o,a,s){var u=(n-e)/o-(i-e)/(o+a)+(i-n)/a,c=(i-n)/a-(r-n)/(a+s)+(r-i)/s;u*=a,c*=a,t(n,i,u,c)},calc:function(t){var o=t*t,a=o*t;return e+n*t+i*o+r*a}}}function pr(t){this.points=t||[],this.closed=!1}function dr(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}function mr(t,e,n){this.v0=t,this.v1=e,this.v2=n}function vr(t,e){this.v1=t,this.v2=e}function gr(t,e,n,i,r,o){vi.call(this,t,e,n,n,i,r,o)}function yr(t,e,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ht(t,e,n,r,o,a)}function _r(t){return console.warn("THREE.MeshFaceMaterial has been renamed to THREE.MultiMaterial."),new dn(t)}function xr(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Me(t,e)}function br(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new de(t)}function wr(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Me(t,e)}function Mr(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new we(t)}function Er(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new we(t)}function Tr(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new we(t)}function Sr(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new u(t,e,n)}function Pr(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new pt(t,e).setDynamic(!0)}function Ar(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dt(t,e)}function Cr(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new mt(t,e)}function Lr(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new vt(t,e)}function Ir(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new gt(t,e)}function Rr(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new yt(t,e)}function Nr(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new _t(t,e)}function Or(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new xt(t,e)}function Dr(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new bt(t,e)}function Br(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new wt(t,e)}function Ur(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),pr.call(this,t),this.type="catmullrom",this.closed=!0}function Fr(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),pr.call(this,t),this.type="catmullrom"}function kr(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),pr.call(this,t),
this.type="catmullrom"}function zr(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new cr(t,e)}function Gr(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new be(new on(t.geometry),new _e({color:void 0!==e?e:16777215}))}function Hr(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new be(new Ce(t.geometry),new _e({color:void 0!==e?e:16777215}))}function jr(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Mn(t)}function Xr(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Tn(t)}function Vr(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Yr(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}}(),e.prototype={addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&n[t].indexOf(e)!==-1},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners,i=n[t];if(void 0!==i){var r=i.indexOf(e);r!==-1&&i.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;var i=[],r=0,o=n.length;for(r=0;r<o;r++)i[r]=n[r];for(r=0;r<o;r++)i[r].call(this,t)}}}};var Wr="84",qr={LEFT:0,MIDDLE:1,RIGHT:2},$r=0,Zr=1,Jr=2,Kr=3,Qr=0,to=1,eo=0,no=1,io=2,ro=0,oo=1,ao=2,so=1,uo=2,co=0,lo=1,ho=2,fo=0,po=1,mo=2,vo=3,go=4,yo=5,_o=100,xo=101,bo=102,wo=103,Mo=104,Eo=200,To=201,So=202,Po=203,Ao=204,Co=205,Lo=206,Io=207,Ro=208,No=209,Oo=210,Do=0,Bo=1,Uo=2,Fo=3,ko=4,zo=5,Go=6,Ho=7,jo=0,Xo=1,Vo=2,Yo=0,Wo=1,qo=2,$o=3,Zo=4,Jo=300,Ko=301,Qo=302,ta=303,ea=304,na=305,ia=306,ra=307,oa=1e3,aa=1001,sa=1002,ua=1003,ca=1004,la=1005,ha=1006,fa=1007,pa=1008,da=1009,ma=1010,va=1011,ga=1012,ya=1013,_a=1014,xa=1015,ba=1016,wa=1017,Ma=1018,Ea=1019,Ta=1020,Sa=1021,Pa=1022,Aa=1023,Ca=1024,La=1025,Ia=Aa,Ra=1026,Na=1027,Oa=2001,Da=2002,Ba=2003,Ua=2004,Fa=2100,ka=2101,za=2102,Ga=2103,Ha=2151,ja=2200,Xa=2201,Va=2202,Ya=2300,Wa=2301,qa=2302,$a=2400,Za=2401,Ja=2402,Ka=0,Qa=1,ts=2,es=3e3,ns=3001,is=3007,rs=3002,os=3003,as=3004,ss=3005,us=3006,cs=3200,ls=3201,hs={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0;return function(){for(var r=0;r<36;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19===r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*hs.DEG2RAD},radToDeg:function(t){return t*hs.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}};n.prototype={constructor:n,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(i,r){return void 0===t&&(t=new n,e=new n),t.set(i,i),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}};var fs=0;i.DEFAULT_IMAGE=void 0,i.DEFAULT_MAPPING=Jo,i.prototype={constructor:i,isTexture:!0,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){function e(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=hs.generateUUID()),void 0===t.images[i.uuid]&&(t.images[i.uuid]={uuid:i.uuid,url:e(i)}),n.image=i.uuid}return t.textures[this.uuid]=n,n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===Jo){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case oa:t.x=t.x-Math.floor(t.x);break;case aa:t.x=t.x<0?0:1;break;case sa:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case oa:t.y=t.y-Math.floor(t.y);break;case aa:t.y=t.y<0?0:1;break;case sa:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(i.prototype,e.prototype),r.prototype={constructor:r,isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o=.01,a=.1,s=t.elements,u=s[0],c=s[4],l=s[8],h=s[1],f=s[5],p=s[9],d=s[2],m=s[6],v=s[10];if(Math.abs(c-h)<o&&Math.abs(l-d)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(l+d)<a&&Math.abs(p+m)<a&&Math.abs(u+f+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var g=(u+1)/2,y=(f+1)/2,_=(v+1)/2,x=(c+h)/4,b=(l+d)/4,w=(p+m)/4;return g>y&&g>_?g<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(g),i=x/n,r=b/n):y>_?y<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(y),n=x/i,r=w/i):_<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(_),n=b/r,i=w/r),this.set(n,i,r,e),this}var M=Math.sqrt((m-p)*(m-p)+(l-d)*(l-d)+(h-c)*(h-c));return Math.abs(M)<.001&&(M=1),this.x=(m-p)/M,this.y=(l-d)/M,this.z=(h-c)/M,this.w=Math.acos((u+f+v-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new r,e=new r),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}},o.prototype={constructor:o,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(o.prototype,e.prototype),a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.isWebGLRenderTargetCube=!0,s.prototype={constructor:s,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if((t&&t.isEuler)===!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),u=t.order;return"XYZ"===u?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"YXZ"===u?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"ZXY"===u?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"ZYX"===u?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"YZX"===u?(this._x=o*i*r+n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r-o*a*s):"XZY"===u&&(this._x=o*i*r-n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r+o*a*s),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],u=n[9],c=n[2],l=n[6],h=n[10],f=i+s+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(l-u)*e,this._y=(o-c)*e,this._z=(a-r)*e):i>s&&i>h?(e=2*Math.sqrt(1+i-s-h),this._w=(l-u)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+c)/e):s>h?(e=2*Math.sqrt(1+s-i-h),this._w=(o-c)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(u+l)/e):(e=2*Math.sqrt(1+h-i-s),this._w=(a-r)/e,this._x=(o+c)/e,this._y=(u+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,n=1e-6;return function(i,r){return void 0===t&&(t=new u),e=i.dot(r)+1,e<n?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+i*u-r*s,this._y=i*c+o*s+r*a-n*u,this._z=r*c+o*u+n*s-i*a,this._w=o*c-n*a-i*s-r*u,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var u=Math.atan2(s,a),c=Math.sin((1-e)*u)/s,l=Math.sin(e*u)/s;return this._w=o*c+this._w*l,this._x=n*c+this._x*l,this._y=i*c+this._y*l,this._z=r*c+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(s,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s=n[i+0],u=n[i+1],c=n[i+2],l=n[i+3],h=r[o+0],f=r[o+1],p=r[o+2],d=r[o+3];if(l!==d||s!==h||u!==f||c!==p){var m=1-a,v=s*h+u*f+c*p+l*d,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,v*g);m=Math.sin(m*x)/_,a=Math.sin(a*x)/_}var b=a*g;if(s=s*m+h*b,u=u*m+f*b,c=c*m+p*b,l=l*m+d*b,m===1-a){var w=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=w,u*=w,c*=w,l*=w}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}}),u.prototype={constructor:u,isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return(e&&e.isEuler)===!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new s),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new s),this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14];var o=r[3]*e+r[7]*n+r[11]*i+r[15];return this.divideScalar(o)},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*i-a*n,c=s*n+a*e-r*i,l=s*i+r*n-o*e,h=-r*e-o*n-a*i;return this.x=u*s+h*-r+c*-a-l*-o,this.y=c*s+h*-o+l*-r-u*-a,this.z=l*s+h*-a+u*-o-c*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new c),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new c),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new u,e=new u),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new u),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new u),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(hs.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var n=t;t=e,e=n}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},c.prototype={constructor:c,isMatrix4:!0,set:function(t,e,n,i,r,o,a,s,u,c,l,h,f,p,d,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=u,v[6]=c,v[10]=l,v[14]=h,v[3]=f,v[7]=p,v[11]=d,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new c).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new u);var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(t){(t&&t.isEuler)===!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),u=Math.sin(i),c=Math.cos(r),l=Math.sin(r);if("XYZ"===t.order){var h=o*c,f=o*l,p=a*c,d=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=f+p*u,e[5]=h-d*u,e[9]=-a*s,e[2]=d-h*u,e[6]=p+f*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m+y*a,e[4]=g*a-v,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,
e[2]=v*a-g,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m-y*a,e[4]=-o*l,e[8]=g+v*a,e[1]=v+g*a,e[5]=o*c,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var h=o*c,f=o*l,p=a*c,d=a*l;e[0]=s*c,e[4]=p*u-f,e[8]=h*u+d,e[1]=s*l,e[5]=d*u+h,e[9]=f*u-p,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var _=o*s,x=o*u,b=a*s,w=a*u;e[0]=s*c,e[4]=w-_*l,e[8]=b*l+x,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=x*l+b,e[10]=_-w*l}else if("XZY"===t.order){var _=o*s,x=o*u,b=a*s,w=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=_*l+w,e[5]=o*c,e[9]=x*l-b,e[2]=b*l-x,e[6]=a*c,e[10]=w*l+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,o=t.w,a=n+n,s=i+i,u=r+r,c=n*a,l=n*s,h=n*u,f=i*s,p=i*u,d=r*u,m=o*a,v=o*s,g=o*u;return e[0]=1-(f+d),e[4]=l-g,e[8]=h+v,e[1]=l+g,e[5]=1-(c+d),e[9]=p-m,e[2]=h-v,e[6]=p+m,e[10]=1-(c+f),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,n;return function(i,r,o){void 0===t&&(t=new u,e=new u,n=new u);var a=this.elements;return n.subVectors(i,r).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(o,n).normalize(),0===t.lengthSq()&&(n.z+=1e-4,t.crossVectors(o,n).normalize()),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],f=n[13],p=n[2],d=n[6],m=n[10],v=n[14],g=n[3],y=n[7],_=n[11],x=n[15],b=i[0],w=i[4],M=i[8],E=i[12],T=i[1],S=i[5],P=i[9],A=i[13],C=i[2],L=i[6],I=i[10],R=i[14],N=i[3],O=i[7],D=i[11],B=i[15];return r[0]=o*b+a*T+s*C+u*N,r[4]=o*w+a*S+s*L+u*O,r[8]=o*M+a*P+s*I+u*D,r[12]=o*E+a*A+s*R+u*B,r[1]=c*b+l*T+h*C+f*N,r[5]=c*w+l*S+h*L+f*O,r[9]=c*M+l*P+h*I+f*D,r[13]=c*E+l*A+h*R+f*B,r[2]=p*b+d*T+m*C+v*N,r[6]=p*w+d*S+m*L+v*O,r[10]=p*M+d*P+m*I+v*D,r[14]=p*E+d*A+m*R+v*B,r[3]=g*b+y*T+_*C+x*N,r[7]=g*w+y*S+_*L+x*O,r[11]=g*M+y*P+_*I+x*D,r[15]=g*E+y*A+_*R+x*B,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new u);for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],f=t[14],p=t[3],d=t[7],m=t[11],v=t[15];return p*(+r*s*l-i*u*l-r*a*h+n*u*h+i*a*f-n*s*f)+d*(+e*s*f-e*u*h+r*o*h-i*o*f+i*u*c-r*s*c)+m*(+e*u*l-e*a*f-r*o*l+n*o*f+r*a*c-n*u*c)+v*(-i*a*c-e*s*l+e*a*h+i*o*l-n*o*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],a=i[2],s=i[3],u=i[4],c=i[5],l=i[6],h=i[7],f=i[8],p=i[9],d=i[10],m=i[11],v=i[12],g=i[13],y=i[14],_=i[15],x=p*y*h-g*d*h+g*l*m-c*y*m-p*l*_+c*d*_,b=v*d*h-f*y*h-v*l*m+u*y*m+f*l*_-u*d*_,w=f*g*h-v*p*h+v*c*m-u*g*m-f*c*_+u*p*_,M=v*p*l-f*g*l-v*c*d+u*g*d+f*c*y-u*p*y,E=r*x+o*b+a*w+s*M;if(0===E){var T="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(T);return console.warn(T),this.identity()}var S=1/E;return n[0]=x*S,n[1]=(g*d*s-p*y*s-g*a*m+o*y*m+p*a*_-o*d*_)*S,n[2]=(c*y*s-g*l*s+g*a*h-o*y*h-c*a*_+o*l*_)*S,n[3]=(p*l*s-c*d*s-p*a*h+o*d*h+c*a*m-o*l*m)*S,n[4]=b*S,n[5]=(f*y*s-v*d*s+v*a*m-r*y*m-f*a*_+r*d*_)*S,n[6]=(v*l*s-u*y*s-v*a*h+r*y*h+u*a*_-r*l*_)*S,n[7]=(u*d*s-f*l*s+f*a*h-r*d*h-u*a*m+r*l*m)*S,n[8]=w*S,n[9]=(v*p*s-f*g*s-v*o*m+r*g*m+f*o*_-r*p*_)*S,n[10]=(u*g*s-v*c*s+v*o*h-r*g*h-u*o*_+r*c*_)*S,n[11]=(f*c*s-u*p*s-f*o*h+r*p*h+u*o*m-r*c*m)*S,n[12]=M*S,n[13]=(f*g*a-v*p*a+v*o*d-r*g*d-f*o*y+r*p*y)*S,n[14]=(v*c*a-u*g*a-v*o*l+r*g*l+u*o*y-r*c*y)*S,n[15]=(u*p*a-f*c*a+f*o*l-r*p*l-u*o*d+r*c*d)*S,this},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,u=r*o,c=r*a;return this.set(u*o+n,u*a-i*s,u*s+i*a,0,u*a+i*s,c*a+n,c*s-i*o,0,u*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,i,r){void 0===t&&(t=new u,e=new c);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length(),h=this.determinant();h<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements);var f=1/a,p=1/s,d=1/l;return e.elements[0]*=f,e.elements[1]*=f,e.elements[2]*=f,e.elements[4]*=p,e.elements[5]*=p,e.elements[6]*=p,e.elements[8]*=d,e.elements[9]*=d,e.elements[10]*=d,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makePerspective:function(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(e-t),u=2*r/(n-i),c=(e+t)/(e-t),l=(n+i)/(n-i),h=-(o+r)/(o-r),f=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),u=1/(n-i),c=1/(o-r),l=(e+t)*s,h=(n+i)*u,f=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}},l.prototype=Object.create(i.prototype),l.prototype.constructor=l,l.prototype.isCubeTexture=!0,Object.defineProperty(l.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var ps=new i,ds=new l,ms=[],vs=[];G.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(t,e[o.id])}};var gs=/([\w\d_]+)(\])?(\[|\.)?/g;X.prototype.setValue=function(t,e,n){var i=this.map[e];void 0!==i&&i.setValue(t,n,this.renderer)},X.prototype.set=function(t,e,n){var i=this.map[n];void 0!==i&&i.setValue(t,e[n],this.renderer)},X.prototype.setOptional=function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)},X.upload=function(t,e,n,i){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=n[a.id];s.needsUpdate!==!1&&a.setValue(t,s.value,i)}},X.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var o=t[i];o.id in e&&n.push(o)}return n};var ys={merge:function(t){for(var e={},n=0;n<t.length;n++){var i=this.clone(t[n]);for(var r in i)e[r]=i[r]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var i in t[n]){var r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}},_s="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",xs="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",bs="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",ws="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",Ms="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",Es="\nvec3 transformed = vec3( position );\n",Ts="\nvec3 objectNormal = vec3( normal );\n",Ss="float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 ltcTextureCoords( const in GeometricContext geometry, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = (LUT_SIZE - 1.0)/LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5/LUT_SIZE;\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nvoid clipQuadToHorizon( inout vec3 L[5], out int n ) {\n\tint config = 0;\n\tif ( L[0].z > 0.0 ) config += 1;\n\tif ( L[1].z > 0.0 ) config += 2;\n\tif ( L[2].z > 0.0 ) config += 4;\n\tif ( L[3].z > 0.0 ) config += 8;\n\tn = 0;\n\tif ( config == 0 ) {\n\t} else if ( config == 1 ) {\n\t\tn = 3;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 2 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 3 ) {\n\t\tn = 4;\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t\tL[3] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 4 ) {\n\t\tn = 3;\n\t\tL[0] = -L[3].z * L[2] + L[2].z * L[3];\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t} else if ( config == 5 ) {\n\t\tn = 0;\n\t} else if ( config == 6 ) {\n\t\tn = 4;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 7 ) {\n\t\tn = 5;\n\t\tL[4] = -L[3].z * L[0] + L[0].z * L[3];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 8 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[1] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] =  L[3];\n\t} else if ( config == 9 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[2].z * L[3] + L[3].z * L[2];\n\t} else if ( config == 10 ) {\n\t\tn = 0;\n\t} else if ( config == 11 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 12 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t} else if ( config == 13 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = L[2];\n\t\tL[2] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t} else if ( config == 14 ) {\n\t\tn = 5;\n\t\tL[4] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t} else if ( config == 15 ) {\n\t\tn = 4;\n\t}\n\tif ( n == 3 )\n\t\tL[3] = L[0];\n\tif ( n == 4 )\n\t\tL[4] = L[0];\n}\nfloat integrateLtcBrdfOverRectEdge( vec3 v1, vec3 v2 ) {\n\tfloat cosTheta = dot( v1, v2 );\n\tfloat theta = acos( cosTheta );\n\tfloat res = cross( v1, v2 ).z * ( ( theta > 0.001 ) ? theta / sin( theta ) : 1.0 );\n\treturn res;\n}\nvoid initRectPoints( const in vec3 pos, const in vec3 halfWidth, const in vec3 halfHeight, out vec3 rectPoints[4] ) {\n\trectPoints[0] = pos - halfWidth - halfHeight;\n\trectPoints[1] = pos + halfWidth - halfHeight;\n\trectPoints[2] = pos + halfWidth + halfHeight;\n\trectPoints[3] = pos - halfWidth + halfHeight;\n}\nvec3 integrateLtcBrdfOverRect( const in GeometricContext geometry, const in mat3 brdfMat, const in vec3 rectPoints[4] ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tvec3 T1, T2;\n\tT1 = normalize(V - N * dot( V, N ));\n\tT2 = - cross( N, T1 );\n\tmat3 brdfWrtSurface = brdfMat * transpose( mat3( T1, T2, N ) );\n\tvec3 clippedRect[5];\n\tclippedRect[0] = brdfWrtSurface * ( rectPoints[0] - P );\n\tclippedRect[1] = brdfWrtSurface * ( rectPoints[1] - P );\n\tclippedRect[2] = brdfWrtSurface * ( rectPoints[2] - P );\n\tclippedRect[3] = brdfWrtSurface * ( rectPoints[3] - P );\n\tint n;\n\tclipQuadToHorizon(clippedRect, n);\n\tif ( n == 0 )\n\t\treturn vec3( 0, 0, 0 );\n\tclippedRect[0] = normalize( clippedRect[0] );\n\tclippedRect[1] = normalize( clippedRect[1] );\n\tclippedRect[2] = normalize( clippedRect[2] );\n\tclippedRect[3] = normalize( clippedRect[3] );\n\tclippedRect[4] = normalize( clippedRect[4] );\n\tfloat sum = 0.0;\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[0], clippedRect[1] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[1], clippedRect[2] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[2], clippedRect[3] );\n\tif (n >= 4)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[3], clippedRect[4] );\n\tif (n == 5)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[4], clippedRect[0] );\n\tsum = max( 0.0, sum );\n\tvec3 Lo_i = vec3( sum, sum, sum );\n\treturn Lo_i;\n}\nvec3 Rect_Area_Light_Specular_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight,\n\t\tconst in float roughness,\n\t\tconst in sampler2D ltcMat, const in sampler2D ltcMag ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tvec2 uv = ltcTextureCoords( geometry, roughness );\n\tvec4 brdfLtcApproxParams, t;\n\tbrdfLtcApproxParams = texture2D( ltcMat, uv );\n\tt = texture2D( ltcMat, uv );\n\tfloat brdfLtcScalar = texture2D( ltcMag, uv ).a;\n\tmat3 brdfLtcApproxMat = mat3(\n\t\tvec3(   1,   0, t.y ),\n\t\tvec3(   0, t.z,   0 ),\n\t\tvec3( t.w,   0, t.x )\n\t);\n\tvec3 specularReflectance = integrateLtcBrdfOverRect( geometry, brdfLtcApproxMat, rectPoints );\n\tspecularReflectance *= brdfLtcScalar;\n\treturn specularReflectance;\n}\nvec3 Rect_Area_Light_Diffuse_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tmat3 diffuseBrdfMat = mat3(1);\n\tvec3 diffuseReflectance = integrateLtcBrdfOverRect( geometry, diffuseBrdfMat, rectPoints );\n\treturn diffuseReflectance;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",Ps="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",As="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",Cs="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",Ls="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",Is="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",Rs="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",Ns="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",Os="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",Ds="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",Bs="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",Us="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",Fs="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",ks="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",zs="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",Gs="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",Hs="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",js="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",Xs="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",Vs="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",Ys="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",Ws="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",qs="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",$s="\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",Zs="#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",Js="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",Ks="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",Qs="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",tu="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",eu="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",nu="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",iu="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",ru="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",ou="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 matDiffColor = material.diffuseColor;\n\t\tvec3 matSpecColor = material.specularColor;\n\t\tvec3 lightColor   = rectAreaLight.color;\n\t\tfloat roughness = BlinnExponentToGGXRoughness( material.specularShininess );\n\t\tvec3 spec = Rect_Area_Light_Specular_Reflectance(\n\t\t\t\tgeometry,\n\t\t\t\trectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n\t\t\t\troughness,\n\t\t\t\tltcMat, ltcMag );\n\t\tvec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n\t\t\t\tgeometry,\n\t\t\t\trectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n\t\treflectedLight.directSpecular += lightColor * matSpecColor * spec / PI2;\n\t\treflectedLight.directDiffuse  += lightColor * matDiffColor * diff / PI2;\n\t}\n#endif\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",au="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",su="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 matDiffColor = material.diffuseColor;\n\t\tvec3 matSpecColor = material.specularColor;\n\t\tvec3 lightColor   = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 spec = Rect_Area_Light_Specular_Reflectance(\n\t\t\t\tgeometry,\n\t\t\t\trectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n\t\t\t\troughness,\n\t\t\t\tltcMat, ltcMag );\n\t\tvec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n\t\t\t\tgeometry,\n\t\t\t\trectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n\t\treflectedLight.directSpecular += lightColor * matSpecColor * spec;\n\t\treflectedLight.directDiffuse  += lightColor * matDiffColor * diff;\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",uu="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",cu="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",lu="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",hu="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",fu="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",pu="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",du="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",mu="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",vu="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",gu="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",yu="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",_u="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",xu="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",bu="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",wu="#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",Mu="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",Eu="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",Tu="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",Su="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",Pu="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",Au="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",Cu="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",Lu="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",Iu="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",Ru="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",Nu="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",Ou="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",Du="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",Bu="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",Uu="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",Fu="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",ku="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",zu="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",Gu="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",Hu="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",ju="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",Xu="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",Vu="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Yu="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",Wu="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",qu="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",$u="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",Zu="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Ju="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",Ku="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",Qu="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",tc="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",ec="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",nc="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",ic="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",rc="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",oc="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",ac="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",sc="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",uc="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",cc="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",lc="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",hc="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",fc="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",pc="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",dc="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",mc="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",vc="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",gc="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",yc="#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",_c={
alphamap_fragment:_s,alphamap_pars_fragment:xs,alphatest_fragment:bs,aomap_fragment:ws,aomap_pars_fragment:Ms,begin_vertex:Es,beginnormal_vertex:Ts,bsdfs:Ss,bumpmap_pars_fragment:Ps,clipping_planes_fragment:As,clipping_planes_pars_fragment:Cs,clipping_planes_pars_vertex:Ls,clipping_planes_vertex:Is,color_fragment:Rs,color_pars_fragment:Ns,color_pars_vertex:Os,color_vertex:Ds,common:Bs,cube_uv_reflection_fragment:Us,defaultnormal_vertex:Fs,displacementmap_pars_vertex:ks,displacementmap_vertex:zs,emissivemap_fragment:Gs,emissivemap_pars_fragment:Hs,encodings_fragment:js,encodings_pars_fragment:Xs,envmap_fragment:Vs,envmap_pars_fragment:Ys,envmap_pars_vertex:Ws,envmap_vertex:qs,fog_vertex:$s,fog_pars_vertex:Zs,fog_fragment:Js,fog_pars_fragment:Ks,gradientmap_pars_fragment:Qs,lightmap_fragment:tu,lightmap_pars_fragment:eu,lights_lambert_vertex:nu,lights_pars:iu,lights_phong_fragment:ru,lights_phong_pars_fragment:ou,lights_physical_fragment:au,lights_physical_pars_fragment:su,lights_template:uu,logdepthbuf_fragment:cu,logdepthbuf_pars_fragment:lu,logdepthbuf_pars_vertex:hu,logdepthbuf_vertex:fu,map_fragment:pu,map_pars_fragment:du,map_particle_fragment:mu,map_particle_pars_fragment:vu,metalnessmap_fragment:gu,metalnessmap_pars_fragment:yu,morphnormal_vertex:_u,morphtarget_pars_vertex:xu,morphtarget_vertex:bu,normal_flip:wu,normal_fragment:Mu,normalmap_pars_fragment:Eu,packing:Tu,premultiplied_alpha_fragment:Su,project_vertex:Pu,roughnessmap_fragment:Au,roughnessmap_pars_fragment:Cu,shadowmap_pars_fragment:Lu,shadowmap_pars_vertex:Iu,shadowmap_vertex:Ru,shadowmask_pars_fragment:Nu,skinbase_vertex:Ou,skinning_pars_vertex:Du,skinning_vertex:Bu,skinnormal_vertex:Uu,specularmap_fragment:Fu,specularmap_pars_fragment:ku,tonemapping_fragment:zu,tonemapping_pars_fragment:Gu,uv_pars_fragment:Hu,uv_pars_vertex:ju,uv_vertex:Xu,uv2_pars_fragment:Vu,uv2_pars_vertex:Yu,uv2_vertex:Wu,worldpos_vertex:qu,cube_frag:$u,cube_vert:Zu,depth_frag:Ju,depth_vert:Ku,distanceRGBA_frag:Qu,distanceRGBA_vert:tc,equirect_frag:ec,equirect_vert:nc,linedashed_frag:ic,linedashed_vert:rc,meshbasic_frag:oc,meshbasic_vert:ac,meshlambert_frag:sc,meshlambert_vert:uc,meshphong_frag:cc,meshphong_vert:lc,meshphysical_frag:hc,meshphysical_vert:fc,normal_frag:pc,normal_vert:dc,points_frag:mc,points_vert:vc,shadow_frag:gc,shadow_vert:yc};V.prototype={constructor:V,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,i){if(e=hs.euclideanModulo(e,1),n=hs.clamp(n,0,1),i=hs.clamp(i,0,1),0===n)this.r=this.g=this.b=i;else{var r=i<=.5?i*(1+n):i+n-i*n,o=2*i-r;this.r=t(o,r,e+1/3),this.g=t(o,r,e),this.b=t(o,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(t&&t.length>0){var c=xc[t];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,i=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),u=Math.min(r,o,a),c=(u+s)/2;if(u===s)e=0,n=0;else{var l=s-u;switch(n=c<=.5?l/(s+u):l/(2-s-u),s){case r:e=(o-a)/l+(o<a?6:0);break;case o:e=(a-r)/l+2;break;case a:e=(r-o)/l+4}e/=6}return i.h=e,i.s=n,i.l=c,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}};var xc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Y.prototype=Object.create(i.prototype),Y.prototype.constructor=Y,Y.prototype.isDataTexture=!0;var bc={common:{diffuse:{value:new V(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new V(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new V(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)}}},wc={basic:{uniforms:ys.merge([bc.common,bc.aomap,bc.lightmap,bc.fog]),vertexShader:_c.meshbasic_vert,fragmentShader:_c.meshbasic_frag},lambert:{uniforms:ys.merge([bc.common,bc.aomap,bc.lightmap,bc.emissivemap,bc.fog,bc.lights,{emissive:{value:new V(0)}}]),vertexShader:_c.meshlambert_vert,fragmentShader:_c.meshlambert_frag},phong:{uniforms:ys.merge([bc.common,bc.aomap,bc.lightmap,bc.emissivemap,bc.bumpmap,bc.normalmap,bc.displacementmap,bc.gradientmap,bc.fog,bc.lights,{emissive:{value:new V(0)},specular:{value:new V(1118481)},shininess:{value:30}}]),vertexShader:_c.meshphong_vert,fragmentShader:_c.meshphong_frag},standard:{uniforms:ys.merge([bc.common,bc.aomap,bc.lightmap,bc.emissivemap,bc.bumpmap,bc.normalmap,bc.displacementmap,bc.roughnessmap,bc.metalnessmap,bc.fog,bc.lights,{emissive:{value:new V(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_c.meshphysical_vert,fragmentShader:_c.meshphysical_frag},points:{uniforms:ys.merge([bc.points,bc.fog]),vertexShader:_c.points_vert,fragmentShader:_c.points_frag},dashed:{uniforms:ys.merge([bc.common,bc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_c.linedashed_vert,fragmentShader:_c.linedashed_frag},depth:{uniforms:ys.merge([bc.common,bc.displacementmap]),vertexShader:_c.depth_vert,fragmentShader:_c.depth_frag},normal:{uniforms:ys.merge([bc.common,bc.bumpmap,bc.normalmap,bc.displacementmap,{opacity:{value:1}}]),vertexShader:_c.normal_vert,fragmentShader:_c.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_c.cube_vert,fragmentShader:_c.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:_c.equirect_vert,fragmentShader:_c.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new u}},vertexShader:_c.distanceRGBA_vert,fragmentShader:_c.distanceRGBA_frag}};wc.physical={uniforms:ys.merge([wc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:_c.meshphysical_vert,fragmentShader:_c.meshphysical_frag},W.prototype={constructor:W,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new n;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new n;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new n;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){var i=e||new n;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){var i=e||new n;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new n;return function(e){var n=t.copy(e).clamp(this.min,this.max);return n.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};var Mc=0;Z.prototype={constructor:Z,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){var i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):"overdraw"===e?this[e]=Number(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var n=void 0===t;n&&(t={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==po&&(i.blending=this.blending),this.shading!==uo&&(i.shading=this.shading),this.side!==ro&&(i.side=this.side),this.vertexColors!==co&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),i.skinning=this.skinning,i.morphTargets=this.morphTargets,n){var r=e(t.textures),o=e(t.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(Z.prototype,e.prototype),J.prototype=Object.create(Z.prototype),J.prototype.constructor=J,J.prototype.isShaderMaterial=!0,J.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ys.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},J.prototype.toJSON=function(t){var e=Z.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},K.prototype=Object.create(Z.prototype),K.prototype.constructor=K,K.prototype.isMeshDepthMaterial=!0,K.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Q.prototype={constructor:Q,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=+(1/0),n=+(1/0),i=+(1/0),r=-(1/0),o=-(1/0),a=-(1/0),s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],h=t[s+2];c<e&&(e=c),l<n&&(n=l),h<i&&(i=h),c>r&&(r=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromBufferAttribute:function(t){for(var e=+(1/0),n=+(1/0),i=+(1/0),r=-(1/0),o=-(1/0),a=-(1/0),s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),h=t.getZ(s);c<e&&(e=c),l<n&&(n=l),h<i&&(i=h),c>r&&(r=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new u;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new u;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new u;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t=new u;return function(e){var n=this;return e.updateMatrixWorld(!0),e.traverse(function(e){var i,r,o=e.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(i=0,r=a.length;i<r;i++)t.copy(a[i]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(i=0,r=s.count;i<r;i++)t.fromBufferAttribute(s,i).applyMatrix4(e.matrixWorld),n.expandByPoint(t)}}),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){var n=e||new u;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new u),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){var n=e||new u;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new u;return function(e){var n=t.copy(e).clamp(this.min,this.max);return n.sub(e).length()}}(),getBoundingSphere:function(){var t=new u;return function(e){var n=e||new tt;return this.getCenter(n.center),n.radius=.5*this.getSize(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new u,new u,new u,new u,new u,new u,new u,new u];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},tt.prototype={constructor:tt,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t;return function(e,n){void 0===t&&(t=new Q);var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).getCenter(i);for(var r=0,o=0,a=e.length;o<a;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new u;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var e=t||new Q;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},et.prototype={constructor:et,isMatrix3:!0,set:function(t,e,n,i,r,o,a,s,u){var c=this.elements;return c[0]=t,c[1]=i,c[2]=a,c[3]=e,c[4]=r,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new u);for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*r*c+n*a*s+i*r*u-i*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=n[8],p=f*u-c*h,d=c*l-f*s,m=h*s-u*l,v=r*p+o*d+a*m;if(0===v){var g="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return i[0]=p*y,i[1]=(a*h-f*o)*y,i[2]=(c*o-a*u)*y,i[3]=d*y,i[4]=(f*r-a*l)*y,i[5]=(a*s-c*r)*y,i[6]=m*y,i[7]=(o*l-h*r)*y,i[8]=(u*r-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},nt.prototype={constructor:nt,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new u,e=new u;return function(n,i,r){var o=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t),i=e||new u;return i.copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new u;return function(e,n){var i=n||new u,r=e.delta(t),o=this.normal.dot(r);if(0!==o){var a=-(e.start.dot(this.normal)+this.constant)/o;if(!(a<0||a>1))return i.copy(r).multiplyScalar(a).add(e.start)}else if(0===this.distanceToPoint(e.start))return i.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new u;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new u,e=new et;return function(n,i){var r=this.coplanarPoint(t).applyMatrix4(n),o=i||e.getNormalMatrix(n),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),
this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},it.prototype={constructor:it,set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],p=n[10],d=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-i,l-s,d-h,y-m).normalize(),e[1].setComponents(a+i,l+s,d+h,y+m).normalize(),e[2].setComponents(a+r,l+u,d+f,y+v).normalize(),e[3].setComponents(a-r,l-u,d-f,y-v).normalize(),e[4].setComponents(a-o,l-c,d-p,y-g).normalize(),e[5].setComponents(a+o,l+c,d+p,y+g).normalize(),this},intersectsObject:function(){var t=new tt;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new tt;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++){var o=e[r].distanceToPoint(n);if(o<i)return!1}return!0},intersectsBox:function(){var t=new u,e=new u;return function(n){for(var i=this.planes,r=0;r<6;r++){var o=i[r];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}},ot.prototype={constructor:ot,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var n=e||new u;return n.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new u;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new u;n.subVectors(t,this.origin);var i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new u;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new u,e=new u,n=new u;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,u,c,l,h=.5*i.distanceTo(r),f=-this.direction.dot(e),p=n.dot(this.direction),d=-n.dot(e),m=n.lengthSq(),v=Math.abs(1-f*f);if(v>0)if(s=f*d-p,u=f*p-d,l=h*v,s>=0)if(u>=-l)if(u<=l){var g=1/v;s*=g,u*=g,c=s*(s+f*u+2*p)+u*(f*s+u+2*d)+m}else u=h,s=Math.max(0,-(f*u+p)),c=-s*s+u*(u+2*d)+m;else u=-h,s=Math.max(0,-(f*u+p)),c=-s*s+u*(u+2*d)+m;else u<=-l?(s=Math.max(0,-(-f*h+p)),u=s>0?-h:Math.min(Math.max(-h,-d),h),c=-s*s+u*(u+2*d)+m):u<=l?(s=0,u=Math.min(Math.max(-h,-d),h),c=u*(u+2*d)+m):(s=Math.max(0,-(f*h+p)),u=s>0?h:Math.min(Math.max(-h,-d),h),c=-s*s+u*(u+2*d)+m);else u=f>0?-h:h,s=Math.max(0,-(f*u+p)),c=-s*s+u*(u+2*d)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(u).add(t),c}}(),intersectSphere:function(){var t=new u;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,u=i+a;return s<0&&u<0?null:s<0?this.at(u,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var n=t.normal.dot(this.direction);return n*e<0},intersectBox:function(t,e){var n,i,r,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,i=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,i=(t.min.x-h.x)*u),c>=0?(r=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>i?null:((a>n||n!==n)&&(n=a),(s<i||i!==i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))},intersectsBox:function(){var t=new u;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new u,e=new u,n=new u,i=new u;return function(r,o,a,s,u){e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n);var c,l=this.direction.dot(i);if(l>0){if(s)return null;c=1}else{if(!(l<0))return null;c=-1,l=-l}t.subVectors(this.origin,r);var h=c*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var f=c*this.direction.dot(e.cross(t));if(f<0)return null;if(h+f>l)return null;var p=-c*t.dot(i);return p<0?null:this.at(p/l,u)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},at.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],at.DefaultOrder="XYZ",at.prototype={constructor:at,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=hs.clamp,r=t.elements,o=r[0],a=r[4],s=r[8],u=r[1],c=r[5],l=r[9],h=r[2],f=r[6],p=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new c),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new s;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new u(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},st.prototype={constructor:st,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}};var Ec=0;ut.DefaultUp=new u(0,1,0),ut.DefaultMatrixAutoUpdate=!0,ut.prototype={constructor:ut,isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new s;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new u(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new u(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new u(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new u;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new u(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new u(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new u(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new c;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new c;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var n=this.children.indexOf(t);n!==-1&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n],o=r.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){var e=t||new u;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new u,e=new u;return function(n){var i=n||new s;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new s;return function(e){var n=e||new at;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new u,e=new s;return function(n){var i=n||new u;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new s;return function(e){var n=e||new u;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&t!==!0||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var n=void 0===t||""===t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),this.children.length>0){r.children=[];for(var o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(n){var a=e(t.geometries),s=e(t.materials),u=e(t.textures),c=e(t.images);a.length>0&&(i.geometries=a),s.length>0&&(i.materials=s),u.length>0&&(i.textures=u),c.length>0&&(i.images=c)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}},Object.assign(ut.prototype,e.prototype),ct.prototype={constructor:ct,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){var e=t||new u;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new u;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new u;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new u,e=new u;return function(n,i){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),o=e.dot(t),a=o/r;return i&&(a=hs.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e),r=n||new u;return this.delta(r).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},lt.normal=function(){var t=new u;return function(e,n,i,r){var o=r||new u;o.subVectors(i,n),t.subVectors(e,n),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),lt.barycoordFromPoint=function(){var t=new u,e=new u,n=new u;return function(i,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),n.subVectors(i,r);var c=t.dot(t),l=t.dot(e),h=t.dot(n),f=e.dot(e),p=e.dot(n),d=c*f-l*l,m=s||new u;if(0===d)return m.set(-2,-1,-1);var v=1/d,g=(f*h-l*p)*v,y=(c*p-l*h)*v;return m.set(1-g-y,y,g)}}(),lt.containsPoint=function(){var t=new u;return function(e,n,i,r){var o=lt.barycoordFromPoint(e,n,i,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),lt.prototype={constructor:lt,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new u,e=new u;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new u;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return lt.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new nt;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return lt.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return lt.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,n,i;return function(r,o){void 0===t&&(t=new nt,e=[new ct,new ct,new ct],n=new u,i=new u);var a=o||new u,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,n),this.containsPoint(n)===!0)a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var c=0;c<e.length;c++){e[c].closestPointToPoint(n,!0,i);var l=n.distanceToSquared(i);l<s&&(s=l,a.copy(i))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},ht.prototype={constructor:ht,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},ft.prototype=Object.create(Z.prototype),ft.prototype.constructor=ft,ft.prototype.isMeshBasicMaterial=!0,ft.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},pt.prototype={constructor:pt,isBufferAttribute:!0,set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new V),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new n),e[i++]=a.x,e[i++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new u),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new r),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},dt.prototype=Object.create(pt.prototype),dt.prototype.constructor=dt,mt.prototype=Object.create(pt.prototype),mt.prototype.constructor=mt,vt.prototype=Object.create(pt.prototype),vt.prototype.constructor=vt,gt.prototype=Object.create(pt.prototype),gt.prototype.constructor=gt,yt.prototype=Object.create(pt.prototype),yt.prototype.constructor=yt,_t.prototype=Object.create(pt.prototype),_t.prototype.constructor=_t,xt.prototype=Object.create(pt.prototype),xt.prototype.constructor=xt,bt.prototype=Object.create(pt.prototype),bt.prototype.constructor=bt,wt.prototype=Object.create(pt.prototype),wt.prototype.constructor=wt,Object.assign(Mt.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,i=t.faces,r=t.vertices,o=t.faceVertexUvs,a=o[0]&&o[0].length>0,s=o[1]&&o[1].length>0,u=t.morphTargets,c=u.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var h,f=t.morphNormals,p=f.length;if(p>0){h=[];for(var l=0;l<p;l++)h[l]=[];this.morphTargets.normal=h}for(var d=t.skinIndices,m=t.skinWeights,v=d.length===r.length,g=m.length===r.length,l=0;l<i.length;l++){var y=i[l];this.vertices.push(r[y.a],r[y.b],r[y.c]);var _=y.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var x=y.normal;this.normals.push(x,x,x)}var b=y.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=y.color;this.colors.push(w,w,w)}if(a===!0){var M=o[0][l];void 0!==M?this.uvs.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new n,new n,new n))}if(s===!0){var M=o[1][l];void 0!==M?this.uvs2.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new n,new n,new n))}for(var E=0;E<c;E++){var T=u[E].vertices;e[E].push(T[y.a],T[y.b],T[y.c])}for(var E=0;E<p;E++){var S=f[E].vertexNormals[l];h[E].push(S.a,S.b,S.c)}v&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),g&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Tc=0;St.prototype={constructor:St,isGeometry:!0,applyMatrix:function(t){for(var e=(new et).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++){var r=this.vertices[n];r.applyMatrix4(t)}for(var n=0,i=this.faces.length;n<i;n++){var o=this.faces[n];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;a<s;a++)o.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new c),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new c),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ut),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,n,r){var o=void 0!==s?[f[t].clone(),f[e].clone(),f[n].clone()]:[],a=void 0!==c?[i.colors[t].clone(),i.colors[e].clone(),i.colors[n].clone()]:[],u=new ht(t,e,n,o,a,r);i.faces.push(u),void 0!==l&&i.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[n].clone()]),void 0!==h&&i.faceVertexUvs[1].push([d[t].clone(),d[e].clone(),d[n].clone()])}var i=this,r=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,c=void 0!==o.color?o.color.array:void 0,l=void 0!==o.uv?o.uv.array:void 0,h=void 0!==o.uv2?o.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var f=[],p=[],d=[],m=0,v=0;m<a.length;m+=3,v+=2)i.vertices.push(new u(a[m],a[m+1],a[m+2])),void 0!==s&&f.push(new u(s[m],s[m+1],s[m+2])),void 0!==c&&i.colors.push(new V(c[m],c[m+1],c[m+2])),void 0!==l&&p.push(new n(l[v],l[v+1])),void 0!==h&&d.push(new n(h[v],h[v+1]));if(void 0!==r){var g=t.groups;if(g.length>0)for(var m=0;m<g.length;m++)for(var y=g[m],_=y.start,x=y.count,v=_,b=_+x;v<b;v+=3)e(r[v],r[v+1],r[v+2],y.materialIndex);else for(var m=0;m<r.length;m+=3)e(r[m],r[m+1],r[m+2])}else for(var m=0;m<a.length/3;m+=3)e(m,m+1,m+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new c;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new u,e=new u,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,i,r,o,a;for(a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new u;if(t){var s,c,l,h=new u,f=new u;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],h.subVectors(l,c),f.subVectors(s,c),h.cross(f),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)o=this.faces[i],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(i=0,r=this.faces.length;i<r;i++){o=this.faces[i];var p=o.vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){n=this.faces[t];var i=n.vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new St;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,s,c=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)a=new u,s={a:new u,b:new u,c:new u},c.push(a),l.push(s)}var h=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],a=h.faceNormals[n],s=h.vertexNormals[n],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Q),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new tt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if((t&&t.isGeometry)===!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var i,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,c=this.faceVertexUvs[0],l=t.faceVertexUvs[0],h=this.colors,f=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new et).getNormalMatrix(e));for(var p=0,d=a.length;p<d;p++){var m=a[p],v=m.clone();void 0!==e&&v.applyMatrix4(e),o.push(v)}for(var p=0,d=f.length;p<d;p++)h.push(f[p].clone());for(p=0,d=u.length;p<d;p++){var g,y,_,x=u[p],b=x.vertexNormals,w=x.vertexColors;g=new ht(x.a+r,x.b+r,x.c+r),g.normal.copy(x.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var M=0,E=b.length;M<E;M++)y=b[M].clone(),void 0!==i&&y.applyMatrix3(i).normalize(),g.vertexNormals.push(y);g.color.copy(x.color);for(var M=0,E=w.length;M<E;M++)_=w[M],g.vertexColors.push(_.clone());g.materialIndex=x.materialIndex+n,s.push(g)}for(p=0,d=l.length;p<d;p++){var T=l[p],S=[];if(void 0!==T){for(var M=0,E=T.length;M<E;M++)S.push(T[M].clone());c.push(S)}}},mergeMesh:function(t){return(t&&t.isMesh)===!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),
void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,i,r,o,a,s,u={},c=[],l=[],h=4,f=Math.pow(10,h);for(n=0,i=this.vertices.length;n<i;n++)t=this.vertices[n],e=Math.round(t.x*f)+"_"+Math.round(t.y*f)+"_"+Math.round(t.z*f),void 0===u[e]?(u[e]=n,c.push(this.vertices[n]),l[n]=c.length-1):l[n]=l[u[e]];var p=[];for(n=0,i=this.faces.length;n<i;n++){r=this.faces[n],r.a=l[r.a],r.b=l[r.b],r.c=l[r.c],o=[r.a,r.b,r.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var m=p[n];for(this.faces.splice(m,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(m,1)}var v=this.vertices.length-c.length;return this.vertices=c,v},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,n=e.length,i=0;i<n;i++)e[i]._id=i;e.sort(t);var r,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===n&&(r=[]),s&&s.length===n&&(o=[]);for(var i=0;i<n;i++){var u=e[i]._id;r&&r.push(a[u]),o&&o.push(s[u])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==f[e]?f[e]:(f[e]=h.length/3,h.push(t.x,t.y,t.z),f[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==d[e]?d[e]:(d[e]=p.length,p.push(t.getHex()),d[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==v[e]?v[e]:(v[e]=m.length/2,m.push(t.x,t.y),v[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(var s=[],u=0;u<this.vertices.length;u++){var c=this.vertices[u];s.push(c.x,c.y,c.z)}for(var l=[],h=[],f={},p=[],d={},m=[],v={},u=0;u<this.faces.length;u++){var g=this.faces[u],y=!0,_=!1,x=void 0!==this.faceVertexUvs[0][u],b=g.normal.length()>0,w=g.vertexNormals.length>0,M=1!==g.color.r||1!==g.color.g||1!==g.color.b,E=g.vertexColors.length>0,T=0;if(T=t(T,0,0),T=t(T,1,y),T=t(T,2,_),T=t(T,3,x),T=t(T,4,b),T=t(T,5,w),T=t(T,6,M),T=t(T,7,E),l.push(T),l.push(g.a,g.b,g.c),l.push(g.materialIndex),x){var S=this.faceVertexUvs[0][u];l.push(i(S[0]),i(S[1]),i(S[2]))}if(b&&l.push(e(g.normal)),w){var P=g.vertexNormals;l.push(e(P[0]),e(P[1]),e(P[2]))}if(M&&l.push(n(g.color)),E){var A=g.vertexColors;l.push(n(A[0]),n(A[1]),n(A[2]))}}return r.data={},r.data.vertices=s,r.data.normals=h,p.length>0&&(r.data.colors=p),m.length>0&&(r.data.uvs=[m]),r.data.faces=l,r},clone:function(){return(new St).copy(this)},copy:function(t){var e,n,i,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var c=t.faces;for(e=0,n=c.length;e<n;e++)this.faces.push(c[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),i=0,r=l.length;i<r;i++){var h=l[i],f=[];for(o=0,a=h.length;o<a;o++){var p=h[o];f.push(p.clone())}this.faceVertexUvs[e].push(f)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var m={};if(m.name=d[e].name,void 0!==d[e].vertices)for(m.vertices=[],i=0,r=d[e].vertices.length;i<r;i++)m.vertices.push(d[e].vertices[i].clone());if(void 0!==d[e].normals)for(m.normals=[],i=0,r=d[e].normals.length;i<r;i++)m.normals.push(d[e].normals[i].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],i=0,r=v[e].vertexNormals.length;i<r;i++){var y=v[e].vertexNormals[i],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),g.vertexNormals.push(_)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],i=0,r=v[e].faceNormals.length;i<r;i++)g.faceNormals.push(v[e].faceNormals[i].clone());this.morphNormals.push(g)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var b=t.skinIndices;for(e=0,n=b.length;e<n;e++)this.skinIndices.push(b[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var M=t.boundingBox;null!==M&&(this.boundingBox=M.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(St.prototype,e.prototype),Pt.prototype={constructor:Pt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Et(t)>65535?xt:yt)(t,1):this.index=t},addAttribute:function(t,e){return(e&&e.isBufferAttribute)===!1&&(e&&e.isInterleavedBufferAttribute)===!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new pt(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new et).getNormalMatrix(t);i.applyToBufferAttribute(n),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new c),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new c),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new c),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ut),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new bt(3*e.vertices.length,3),i=new bt(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new bt(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(e.elementsNeedUpdate===!0&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}var i;return e.verticesNeedUpdate===!0&&(i=this.attributes.position,void 0!==i&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1),e.normalsNeedUpdate===!0&&(i=this.attributes.normal,void 0!==i&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1),e.colorsNeedUpdate===!0&&(i=this.attributes.color,void 0!==i&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(i=this.attributes.uv,void 0!==i&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,void 0!==i&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Mt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new pt(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new pt(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(3*t.colors.length);this.addAttribute("color",new pt(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new pt(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new pt(o,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=Et(t.indices)>65535?Uint32Array:Uint16Array,s=new a(3*t.indices.length);this.setIndex(new pt(s,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var u in t.morphTargets){for(var c=[],l=t.morphTargets[u],h=0,f=l.length;h<f;h++){var p=l[h],d=new bt(3*p.length,3);c.push(d.copyVector3sArray(p))}this.morphAttributes[u]=c}if(t.skinIndices.length>0){var m=new bt(4*t.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var v=new bt(4*t.skinWeights.length,4);this.addAttribute("skinWeight",v.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Q);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new Q,e=new u;return function(){null===this.boundingSphere&&(this.boundingSphere=new tt);var n=this.attributes.position;if(n){var i=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(i);for(var r=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),r=Math.max(r,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new pt(new Float32Array(i.length),3));else for(var r=e.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,c,l,h=e.normal.array,f=new u,p=new u,d=new u,m=new u,v=new u;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var y=0,_=n.length;y<_;++y)for(var x=n[y],b=x.start,w=x.count,o=b,a=b+w;o<a;o+=3)s=3*g[o+0],c=3*g[o+1],l=3*g[o+2],f.fromArray(i,s),p.fromArray(i,c),d.fromArray(i,l),m.subVectors(d,p),v.subVectors(f,p),m.cross(v),h[s]+=m.x,h[s+1]+=m.y,h[s+2]+=m.z,h[c]+=m.x,h[c+1]+=m.y,h[c+2]+=m.z,h[l]+=m.x,h[l+1]+=m.y,h[l+2]+=m.z}else for(var o=0,a=i.length;o<a;o+=9)f.fromArray(i,o),p.fromArray(i,o+3),d.fromArray(i,o+6),m.subVectors(d,p),v.subVectors(f,p),m.cross(v),h[o]=m.x,h[o+1]=m.y,h[o+2]=m.z,h[o+3]=m.x,h[o+4]=m.y,h[o+5]=m.z,h[o+6]=m.x,h[o+7]=m.y,h[o+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if((t&&t.isBufferGeometry)===!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var r=n[i],o=r.array,a=t.attributes[i],s=a.array,u=a.itemSize,c=0,l=u*e;c<s.length;c++,l++)o[l]=s[c];return this},normalizeNormals:function(){for(var t,e,n,i,r=this.attributes.normal.array,o=0,a=r.length;o<a;o+=3)t=r[o],e=r[o+1],n=r[o+2],i=1/Math.sqrt(t*t+e*e+n*n),r[o]*=i,r[o+1]*=i,r[o+2]*=i},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Pt,e=this.index.array,n=this.attributes;for(var i in n){for(var r=n[i],o=r.array,a=r.itemSize,s=new o.constructor(e.length*a),u=0,c=0,l=0,h=e.length;l<h;l++){u=e[l]*a;for(var f=0;f<a;f++)s[c++]=o[u++]}t.addAttribute(i,new pt(s,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);t.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n],r=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;return null!==u&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new Pt).copy(this)},copy:function(t){var e,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],c=s[e];for(n=0,i=c.length;n<i;n++)u.push(c[n].clone());this.morphAttributes[e]=u}var l=t.groups;for(n=0,i=l.length;n<i;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Pt.MaxIndex=65535,Object.assign(Pt.prototype,e.prototype),At.prototype=Object.assign(Object.create(ut.prototype),{constructor:At,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return ut.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&t.length>0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,n=t.length;e<n;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,n,i,r,o,a){return lt.barycoordFromPoint(t,e,n,i,y),r.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),r.add(o).add(a),r.clone()}function e(t,e,n,i,r,o,a){var s,u=t.material;if(s=u.side===oo?n.intersectTriangle(o,r,i,!0,a):n.intersectTriangle(i,r,o,u.side!==ao,a),null===s)return null;x.copy(a),x.applyMatrix4(t.matrixWorld);var c=e.ray.origin.distanceTo(x);return c<e.near||c>e.far?null:{distance:c,point:x.clone(),object:t}}function i(n,i,r,o,a,u,c,f){s.fromBufferAttribute(o,u),l.fromBufferAttribute(o,c),h.fromBufferAttribute(o,f);var p=e(n,i,r,s,l,h,_);return p&&(a&&(m.fromBufferAttribute(a,u),v.fromBufferAttribute(a,c),g.fromBufferAttribute(a,f),p.uv=t(_,s,l,h,m,v,g)),p.face=new ht(u,c,f,lt.normal(s,l,h)),p.faceIndex=u),p}var r=new c,o=new ot,a=new tt,s=new u,l=new u,h=new u,f=new u,p=new u,d=new u,m=new n,v=new n,g=new n,y=new u,_=new u,x=new u;return function(n,u){var c=this.geometry,y=this.material,x=this.matrixWorld;if(void 0!==y&&(null===c.boundingSphere&&c.computeBoundingSphere(),a.copy(c.boundingSphere),a.applyMatrix4(x),n.ray.intersectsSphere(a)!==!1&&(r.getInverse(x),o.copy(n.ray).applyMatrix4(r),null===c.boundingBox||o.intersectsBox(c.boundingBox)!==!1))){var b;if(c.isBufferGeometry){var w,M,E,T,S,P=c.index,A=c.attributes.position,C=c.attributes.uv;if(null!==P)for(T=0,S=P.count;T<S;T+=3)w=P.getX(T),M=P.getX(T+1),E=P.getX(T+2),b=i(this,n,o,A,C,w,M,E),b&&(b.faceIndex=Math.floor(T/3),u.push(b));else for(T=0,S=A.count;T<S;T+=3)w=T,M=T+1,E=T+2,b=i(this,n,o,A,C,w,M,E),b&&(b.index=w,u.push(b))}else if(c.isGeometry){var L,I,R,N,O=y&&y.isMultiMaterial,D=O===!0?y.materials:null,B=c.vertices,U=c.faces,F=c.faceVertexUvs[0];F.length>0&&(N=F);for(var k=0,z=U.length;k<z;k++){var G=U[k],H=O===!0?D[G.materialIndex]:y;if(void 0!==H){if(L=B[G.a],I=B[G.b],R=B[G.c],H.morphTargets===!0){var j=c.morphTargets,X=this.morphTargetInfluences;s.set(0,0,0),l.set(0,0,0),h.set(0,0,0);for(var V=0,Y=j.length;V<Y;V++){var W=X[V];if(0!==W){var q=j[V].vertices;s.addScaledVector(f.subVectors(q[G.a],L),W),l.addScaledVector(p.subVectors(q[G.b],I),W),h.addScaledVector(d.subVectors(q[G.c],R),W)}}s.add(L),l.add(I),h.add(R),L=s,I=l,R=h}if(b=e(this,n,o,L,I,R,_)){if(N){var $=N[k];m.copy($[0]),v.copy($[1]),g.copy($[2]),b.uv=t(_,L,I,R,m,v,g)}b.face=G,b.faceIndex=k,u.push(b)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ct.prototype=Object.create(St.prototype),Ct.prototype.constructor=Ct,Lt.prototype=Object.create(Pt.prototype),Lt.prototype.constructor=Lt,It.prototype=Object.create(St.prototype),It.prototype.constructor=It,Rt.prototype=Object.create(Pt.prototype),Rt.prototype.constructor=Rt,Nt.prototype=Object.create(ut.prototype),Nt.prototype.constructor=Nt,Nt.prototype.isCamera=!0,Nt.prototype.getWorldDirection=function(){var t=new s;return function(e){var n=e||new u;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),Nt.prototype.lookAt=function(){var t=new c;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),Nt.prototype.clone=function(){return(new this.constructor).copy(this)},Nt.prototype.copy=function(t){return ut.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},Ot.prototype=Object.assign(Object.create(Nt.prototype),{constructor:Ot,isPerspectiveCamera:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*hs.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*hs.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*hs.RAD2DEG*Math.atan(Math.tan(.5*hs.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*hs.DEG2RAD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*i/a,e-=o.offsetY*n/s,i*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(r+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far)},toJSON:function(t){var e=ut.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Dt.prototype=Object.assign(Object.create(Nt.prototype),{constructor:Dt,isOrthographicCamera:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,o=n+t,a=i+e,s=i-e;if(null!==this.view){var u=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;r+=l*(this.view.offsetX/u),o=r+l*(this.view.width/u),a-=h*(this.view.offsetY/c),s=a-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(t){var e=ut.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var Sc=0;ce.prototype.isFogExp2=!0,ce.prototype.clone=function(){return new ce(this.color.getHex(),this.density)},ce.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},le.prototype.isFog=!0,le.prototype.clone=function(){return new le(this.color.getHex(),this.near,this.far)},le.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},he.prototype=Object.create(ut.prototype),he.prototype.constructor=he,he.prototype.copy=function(t,e){return ut.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},he.prototype.toJSON=function(t){var e=ut.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},fe.prototype=Object.assign(Object.create(ut.prototype),{constructor:fe,isLensFlare:!0,copy:function(t){ut.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,i,r,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new V(16777215)),void 0===i&&(i=po),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:i})},updateLensFlares:function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<n;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),pe.prototype=Object.create(Z.prototype),pe.prototype.constructor=pe,pe.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},de.prototype=Object.assign(Object.create(ut.prototype),{constructor:de,isSprite:!0,raycast:function(){var t=new u;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceSqToPoint(t),r=this.scale.x*this.scale.y/4;i>r||n.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),me.prototype=Object.assign(Object.create(ut.prototype),{constructor:me,copy:function(t){ut.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,i=e.length;n<i;n++){var r=e[n];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new u;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),update:function(){var t=new u,e=new u;return function(n){var i=this.levels;if(i.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);i[0].object.visible=!0;for(var o=1,a=i.length;o<a&&r>=i[o].distance;o++)i[o-1].object.visible=!1,i[o].object.visible=!0;for(;o<a;o++)i[o].object.visible=!1}}}(),toJSON:function(t){var e=ut.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(ve.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new c;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,e=0,n=this.bones.length;e<n;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,n=this.bones.length;e<n;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new c;return function(){for(var e=0,n=this.bones.length;e<n;e++){var i=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(i,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new ve(this.bones,this.boneInverses,this.useVertexTexture)}}),ge.prototype=Object.assign(Object.create(ut.prototype),{constructor:ge,isBone:!0}),ye.prototype=Object.assign(Object.create(At.prototype),{constructor:ye,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var i=new r,o=this.geometry.attributes.skinWeight,t=0;t<o.count;t++){i.x=o.getX(t),i.y=o.getY(t),i.z=o.getZ(t),i.w=o.getW(t);var n=1/i.lengthManhattan();n!==1/0?i.multiplyScalar(n):i.set(1,0,0,0),o.setXYZW(t,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function(t){At.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),_e.prototype=Object.create(Z.prototype),_e.prototype.constructor=_e,_e.prototype.isLineBasicMaterial=!0,_e.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},xe.prototype=Object.assign(Object.create(ut.prototype),{constructor:xe,isLine:!0,raycast:function(){var t=new c,e=new ot,n=new tt;return function(i,r){var o=i.linePrecision,a=o*o,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),i.ray.intersectsSphere(n)!==!1){t.getInverse(c),e.copy(i.ray).applyMatrix4(t);var l=new u,h=new u,f=new u,p=new u,d=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var m=s.index,v=s.attributes,g=v.position.array;if(null!==m)for(var y=m.array,_=0,x=y.length-1;_<x;_+=d){var b=y[_],w=y[_+1];l.fromArray(g,3*b),h.fromArray(g,3*w);var M=e.distanceSqToSegment(l,h,p,f);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var E=i.ray.origin.distanceTo(p);E<i.near||E>i.far||r.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(var _=0,x=g.length/3-1;_<x;_+=d){l.fromArray(g,3*_),h.fromArray(g,3*_+3);var M=e.distanceSqToSegment(l,h,p,f);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var E=i.ray.origin.distanceTo(p);E<i.near||E>i.far||r.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else if(s.isGeometry)for(var T=s.vertices,S=T.length,_=0;_<S-1;_+=d){var M=e.distanceSqToSegment(T[_],T[_+1],p,f);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var E=i.ray.origin.distanceTo(p);E<i.near||E>i.far||r.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),be.prototype=Object.assign(Object.create(xe.prototype),{constructor:be,isLineSegments:!0}),we.prototype=Object.create(Z.prototype),we.prototype.constructor=we,we.prototype.isPointsMaterial=!0,we.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Me.prototype=Object.assign(Object.create(ut.prototype),{constructor:Me,isPoints:!0,raycast:function(){var t=new c,e=new ot,n=new tt;return function(i,r){function o(t,n){var o=e.distanceSqToPoint(t);if(o<f){var s=e.closestPointToPoint(t);s.applyMatrix4(c);var u=i.ray.origin.distanceTo(s);if(u<i.near||u>i.far)return;r.push({distance:u,distanceToRay:Math.sqrt(o),point:s.clone(),index:n,face:null,object:a})}}var a=this,s=this.geometry,c=this.matrixWorld,l=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),i.ray.intersectsSphere(n)!==!1){t.getInverse(c),e.copy(i.ray).applyMatrix4(t);var h=l/((this.scale.x+this.scale.y+this.scale.z)/3),f=h*h,p=new u;if(s.isBufferGeometry){var d=s.index,m=s.attributes,v=m.position.array;if(null!==d)for(var g=d.array,y=0,_=g.length;y<_;y++){var x=g[y];p.fromArray(v,3*x),o(p,x)}else for(var y=0,b=v.length/3;y<b;y++)p.fromArray(v,3*y),o(p,y)}else for(var w=s.vertices,y=0,b=w.length;y<b;y++)o(w[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ee.prototype=Object.assign(Object.create(ut.prototype),{constructor:Ee}),Te.prototype=Object.create(i.prototype),Te.prototype.constructor=Te,Se.prototype=Object.create(i.prototype),Se.prototype.constructor=Se,Se.prototype.isCompressedTexture=!0,Pe.prototype=Object.create(i.prototype),Pe.prototype.constructor=Pe,
Ae.prototype=Object.create(i.prototype),Ae.prototype.constructor=Ae,Ae.prototype.isDepthTexture=!0,Ce.prototype=Object.create(Pt.prototype),Ce.prototype.constructor=Ce,Le.prototype=Object.create(St.prototype),Le.prototype.constructor=Le,Ie.prototype=Object.create(Pt.prototype),Ie.prototype.constructor=Ie,Re.prototype=Object.create(St.prototype),Re.prototype.constructor=Re,Ne.prototype=Object.create(Pt.prototype),Ne.prototype.constructor=Ne,Oe.prototype=Object.create(St.prototype),Oe.prototype.constructor=Oe,De.prototype=Object.create(Ne.prototype),De.prototype.constructor=De,Be.prototype=Object.create(St.prototype),Be.prototype.constructor=Be,Ue.prototype=Object.create(Ne.prototype),Ue.prototype.constructor=Ue,Fe.prototype=Object.create(St.prototype),Fe.prototype.constructor=Fe,ke.prototype=Object.create(Ne.prototype),ke.prototype.constructor=ke,ze.prototype=Object.create(St.prototype),ze.prototype.constructor=ze,Ge.prototype=Object.create(Ne.prototype),Ge.prototype.constructor=Ge,He.prototype=Object.create(St.prototype),He.prototype.constructor=He,je.prototype=Object.create(Pt.prototype),je.prototype.constructor=je,Xe.prototype=Object.create(St.prototype),Xe.prototype.constructor=Xe,Ve.prototype=Object.create(Pt.prototype),Ve.prototype.constructor=Ve,Ye.prototype=Object.create(St.prototype),Ye.prototype.constructor=Ye,We.prototype=Object.create(Pt.prototype),We.prototype.constructor=We;var Pc={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},triangulate:function(){function t(t,e,n,i,r,o){var a,s,u,c,l,h,f,p,d;if(s=t[o[e]].x,u=t[o[e]].y,c=t[o[n]].x,l=t[o[n]].y,h=t[o[i]].x,f=t[o[i]].y,(c-s)*(f-u)-(l-u)*(h-s)<=0)return!1;var m,v,g,y,_,x,b,w,M,E,T,S,P,A,C;for(m=h-c,v=f-l,g=s-h,y=u-f,_=c-s,x=l-u,a=0;a<r;a++)if(p=t[o[a]].x,d=t[o[a]].y,!(p===s&&d===u||p===c&&d===l||p===h&&d===f)&&(b=p-s,w=d-u,M=p-c,E=d-l,T=p-h,S=d-f,C=m*E-v*M,P=_*w-x*b,A=g*S-y*T,C>=-Number.EPSILON&&A>=-Number.EPSILON&&P>=-Number.EPSILON))return!1;return!0}return function(e,n){var i=e.length;if(i<3)return null;var r,o,a,s=[],u=[],c=[];if(Pc.area(e)>0)for(o=0;o<i;o++)u[o]=o;else for(o=0;o<i;o++)u[o]=i-1-o;var l=i,h=2*l;for(o=l-1;l>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),n?c:s;if(r=o,l<=r&&(r=0),o=r+1,l<=o&&(o=0),a=o+1,l<=a&&(a=0),t(e,r,o,a,l,u)){var f,p,d,m,v;for(f=u[r],p=u[o],d=u[a],s.push([e[f],e[p],e[d]]),c.push([u[r],u[o],u[a]]),m=o,v=o+1;v<l;m++,v++)u[m]=u[v];l--,h=2*l}}return n?c:s}}(),triangulateShape:function(t,e){function n(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function i(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function r(t,e,n,r,o){var a=e.x-t.x,s=e.y-t.y,u=r.x-n.x,c=r.y-n.y,l=t.x-n.x,h=t.y-n.y,f=s*u-a*c,p=s*l-a*h;if(Math.abs(f)>Number.EPSILON){var d;if(f>0){if(p<0||p>f)return[];if(d=c*l-u*h,d<0||d>f)return[]}else{if(p>0||p<f)return[];if(d=c*l-u*h,d>0||d<f)return[]}if(0===d)return!o||0!==p&&p!==f?[t]:[];if(d===f)return!o||0!==p&&p!==f?[e]:[];if(0===p)return[n];if(p===f)return[r];var m=d/f;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!==p||c*l!==u*h)return[];var v=0===a&&0===s,g=0===u&&0===c;if(v&&g)return t.x!==n.x||t.y!==n.y?[]:[t];if(v)return i(n,r,t)?[t]:[];if(g)return i(t,e,n)?[n]:[];var y,_,x,b,w,M,E,T;return 0!==a?(t.x<e.x?(y=t,x=t.x,_=e,b=e.x):(y=e,x=e.x,_=t,b=t.x),n.x<r.x?(w=n,E=n.x,M=r,T=r.x):(w=r,E=r.x,M=n,T=n.x)):(t.y<e.y?(y=t,x=t.y,_=e,b=e.y):(y=e,x=e.y,_=t,b=t.y),n.y<r.y?(w=n,E=n.y,M=r,T=r.y):(w=r,E=r.y,M=n,T=n.y)),x<=E?b<E?[]:b===E?o?[]:[w]:b<=T?[w,_]:[w,M]:x>T?[]:x===T?o?[]:[y]:b<=T?[y,_]:[y,M]}function o(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=n.x-t.x,s=n.y-t.y,u=i.x-t.x,c=i.y-t.y,l=r*s-o*a,h=r*c-o*u;if(Math.abs(l)>Number.EPSILON){var f=u*s-c*a;return l>0?h>=0&&f>=0:h>=0||f>=0}return h>0}function a(t,e){function n(t,e){var n=y.length-1,i=t-1;i<0&&(i=n);var r=t+1;r>n&&(r=0);var a=o(y[t],y[i],y[r],s[e]);if(!a)return!1;var u=s.length-1,c=e-1;c<0&&(c=u);var l=e+1;return l>u&&(l=0),a=o(s[e],s[c],s[l],y[t]),!!a}function i(t,e){var n,i,o;for(n=0;n<y.length;n++)if(i=n+1,i%=y.length,o=r(t,e,y[n],y[i],!0),o.length>0)return!0;return!1}function a(t,n){var i,o,a,s,u;for(i=0;i<_.length;i++)for(o=e[_[i]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,u=r(t,n,o[a],o[s],!0),u.length>0)return!0;return!1}for(var s,u,c,l,h,f,p,d,m,v,g,y=t.concat(),_=[],x=[],b=0,w=e.length;b<w;b++)_.push(b);for(var M=0,E=2*_.length;_.length>0;){if(E--,E<0){console.log("Infinite Loop! Holes left:"+_.length+", Probably Hole outside Shape!");break}for(c=M;c<y.length;c++){l=y[c],u=-1;for(var b=0;b<_.length;b++)if(f=_[b],p=l.x+":"+l.y+":"+f,void 0===x[p]){s=e[f];for(var T=0;T<s.length;T++)if(h=s[T],n(c,T)&&!i(l,h)&&!a(l,h)){u=T,_.splice(b,1),d=y.slice(0,c+1),m=y.slice(c),v=s.slice(u),g=s.slice(0,u+1),y=d.concat(v).concat(g).concat(m),M=c;break}if(u>=0)break;x[p]=!0}if(u>=0)break}}return y}n(t),e.forEach(n);for(var s,u,c,l,h,f,p={},d=t.concat(),m=0,v=e.length;m<v;m++)Array.prototype.push.apply(d,e[m]);for(s=0,u=d.length;s<u;s++)h=d[s].x+":"+d[s].y,void 0!==p[h]&&console.warn("THREE.ShapeUtils: Duplicate point",h,s),p[h]=s;var g=a(t,e),y=Pc.triangulate(g,!1);for(s=0,u=y.length;s<u;s++)for(l=y[s],c=0;c<3;c++)h=l[c].x+":"+l[c].y,f=p[h],void 0!==f&&(l[c]=f);return y.concat()},isClockWise:function(t){return Pc.area(t)<0}};qe.prototype=Object.create(St.prototype),qe.prototype.constructor=qe,qe.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];this.addShape(r,e)}},qe.prototype.addShape=function(t,e){function i(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function r(t,e,i){var r,o,a=1,s=t.x-e.x,u=t.y-e.y,c=i.x-t.x,l=i.y-t.y,h=s*s+u*u,f=s*l-u*c;if(Math.abs(f)>Number.EPSILON){var p=Math.sqrt(h),d=Math.sqrt(c*c+l*l),m=e.x-u/p,v=e.y+s/p,g=i.x-l/d,y=i.y+c/d,_=((g-m)*l-(y-v)*c)/(s*l-u*c);r=m+s*_-t.x,o=v+u*_-t.y;var x=r*r+o*o;if(x<=2)return new n(r,o);a=Math.sqrt(x/2)}else{var b=!1;s>Number.EPSILON?c>Number.EPSILON&&(b=!0):s<-Number.EPSILON?c<-Number.EPSILON&&(b=!0):Math.sign(u)===Math.sign(l)&&(b=!0),b?(r=-u,o=s,a=Math.sqrt(h)):(r=s,o=u,a=Math.sqrt(h/2))}return new n(r/a,o/a)}function o(){if(b){var t=0,e=X*t;for(W=0;W<V;W++)j=B[W],l(j[2]+e,j[1]+e,j[0]+e);for(t=M+2*x,e=X*t,W=0;W<V;W++)j=B[W],l(j[0]+e,j[1]+e,j[2]+e)}else{for(W=0;W<V;W++)j=B[W],l(j[2],j[1],j[0]);for(W=0;W<V;W++)j=B[W],l(j[0]+X*M,j[1]+X*M,j[2]+X*M)}}function a(){var t=0;for(s(U,t),t+=U.length,A=0,C=O.length;A<C;A++)P=O[A],s(P,t),t+=P.length}function s(t,e){var n,i;for(W=t.length;--W>=0;){n=W,i=W-1,i<0&&(i=t.length-1);var r=0,o=M+2*x;for(r=0;r<o;r++){var a=X*r,s=X*(r+1),u=e+n+a,c=e+i+a,l=e+i+s,f=e+n+s;h(u,c,l,f,t,r,o,n,i)}}}function c(t,e,n){L.vertices.push(new u(t,e,n))}function l(t,e,n){t+=I,e+=I,n+=I,L.faces.push(new ht(t,e,n,null,null,0));var i=S.generateTopUV(L,t,e,n);L.faceVertexUvs[0].push(i)}function h(t,e,n,i,r,o,a,s,u){t+=I,e+=I,n+=I,i+=I,L.faces.push(new ht(t,e,i,null,null,1)),L.faces.push(new ht(e,n,i,null,null,1));var c=S.generateSideWallUV(L,t,e,n,i);L.faceVertexUvs[0].push([c[0],c[1],c[3]]),L.faceVertexUvs[0].push([c[1],c[2],c[3]])}var f,p,d,m,v,g=void 0!==e.amount?e.amount:100,y=void 0!==e.bevelThickness?e.bevelThickness:6,_=void 0!==e.bevelSize?e.bevelSize:y-2,x=void 0!==e.bevelSegments?e.bevelSegments:3,b=void 0===e.bevelEnabled||e.bevelEnabled,w=void 0!==e.curveSegments?e.curveSegments:12,M=void 0!==e.steps?e.steps:1,E=e.extrudePath,T=!1,S=void 0!==e.UVGenerator?e.UVGenerator:qe.WorldUVGenerator;E&&(f=E.getSpacedPoints(M),T=!0,b=!1,p=void 0!==e.frames?e.frames:E.computeFrenetFrames(M,!1),d=new u,m=new u,v=new u),b||(x=0,y=0,_=0);var P,A,C,L=this,I=this.vertices.length,R=t.extractPoints(w),N=R.shape,O=R.holes,D=!Pc.isClockWise(N);if(D){for(N=N.reverse(),A=0,C=O.length;A<C;A++)P=O[A],Pc.isClockWise(P)&&(O[A]=P.reverse());D=!1}var B=Pc.triangulateShape(N,O),U=N;for(A=0,C=O.length;A<C;A++)P=O[A],N=N.concat(P);for(var F,k,z,G,H,j,X=N.length,V=B.length,Y=[],W=0,q=U.length,$=q-1,Z=W+1;W<q;W++,$++,Z++)$===q&&($=0),Z===q&&(Z=0),Y[W]=r(U[W],U[$],U[Z]);var J,K=[],Q=Y.concat();for(A=0,C=O.length;A<C;A++){for(P=O[A],J=[],W=0,q=P.length,$=q-1,Z=W+1;W<q;W++,$++,Z++)$===q&&($=0),Z===q&&(Z=0),J[W]=r(P[W],P[$],P[Z]);K.push(J),Q=Q.concat(J)}for(F=0;F<x;F++){for(z=F/x,G=y*Math.cos(z*Math.PI/2),k=_*Math.sin(z*Math.PI/2),W=0,q=U.length;W<q;W++)H=i(U[W],Y[W],k),c(H.x,H.y,-G);for(A=0,C=O.length;A<C;A++)for(P=O[A],J=K[A],W=0,q=P.length;W<q;W++)H=i(P[W],J[W],k),c(H.x,H.y,-G)}for(k=_,W=0;W<X;W++)H=b?i(N[W],Q[W],k):N[W],T?(m.copy(p.normals[0]).multiplyScalar(H.x),d.copy(p.binormals[0]).multiplyScalar(H.y),v.copy(f[0]).add(m).add(d),c(v.x,v.y,v.z)):c(H.x,H.y,0);var tt;for(tt=1;tt<=M;tt++)for(W=0;W<X;W++)H=b?i(N[W],Q[W],k):N[W],T?(m.copy(p.normals[tt]).multiplyScalar(H.x),d.copy(p.binormals[tt]).multiplyScalar(H.y),v.copy(f[tt]).add(m).add(d),c(v.x,v.y,v.z)):c(H.x,H.y,g/M*tt);for(F=x-1;F>=0;F--){for(z=F/x,G=y*Math.cos(z*Math.PI/2),k=_*Math.sin(z*Math.PI/2),W=0,q=U.length;W<q;W++)H=i(U[W],Y[W],k),c(H.x,H.y,g+G);for(A=0,C=O.length;A<C;A++)for(P=O[A],J=K[A],W=0,q=P.length;W<q;W++)H=i(P[W],J[W],k),T?c(H.x,H.y+f[M-1].y,f[M-1].x+G):c(H.x,H.y,g+G)}o(),a()},qe.WorldUVGenerator={generateTopUV:function(t,e,i,r){var o=t.vertices,a=o[e],s=o[i],u=o[r];return[new n(a.x,a.y),new n(s.x,s.y),new n(u.x,u.y)]},generateSideWallUV:function(t,e,i,r,o){var a=t.vertices,s=a[e],u=a[i],c=a[r],l=a[o];return Math.abs(s.y-u.y)<.01?[new n(s.x,1-s.z),new n(u.x,1-u.z),new n(c.x,1-c.z),new n(l.x,1-l.z)]:[new n(s.y,1-s.z),new n(u.y,1-u.z),new n(c.y,1-c.z),new n(l.y,1-l.z)]}},$e.prototype=Object.create(qe.prototype),$e.prototype.constructor=$e,Ze.prototype=Object.create(St.prototype),Ze.prototype.constructor=Ze,Je.prototype=Object.create(Pt.prototype),Je.prototype.constructor=Je,Ke.prototype=Object.create(St.prototype),Ke.prototype.constructor=Ke,Qe.prototype=Object.create(Pt.prototype),Qe.prototype.constructor=Qe,tn.prototype=Object.create(St.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(Pt.prototype),en.prototype.constructor=en,nn.prototype=Object.create(St.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(Pt.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(Pt.prototype),on.prototype.constructor=on,an.prototype=Object.create(St.prototype),an.prototype.constructor=an,sn.prototype=Object.create(Pt.prototype),sn.prototype.constructor=sn,un.prototype=Object.create(an.prototype),un.prototype.constructor=un,cn.prototype=Object.create(sn.prototype),cn.prototype.constructor=cn,ln.prototype=Object.create(St.prototype),ln.prototype.constructor=ln,hn.prototype=Object.create(Pt.prototype),hn.prototype.constructor=hn;var Ac=Object.freeze({WireframeGeometry:Ce,ParametricGeometry:Le,ParametricBufferGeometry:Ie,TetrahedronGeometry:Oe,TetrahedronBufferGeometry:De,OctahedronGeometry:Be,OctahedronBufferGeometry:Ue,IcosahedronGeometry:Fe,IcosahedronBufferGeometry:ke,DodecahedronGeometry:ze,DodecahedronBufferGeometry:Ge,PolyhedronGeometry:Re,PolyhedronBufferGeometry:Ne,TubeGeometry:He,TubeBufferGeometry:je,TorusKnotGeometry:Xe,TorusKnotBufferGeometry:Ve,TorusGeometry:Ye,TorusBufferGeometry:We,TextGeometry:$e,SphereGeometry:Ze,SphereBufferGeometry:Je,RingGeometry:Ke,RingBufferGeometry:Qe,PlaneGeometry:It,PlaneBufferGeometry:Rt,LatheGeometry:tn,LatheBufferGeometry:en,ShapeGeometry:nn,ShapeBufferGeometry:rn,ExtrudeGeometry:qe,EdgesGeometry:on,ConeGeometry:un,ConeBufferGeometry:cn,CylinderGeometry:an,CylinderBufferGeometry:sn,CircleGeometry:ln,CircleBufferGeometry:hn,BoxGeometry:Ct,BoxBufferGeometry:Lt});fn.prototype=Object.create(J.prototype),fn.prototype.constructor=fn,fn.prototype.isShadowMaterial=!0,pn.prototype=Object.create(J.prototype),pn.prototype.constructor=pn,pn.prototype.isRawShaderMaterial=!0,dn.prototype={constructor:dn,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},n=this.materials,i=0,r=n.length;i<r;i++){var o=n[i].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},mn.prototype=Object.create(Z.prototype),mn.prototype.constructor=mn,mn.prototype.isMeshStandardMaterial=!0,mn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},vn.prototype=Object.create(mn.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshPhysicalMaterial=!0,vn.prototype.copy=function(t){return mn.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},gn.prototype=Object.create(Z.prototype),gn.prototype.constructor=gn,gn.prototype.isMeshPhongMaterial=!0,gn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yn.prototype=Object.create(gn.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshToonMaterial=!0,yn.prototype.copy=function(t){return gn.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},_n.prototype=Object.create(Z.prototype),_n.prototype.constructor=_n,_n.prototype.isMeshNormalMaterial=!0,_n.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},xn.prototype=Object.create(Z.prototype),xn.prototype.constructor=xn,xn.prototype.isMeshLambertMaterial=!0,xn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},bn.prototype=Object.create(Z.prototype),bn.prototype.constructor=bn,bn.prototype.isLineDashedMaterial=!0,bn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Cc=Object.freeze({ShadowMaterial:fn,SpriteMaterial:pe,RawShaderMaterial:pn,ShaderMaterial:J,PointsMaterial:we,MultiMaterial:dn,MeshPhysicalMaterial:vn,MeshStandardMaterial:mn,MeshPhongMaterial:gn,MeshToonMaterial:yn,MeshNormalMaterial:_n,MeshLambertMaterial:xn,MeshDepthMaterial:K,MeshBasicMaterial:ft,LineDashedMaterial:bn,LineBasicMaterial:_e,Material:Z}),Lc={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Ic=new wn;Object.assign(Mn.prototype,{load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=Lc.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=/^data:(.*?)(;base64)?,(.*)$/,s=t.match(a);if(s){var u=s[1],c=!!s[2],l=s[3];l=window.decodeURIComponent(l),c&&(l=window.atob(l));try{var h,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":h=new ArrayBuffer(l.length);for(var p=new Uint8Array(h),d=0;d<l.length;d++)p[d]=l.charCodeAt(d);"blob"===f&&(h=new Blob([h],{type:u}));break;case"document":var m=new DOMParser;h=m.parseFromString(l,u);break;case"json":h=JSON.parse(l);break;default:h=l}window.setTimeout(function(){e&&e(h),r.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){i&&i(e),r.manager.itemError(t)},0)}}else{var v=new XMLHttpRequest;v.open("GET",t,!0),v.addEventListener("load",function(n){var o=n.target.response;Lc.add(t,o),200===this.status?(e&&e(o),r.manager.itemEnd(t)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),e&&e(o),r.manager.itemEnd(t)):(i&&i(n),r.manager.itemError(t))},!1),void 0!==n&&v.addEventListener("progress",function(t){n(t)},!1),v.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),void 0!==this.responseType&&(v.responseType=this.responseType),void 0!==this.withCredentials&&(v.withCredentials=this.withCredentials),v.overrideMimeType&&v.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),v.send(null)}return r.manager.itemStart(t),v},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Object.assign(En.prototype,{load:function(t,e,n,i){function r(r){u.load(t[r],function(t){var n=o._parser(t,!0);a[r]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},c+=1,6===c&&(1===n.mipmapCount&&(s.minFilter=ha),s.format=n.format,s.needsUpdate=!0,e&&e(s))},n,i)}var o=this,a=[],s=new Se;s.image=a;var u=new Mn(this.manager);if(u.setPath(this.path),u.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,l=0,h=t.length;l<h;++l)r(l);else u.load(t,function(t){var n=o._parser(t,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,r=0;r<i;r++){a[r]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)a[r].mipmaps.push(n.mipmaps[r*n.mipmapCount+u]),a[r].format=n.format,a[r].width=n.width,a[r].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=ha),s.format=n.format,s.needsUpdate=!0,e&&e(s)},n,i);return s},setPath:function(t){return this.path=t,this}}),Object.assign(Tn.prototype,{load:function(t,e,n,i){var r=this,o=new Y,a=new Mn(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var n=r._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:aa,o.wrapT=void 0!==n.wrapT?n.wrapT:aa,o.magFilter=void 0!==n.magFilter?n.magFilter:ha,o.minFilter=void 0!==n.minFilter?n.minFilter:pa,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=ha),o.needsUpdate=!0,e&&e(o,n))},n,i),o}}),Object.assign(Sn.prototype,{load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=Lc.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){Lc.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Pn.prototype,{load:function(t,e,n,i){function r(n){a.load(t[n],function(t){o.images[n]=t,s++,6===s&&(o.needsUpdate=!0,e&&e(o))},void 0,i)}var o=new l,a=new Sn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var s=0,u=0;u<t.length;++u)r(u);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(An.prototype,{load:function(t,e,n,r){var o=new i,a=new Sn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(n){var i=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);o.format=i?Pa:Aa,o.image=n,o.needsUpdate=!0,void 0!==e&&e(o)},n,r),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Cn.prototype=Object.assign(Object.create(ut.prototype),{constructor:Cn,isLight:!0,copy:function(t){return ut.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=ut.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Ln.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Ln,isHemisphereLight:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(In.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Rn.prototype=Object.assign(Object.create(In.prototype),{constructor:Rn,isSpotLightShadow:!0,update:function(t){var e=2*hs.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||500,r=this.camera;e===r.fov&&n===r.aspect&&i===r.far||(r.fov=e,r.aspect=n,r.far=i,r.updateProjectionMatrix())}}),Nn.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Nn,isSpotLight:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),On.prototype=Object.assign(Object.create(Cn.prototype),{constructor:On,isPointLight:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Dn.prototype=Object.assign(Object.create(In.prototype),{constructor:Dn}),Bn.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Bn,isDirectionalLight:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Un.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Un,isAmbientLight:!0});var Rc={arraySlice:function(t,e,n){return Rc.isTypedArray(t)?new t.constructor(t.subarray(e,n)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,n){return t[e]-t[n]}for(var n=t.length,i=new Array(n),r=0;r!==n;++r)i[r]=r;return i.sort(e),i},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*e,u=0;u!==e;++u)r[a++]=t[s+u];return r},flattenJSON:function(t,e,n,i){for(var r=1,o=t[0];void 0!==o&&void 0===o[i];)o=t[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a)){do a=o[i],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[r++];while(void 0!==o)}else if(void 0!==a.toArray){do a=o[i],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++];while(void 0!==o)}else do a=o[i],void 0!==a&&(e.push(o.time),n.push(a)),o=t[r++];while(void 0!==o)}}};Fn.prototype={constructor:Fn,evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{var o;n:{i:if(!(t<i)){for(var a=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,i=e[++n],t<i)break e}o=e.length;break n}{if(t>=r)break t;var s=e[1];t<s&&(n=2,r=s);for(var a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,r=e[--n-1],t>=r)break e}o=n,n=0}}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,o=0;o!==i;++o)e[o]=n[r+o];return e},interpolate_:function(t,e,n,i){throw new Error("call to abstract method")},intervalChanged_:function(t,e,n){}},Object.assign(Fn.prototype,{beforeStart_:Fn.prototype.copySampleValue_,afterEnd_:Fn.prototype.copySampleValue_}),kn.prototype=Object.assign(Object.create(Fn.prototype),{constructor:kn,DefaultSettings_:{endingStart:$a,endingEnd:$a},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case Za:r=t,a=2*e-n;break;case Ja:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Za:o=t,s=2*n-e;break;case Ja:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=r*c,this._offsetNext=o*c},interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-e)/(i-e),d=p*p,m=d*p,v=-h*m+2*h*d-h*p,g=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*p+1,y=(-1-f)*m+(1.5+f)*d+.5*p,_=f*m-f*d,x=0;x!==a;++x)r[x]=v*o[c+x]+g*o[u+x]+y*o[s+x]+_*o[l+x];return r}}),zn.prototype=Object.assign(Object.create(Fn.prototype),{constructor:zn,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(i-e),l=1-c,h=0;h!==a;++h)r[h]=o[u+h]*l+o[s+h]*c;return r}}),Gn.prototype=Object.assign(Object.create(Fn.prototype),{constructor:Gn,interpolate_:function(t,e,n,i){return this.copySampleValue_(t-1)}});var Nc;Nc={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Wa,InterpolantFactoryMethodDiscrete:function(t){return new Gn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new zn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new kn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Ya:e=this.InterpolantFactoryMethodDiscrete;break;case Wa:e=this.InterpolantFactoryMethodLinear;break;case qa:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return void console.warn(n)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ya;case this.InterpolantFactoryMethodLinear:return Wa;case this.InterpolantFactoryMethodSmooth:return qa}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<t;)++r;for(;o!==-1&&n[o]>e;)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);var a=this.getValueSize();this.times=Rc.arraySlice(n,r,o),this.values=Rc.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("invalid value size in track",this),t=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("track is empty",this),t=!1);for(var o=null,a=0;a!==r;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("out of order keys",this,a,s,o),t=!1;break}o=s}if(void 0!==i&&Rc.isTypedArray(i))for(var a=0,u=i.length;a!==u;++a){var c=i[a];if(isNaN(c)){console.error("value is not a valid number",this,a,c),t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),i=this.getInterpolation()===qa,r=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a],c=t[a+1];if(u!==c&&(1!==a||u!==u[0]))if(i)s=!0;else for(var l=a*n,h=l-n,f=l+n,p=0;p!==n;++p){var d=e[l+p];if(d!==e[h+p]||d!==e[f+p]){s=!0;break}}if(s){if(a!==r){t[r]=t[a];for(var m=a*n,v=r*n,p=0;p!==n;++p)e[v+p]=e[m+p]}++r}}if(o>0){t[r]=t[o];for(var m=o*n,v=r*n,p=0;p!==n;++p)e[v+p]=e[m+p];++r}return r!==t.length&&(this.times=Rc.arraySlice(t,0,r),this.values=Rc.arraySlice(e,0,r*n)),this}},jn.prototype=Object.assign(Object.create(Nc),{constructor:jn,ValueTypeName:"vector"}),Xn.prototype=Object.assign(Object.create(Fn.prototype),{constructor:Xn,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,u=t*a,c=(n-e)/(i-e),l=u+a;u!==l;u+=4)s.slerpFlat(r,0,o,u-a,o,u,c);return r}}),Vn.prototype=Object.assign(Object.create(Nc),{constructor:Vn,ValueTypeName:"quaternion",DefaultInterpolation:Wa,InterpolantFactoryMethodLinear:function(t){return new Xn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Yn.prototype=Object.assign(Object.create(Nc),{
constructor:Yn,ValueTypeName:"number"}),Wn.prototype=Object.assign(Object.create(Nc),{constructor:Wn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ya,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),qn.prototype=Object.assign(Object.create(Nc),{constructor:qn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ya,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),$n.prototype=Object.assign(Object.create(Nc),{constructor:$n,ValueTypeName:"color"}),Zn.prototype=Nc,Nc.constructor=Zn,Object.assign(Zn,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=Zn._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],i=[];Rc.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Rc.convertArray(t.times,Array),values:Rc.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Yn;case"vector":case"vector2":case"vector3":case"vector4":return jn;case"color":return $n;case"quaternion":return Vn;case"bool":case"boolean":return qn;case"string":return Wn}throw new Error("Unsupported typeName: "+t)}}),Jn.prototype={constructor:Jn,resetDuration:function(){for(var t=this.tracks,e=0,n=0,i=t.length;n!==i;++n){var r=this.tracks[n];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Jn,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,o=n.length;r!==o;++r)e.push(Zn.parse(n[r]).scale(i));return new Jn(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e},r=0,o=n.length;r!==o;++r)e.push(Zn.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(t,e,n,i){for(var r=e.length,o=[],a=0;a<r;a++){var s=[],u=[];s.push((a+r-1)%r,a,(a+1)%r),u.push(0,1,0);var c=Rc.getKeyframeOrder(s);s=Rc.sortedArray(s,1,c),u=Rc.sortedArray(u,1,c),i||0!==s[0]||(s.push(r),u.push(u[0])),o.push(new Yn(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new Jn(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var i=t;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(r);if(u&&u.length>1){var c=u[1],l=i[c];l||(i[c]=l=[]),l.push(s)}}var h=[];for(var c in i)h.push(Jn.CreateFromMorphTargetSequence(c,i[c],e,n));return h},parseAnimation:function(t,e){if(!t)return console.error("  no animation in JSONLoader data"),null;for(var n=function(t,e,n,i,r){if(0!==n.length){var o=[],a=[];Rc.flattenJSON(n,o,a,i),0!==o.length&&r.push(new t(e,o,a))}},i=[],r=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var f=0;f<c[h].morphTargets.length;f++)l[c[h].morphTargets[f]]=-1;for(var p in l){for(var d=[],m=[],f=0;f!==c[h].morphTargets.length;++f){var v=c[h];d.push(v.time),m.push(v.morphTarget===p?1:0)}i.push(new Yn(".morphTargetInfluence["+p+"]",d,m))}o=l.length*(a||1)}else{var g=".bones["+e[u].name+"]";n(jn,g+".position",c,"pos",i),n(Vn,g+".quaternion",c,"rot",i),n(jn,g+".scale",c,"scl",i)}}if(0===i.length)return null;var y=new Jn(r,o,i);return y}}),Object.assign(Kn.prototype,{load:function(t,e,n,i){var r=this,o=new Mn(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===i[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),i[t]}var i=this.textures,r=new Cc[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.shading&&(r.shading=t.shading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=(new n).fromArray(o)}if(void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),void 0!==t.materials)for(var a=0,s=t.materials.length;a<s;a++)r.materials.push(this.parse(t.materials[a]));return r}}),Object.assign(Qn.prototype,{load:function(t,e,n,i){var r=this,o=new Mn(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=new Pt,n=t.data.index,i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==n){var r=new i[n.type](n.array);e.setIndex(new pt(r,1))}var o=t.data.attributes;for(var a in o){var s=o[a],r=new i[s.type](s.array);e.addAttribute(a,new pt(r,s.itemSize,s.normalized))}var c=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==c)for(var l=0,h=c.length;l!==h;++l){var f=c[l];e.addGroup(f.start,f.count,f.materialIndex)}var p=t.data.boundingSphere;if(void 0!==p){var d=new u;void 0!==p.center&&d.fromArray(p.center),e.boundingSphere=new tt(d,p.radius)}return e}}),ti.prototype={constructor:ti,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(){var t,e,n,i={NoBlending:fo,NormalBlending:po,AdditiveBlending:mo,SubtractiveBlending:vo,MultiplyBlending:go,CustomBlending:yo};return function(r,o,a){function s(t,n,i,r,s){var c,l=o+t,h=ti.Handlers.get(l);null!==h?c=h.load(l):(e.setCrossOrigin(a),c=e.load(l)),void 0!==n&&(c.repeat.fromArray(n),1!==n[0]&&(c.wrapS=oa),1!==n[1]&&(c.wrapT=oa)),void 0!==i&&c.offset.fromArray(i),void 0!==r&&("repeat"===r[0]&&(c.wrapS=oa),"mirror"===r[0]&&(c.wrapS=sa),"repeat"===r[1]&&(c.wrapT=oa),"mirror"===r[1]&&(c.wrapT=sa)),void 0!==s&&(c.anisotropy=s);var f=hs.generateUUID();return u[f]=c,f}void 0===t&&(t=new V),void 0===e&&(e=new An),void 0===n&&(n=new Kn);var u={},c={uuid:hs.generateUUID(),type:"MeshLambertMaterial"};for(var l in r){var h=r[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=h;break;case"blending":c.blending=i[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(h).getHex();break;case"colorSpecular":c.specular=t.fromArray(h).getHex();break;case"colorEmissive":c.emissive=t.fromArray(h).getHex();break;case"specularCoef":c.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=s(h,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=s(h,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=s(h,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=s(h,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=s(h,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=s(h,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[h,h];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=s(h,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=s(h,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=s(h,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=s(h,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=oo;break;case"doubleSided":c.side=ao;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=h;break;case"vertexColors":h===!0&&(c.vertexColors=ho),"face"===h&&(c.vertexColors=lo);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,h)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,c.opacity<1&&(c.transparent=!0),n.setTextures(u),n.parse(c)}}()},ti.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n],o=e[n+1];if(r.test(t))return o}return null}},Object.assign(ei.prototype,{load:function(t,e,n,i){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:ti.prototype.extractUrlBase(t),a=new Mn(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var i=JSON.parse(n),a=i.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var u=r.parse(i,o);e(u.geometry,u.materials)},n,i)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function i(e){function i(t,e){return t&1<<e}var r,o,a,s,l,h,f,p,d,m,v,g,y,_,x,b,w,M,E,T,S,P,A,C,L,I,R,N=t.faces,O=t.vertices,D=t.normals,B=t.colors,U=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&U++;for(r=0;r<U;r++)c.faceVertexUvs[r]=[]}for(s=0,l=O.length;s<l;)M=new u,M.x=O[s++]*e,M.y=O[s++]*e,M.z=O[s++]*e,c.vertices.push(M);for(s=0,l=N.length;s<l;)if(m=N[s++],v=i(m,0),g=i(m,1),y=i(m,3),_=i(m,4),x=i(m,5),b=i(m,6),w=i(m,7),v){if(T=new ht,T.a=N[s],T.b=N[s+1],T.c=N[s+3],S=new ht,S.a=N[s+1],S.b=N[s+2],S.c=N[s+3],s+=4,g&&(d=N[s++],T.materialIndex=d,S.materialIndex=d),a=c.faces.length,y)for(r=0;r<U;r++)for(C=t.uvs[r],c.faceVertexUvs[r][a]=[],c.faceVertexUvs[r][a+1]=[],o=0;o<4;o++)p=N[s++],I=C[2*p],R=C[2*p+1],L=new n(I,R),2!==o&&c.faceVertexUvs[r][a].push(L),0!==o&&c.faceVertexUvs[r][a+1].push(L);if(_&&(f=3*N[s++],T.normal.set(D[f++],D[f++],D[f]),S.normal.copy(T.normal)),x)for(r=0;r<4;r++)f=3*N[s++],A=new u(D[f++],D[f++],D[f]),2!==r&&T.vertexNormals.push(A),0!==r&&S.vertexNormals.push(A);if(b&&(h=N[s++],P=B[h],T.color.setHex(P),S.color.setHex(P)),w)for(r=0;r<4;r++)h=N[s++],P=B[h],2!==r&&T.vertexColors.push(new V(P)),0!==r&&S.vertexColors.push(new V(P));c.faces.push(T),c.faces.push(S)}else{if(E=new ht,E.a=N[s++],E.b=N[s++],E.c=N[s++],g&&(d=N[s++],E.materialIndex=d),a=c.faces.length,y)for(r=0;r<U;r++)for(C=t.uvs[r],c.faceVertexUvs[r][a]=[],o=0;o<3;o++)p=N[s++],I=C[2*p],R=C[2*p+1],L=new n(I,R),c.faceVertexUvs[r][a].push(L);if(_&&(f=3*N[s++],E.normal.set(D[f++],D[f++],D[f])),x)for(r=0;r<3;r++)f=3*N[s++],A=new u(D[f++],D[f++],D[f]),E.vertexNormals.push(A);if(b&&(h=N[s++],E.color.setHex(B[h])),w)for(r=0;r<3;r++)h=N[s++],E.vertexColors.push(new V(B[h]));c.faces.push(E)}}function o(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,i=t.skinWeights.length;n<i;n+=e){var o=t.skinWeights[n],a=e>1?t.skinWeights[n+1]:0,s=e>2?t.skinWeights[n+2]:0,u=e>3?t.skinWeights[n+3]:0;c.skinWeights.push(new r(o,a,s,u))}if(t.skinIndices)for(var n=0,i=t.skinIndices.length;n<i;n+=e){var l=t.skinIndices[n],h=e>1?t.skinIndices[n+1]:0,f=e>2?t.skinIndices[n+2]:0,p=e>3?t.skinIndices[n+3]:0;c.skinIndices.push(new r(l,h,f,p))}c.bones=t.bones,c.bones&&c.bones.length>0&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.")}function a(e){if(void 0!==t.morphTargets)for(var n=0,i=t.morphTargets.length;n<i;n++){c.morphTargets[n]={},c.morphTargets[n].name=t.morphTargets[n].name,c.morphTargets[n].vertices=[];for(var r=c.morphTargets[n].vertices,o=t.morphTargets[n].vertices,a=0,s=o.length;a<s;a+=3){var l=new u;l.x=o[a]*e,l.y=o[a+1]*e,l.z=o[a+2]*e,r.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var h=c.faces,f=t.morphColors[0].colors,n=0,i=h.length;n<i;n++)h[n].color.fromArray(f,3*n)}}function s(){var e=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var i=0;i<n.length;i++){var r=Jn.parseAnimation(n[i],c.bones);r&&e.push(r)}if(c.morphTargets){var o=Jn.CreateClipsFromMorphTargetSequences(c.morphTargets,10);e=e.concat(o)}e.length>0&&(c.animations=e)}var c=new St,l=void 0!==t.scale?1/t.scale:1;if(i(l),o(),a(l),s(),c.computeFaceNormals(),c.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:c};var h=ti.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:c,materials:h}}}),Object.assign(ni.prototype,{load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this,o=new Mn(r.manager);o.load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==i&&i(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;return void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase()?void console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):void r.parse(o,e)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,function(){void 0!==e&&e(a)}),r=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,r),a=this.parseObject(t.object,n,o);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new ei,i=new Qn,r=0,o=t.length;r<o;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Ac[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Ac[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Ac[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Ac[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Ac[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Ac[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new Ac[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Ac[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Ac[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Ac[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Ac[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new Kn;i.setTextures(e);for(var r=0,o=t.length;r<o;r++){var a=i.parse(t[r]);n[a.uuid]=a}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=Jn.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){function n(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemError(t)})}var i=this,r={};if(void 0!==t&&t.length>0){var o=new wn(e),a=new Sn(o);a.setCrossOrigin(this.crossOrigin);for(var s=0,u=t.length;s<u;s++){var c=t[s],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;r[c.uuid]=n(l)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={UVMapping:Jo,CubeReflectionMapping:Ko,CubeRefractionMapping:Qo,EquirectangularReflectionMapping:ta,EquirectangularRefractionMapping:ea,SphericalReflectionMapping:na,CubeUVReflectionMapping:ia,CubeUVRefractionMapping:ra},o={RepeatWrapping:oa,ClampToEdgeWrapping:aa,MirroredRepeatWrapping:sa},a={NearestFilter:ua,NearestMipMapNearestFilter:ca,NearestMipMapLinearFilter:la,LinearFilter:ha,LinearMipMapNearestFilter:fa,LinearMipMapLinearFilter:pa},s={};if(void 0!==t)for(var u=0,c=t.length;u<c;u++){var l=t[u];void 0===l.image&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),void 0===e[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);var h=new i(e[l.image]);h.needsUpdate=!0,h.uuid=l.uuid,void 0!==l.name&&(h.name=l.name),void 0!==l.mapping&&(h.mapping=n(l.mapping,r)),void 0!==l.offset&&h.offset.fromArray(l.offset),void 0!==l.repeat&&h.repeat.fromArray(l.repeat),void 0!==l.wrap&&(h.wrapS=n(l.wrap[0],o),h.wrapT=n(l.wrap[1],o)),void 0!==l.minFilter&&(h.minFilter=n(l.minFilter,a)),void 0!==l.magFilter&&(h.magFilter=n(l.magFilter,a)),void 0!==l.anisotropy&&(h.anisotropy=l.anisotropy),void 0!==l.flipY&&(h.flipY=l.flipY),s[l.uuid]=h}return s},parseObject:function(){var t=new c;return function(e,n,i){function r(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}var a;switch(e.type){case"Scene":a=new he,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new V(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new le(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new ce(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new Ot(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Dt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new Un(e.color,e.intensity);break;case"DirectionalLight":a=new Bn(e.color,e.intensity);break;case"PointLight":a=new On(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new Nn(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Ln(e.color,e.groundColor,e.intensity);break;case"Mesh":var s=r(e.geometry),u=o(e.material);a=s.bones&&s.bones.length>0?new ye(s,u):new At(s,u);break;case"LOD":a=new me;break;case"Line":a=new xe(r(e.geometry),o(e.material),e.mode);break;case"LineSegments":a=new be(r(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new Me(r(e.geometry),o(e.material));break;case"Sprite":a=new de(o(e.material));break;case"Group":a=new Ee;break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh type. Instantiates Object3D instead.");default:a=new ut}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var c in e.children)a.add(this.parseObject(e.children[c],n,i));if("LOD"===e.type)for(var l=e.levels,h=0;h<l.length;h++){var f=l[h],c=a.getObjectByProperty("uuid",f.object);void 0!==c&&a.addLevel(c,f.distance)}return a}}()}),pi.prototype={constructor:pi,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){isNaN(t)&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){isNaN(t)&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(isNaN(t)&&(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)e=this.getPoint(n/t),o+=e.distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i=this.getLengths(),r=0,o=i.length;n=e?e:t*i[o-1];for(var a,s=0,u=o-1;s<=u;)if(r=Math.floor(s+(u-s)/2),a=i[r]-n,a<0)s=r+1;else{if(!(a>0)){u=r;break}u=r-1}if(r=u,i[r]===n){var c=r/(o-1);return c}var l=i[r],h=i[r+1],f=h-l,p=(n-l)/f,c=(r+p)/(o-1);return c},getTangent:function(t){var e=1e-4,n=t-e,i=t+e;n<0&&(n=0),i>1&&(i=1);var r=this.getPoint(n),o=this.getPoint(i),a=o.clone().sub(r);return a.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,i,r,o=new u,a=[],s=[],l=[],h=new u,f=new c;for(n=0;n<=t;n++)i=n/t,a[n]=this.getTangentAt(i),a[n].normalize();s[0]=new u,l[0]=new u;var p=Number.MAX_VALUE,d=Math.abs(a[0].x),m=Math.abs(a[0].y),v=Math.abs(a[0].z);for(d<=p&&(p=d,o.set(1,0,0)),m<=p&&(p=m,o.set(0,1,0)),v<=p&&o.set(0,0,1),h.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],h),l[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),h.crossVectors(a[n-1],a[n]),h.length()>Number.EPSILON&&(h.normalize(),r=Math.acos(hs.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(f.makeRotationAxis(h,r))),l[n].crossVectors(a[n],s[n]);if(e===!0)for(r=Math.acos(hs.clamp(s[0].dot(s[t]),-1,1)),r/=t,a[0].dot(h.crossVectors(s[0],s[t]))>0&&(r=-r),n=1;n<=t;n++)s[n].applyMatrix4(f.makeRotationAxis(a[n],r*n)),l[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:l}}},di.prototype=Object.create(pi.prototype),di.prototype.constructor=di,di.prototype.isLineCurve=!0,di.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},di.prototype.getPointAt=function(t){return this.getPoint(t)},di.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},mi.prototype=Object.assign(Object.create(pi.prototype),{constructor:mi,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new di(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e){var r=n[i]-e,o=this.curves[i],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}i++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){isNaN(t)&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new St,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new u(r.x,r.y,r.z||0))}return e}}),vi.prototype=Object.create(pi.prototype),vi.prototype.constructor=vi,vi.prototype.isEllipseCurve=!0,vi.prototype.getPoint=function(t){for(var e=2*Math.PI,i=this.aEndAngle-this.aStartAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=e;for(;i>e;)i-=e;i<Number.EPSILON&&(i=r?0:e),this.aClockwise!==!0||r||(i===e?i=-e:i-=e);var o=this.aStartAngle+t*i,a=this.aX+this.xRadius*Math.cos(o),s=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),l=a-this.aX,h=s-this.aY;a=l*u-h*c+this.aX,s=l*c+h*u+this.aY}return new n(a,s)},gi.prototype=Object.create(pi.prototype),gi.prototype.constructor=gi,gi.prototype.isSplineCurve=!0,gi.prototype.getPoint=function(t){var e=this.points,i=(e.length-1)*t,r=Math.floor(i),o=i-r,a=e[0===r?r:r-1],s=e[r],u=e[r>e.length-2?e.length-1:r+1],c=e[r>e.length-3?e.length-1:r+2];return new n(ii(o,a.x,s.x,u.x,c.x),ii(o,a.y,s.y,u.y,c.y))},yi.prototype=Object.create(pi.prototype),yi.prototype.constructor=yi,yi.prototype.getPoint=function(t){var e=this.v0,i=this.v1,r=this.v2,o=this.v3;return new n(fi(t,e.x,i.x,r.x,o.x),fi(t,e.y,i.y,r.y,o.y))},_i.prototype=Object.create(pi.prototype),_i.prototype.constructor=_i,_i.prototype.getPoint=function(t){var e=this.v0,i=this.v1,r=this.v2;return new n(si(t,e.x,i.x,r.x),si(t,e.y,i.y,r.y))};var Oc=Object.assign(Object.create(mi.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new di(this.currentPoint.clone(),new n(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,r){var o=new _i(this.currentPoint.clone(),new n(t,e),new n(i,r));this.curves.push(o),this.currentPoint.set(i,r)},bezierCurveTo:function(t,e,i,r,o,a){var s=new yi(this.currentPoint.clone(),new n(t,e),new n(i,r),new n(o,a));this.curves.push(s),this.currentPoint.set(o,a)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),n=new gi(e);this.curves.push(n),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,i,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,n,i,r,o)},absarc:function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},ellipse:function(t,e,n,i,r,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(t+u,e+c,n,i,r,o,a,s)},absellipse:function(t,e,n,i,r,o,a,s){var u=new vi(t,e,n,i,r,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);
c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);this.currentPoint.copy(l)}});xi.prototype=Oc,Oc.constructor=xi,bi.prototype=Object.assign(Object.create(Oc),{constructor:bi,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),wi.prototype={moveTo:function(t,e){this.currentPath=new xi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,i){this.currentPath.quadraticCurveTo(t,e,n,i)},bezierCurveTo:function(t,e,n,i,r,o){this.currentPath.bezierCurveTo(t,e,n,i,r,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],o=new bi;o.curves=r.curves,e.push(o)}return e}function i(t,e){for(var n=e.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=e[r],s=e[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],u=-u,s=e[r],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=c*(t.x-a.x)-u*(t.y-a.y);if(0===l)return!0;if(l<0)continue;i=!i}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return i}var r=Pc.isClockWise,o=this.subPaths;if(0===o.length)return[];if(e===!0)return n(o);var a,s,u,c=[];if(1===o.length)return s=o[0],u=new bi,u.curves=s.curves,c.push(u),c;var l=!r(o[0].getPoints());l=t?!l:l;var h,f=[],p=[],d=[],m=0;p[m]=void 0,d[m]=[];for(var v=0,g=o.length;v<g;v++)s=o[v],h=s.getPoints(),a=r(h),a=t?!a:a,a?(!l&&p[m]&&m++,p[m]={s:new bi,p:h},p[m].s.curves=s.curves,l&&m++,d[m]=[]):d[m].push({h:s,p:h[0]});if(!p[0])return n(o);if(p.length>1){for(var y=!1,_=[],x=0,b=p.length;x<b;x++)f[x]=[];for(var x=0,b=p.length;x<b;x++)for(var w=d[x],M=0;M<w.length;M++){for(var E=w[M],T=!0,S=0;S<p.length;S++)i(E.p,p[S].p)&&(x!==S&&_.push({froms:x,tos:S,hole:M}),T?(T=!1,f[S].push(E)):y=!0);T&&f[x].push(E)}_.length>0&&(y||(d=f))}for(var P,v=0,A=p.length;v<A;v++){u=p[v].s,c.push(u),P=d[v];for(var C=0,L=P.length;C<L;C++)u.holes.push(P[C].h)}return c}},Object.assign(Mi.prototype,{isFont:!0,generateShapes:function(t,e,n){function i(t){for(var n=String(t).split(""),i=e/o.resolution,a=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*i,s=0,u=0,c=[],l=0;l<n.length;l++){var h=n[l];if("\n"===h)s=0,u-=a;else{var f=r(h,i,s,u);s+=f.offsetX,c.push(f.path)}}return c}function r(t,e,i,r){var a=o.glyphs[t]||o.glyphs["?"];if(a){var s,u,c,l,h,f,p,d,m,v,g,y=new wi,_=[];if(a.o)for(var x=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),b=0,w=x.length;b<w;){var M=x[b++];switch(M){case"m":s=x[b++]*e+i,u=x[b++]*e+r,y.moveTo(s,u);break;case"l":s=x[b++]*e+i,u=x[b++]*e+r,y.lineTo(s,u);break;case"q":if(c=x[b++]*e+i,l=x[b++]*e+r,p=x[b++]*e+i,d=x[b++]*e+r,y.quadraticCurveTo(p,d,c,l),g=_[_.length-1]){h=g.x,f=g.y;for(var E=1;E<=n;E++){var T=E/n;si(T,h,p,c),si(T,f,d,l)}}break;case"b":if(c=x[b++]*e+i,l=x[b++]*e+r,p=x[b++]*e+i,d=x[b++]*e+r,m=x[b++]*e+i,v=x[b++]*e+r,y.bezierCurveTo(p,d,m,v,c,l),g=_[_.length-1]){h=g.x,f=g.y;for(var E=1;E<=n;E++){var T=E/n;fi(T,h,p,m,c),fi(T,f,d,v,l)}}}}return{offsetX:a.ha*e,path:y}}}void 0===e&&(e=100),void 0===n&&(n=4);for(var o=this.data,a=i(t),s=[],u=0,c=a.length;u<c;u++)Array.prototype.push.apply(s,a[u].toShapes());return s}}),Object.assign(Ei.prototype,{load:function(t,e,n,i){var r=this,o=new Mn(this.manager);o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var i=r.parse(n);e&&e(i)},n,i)},parse:function(t){return new Mi(t)}});var Dc,Bc={getContext:function(){return void 0===Dc&&(Dc=new(window.AudioContext||window.webkitAudioContext)),Dc},setContext:function(t){Dc=t}};Object.assign(Ti.prototype,{load:function(t,e,n,i){var r=new Mn(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){var n=Bc.getContext();n.decodeAudioData(t,function(t){e(t)})},n,i)}}),Si.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Si,isRectAreaLight:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this}}),Object.assign(Pi.prototype,{update:function(){var t,e,n,i,r,o,a,s=new c,u=new c;return function(c){var l=t!==this||e!==c.focus||n!==c.fov||i!==c.aspect*this.aspect||r!==c.near||o!==c.far||a!==c.zoom;if(l){t=this,e=c.focus,n=c.fov,i=c.aspect*this.aspect,r=c.near,o=c.far,a=c.zoom;var h,f,p=c.projectionMatrix.clone(),d=this.eyeSep/2,m=d*r/e,v=r*Math.tan(hs.DEG2RAD*n*.5)/a;u.elements[12]=-d,s.elements[12]=d,h=-v*i+m,f=v*i+m,p.elements[0]=2*r/(f-h),p.elements[8]=(f+h)/(f-h),this.cameraL.projectionMatrix.copy(p),h=-v*i-m,f=v*i-m,p.elements[0]=2*r/(f-h),p.elements[8]=(f+h)/(f-h),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(s)}}()}),Ai.prototype=Object.create(ut.prototype),Ai.prototype.constructor=Ai,Ci.prototype=Object.assign(Object.create(ut.prototype),{constructor:Ci,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new u,e=new s,n=new u,i=new u;return function(r){ut.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(i.x,this.context.currentTime),o.forwardY.setValueAtTime(i.y,this.context.currentTime),o.forwardZ.setValueAtTime(i.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(i.x,i.y,i.z,a.x,a.y,a.z))}}()}),Li.prototype=Object.assign(Object.create(ut.prototype),{constructor:Li,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),t.start(0,this.startTime),this.isPlaying=!0,this.source=t,this.connect()},pause:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Ii.prototype=Object.assign(Object.create(Li.prototype),{constructor:Ii,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new u;return function(e){ut.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(Ri.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Ni.prototype={constructor:Ni,accumulate:function(t,e){var n=this.buffer,i=this.valueSize,r=t*i+i,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==i;++a)n[r+a]=n[a];o=e}else{o+=e;var s=e/o;this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*e;this._mixBufferRegion(n,i,a,1-r,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,i);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,i=3*n;t.getValue(e,i);for(var r=n,o=i;r!==o;++r)e[r]=e[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,i,r){if(i>=.5)for(var o=0;o!==r;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,i,r){s.slerpFlat(t,e,t,e,t,n,i)},_lerp:function(t,e,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*i}}},Oi.prototype={constructor:Oi,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(t=Oi.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("  can not bind to objectName of node, undefined",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o]}}var s=t[i];if(void 0===s){var u=e.nodeName;return void console.error("  trying to update property for track: "+u+"."+i+" but it wasn't found.",t)}var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===r){r=a;break}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(Oi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:Oi.prototype.getValue,_setValue_unbound:Oi.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),Oi.Composite=function(t,e,n){var i=n||Oi.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)},Oi.Composite.prototype={constructor:Oi.Composite,getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Oi.create=function(t,e,n){return t&&t.isAnimationObjectGroup?new Oi.Composite(t,e,n):new Oi(t,e,n)},Oi.parseTrackName=function(t){var e=/^((?:[\w-]+[\/:])*)([\w-]+)?(?:\.([\w-]+)(?:\[(.+)\])?)?\.([\w-]+)(?:\[(.+)\])?$/,n=e.exec(t);if(!n)throw new Error("cannot parse trackName at all: "+t);var i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]};if(null===i.propertyName||0===i.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return i},Oi.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null},i=n(t.skeleton);if(i)return i}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},o=r(t.children);if(o)return o}return null},Di.prototype={constructor:Di,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,u=s.length,c=0,l=arguments.length;c!==l;++c){var h=arguments[c],f=h.uuid,p=r[f],d=void 0;if(void 0===p){p=n++,r[f]=p,e.push(h);for(var m=0,v=u;m!==v;++m)s[m].push(new Oi(h,o[m],a[m]))}else if(p<i){d=e[p];var g=--i,y=e[g];r[y.uuid]=p,e[p]=y,r[f]=g,e[g]=h;for(var m=0,v=u;m!==v;++m){var _=s[m],x=_[g],b=_[p];_[p]=x,void 0===b&&(b=new Oi(h,o[m],a[m])),_[g]=b}}else e[p]!==d&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=i},remove:function(t){for(var e=this._objects,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=i[c];if(void 0!==l&&l>=n){var h=n++,f=e[h];i[f.uuid]=l,e[l]=f,i[c]=h,e[h]=u;for(var p=0,d=o;p!==d;++p){var m=r[p],v=m[h],g=m[l];m[l]=v,m[h]=g}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,a=o.length,s=0,u=arguments.length;s!==u;++s){var c=arguments[s],l=c.uuid,h=r[l];if(void 0!==h)if(delete r[l],h<i){var f=--i,p=e[f],d=--n,m=e[d];r[p.uuid]=h,e[h]=p,r[m.uuid]=f,e[f]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y=o[v],_=y[f],x=y[d];y[h]=_,y[f]=x,y.pop()}}else{var d=--n,m=e[d];r[m.uuid]=h,e[h]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y=o[v];y[h]=y[d],y.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);i=r.length,n[t]=i,o.push(t),a.push(e),r.push(l);for(var h=c,f=s.length;h!==f;++h){var p=s[h];l[h]=new Oi(p,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a],u=t[a];e[u]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}},Bi.prototype={constructor:Bi,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var i=this._clip.duration,r=t._clip.duration,o=r/i,a=i/r;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=r,s[1]=r+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){var r=this._startTime;if(null!==r){var o=(t-r)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,h=u.length;l!==h;++l)u[l].evaluate(a),c[l].accumulate(i,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(i===ja){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=i===Va;if(r===-1&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1===(1&r))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=Za,i.endingEnd=Za):(t?i.endingStart=this.zeroSlopeAtStart?Za:$a:i.endingStart=Ja,e?i.endingEnd=this.zeroSlopeAtEnd?Za:$a:i.endingEnd=Ja)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=n,this}},Ui.prototype={constructor:Ui,clipAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?Jn.findByName(n,t):t,o=null!==r?r.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[i];if(void 0!==u)return u;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new Bi(this,r,e);return this._bindAction(c,s),this._addInactiveAction(c,o,i),c},existingAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?Jn.findByName(n,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a?a.actionByRoot[i]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(var r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){var s=e[a];s.enabled&&s._update(i,t,r,o)}for(var u=this._bindings,c=this._nActiveBindings,a=0;a!==c;++a)u[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,e[c]=l,e.pop(),this._removeInactiveBindingsForAction(u)}delete i[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot,o=r[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName,s=a[e];if(void 0!==s)for(var u in s){var c=s[u];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},Object.assign(Ui.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==r;++l){var h=i[l],f=h.name,p=c[f];if(void 0!==p)o[l]=p;else{if(p=o[l],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,f));continue}var d=e&&e._propertyBindings[l].binding.parsedPath;p=new Ni(Oi.create(n,f,d),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,s,f),o[l]=p}a[l].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(var r=t._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null;var l=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete l[h],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],o=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[r];t:{for(var c in a)break t;delete o[i]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new zn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),Object.assign(Ui.prototype,e.prototype),Fi.prototype.clone=function(){return new Fi(void 0===this.value.clone?this.value:this.value.clone())},ki.prototype=Object.create(Pt.prototype),ki.prototype.constructor=ki,ki.prototype.isInstancedBufferGeometry=!0,ki.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,materialIndex:n})},ki.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n=t.attributes;for(var i in n){var r=n[i];this.addAttribute(i,r.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var u=o[a];this.addGroup(u.start,u.count,u.materialIndex)}return this},zi.prototype={constructor:zi,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},Gi.prototype={constructor:Gi,isInterleavedBuffer:!0,
set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}},Hi.prototype=Object.create(Gi.prototype),Hi.prototype.constructor=Hi,Hi.prototype.isInstancedInterleavedBuffer=!0,Hi.prototype.copy=function(t){return Gi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},ji.prototype=Object.create(pt.prototype),ji.prototype.constructor=ji,ji.prototype.isInstancedBufferAttribute=!0,ji.prototype.copy=function(t){return pt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Xi.prototype={constructor:Xi,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return Yi(t,this,n,e),n.sort(Vi),n},intersectObjects:function(t,e){var n=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,r=t.length;i<r;i++)Yi(t[i],this,n,e);return n.sort(Vi),n}},Wi.prototype={constructor:Wi,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},qi.prototype={constructor:qi,set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(hs.clamp(t.y/this.radius,-1,1))),this}},$i.prototype={constructor:$i,set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}},Zi.prototype=Object.create(At.prototype),Zi.prototype.constructor=Zi,Zi.prototype.createAnimation=function(t,e,n,i){var r={start:e,end:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},Zi.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/i,i={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o],u=s.name.match(n);if(u&&u.length>1){var c=u[1];i[c]||(i[c]={start:1/0,end:-(1/0)});var l=i[c];o<l.start&&(l.start=o),o>l.end&&(l.end=o),e||(e=c)}}for(var c in i){var l=i[c];this.createAnimation(c,l.start,l.end,t)}this.firstAnimation=e},Zi.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},Zi.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},Zi.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},Zi.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},Zi.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},Zi.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},Zi.prototype.getAnimationTime=function(t){var e=0,n=this.animationsMap[t];return n&&(e=n.time),e},Zi.prototype.getAnimationDuration=function(t){var e=-1,n=this.animationsMap[t];return n&&(e=n.duration),e},Zi.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Zi.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},Zi.prototype.update=function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var i=this.animationsList[e];if(i.active){var r=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var o=i.start+hs.clamp(Math.floor(i.time/r),0,i.length-1),a=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o);var s=i.time%r/r;i.directionBackwards&&(s=1-s),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=s*a,this.morphTargetInfluences[i.lastFrame]=(1-s)*a):this.morphTargetInfluences[i.currentFrame]=a}}},Ji.prototype=Object.create(ut.prototype),Ji.prototype.constructor=Ji,Ji.prototype.isImmediateRenderObject=!0,Ki.prototype=Object.create(be.prototype),Ki.prototype.constructor=Ki,Ki.prototype.update=function(){var t=new u,e=new u,n=new et;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,u=a.faces,c=0,l=0,h=u.length;l<h;l++)for(var f=u[l],p=0,d=f.vertexNormals.length;p<d;p++){var m=s[f[i[p]]],v=f.vertexNormals[p];t.copy(m).applyMatrix4(r),e.copy(v).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1}else if(a&&a.isBufferGeometry)for(var g=a.attributes.position,y=a.attributes.normal,c=0,p=0,d=g.count;p<d;p++)t.set(g.getX(p),g.getY(p),g.getZ(p)).applyMatrix4(r),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1;return o.needsUpdate=!0,this}}(),Qi.prototype=Object.create(ut.prototype),Qi.prototype.constructor=Qi,Qi.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Qi.prototype.update=function(){var t=new u,e=new u;return function(){var n=this.light.distance?this.light.distance:1e3,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),tr.prototype=Object.create(be.prototype),tr.prototype.constructor=tr,tr.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},tr.prototype.update=function(){var t=new u,e=new c,n=new c;return function(){var i=this.geometry,r=i.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var o=0,a=0;o<this.bones.length;o++){var s=this.bones[o];s.parent&&s.parent.isBone&&(e.multiplyMatrices(n,s.matrixWorld),t.setFromMatrixPosition(e),r.setXYZ(a,t.x,t.y,t.z),e.multiplyMatrices(n,s.parent.matrixWorld),t.setFromMatrixPosition(e),r.setXYZ(a+1,t.x,t.y,t.z),a+=2)}i.getAttribute("position").needsUpdate=!0}}(),er.prototype=Object.create(At.prototype),er.prototype.constructor=er,er.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},er.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},nr.prototype=Object.create(ut.prototype),nr.prototype.constructor=nr,nr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose(),this.children[1].geometry.dispose(),this.children[1].material.dispose()},nr.prototype.update=function(){var t=new u,e=new u;return function(){var n=this.children[0],i=this.children[1];if(this.light.target){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld);var r=e.clone().sub(t);n.lookAt(r),i.lookAt(r)}n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),i.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var o=.5*this.light.width,a=.5*this.light.height,s=n.geometry.getAttribute("position"),u=s.array;u[0]=o,u[1]=-a,u[2]=0,u[3]=o,u[4]=a,u[5]=0,u[6]=-o,u[7]=a,u[8]=0,u[9]=-o,u[10]=a,u[11]=0,u[12]=-o,u[13]=-a,u[14]=0,u[15]=o,u[16]=-a,u[17]=0,s.needsUpdate=!0}}(),ir.prototype=Object.create(ut.prototype),ir.prototype.constructor=ir,ir.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ir.prototype.update=function(){var t=new u,e=new V,n=new V;return function(){var i=this.children[0],r=i.geometry.getAttribute("color");e.copy(this.light.color).multiplyScalar(this.light.intensity),n.copy(this.light.groundColor).multiplyScalar(this.light.intensity);for(var o=0,a=r.count;o<a;o++){var s=o<a/2?e:n;r.setXYZ(o,s.r,s.g,s.b)}i.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),r.needsUpdate=!0}}(),rr.prototype=Object.create(be.prototype),rr.prototype.constructor=rr,or.prototype=Object.create(be.prototype),or.prototype.constructor=or,ar.prototype=Object.create(be.prototype),ar.prototype.constructor=ar,ar.prototype.update=function(){var t=new u,e=new u,n=new et;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,u=0,c=0,l=s.length;c<l;c++){var h=s[c],f=h.normal;t.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(i),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),r.setXYZ(u,t.x,t.y,t.z),u+=1,r.setXYZ(u,e.x,e.y,e.z),u+=1}return r.needsUpdate=!0,this}}(),sr.prototype=Object.create(ut.prototype),sr.prototype.constructor=sr,sr.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},sr.prototype.update=function(){var t=new u,e=new u,n=new u;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t);var i=this.children[0],r=this.children[1];i.lookAt(n),i.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(n),r.scale.z=n.length()}}(),ur.prototype=Object.create(be.prototype),ur.prototype.constructor=ur,ur.prototype.update=function(){function t(t,o,a,s){i.set(o,a,s).unproject(r);var u=n[t];if(void 0!==u)for(var c=e.getAttribute("position"),l=0,h=u.length;l<h;l++)c.setXYZ(u[l],i.x,i.y,i.z)}var e,n,i=new u,r=new Nt;return function(){e=this.geometry,n=this.pointMap;var i=1,o=1;r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-i,-o,-1),t("n2",i,-o,-1),t("n3",-i,o,-1),t("n4",i,o,-1),t("f1",-i,-o,1),t("f2",i,-o,1),t("f3",-i,o,1),t("f4",i,o,1),t("u1",.7*i,1.1*o,-1),t("u2",.7*-i,1.1*o,-1),t("u3",0,2*o,-1),t("cf1",-i,0,1),t("cf2",i,0,1),t("cf3",0,-o,1),t("cf4",0,o,1),t("cn1",-i,0,-1),t("cn2",i,0,-1),t("cn3",0,-o,-1),t("cn4",0,o,-1),e.getAttribute("position").needsUpdate=!0}}(),cr.prototype=Object.create(be.prototype),cr.prototype.constructor=cr,cr.prototype.update=function(){var t=new Q;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var n=t.min,i=t.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var Uc,Fc;lr.prototype=Object.create(ut.prototype),lr.prototype.constructor=lr,lr.prototype.setDirection=function(){var t,e=new u;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),lr.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},lr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},hr.prototype=Object.create(be.prototype),hr.prototype.constructor=hr;var kc=new u,zc=new fr,Gc=new fr,Hc=new fr;pr.prototype=Object.create(pi.prototype),pr.prototype.constructor=pr,pr.prototype.getPoint=function(t){var e=this.points,n=e.length;n<2&&console.log("duh, you need at least 2 points");var i=(n-(this.closed?0:1))*t,r=Math.floor(i),o=i-r;this.closed?r+=r>0?0:(Math.floor(Math.abs(r)/e.length)+1)*e.length:0===o&&r===n-1&&(r=n-2,o=1);var a,s,c,l;if(this.closed||r>0?a=e[(r-1)%n]:(kc.subVectors(e[0],e[1]).add(e[0]),a=kc),s=e[r%n],c=e[(r+1)%n],this.closed||r+2<n?l=e[(r+2)%n]:(kc.subVectors(e[n-1],e[n-2]).add(e[n-1]),l=kc),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var h="chordal"===this.type?.5:.25,f=Math.pow(a.distanceToSquared(s),h),p=Math.pow(s.distanceToSquared(c),h),d=Math.pow(c.distanceToSquared(l),h);p<1e-4&&(p=1),f<1e-4&&(f=p),d<1e-4&&(d=p),zc.initNonuniformCatmullRom(a.x,s.x,c.x,l.x,f,p,d),Gc.initNonuniformCatmullRom(a.y,s.y,c.y,l.y,f,p,d),Hc.initNonuniformCatmullRom(a.z,s.z,c.z,l.z,f,p,d)}else if("catmullrom"===this.type){var m=void 0!==this.tension?this.tension:.5;zc.initCatmullRom(a.x,s.x,c.x,l.x,m),Gc.initCatmullRom(a.y,s.y,c.y,l.y,m),Hc.initCatmullRom(a.z,s.z,c.z,l.z,m)}return new u(zc.calc(o),Gc.calc(o),Hc.calc(o))},dr.prototype=Object.create(pi.prototype),dr.prototype.constructor=dr,dr.prototype.getPoint=function(t){var e=this.v0,n=this.v1,i=this.v2,r=this.v3;return new u(fi(t,e.x,n.x,i.x,r.x),fi(t,e.y,n.y,i.y,r.y),fi(t,e.z,n.z,i.z,r.z))},mr.prototype=Object.create(pi.prototype),mr.prototype.constructor=mr,mr.prototype.getPoint=function(t){var e=this.v0,n=this.v1,i=this.v2;return new u(si(t,e.x,n.x,i.x),si(t,e.y,n.y,i.y),si(t,e.z,n.z,i.z))},vr.prototype=Object.create(pi.prototype),vr.prototype.constructor=vr,vr.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=new u;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e},gr.prototype=Object.create(vi.prototype),gr.prototype.constructor=gr;var jc={createMultiMaterialObject:function(t,e){for(var n=new Ee,i=0,r=e.length;i<r;i++)n.add(new At(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new c;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},Xc=0,Vc=1;pi.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(pi.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Ur.prototype=Object.create(pr.prototype),Fr.prototype=Object.create(pr.prototype),kr.prototype=Object.create(pr.prototype),Object.assign(kr.prototype,{initFromArray:function(t){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(t){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(t){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),rr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Object.assign(W.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Q.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),ct.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},hs.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(et.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(t,e,n){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(c.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new u),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(t,e,n){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,o)}}),nt.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},s.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ot.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(bi.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new qe(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new nn(this,t)}}),Object.assign(n.prototype,{fromAttribute:function(t,e,n){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),Object.assign(u.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),Object.assign(r.prototype,{fromAttribute:function(t,e,n){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),St.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(ut.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(ut.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(me.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Ot.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Cn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(pt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Pt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Fi.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Z.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new V}}}),Object.defineProperties(gn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(J.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ue.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.");
}}),Object.defineProperties(ue.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(rt.prototype,{cullFace:{get:function(){return this.renderReverseSided?Jr:Zr},set:function(t){var e=t!==Zr;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(o.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Li.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this,n=new Ti;return n.load(t,function(t){e.setBuffer(t)}),this},Ri.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var Yc={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},Wc={crossOrigin:void 0,loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new An;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Pn;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};t.WebGLRenderTargetCube=a,t.WebGLRenderTarget=o,t.WebGLRenderer=ue,t.ShaderLib=wc,t.UniformsLib=bc,t.UniformsUtils=ys,t.ShaderChunk=_c,t.FogExp2=ce,t.Fog=le,t.Scene=he,t.LensFlare=fe,t.Sprite=de,t.LOD=me,t.SkinnedMesh=ye,t.Skeleton=ve,t.Bone=ge,t.Mesh=At,t.LineSegments=be,t.Line=xe,t.Points=Me,t.Group=Ee,t.VideoTexture=Te,t.DataTexture=Y,t.CompressedTexture=Se,t.CubeTexture=l,t.CanvasTexture=Pe,t.DepthTexture=Ae,t.Texture=i,t.CompressedTextureLoader=En,t.DataTextureLoader=Tn,t.CubeTextureLoader=Pn,t.TextureLoader=An,t.ObjectLoader=ni,t.MaterialLoader=Kn,t.BufferGeometryLoader=Qn,t.DefaultLoadingManager=Ic,t.LoadingManager=wn,t.JSONLoader=ei,t.ImageLoader=Sn,t.FontLoader=Ei,t.FileLoader=Mn,t.Loader=ti,t.Cache=Lc,t.AudioLoader=Ti,t.SpotLightShadow=Rn,t.SpotLight=Nn,t.PointLight=On,t.RectAreaLight=Si,t.HemisphereLight=Ln,t.DirectionalLightShadow=Dn,t.DirectionalLight=Bn,t.AmbientLight=Un,t.LightShadow=In,t.Light=Cn,t.StereoCamera=Pi,t.PerspectiveCamera=Ot,t.OrthographicCamera=Dt,t.CubeCamera=Ai,t.Camera=Nt,t.AudioListener=Ci,t.PositionalAudio=Ii,t.AudioContext=Bc,t.AudioAnalyser=Ri,t.Audio=Li,t.VectorKeyframeTrack=jn,t.StringKeyframeTrack=Wn,t.QuaternionKeyframeTrack=Vn,t.NumberKeyframeTrack=Yn,t.ColorKeyframeTrack=$n,t.BooleanKeyframeTrack=qn,t.PropertyMixer=Ni,t.PropertyBinding=Oi,t.KeyframeTrack=Zn,t.AnimationUtils=Rc,t.AnimationObjectGroup=Di,t.AnimationMixer=Ui,t.AnimationClip=Jn,t.Uniform=Fi,t.InstancedBufferGeometry=ki,t.BufferGeometry=Pt,t.GeometryIdCount=Tt,t.Geometry=St,t.InterleavedBufferAttribute=zi,t.InstancedInterleavedBuffer=Hi,t.InterleavedBuffer=Gi,t.InstancedBufferAttribute=ji,t.Face3=ht,t.Object3D=ut,t.Raycaster=Xi,t.Layers=st,t.EventDispatcher=e,t.Clock=Wi,t.QuaternionLinearInterpolant=Xn,t.LinearInterpolant=zn,t.DiscreteInterpolant=Gn,t.CubicInterpolant=kn,t.Interpolant=Fn,t.Triangle=lt,t.Math=hs,t.Spherical=qi,t.Cylindrical=$i,t.Plane=nt,t.Frustum=it,t.Sphere=tt,t.Ray=ot,t.Matrix4=c,t.Matrix3=et,t.Box3=Q,t.Box2=W,t.Line3=ct,t.Euler=at,t.Vector4=r,t.Vector3=u,t.Vector2=n,t.Quaternion=s,t.Color=V,t.MorphBlendMesh=Zi,t.ImmediateRenderObject=Ji,t.VertexNormalsHelper=Ki,t.SpotLightHelper=Qi,t.SkeletonHelper=tr,t.PointLightHelper=er,t.RectAreaLightHelper=nr,t.HemisphereLightHelper=ir,t.GridHelper=rr,t.PolarGridHelper=or,t.FaceNormalsHelper=ar,t.DirectionalLightHelper=sr,t.CameraHelper=ur,t.BoxHelper=cr,t.ArrowHelper=lr,t.AxisHelper=hr,t.CatmullRomCurve3=pr,t.CubicBezierCurve3=dr,t.QuadraticBezierCurve3=mr,t.LineCurve3=vr,t.ArcCurve=gr,t.EllipseCurve=vi,t.SplineCurve=gi,t.CubicBezierCurve=yi,t.QuadraticBezierCurve=_i,t.LineCurve=di,t.Shape=bi,t.Path=xi,t.ShapePath=wi,t.Font=Mi,t.CurvePath=mi,t.Curve=pi,t.ShapeUtils=Pc,t.SceneUtils=jc,t.WireframeGeometry=Ce,t.ParametricGeometry=Le,t.ParametricBufferGeometry=Ie,t.TetrahedronGeometry=Oe,t.TetrahedronBufferGeometry=De,t.OctahedronGeometry=Be,t.OctahedronBufferGeometry=Ue,t.IcosahedronGeometry=Fe,t.IcosahedronBufferGeometry=ke,t.DodecahedronGeometry=ze,t.DodecahedronBufferGeometry=Ge,t.PolyhedronGeometry=Re,t.PolyhedronBufferGeometry=Ne,t.TubeGeometry=He,t.TubeBufferGeometry=je,t.TorusKnotGeometry=Xe,t.TorusKnotBufferGeometry=Ve,t.TorusGeometry=Ye,t.TorusBufferGeometry=We,t.TextGeometry=$e,t.SphereGeometry=Ze,t.SphereBufferGeometry=Je,t.RingGeometry=Ke,t.RingBufferGeometry=Qe,t.PlaneGeometry=It,t.PlaneBufferGeometry=Rt,t.LatheGeometry=tn,t.LatheBufferGeometry=en,t.ShapeGeometry=nn,t.ShapeBufferGeometry=rn,t.ExtrudeGeometry=qe,t.EdgesGeometry=on,t.ConeGeometry=un,t.ConeBufferGeometry=cn,t.CylinderGeometry=an,t.CylinderBufferGeometry=sn,t.CircleGeometry=ln,t.CircleBufferGeometry=hn,t.BoxGeometry=Ct,t.BoxBufferGeometry=Lt,t.ShadowMaterial=fn,t.SpriteMaterial=pe,t.RawShaderMaterial=pn,t.ShaderMaterial=J,t.PointsMaterial=we,t.MultiMaterial=dn,t.MeshPhysicalMaterial=vn,t.MeshStandardMaterial=mn,t.MeshPhongMaterial=gn,t.MeshToonMaterial=yn;t.MeshNormalMaterial=_n;t.MeshLambertMaterial=xn,t.MeshDepthMaterial=K,t.MeshBasicMaterial=ft,t.LineDashedMaterial=bn,t.LineBasicMaterial=_e,t.Material=Z,t.Float64BufferAttribute=wt,t.Float32BufferAttribute=bt,t.Uint32BufferAttribute=xt,t.Int32BufferAttribute=_t,t.Uint16BufferAttribute=yt,t.Int16BufferAttribute=gt,t.Uint8ClampedBufferAttribute=vt,t.Uint8BufferAttribute=mt,t.Int8BufferAttribute=dt,t.BufferAttribute=pt,t.REVISION=Wr,t.MOUSE=qr,t.CullFaceNone=$r,t.CullFaceBack=Zr,t.CullFaceFront=Jr,t.CullFaceFrontBack=Kr,t.FrontFaceDirectionCW=Qr,t.FrontFaceDirectionCCW=to,t.BasicShadowMap=eo,t.PCFShadowMap=no,t.PCFSoftShadowMap=io,t.FrontSide=ro,t.BackSide=oo,t.DoubleSide=ao,t.FlatShading=so,t.SmoothShading=uo,t.NoColors=co,t.FaceColors=lo,t.VertexColors=ho,t.NoBlending=fo,t.NormalBlending=po,t.AdditiveBlending=mo,t.SubtractiveBlending=vo,t.MultiplyBlending=go,t.CustomBlending=yo,t.AddEquation=_o,t.SubtractEquation=xo,t.ReverseSubtractEquation=bo,t.MinEquation=wo,t.MaxEquation=Mo,t.ZeroFactor=Eo,t.OneFactor=To,t.SrcColorFactor=So,t.OneMinusSrcColorFactor=Po,t.SrcAlphaFactor=Ao,t.OneMinusSrcAlphaFactor=Co,t.DstAlphaFactor=Lo,t.OneMinusDstAlphaFactor=Io,t.DstColorFactor=Ro,t.OneMinusDstColorFactor=No,t.SrcAlphaSaturateFactor=Oo,t.NeverDepth=Do,t.AlwaysDepth=Bo,t.LessDepth=Uo,t.LessEqualDepth=Fo,t.EqualDepth=ko,t.GreaterEqualDepth=zo,t.GreaterDepth=Go,t.NotEqualDepth=Ho,t.MultiplyOperation=jo,t.MixOperation=Xo,t.AddOperation=Vo,t.NoToneMapping=Yo,t.LinearToneMapping=Wo,t.ReinhardToneMapping=qo,t.Uncharted2ToneMapping=$o,t.CineonToneMapping=Zo,t.UVMapping=Jo,t.CubeReflectionMapping=Ko,t.CubeRefractionMapping=Qo,t.EquirectangularReflectionMapping=ta,t.EquirectangularRefractionMapping=ea,t.SphericalReflectionMapping=na,t.CubeUVReflectionMapping=ia,t.CubeUVRefractionMapping=ra,t.RepeatWrapping=oa,t.ClampToEdgeWrapping=aa,t.MirroredRepeatWrapping=sa,t.NearestFilter=ua,t.NearestMipMapNearestFilter=ca,t.NearestMipMapLinearFilter=la,t.LinearFilter=ha,t.LinearMipMapNearestFilter=fa,t.LinearMipMapLinearFilter=pa,t.UnsignedByteType=da,t.ByteType=ma,t.ShortType=va,t.UnsignedShortType=ga,t.IntType=ya,t.UnsignedIntType=_a,t.FloatType=xa,t.HalfFloatType=ba,t.UnsignedShort4444Type=wa,t.UnsignedShort5551Type=Ma,t.UnsignedShort565Type=Ea,t.UnsignedInt248Type=Ta,t.AlphaFormat=Sa,t.RGBFormat=Pa,t.RGBAFormat=Aa,t.LuminanceFormat=Ca,t.LuminanceAlphaFormat=La,t.RGBEFormat=Ia,t.DepthFormat=Ra,t.DepthStencilFormat=Na,t.RGB_S3TC_DXT1_Format=Oa,t.RGBA_S3TC_DXT1_Format=Da,t.RGBA_S3TC_DXT3_Format=Ba,t.RGBA_S3TC_DXT5_Format=Ua,t.RGB_PVRTC_4BPPV1_Format=Fa,t.RGB_PVRTC_2BPPV1_Format=ka,t.RGBA_PVRTC_4BPPV1_Format=za,t.RGBA_PVRTC_2BPPV1_Format=Ga,t.RGB_ETC1_Format=Ha,t.LoopOnce=ja,t.LoopRepeat=Xa,t.LoopPingPong=Va,t.InterpolateDiscrete=Ya,t.InterpolateLinear=Wa,t.InterpolateSmooth=qa,t.ZeroCurvatureEnding=$a,t.ZeroSlopeEnding=Za,t.WrapAroundEnding=Ja,t.TrianglesDrawMode=Ka,t.TriangleStripDrawMode=Qa,t.TriangleFanDrawMode=ts,t.LinearEncoding=es,t.sRGBEncoding=ns,t.GammaEncoding=is,t.RGBEEncoding=rs,t.LogLuvEncoding=os,t.RGBM7Encoding=as,t.RGBM16Encoding=ss,t.RGBDEncoding=us,t.BasicDepthPacking=cs,t.RGBADepthPacking=ls,t.CubeGeometry=Ct,t.Face4=yr,t.LineStrip=Xc,t.LinePieces=Vc,t.MeshFaceMaterial=_r,t.PointCloud=xr,t.Particle=br,t.ParticleSystem=wr,t.PointCloudMaterial=Mr,t.ParticleBasicMaterial=Er,t.ParticleSystemMaterial=Tr,t.Vertex=Sr,t.DynamicBufferAttribute=Pr,t.Int8Attribute=Ar,t.Uint8Attribute=Cr,t.Uint8ClampedAttribute=Lr,t.Int16Attribute=Ir,t.Uint16Attribute=Rr,t.Int32Attribute=Nr,t.Uint32Attribute=Or,t.Float32Attribute=Dr,t.Float64Attribute=Br,t.ClosedSplineCurve3=Ur,t.SplineCurve3=Fr,t.Spline=kr,t.BoundingBoxHelper=zr,t.EdgesHelper=Gr,t.WireframeHelper=Hr,t.XHRLoader=jr,t.BinaryTextureLoader=Xr,t.GeometryUtils=Yc,t.ImageUtils=Wc,t.Projector=Vr,t.CanvasRenderer=Yr,Object.defineProperty(t,"__esModule",{value:!0})})},,,function(t,e,n){t.exports={default:n(101),__esModule:!0}},function(t,e,n){t.exports={default:n(102),__esModule:!0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(99),o=i(r),a=n(98),s=i(a),u="function"==typeof s.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":typeof t};e.default="function"==typeof s.default&&"symbol"===u(o.default)?function(t){return"undefined"==typeof t?"undefined":u(t)}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":"undefined"==typeof t?"undefined":u(t)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(20),r=n(7).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){t.exports=!n(6)&&!n(13)(function(){return 7!=Object.defineProperty(n(49)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(48);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){"use strict";var i=n(31),r=n(8),o=n(56),a=n(14),s=n(9),u=n(30),c=n(115),l=n(34),h=n(122),f=n(16)("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",m="keys",v="values",g=function(){return this};t.exports=function(t,e,n,y,_,x,b){c(n,e,y);var w,M,E,T=function(t){if(!p&&t in C)return C[t];switch(t){case m:return function(){return new n(this,t)};case v:return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",P=_==v,A=!1,C=t.prototype,L=C[f]||C[d]||_&&C[_],I=L||T(_),R=_?P?T("entries"):I:void 0,N="Array"==e?C.entries||L:L;if(N&&(E=h(N.call(new t)),E!==Object.prototype&&(l(E,S,!0),i||s(E,f)||a(E,f,g))),P&&L&&L.name!==v&&(A=!0,I=function(){return L.call(this)}),i&&!b||!p&&!A&&C[f]||a(C,f,I),u[e]=I,u[S]=g,_)if(w={values:P?I:T(v),keys:x?I:T(m),entries:R},b)for(M in w)M in C||o(C,M,w[M]);else r(r.P+r.F*(p||A),e,w);return w}},function(t,e,n){var i=n(10),r=n(19),o=n(15);t.exports=n(6)?Object.defineProperties:function(t,e){r(t);for(var n,a=o(e),s=a.length,u=0;s>u;)i.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var i=n(55),r=n(29).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(9),r=n(11),o=n(110)(!1),a=n(35)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),u=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;e.length>u;)i(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){t.exports=n(14)},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t){return function(e,n){return Mc(t(e),n)}}function n(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=kc?r*=10:o>=zc?r*=5:o>=Gc&&(r*=2),e<t?-r:r}function i(t){return t.length}function r(){}function o(t,e){var n=new r;if(t instanceof r)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,o=-1,a=t.length;if(null==e)for(;++o<a;)n.set(o,t[o]);else for(;++o<a;)n.set(e(i=t[o],o,t),i)}else if(t)for(var s in t)n.set(s,t[s]);return n}function a(){return{}}function s(t,e,n){t[e]=n}function u(){return o()}function c(t,e,n){t.set(e,n)}function l(){}function h(t,e){var n=new l;if(t instanceof l)t.each(function(t){n.add(t)});else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}function f(t){return+t}function p(t){return t*t}function d(t){return t*(2-t)}function m(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function v(t){return t*t*t}function g(t){return--t*t*t+1}function y(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function _(t){return 1-Math.cos(t*Ml)}function x(t){return Math.sin(t*Ml)}function b(t){return(1-Math.cos(wl*t))/2}function w(t){return Math.pow(2,10*t-10)}function M(t){return 1-Math.pow(2,-10*t)}function E(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function T(t){return 1-Math.sqrt(1-t*t)}function S(t){return Math.sqrt(1- --t*t)}function P(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function A(t){return 1-C(1-t)}function C(t){return(t=+t)<El?Nl*t*t:t<Sl?Nl*(t-=Tl)*t+Pl:t<Cl?Nl*(t-=Al)*t+Ll:Nl*(t-=Il)*t+Rl}function L(t){return((t*=2)<=1?1-C(1-t):C(t-1)+1)/2}function I(t,e){return t[0]-e[0]||t[1]-e[1]}function R(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;++r){for(;i>1&&Yl(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function N(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function O(){return new N}function D(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o,a,s,u,c,l,h,f,p=t._root,d={data:i},m=t._x0,v=t._y0,g=t._x1,y=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((c=e>=(o=(m+g)/2))?m=o:g=o,(l=n>=(a=(v+y)/2))?v=a:y=a,r=p,!(p=p[h=l<<1|c]))return r[h]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===s&&n===u)return d.next=p,r?r[h]=d:t._root=d,t;do r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+g)/2))?m=o:g=o,(l=n>=(a=(v+y)/2))?v=a:y=a;while((h=l<<1|c)===(f=(u>=a)<<1|s>=o));return r[f]=p,r[h]=d,t}function B(t){var e,n,i,r,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-(1/0),h=-(1/0);for(n=0;n<o;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(a[n]=i,s[n]=r,i<u&&(u=i),i>l&&(l=i),r<c&&(c=r),r>h&&(h=r));for(l<u&&(u=this._x0,l=this._x1),h<c&&(c=this._y0,h=this._y1),this.cover(u,c).cover(l,h),n=0;n<o;++n)D(this,a[n],s[n],t[n]);return this}function U(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function F(t){return t[0]}function k(t){return t[1]}function z(t,e,n){var i=new G(null==e?F:e,null==n?k:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function G(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function H(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}function j(t){if(!(t>=1))throw new Error;this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function X(t){if(!t._start)try{V(t)}catch(e){if(t._tasks[t._ended+t._active-1])W(t,e);else if(!t._data)throw e}}function V(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,n=t._tasks[e],i=n.length-1,r=n[i];n[i]=Y(t,e),--t._waiting,++t._active,n=r.apply(null,n),t._tasks[e]&&(t._tasks[e]=n||mh)}}function Y(t,e){return function(n,i){t._tasks[e]&&(--t._active,++t._ended,t._tasks[e]=null,null==t._error&&(null!=n?W(t,n):(t._data[e]=i,t._waiting?X(t):q(t))))}}function W(t,e){var n,i=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;--i>=0;)if((n=t._tasks[i])&&(t._tasks[i]=null,n.abort))try{n.abort()}catch(t){}t._active=NaN,q(t)}function q(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function $(t){return new j(arguments.length?+t:1/0)}function Z(t){return t.innerRadius}function J(t){return t.outerRadius}function K(t){return t.startAngle}function Q(t){return t.endAngle}function tt(t){return t&&t.padAngle}function et(t){return t>=1?_h:t<=-1?-_h:Math.asin(t)}function nt(t,e,n,i,r,o,a,s){var u=n-t,c=i-e,l=a-r,h=s-o,f=(l*(e-o)-h*(t-r))/(h*u-l*c);return[t+f*u,e+f*c]}function it(t,e,n,i,r,o,a){var s=t-n,u=e-i,c=(a?o:-o)/Math.sqrt(s*s+u*u),l=c*u,h=-c*s,f=t+l,p=e+h,d=n+l,m=i+h,v=(f+d)/2,g=(p+m)/2,y=d-f,_=m-p,x=y*y+_*_,b=r-o,w=f*m-d*p,M=(_<0?-1:1)*Math.sqrt(Math.max(0,b*b*x-w*w)),E=(w*_-y*M)/x,T=(-w*y-_*M)/x,S=(w*_+y*M)/x,P=(-w*y+_*M)/x,A=E-v,C=T-g,L=S-v,I=P-g;return A*A+C*C>L*L+I*I&&(E=S,T=P),{cx:E,cy:T,x01:-l,y01:-h,x11:E*(r/b-1),y11:T*(r/b-1)}}function rt(t){this._context=t}function ot(t){return t[0]}function at(t){return t[1]}function st(t){this._curve=t}function ut(t){function e(e){return new st(t(e))}return e._curve=t,e}function ct(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(ut(t)):e()._curve},t}function lt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function ht(t){this._context=t}function ft(t){this._context=t}function pt(t){this._context=t}function dt(t,e){this._basis=new ht(t),this._beta=e}function mt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function vt(t,e){this._context=t,this._k=(1-e)/6}function gt(t,e){this._context=t,this._k=(1-e)/6}function yt(t,e){this._context=t,this._k=(1-e)/6}function _t(t,e,n){var i=t._x1,r=t._y1,o=t._x2,a=t._y2;if(t._l01_a>gh){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>gh){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(i,r,o,a,t._x2,t._y2)}function xt(t,e){this._context=t,this._alpha=e}function bt(t,e){this._context=t,this._alpha=e}function wt(t,e){this._context=t,this._alpha=e}function Mt(t){this._context=t}function Et(t){return t<0?-1:1}function Tt(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),a=(n-t._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(Et(o)+Et(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function St(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Pt(t,e,n){var i=t._x0,r=t._y0,o=t._x1,a=t._y1,s=(o-i)/3;t._context.bezierCurveTo(i+s,r+s*e,o-s,a-s*n,o,a)}function At(t){this._context=t}function Ct(t){this._context=new Lt(t)}function Lt(t){this._context=t}function It(t){return new At(t)}function Rt(t){return new Ct(t)}function Nt(t){this._context=t}function Ot(t){var e,n,i=t.length-1,r=new Array(i),o=new Array(i),a=new Array(i);for(r[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,o[i-1]=7,a[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(r[i-1]=a[i-1]/o[i-1],e=i-2;e>=0;--e)r[e]=(a[e]-r[e+1])/o[e];for(o[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)o[e]=2*t[e+1]-r[e+1];return[r,o]}function Dt(t,e){this._context=t,this._t=e}function Bt(t){return new Dt(t,0)}function Ut(t){return new Dt(t,1)}function Ft(t,e){return t[e]}function kt(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}function zt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Gt(){}function Ht(t){var e;return t=(t+"").trim().toLowerCase(),(e=Cf.exec(t))?(e=parseInt(e[1],16),new Wt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=Lf.exec(t))?jt(parseInt(e[1],16)):(e=If.exec(t))?new Wt(e[1],e[2],e[3],1):(e=Rf.exec(t))?new Wt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Nf.exec(t))?Xt(e[1],e[2],e[3],e[4]):(e=Of.exec(t))?Xt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Df.exec(t))?qt(e[1],e[2]/100,e[3]/100,1):(e=Bf.exec(t))?qt(e[1],e[2]/100,e[3]/100,e[4]):Uf.hasOwnProperty(t)?jt(Uf[t]):"transparent"===t?new Wt(NaN,NaN,NaN,0):null}function jt(t){return new Wt(t>>16&255,t>>8&255,255&t,1)}function Xt(t,e,n,i){return i<=0&&(t=e=n=NaN),new Wt(t,e,n,i)}function Vt(t){return t instanceof Gt||(t=Ht(t)),t?(t=t.rgb(),new Wt(t.r,t.g,t.b,t.opacity)):new Wt}function Yt(t,e,n,i){return 1===arguments.length?Vt(t):new Wt(t,e,n,null==i?1:i)}function Wt(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function qt(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Jt(t,e,n,i)}function $t(t){if(t instanceof Jt)return new Jt(t.h,t.s,t.l,t.opacity);if(t instanceof Gt||(t=Ht(t)),!t)return new Jt;if(t instanceof Jt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Jt(a,s,u,t.opacity)}function Zt(t,e,n,i){return 1===arguments.length?$t(t):new Jt(t,e,n,null==i?1:i)}function Jt(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Kt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Qt(t){if(t instanceof ee)return new ee(t.l,t.a,t.b,t.opacity);if(t instanceof ue){var e=t.h*Ff;return new ee(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Wt||(t=Vt(t));var n=oe(t.r),i=oe(t.g),r=oe(t.b),o=ne((.4124564*n+.3575761*i+.1804375*r)/Gf),a=ne((.2126729*n+.7151522*i+.072175*r)/Hf),s=ne((.0193339*n+.119192*i+.9503041*r)/jf);return new ee(116*a-16,500*(o-a),200*(a-s),t.opacity)}function te(t,e,n,i){return 1===arguments.length?Qt(t):new ee(t,e,n,null==i?1:i)}function ee(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function ne(t){return t>Wf?Math.pow(t,1/3):t/Yf+Xf}function ie(t){return t>Vf?t*t*t:Yf*(t-Xf)}function re(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function oe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ae(t){if(t instanceof ue)return new ue(t.h,t.c,t.l,t.opacity);t instanceof ee||(t=Qt(t));var e=Math.atan2(t.b,t.a)*kf;return new ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function se(t,e,n,i){return 1===arguments.length?ae(t):new ue(t,e,n,null==i?1:i)}function ue(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function ce(t){if(t instanceof he)return new he(t.h,t.s,t.l,t.opacity);t instanceof Wt||(t=Vt(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(ep*i+Qf*e-tp*n)/(ep+Qf-tp),o=i-r,a=(Kf*(n-r)-Zf*o)/Jf,s=Math.sqrt(a*a+o*o)/(Kf*r*(1-r)),u=s?Math.atan2(a,o)*kf-120:NaN;return new he(u<0?u+360:u,s,r,t.opacity)}function le(t,e,n,i){return 1===arguments.length?ce(t):new he(t,e,n,null==i?1:i)}function he(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function fe(t,e,n,i,r){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*i+a*r)/6}function pe(t,e){return function(n){return t+n*e}}function de(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function me(t,e){var n=e-t;return n?pe(t,n>180||n<-180?n-360*Math.round(n/360):n):up(isNaN(t)?e:t)}function ve(t){return 1===(t=+t)?ge:function(e,n){return n-e?de(e,n,t):up(isNaN(e)?n:e)}}function ge(t,e){var n=e-t;return n?pe(t,n):up(isNaN(t)?e:t)}function ye(t){return function(e){var n,i,r=e.length,o=new Array(r),a=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=Yt(e[n]),o[n]=i.r||0,a[n]=i.g||0,s[n]=i.b||0;return o=t(o),a=t(a),s=t(s),i.opacity=1,function(t){return i.r=o(t),i.g=a(t),i.b=s(t),i+""}}}function _e(t){return function(){return t}}function xe(t){return function(e){return t(e)+""}}function be(t){return"none"===t?wp:(np||(np=document.createElement("DIV"),ip=document.documentElement,rp=document.defaultView),np.style.transform=t,t=rp.getComputedStyle(ip.appendChild(np),null).getPropertyValue("transform"),ip.removeChild(np),t=t.slice(7,-1).split(","),Mp(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function we(t){return null==t?wp:(op||(op=document.createElementNS("http://www.w3.org/2000/svg","g")),op.setAttribute("transform",t),(t=op.transform.baseVal.consolidate())?(t=t.matrix,Mp(t.a,t.b,t.c,t.d,t.e,t.f)):wp)}function Me(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}function o(t,i,r,o,a,s){if(t!==r||i!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:dp(t,r)},{i:u-2,x:dp(i,o)})}else(r||o)&&a.push("translate("+r+e+o+n)}function a(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:dp(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}function s(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:dp(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}function u(t,e,n,i,o,a){if(t!==n||e!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:dp(t,n)},{i:s-2,x:dp(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}return function(e,n){var i=[],r=[];return e=t(e),n=t(n),o(e.translateX,e.translateY,n.translateX,n.translateY,i,r),a(e.rotate,n.rotate,i,r),s(e.skewX,n.skewX,i,r),u(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,r),e=n=null,function(t){for(var e,n=-1,o=r.length;++n<o;)i[(e=r[n]).i]=e.x(t);return i.join("")}}}function Ee(t){return((t=Math.exp(t))+1/t)/2}function Te(t){return((t=Math.exp(t))-1/t)/2}function Se(t){return((t=Math.exp(2*t))-1)/(t+1)}function Pe(t){return function(e,n){var i=t((e=Zt(e)).h,(n=Zt(n)).h),r=ge(e.s,n.s),o=ge(e.l,n.l),a=ge(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=r(t),e.l=o(t),e.opacity=a(t),e+""}}}function Ae(t,e){var n=ge((t=te(t)).l,(e=te(e)).l),i=ge(t.a,e.a),r=ge(t.b,e.b),o=ge(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=r(e),t.opacity=o(e),t+""}}function Ce(t){return function(e,n){var i=t((e=se(e)).h,(n=se(n)).h),r=ge(e.c,n.c),o=ge(e.l,n.l),a=ge(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=r(t),e.l=o(t),e.opacity=a(t),e+""}}}function Le(t){return function e(n){function i(e,i){var r=t((e=le(e)).h,(i=le(i)).h),o=ge(e.s,i.s),a=ge(e.l,i.l),s=ge(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,i.gamma=e,i}(1)}function Ie(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new Re(i)}function Re(t){this._=t}function Ne(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function Oe(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function De(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Fp,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}function Be(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function Ue(t,e){var n=Be(t);return function(i,r){return e(n(i),r,t)}}function Fe(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var i in t)i in e||n.push(e[i]=i)}),n}function ke(t){return function(e,n){t(null==e?n:null)}}function ze(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Ge(t,e){return function(n){return t(n.responseText,e)}}function He(){return fd||(md(je),fd=dd.now()+pd)}function je(){fd=0}function Xe(){this._call=this._time=this._next=null}function Ve(t,e,n){var i=new Xe;return i.restart(t,e,n),i}function Ye(){He(),++sd;for(var t,e=kp;e;)(t=fd-e._time)>=0&&e._call.call(null,t),e=e._next;--sd}function We(){fd=(hd=dd.now())+pd,sd=ud=0;try{Ye()}finally{sd=0,$e(),fd=0}}function qe(){var t=dd.now(),e=t-hd;e>ld&&(pd-=e,hd=t)}function $e(){for(var t,e,n=kp,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:kp=e);zp=t,Ze(i)}function Ze(t){if(!sd){ud&&(ud=clearTimeout(ud));var e=t-fd;e>24?(t<1/0&&(ud=setTimeout(We,e)),cd&&(cd=clearInterval(cd))):(cd||(cd=setInterval(qe,ld)),sd=1,md(We))}}function Je(t,e,n,i){function r(e){return t(e=new Date(+e)),e}return r.floor=r,r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,o){var a=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return a;do a.push(new Date(+n));while(e(n,o),t(n),n<i);return a},r.filter=function(n){
return Je(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,i){if(t>=t)for(;--i>=0;)for(;e(t,1),!n(t););})},n&&(r.count=function(e,i){return yd.setTime(+e),_d.setTime(+i),t(yd),t(_d),Math.floor(n(yd,_d))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t===0}:function(e){return r.count(0,e)%t===0}):r:null}),r}function Ke(t){return Je(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Md)/Sd})}function Qe(t){return Je(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Sd})}function tn(t){if(!(e=Im.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",i=e[2]||">",r=e[3]||"-",o=e[4]||"",a=!!e[5],s=e[6]&&+e[6],u=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(u=!0,l="g"):Lm[l]||(l=""),(a||"0"===n&&"="===i)&&(a=!0,n="0",i="="),this.fill=n,this.align=i,this.sign=r,this.symbol=o,this.zero=a,this.width=s,this.comma=u,this.precision=c,this.type=l}function en(t){return t}function nn(e){return Nm=Dm(e),t.format=Nm.format,t.formatPrefix=Nm.formatPrefix,Nm}function rn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function on(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function an(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function sn(t){function e(t,e){return function(n){var i,r,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(r=zm[i=t.charAt(++s)])?i=t.charAt(++s):r="e"===i?" ":"0",(o=e[i])&&(i=o(n,r)),a.push(i),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function n(t,e){return function(n){var r=an(1900),o=i(r,t,n+="",0);if(o!=n.length)return null;if("p"in r&&(r.H=r.H%12+12*r.p),"W"in r||"U"in r){"w"in r||(r.w="W"in r?1:0);var a="Z"in r?on(an(r.y)).getUTCDay():e(an(r.y)).getDay();r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(a+5)%7:r.w+7*r.U-(a+6)%7}return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,on(r)):e(r)}}function i(t,e,n,i){for(var r,o,a=0,s=e.length,u=n.length;a<s;){if(i>=u)return-1;if(r=e.charCodeAt(a++),37===r){if(r=e.charAt(a++),o=H[r in zm?e.charAt(a++):r],!o||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function r(t,e,n){var i=L.exec(e.slice(n));return i?(t.p=I[i[0].toLowerCase()],n+i[0].length):-1}function o(t,e,n){var i=O.exec(e.slice(n));return i?(t.w=D[i[0].toLowerCase()],n+i[0].length):-1}function a(t,e,n){var i=R.exec(e.slice(n));return i?(t.w=N[i[0].toLowerCase()],n+i[0].length):-1}function s(t,e,n){var i=F.exec(e.slice(n));return i?(t.m=k[i[0].toLowerCase()],n+i[0].length):-1}function u(t,e,n){var i=B.exec(e.slice(n));return i?(t.m=U[i[0].toLowerCase()],n+i[0].length):-1}function c(t,e,n){return i(t,w,e,n)}function l(t,e,n){return i(t,M,e,n)}function h(t,e,n){return i(t,E,e,n)}function f(t){return P[t.getDay()]}function p(t){return S[t.getDay()]}function d(t){return C[t.getMonth()]}function m(t){return A[t.getMonth()]}function v(t){return T[+(t.getHours()>=12)]}function g(t){return P[t.getUTCDay()]}function y(t){return S[t.getUTCDay()]}function _(t){return C[t.getUTCMonth()]}function x(t){return A[t.getUTCMonth()]}function b(t){return T[+(t.getUTCHours()>=12)]}var w=t.dateTime,M=t.date,E=t.time,T=t.periods,S=t.days,P=t.shortDays,A=t.months,C=t.shortMonths,L=ln(T),I=hn(T),R=ln(S),N=hn(S),O=ln(P),D=hn(P),B=ln(A),U=hn(A),F=ln(C),k=hn(C),z={a:f,A:p,b:d,B:m,c:null,d:Sn,e:Sn,H:Pn,I:An,j:Cn,L:Ln,m:In,M:Rn,p:v,S:Nn,U:On,w:Dn,W:Bn,x:null,X:null,y:Un,Y:Fn,Z:kn,"%":ti},G={a:g,A:y,b:_,B:x,c:null,d:zn,e:zn,H:Gn,I:Hn,j:jn,L:Xn,m:Vn,M:Yn,p:b,S:Wn,U:qn,w:$n,W:Zn,x:null,X:null,y:Jn,Y:Kn,Z:Qn,"%":ti},H={a:o,A:a,b:s,B:u,c:c,d:_n,e:_n,H:bn,I:bn,j:xn,L:En,m:yn,M:wn,p:r,S:Mn,U:pn,w:fn,W:dn,x:l,X:h,y:vn,Y:mn,Z:gn,"%":Tn};return z.x=e(M,z),z.X=e(E,z),z.c=e(w,z),G.x=e(M,G),G.X=e(E,G),G.c=e(w,G),{format:function(t){var n=e(t+="",z);return n.toString=function(){return t},n},parse:function(t){var e=n(t+="",rn);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",G);return n.toString=function(){return t},n},utcParse:function(t){var e=n(t,on);return e.toString=function(){return t},e}}}function un(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function cn(t){return t.replace(jm,"\\$&")}function ln(t){return new RegExp("^(?:"+t.map(cn).join("|")+")","i")}function hn(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function fn(t,e,n){var i=Gm.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function pn(t,e,n){var i=Gm.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function dn(t,e,n){var i=Gm.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function mn(t,e,n){var i=Gm.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function vn(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function gn(t,e,n){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function yn(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function _n(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function xn(t,e,n){var i=Gm.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function bn(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function wn(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Mn(t,e,n){var i=Gm.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function En(t,e,n){var i=Gm.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Tn(t,e,n){var i=Hm.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Sn(t,e){return un(t.getDate(),e,2)}function Pn(t,e){return un(t.getHours(),e,2)}function An(t,e){return un(t.getHours()%12||12,e,2)}function Cn(t,e){return un(1+Nd.count(Jd(t),t),e,3)}function Ln(t,e){return un(t.getMilliseconds(),e,3)}function In(t,e){return un(t.getMonth()+1,e,2)}function Rn(t,e){return un(t.getMinutes(),e,2)}function Nn(t,e){return un(t.getSeconds(),e,2)}function On(t,e){return un(Dd.count(Jd(t),t),e,2)}function Dn(t){return t.getDay()}function Bn(t,e){return un(Bd.count(Jd(t),t),e,2)}function Un(t,e){return un(t.getFullYear()%100,e,2)}function Fn(t,e){return un(t.getFullYear()%1e4,e,4)}function kn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+un(e/60|0,"0",2)+un(e%60,"0",2)}function zn(t,e){return un(t.getUTCDate(),e,2)}function Gn(t,e){return un(t.getUTCHours(),e,2)}function Hn(t,e){return un(t.getUTCHours()%12||12,e,2)}function jn(t,e){return un(1+im.count(bm(t),t),e,3)}function Xn(t,e){return un(t.getUTCMilliseconds(),e,3)}function Vn(t,e){return un(t.getUTCMonth()+1,e,2)}function Yn(t,e){return un(t.getUTCMinutes(),e,2)}function Wn(t,e){return un(t.getUTCSeconds(),e,2)}function qn(t,e){return un(om.count(bm(t),t),e,2)}function $n(t){return t.getUTCDay()}function Zn(t,e){return un(am.count(bm(t),t),e,2)}function Jn(t,e){return un(t.getUTCFullYear()%100,e,2)}function Kn(t,e){return un(t.getUTCFullYear()%1e4,e,4)}function Qn(){return"+0000"}function ti(){return"%"}function ei(e){return Bm=sn(e),t.timeFormat=Bm.format,t.timeParse=Bm.parse,t.utcFormat=Bm.utcFormat,t.utcParse=Bm.utcParse,Bm}function ni(t){return t.toISOString()}function ii(t){var e=new Date(t);return isNaN(e)?null:e}function ri(t){function e(e){var o=e+"",a=n.get(o);if(!a){if(r!==Zm)return r;n.set(o,a=i.push(e))}return t[(a-1)%t.length]}var n=o(),i=[],r=Zm;return t=null==t?[]:$m.call(t),e.domain=function(t){if(!arguments.length)return i.slice();i=[],n=o();for(var r,a,s=-1,u=t.length;++s<u;)n.has(a=(r=t[s])+"")||n.set(a,i.push(r));return e},e.range=function(n){return arguments.length?(t=$m.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return ri().domain(i).range(t).unknown(r)},e}function oi(){function t(){var t=r().length,i=a[1]<a[0],h=a[i-0],f=a[1-i];e=(f-h)/Math.max(1,t-u+2*c),s&&(e=Math.floor(e)),h+=(f-h-e*(t-u))*l,n=e*(1-u),s&&(h=Math.round(h),n=Math.round(n));var p=Fc(t).map(function(t){return h+e*t});return o(i?p.reverse():p)}var e,n,i=ri().unknown(void 0),r=i.domain,o=i.range,a=[0,1],s=!1,u=0,c=0,l=.5;return delete i.unknown,i.domain=function(e){return arguments.length?(r(e),t()):r()},i.range=function(e){return arguments.length?(a=[+e[0],+e[1]],t()):a.slice()},i.rangeRound=function(e){return a=[+e[0],+e[1]],s=!0,t()},i.bandwidth=function(){return n},i.step=function(){return e},i.round=function(e){return arguments.length?(s=!!e,t()):s},i.padding=function(e){return arguments.length?(u=c=Math.max(0,Math.min(1,e)),t()):u},i.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),t()):u},i.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),t()):c},i.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},i.copy=function(){return oi().domain(r()).range(a).round(s).paddingInner(u).paddingOuter(c).align(l)},t()}function ai(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return ai(e())},t}function si(){return ai(oi().paddingInner(1))}function ui(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Jm(e)}function ci(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:i(t)}}}function li(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:i(t)}}}function hi(t,e,n,i){var r=t[0],o=t[1],a=e[0],s=e[1];return o<r?(r=n(o,r),a=i(s,a)):(r=n(r,o),a=i(a,s)),function(t){return a(r(t))}}function fi(t,e,n,i){var r=Math.min(t.length,e.length)-1,o=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)o[s]=n(t[s],t[s+1]),a[s]=i(e[s],e[s+1]);return function(e){var n=Sc(t,e,1,r)-1;return a[n](o[n](e))}}function pi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function di(t,e){function n(){return r=Math.min(s.length,u.length)>2?fi:hi,o=a=null,i}function i(e){return(o||(o=r(s,u,l?ci(t):t,c)))(+e)}var r,o,a,s=Qm,u=Qm,c=_p,l=!1;return i.invert=function(t){return(a||(a=r(u,s,ui,l?li(e):e)))(+t)},i.domain=function(t){return arguments.length?(s=qm.call(t,Km),n()):s.slice()},i.range=function(t){return arguments.length?(u=$m.call(t),n()):u.slice()},i.rangeRound=function(t){return u=$m.call(t),c=xp,n()},i.clamp=function(t){return arguments.length?(l=!!t,n()):l},i.interpolate=function(t){return arguments.length?(c=t,n()):c},n()}function mi(t){var e=t.domain;return t.ticks=function(t){var n=e();return Hc(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return tv(e(),t,n)},t.nice=function(i){var r=e(),o=r.length-1,a=null==i?10:i,s=r[0],u=r[o],c=n(s,u,a);return c&&(c=n(Math.floor(s/c)*c,Math.ceil(u/c)*c,a),r[0]=Math.floor(s/c)*c,r[o]=Math.ceil(u/c)*c,e(r)),t},t}function vi(){var t=di(ui,dp);return t.copy=function(){return pi(t,vi())},mi(t)}function gi(){function t(t){return+t}var e=[0,1];return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=qm.call(n,Km),t):e.slice()},t.copy=function(){return gi().domain(e)},mi(t)}function yi(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:Jm(e)}function _i(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function xi(t){return isFinite(t)?+("1e"+t):t<0?0:t}function bi(t){return 10===t?xi:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function wi(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Mi(t){return function(e){return-t(-e)}}function Ei(){function e(){return o=wi(r),a=bi(r),i()[0]<0&&(o=Mi(o),a=Mi(a)),n}var n=di(yi,_i).domain([1,10]),i=n.domain,r=10,o=wi(10),a=bi(10);return n.base=function(t){return arguments.length?(r=+t,e()):r},n.domain=function(t){return arguments.length?(i(t),e()):i()},n.ticks=function(t){var e,n=i(),s=n[0],u=n[n.length-1];(e=u<s)&&(f=s,s=u,u=f);var c,l,h,f=o(s),p=o(u),d=null==t?10:+t,m=[];if(!(r%1)&&p-f<d){if(f=Math.round(f)-1,p=Math.round(p)+1,s>0){for(;f<p;++f)for(l=1,c=a(f);l<r;++l)if(h=c*l,!(h<s)){if(h>u)break;m.push(h)}}else for(;f<p;++f)for(l=r-1,c=a(f);l>=1;--l)if(h=c*l,!(h<s)){if(h>u)break;m.push(h)}}else m=Hc(f,p,Math.min(p-f,d)).map(a);return e?m.reverse():m},n.tickFormat=function(e,i){if(null==i&&(i=10===r?".0e":","),"function"!=typeof i&&(i=t.format(i)),e===1/0)return i;null==e&&(e=10);var s=Math.max(1,r*e/n.ticks().length);return function(t){var e=t/a(Math.round(o(t)));return e*r<r-.5&&(e*=r),e<=s?i(t):""}},n.nice=function(){return i(ev(i(),{floor:function(t){return a(Math.floor(o(t)))},ceil:function(t){return a(Math.ceil(o(t)))}}))},n.copy=function(){return pi(n,Ei().base(r))},n}function Ti(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function Si(){function t(t,e){return(e=Ti(e,n)-(t=Ti(t,n)))?function(i){return(Ti(i,n)-t)/e}:Jm(e)}function e(t,e){return e=Ti(e,n)-(t=Ti(t,n)),function(i){return Ti(t+e*i,1/n)}}var n=1,i=di(t,e),r=i.domain;return i.exponent=function(t){return arguments.length?(n=+t,r(r())):n},i.copy=function(){return pi(i,Si().exponent(n))},mi(i)}function Pi(){return Si().exponent(.5)}function Ai(){function t(){var t=0,o=Math.max(1,i.length);for(r=new Array(o-1);++t<o;)r[t-1]=Vc(n,t/o);return e}function e(t){if(!isNaN(t=+t))return i[Sc(r,t)]}var n=[],i=[],r=[];return e.invertExtent=function(t){var e=i.indexOf(t);return e<0?[NaN,NaN]:[e>0?r[e-1]:n[0],e<r.length?r[e]:n[n.length-1]]},e.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var i,r=0,o=e.length;r<o;++r)i=e[r],null==i||isNaN(i=+i)||n.push(i);return n.sort(Mc),t()},e.range=function(e){return arguments.length?(i=$m.call(e),t()):i.slice()},e.quantiles=function(){return r.slice()},e.copy=function(){return Ai().domain(n).range(i)},e}function Ci(){function t(t){if(t<=t)return a[Sc(o,t,0,r)]}function e(){var e=-1;for(o=new Array(r);++e<r;)o[e]=((e+1)*i-(e-r)*n)/(r+1);return t}var n=0,i=1,r=1,o=[.5],a=[0,1];return t.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],e()):[n,i]},t.range=function(t){return arguments.length?(r=(a=$m.call(t)).length-1,e()):a.slice()},t.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=r?[o[r-1],i]:[o[e-1],o[e]]},t.copy=function(){return Ci().domain([n,i]).range(a)},mi(t)}function Li(){function t(t){if(t<=t)return n[Sc(e,t,0,i)]}var e=[.5],n=[0,1],i=1;return t.domain=function(r){return arguments.length?(e=$m.call(r),i=Math.min(e.length,n.length-1),t):e.slice()},t.range=function(r){return arguments.length?(n=$m.call(r),i=Math.min(e.length,n.length-1),t):n.slice()},t.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},t.copy=function(){return Li().domain(e).range(n)},t}function Ii(t){return new Date(t)}function Ri(t){return t instanceof Date?+t:+new Date(+t)}function Ni(t,e,i,r,o,a,s,u,c){function l(n){return(s(n)<n?m:a(n)<n?v:o(n)<n?g:r(n)<n?y:e(n)<n?i(n)<n?_:x:t(n)<n?b:w)(n)}function h(e,i,r,o){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-i)/e,s=Ec(function(t){return t[2]}).right(M,a);s===M.length?(o=n(i/uv,r/uv,e),e=t):s?(s=M[a/M[s-1][2]<M[s][2]/a?s-1:s],o=s[1],e=s[0]):(o=n(i,r,e),e=u)}return null==o?e:e.every(o)}var f=di(ui,dp),p=f.invert,d=f.domain,m=c(".%L"),v=c(":%S"),g=c("%I:%M"),y=c("%I %p"),_=c("%a %d"),x=c("%b %d"),b=c("%B"),w=c("%Y"),M=[[s,1,nv],[s,5,5*nv],[s,15,15*nv],[s,30,30*nv],[a,1,iv],[a,5,5*iv],[a,15,15*iv],[a,30,30*iv],[o,1,rv],[o,3,3*rv],[o,6,6*rv],[o,12,12*rv],[r,1,ov],[r,2,2*ov],[i,1,av],[e,1,sv],[e,3,3*sv],[t,1,uv]];return f.invert=function(t){return new Date(p(t))},f.domain=function(t){return arguments.length?d(qm.call(t,Ri)):d().map(Ii)},f.ticks=function(t,e){var n,i=d(),r=i[0],o=i[i.length-1],a=o<r;return a&&(n=r,r=o,o=n),n=h(t,r,o,e),n=n?n.range(r,o+1):[],a?n.reverse():n},f.tickFormat=function(t,e){return null==e?l:c(e)},f.nice=function(t,e){var n=d();return(t=h(t,n[0],n[n.length-1],e))?d(ev(n,t)):f},f.copy=function(){return pi(f,Ni(t,e,i,r,o,a,s,u,c))},f}function Oi(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Di(t){function e(e){var o=(e-n)/(i-n);return t(r?Math.max(0,Math.min(1,o)):o)}var n=0,i=1,r=!1;return e.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.clamp=function(t){return arguments.length?(r=!!t,e):r},e.interpolator=function(n){return arguments.length?(t=n,e):t},e.copy=function(){return Di(t).domain([n,i]).clamp(r)},mi(e)}function Bi(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Tv&&e.documentElement.namespaceURI===Tv?e.createElement(t):e.createElementNS(n,t)}}function Ui(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Fi(){return new ki}function ki(){this._="@"+(++Cv).toString(36)}function zi(t,e,n){return t=Gi(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Gi(e,n,i){return function(r){var o=t.event;t.event=r;try{e.call(this,this.__data__,n,i)}finally{t.event=o}}}function Hi(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function ji(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function Xi(t,e,n){var i=Ov.hasOwnProperty(t.type)?zi:Gi;return function(r,o,a){var s,u=this.__on,c=i(e,o,a);if(u)for(var l=0,h=u.length;l<h;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function Vi(e,n,i,r){var o=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(i,r)}finally{t.event=o}}function Yi(){}function Wi(){return[]}function qi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function $i(t,e,n,i,r,o){for(var a,s=0,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new qi(t,o[s]);for(;s<u;++s)(a=e[s])&&(r[s]=a)}function Zi(t,e,n,i,r,o,a){var s,u,c,l={},h=e.length,f=o.length,p=new Array(h);for(s=0;s<h;++s)(u=e[s])&&(p[s]=c=qv+a.call(u,u.__data__,s,e),c in l?r[s]=u:l[c]=u);for(s=0;s<f;++s)c=qv+a.call(t,o[s],s,o),(u=l[c])?(i[s]=u,u.__data__=o[s],l[c]=null):n[s]=new qi(t,o[s]);for(s=0;s<h;++s)(u=e[s])&&l[p[s]]===u&&(r[s]=u)}function Ji(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ki(t){return function(){this.removeAttribute(t)}}function Qi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tr(t,e){return function(){this.setAttribute(t,e)}}function er(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function nr(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function ir(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function rr(t){return function(){this.style.removeProperty(t)}}function or(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ar(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function sr(t){return function(){delete this[t]}}function ur(t,e){return function(){this[t]=e}}function cr(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function lr(t){return t.trim().split(/^|\s+/)}function hr(t){return t.classList||new fr(t)}function fr(t){this._node=t,this._names=lr(t.getAttribute("class")||"")}function pr(t,e){for(var n=hr(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function dr(t,e){for(var n=hr(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function mr(t){return function(){pr(this,t)}}function vr(t){return function(){dr(this,t)}}function gr(t,e){return function(){(e.apply(this,arguments)?pr:dr)(this,t)}}function yr(){this.textContent=""}function _r(t){return function(){this.textContent=t}}function xr(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function br(){this.innerHTML=""}function wr(t){return function(){this.innerHTML=t}}function Mr(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Er(){this.nextSibling&&this.parentNode.appendChild(this)}function Tr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sr(){return null}function Pr(){var t=this.parentNode;t&&t.removeChild(this)}function Ar(t,e,n){var i=sg(t),r=i.CustomEvent;r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Cr(t,e){return function(){return Ar(this,t,e)}}function Lr(t,e){return function(){return Ar(this,t,e.apply(this,arguments))}}function Ir(t,e){this._groups=t,this._parents=e}function Rr(){return new Ir([[document.documentElement]],xg)}function Nr(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Pg)throw new Error("too late");return n}function Or(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Cg)throw new Error("too late");return n}function Dr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}function Br(t,e,n){function i(t){n.state=Ag,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}function r(i){var c,l,h,f;if(n.state!==Ag)return a();for(c in u)if(f=u[c],f.name===n.name){if(f.state===Lg)return vd(r);f.state===Ig?(f.state=Ng,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete u[c]):+c<e&&(f.state=Ng,f.timer.stop(),delete u[c])}if(vd(function(){n.state===Lg&&(n.state=Ig,n.timer.restart(o,n.delay,n.time),o(i))}),n.state=Cg,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Cg){for(n.state=Lg,s=new Array(h=n.tween.length),c=0,l=-1;c<h;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(s[++l]=f);s.length=l+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=Rg,1),r=-1,o=s.length;++r<o;)s[r].call(null,i);n.state===Rg&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Ng,n.timer.stop(),delete u[e];for(var i in u)return;delete t.__transition}var s,u=t.__transition;u[e]=n,n.timer=Ve(i,0,n.time)}function Ur(t,e){var n,i;return function(){var r=Or(this,t),o=r.tween;if(o!==n){i=n=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function Fr(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=Or(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},u=0,c=r.length;u<c;++u)if(r[u].name===e){r[u]=s;break}u===c&&r.push(s)}o.tween=r}}function kr(t,e,n){var i=t._id;return t.each(function(){var t=Or(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return Dr(t,i).value[e]}}function zr(t){return function(){this.removeAttribute(t)}}function Gr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Hr(t,e,n){var i,r;return function(){var o=this.getAttribute(t);return o===n?null:o===i?r:r=e(i=o,n)}}function jr(t,e,n){var i,r;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===i?r:r=e(i=o,n)}}function Xr(t,e,n){var i,r,o;return function(){var a,s=n(this);return null==s?void this.removeAttribute(t):(a=this.getAttribute(t),a===s?null:a===i&&s===r?o:o=e(i=a,r=s))}}function Vr(t,e,n){var i,r,o;return function(){var a,s=n(this);return null==s?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),a===s?null:a===i&&s===r?o:o=e(i=a,r=s))}}function Yr(t,e){function n(){var n=this,i=e.apply(n,arguments);return i&&function(e){n.setAttributeNS(t.space,t.local,i(e))}}return n._value=e,n}function Wr(t,e){function n(){var n=this,i=e.apply(n,arguments);return i&&function(e){n.setAttribute(t,i(e))}}return n._value=e,n}function qr(t,e){return function(){Nr(this,t).delay=+e.apply(this,arguments)}}function $r(t,e){return e=+e,function(){Nr(this,t).delay=e}}function Zr(t,e){return function(){Or(this,t).duration=+e.apply(this,arguments)}}function Jr(t,e){return e=+e,function(){Or(this,t).duration=e}}function Kr(t,e){if("function"!=typeof e)throw new Error;return function(){Or(this,t).ease=e}}function Qr(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}function to(t,e,n){var i,r,o=Qr(e)?Nr:Or;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(e,n),a.on=r}}function eo(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function no(t,e){var n,i,r;return function(){var o=sg(this).getComputedStyle(this,null),a=o.getPropertyValue(t),s=(this.style.removeProperty(t),o.getPropertyValue(t));return a===s?null:a===n&&s===i?r:r=e(n=a,i=s)}}function io(t){return function(){this.style.removeProperty(t)}}function ro(t,e,n){var i,r;return function(){var o=sg(this).getComputedStyle(this,null).getPropertyValue(t);return o===n?null:o===i?r:r=e(i=o,n)}}function oo(t,e,n){var i,r,o;return function(){var a=sg(this).getComputedStyle(this,null),s=a.getPropertyValue(t),u=n(this);return null==u&&(this.style.removeProperty(t),u=a.getPropertyValue(t)),s===u?null:s===i&&u===r?o:o=e(i=s,r=u)}}function ao(t,e,n){function i(){var i=this,r=e.apply(i,arguments);return r&&function(e){i.style.setProperty(t,r(e),n)}}return i._value=e,i}function so(t){return function(){this.textContent=t}}function uo(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function co(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function lo(t){return Rr().transition(t)}function ho(){return++ny}function fo(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return ry.time=He(),ry;return n}function po(t,e,n){var i=t(n);return"translate("+(isFinite(i)?i:e(n))+",0)"}function mo(t,e,n){var i=t(n);return"translate(0,"+(isFinite(i)?i:e(n))+")"}function vo(t){var e=t.bandwidth()/2;return t.round()&&(e=Math.round(e)),function(n){return t(n)+e}}function go(){return!this.__axis}function yo(t,e){function n(n){var c,l=null==r?e.ticks?e.ticks.apply(e,i):e.domain():r,h=null==o?e.tickFormat?e.tickFormat.apply(e,i):cy:o,f=Math.max(a,0)+u,p=t===ly||t===fy?po:mo,d=e.range(),m=d[0]+.5,v=d[d.length-1]+.5,g=(e.bandwidth?vo:cy)(e.copy()),y=n.selection?n.selection():n,_=y.selectAll(".domain").data([null]),x=y.selectAll(".tick").data(l,e).order(),b=x.exit(),w=x.enter().append("g").attr("class","tick"),M=x.select("line"),E=x.select("text"),T=t===ly||t===py?-1:1,S=t===py||t===hy?(c="x","y"):(c="y","x");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),x=x.merge(w),M=M.merge(w.append("line").attr("stroke","#000").attr(c+"2",T*a).attr(S+"1",.5).attr(S+"2",.5)),E=E.merge(w.append("text").attr("fill","#000").attr(c,T*f).attr(S,.5).attr("dy",t===ly?"0em":t===fy?"0.71em":"0.32em")),n!==y&&(_=_.transition(n),x=x.transition(n),M=M.transition(n),E=E.transition(n),b=b.transition(n).attr("opacity",dy).attr("transform",function(t){return p(g,this.parentNode.__axis||g,t)}),w.attr("opacity",dy).attr("transform",function(t){return p(this.parentNode.__axis||g,g,t)})),b.remove(),_.attr("d",t===py||t==hy?"M"+T*s+","+m+"H0.5V"+v+"H"+T*s:"M"+m+","+T*s+"V0.5H"+v+"V"+T*s),x.attr("opacity",1).attr("transform",function(t){return p(g,g,t)}),M.attr(c+"2",T*a),E.attr(c,T*f).text(h),y.filter(go).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===hy?"start":t===py?"end":"middle"),y.each(function(){this.__axis=g})}var i=[],r=null,o=null,a=6,s=6,u=3;return n.scale=function(t){return arguments.length?(e=t,n):e},n.ticks=function(){return i=uy.call(arguments),n},n.tickArguments=function(t){return arguments.length?(i=null==t?[]:uy.call(t),n):i.slice()},n.tickValues=function(t){return arguments.length?(r=null==t?null:uy.call(t),n):r&&r.slice()},n.tickFormat=function(t){return arguments.length?(o=t,n):o},n.tickSize=function(t){return arguments.length?(a=s=+t,n):a},n.tickSizeInner=function(t){return arguments.length?(a=+t,n):a},n.tickSizeOuter=function(t){return arguments.length?(s=+t,n):s},n.tickPadding=function(t){return arguments.length?(u=+t,n):u},n}function _o(t){return yo(ly,t)}function xo(t){return yo(hy,t)}function bo(t){return yo(fy,t)}function wo(t){return yo(py,t)}function Mo(t,e){return t.parent===e.parent?1:2}function Eo(t){return t.reduce(To,0)/t.length}function To(t,e){return t+e.x}function So(t){return 1+t.reduce(Po,0)}function Po(t,e){return Math.max(t,e.y)}function Ao(t){for(var e;e=t.children;)t=e[0];return t}function Co(t){for(var e;e=t.children;)t=e[e.length-1];return t}function Lo(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function Io(t,e){var n,i,r,o,a,s=new Bo(t),u=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=No);n=c.pop();)if(u&&(n.value=+n.data.value),(r=e(n.data))&&(a=r.length))for(n.children=new Array(a),o=a-1;o>=0;--o)c.push(i=n.children[o]=new Bo(r[o])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(Do)}function Ro(){return Io(this).eachBefore(Oo)}function No(t){return t.children}function Oo(t){t.data=t.data.data}function Do(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Bo(t){this.data=t,this.depth=this.height=0,this.parent=null}function Uo(t){this._=t,this.next=null}function Fo(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r-e.r;return r*r+1e-6>n*n+i*i}function ko(t,e){var n,i,r,o=null,a=t.head;switch(e.length){case 1:n=zo(e[0]);break;case 2:n=Go(e[0],e[1]);break;case 3:n=Ho(e[0],e[1],e[2])}for(;a;)r=a._,i=a.next,n&&Fo(n,r)?o=a:(o?(t.tail=o,o.next=null):t.head=t.tail=null,e.push(r),n=ko(t,e),e.pop(),t.head?(a.next=t.head,t.head=a):(a.next=null,t.head=t.tail=a),o=t.tail,o.next=i),a=i;return t.tail=o,n}function zo(t){return{x:t.x,y:t.y,r:t.r}}function Go(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,a=e.y,s=e.r,u=o-n,c=a-i,l=s-r,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*l)/2,y:(i+a+c/h*l)/2,r:(h+r+s)/2}}function Ho(t,e,n){var i=t.x,r=t.y,o=t.r,a=e.x,s=e.y,u=e.r,c=n.x,l=n.y,h=n.r,f=2*(i-a),p=2*(r-s),d=2*(u-o),m=i*i+r*r-o*o-a*a-s*s+u*u,v=2*(i-c),g=2*(r-l),y=2*(h-o),_=i*i+r*r-o*o-c*c-l*l+h*h,x=v*p-f*g,b=(p*_-g*m)/x-i,w=(g*d-p*y)/x,M=(v*m-f*_)/x-r,E=(f*y-v*d)/x,T=w*w+E*E-1,S=2*(b*w+M*E+o),P=b*b+M*M-o*o,A=(-S-Math.sqrt(S*S-4*T*P))/(2*T);return{x:b+w*A+i,y:M+E*A+r,r:A}}function jo(t,e,n){var i=t.x,r=t.y,o=e.r+n.r,a=t.r+n.r,s=e.x-i,u=e.y-r,c=s*s+u*u;if(c){var l=.5+((a*=a)-(o*=o))/(2*c),h=Math.sqrt(Math.max(0,2*o*(a+c)-(a-=c)*a-o*o))/(2*c);n.x=i+l*s+h*u,n.y=r+l*u-h*s}else n.x=i+a,n.y=r}function Xo(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return r*r>n*n+i*i}function Vo(t,e,n){var i=t.x-e,r=t.y-n;return i*i+r*r}function Yo(t){this._=t,this.next=null,this.previous=null}function Wo(t){if(!(r=t.length))return 0;var e,n,i,r;if(e=t[0],e.x=0,e.y=0,!(r>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(r>2))return e.r+n.r;jo(n,e,i=t[2]);var o,a,s,u,c,l,h,f=e.r*e.r,p=n.r*n.r,d=i.r*i.r,m=f+p+d,v=f*e.x+p*n.x+d*i.x,g=f*e.y+p*n.y+d*i.y;e=new Yo(e),n=new Yo(n),i=new Yo(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(s=3;s<r;++s){if(jo(e._,n._,i=t[s]),i=new Yo(i),(c=e.previous)===(u=n.next)){if(Xo(u._,i._)){e=n,n=u,--s;continue t}}else{l=u._.r,h=c._.r;do if(l<=h){if(Xo(u._,i._)){n=u,e.next=n,
n.previous=e,--s;continue t}u=u.next,l+=u._.r}else{if(Xo(c._,i._)){e=c,e.next=n,n.previous=e,--s;continue t}c=c.previous,h+=c._.r}while(u!==c.next)}for(i.previous=e,i.next=n,e.next=n.previous=n=i,m+=d=i._.r*i._.r,v+=d*i._.x,g+=d*i._.y,f=Vo(e._,o=v/m,a=g/m);(i=i.next)!==n;)(d=Vo(i._,o,a))<f&&(e=i,f=d);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=Py(e),s=0;s<r;++s)e=t[s],e.x-=i.x,e.y-=i.y;return i.r}function qo(t){return null==t?null:$o(t)}function $o(t){if("function"!=typeof t)throw new Error;return t}function Zo(){return 0}function Jo(t){return Math.sqrt(t.value)}function Ko(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Qo(t,e){return function(n){if(i=n.children){var i,r,o,a=i.length,s=t(n)*e||0;if(s)for(r=0;r<a;++r)i[r].r+=s;if(o=Wo(i),s)for(r=0;r<a;++r)i[r].r-=s;n.r=o+s}}}function ta(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function ea(t){return t.id}function na(t){return t.parentId}function ia(t,e){return t.parent===e.parent?1:2}function ra(t){var e=t.children;return e?e[0]:t.t}function oa(t){var e=t.children;return e?e[e.length-1]:t.t}function aa(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function sa(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)e=r[o],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}function ua(t,e,n){return t.a.parent===e.parent?t.a:n}function ca(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function la(t){for(var e,n,i,r,o,a=new ca(t,0),s=[a];e=s.pop();)if(i=e._.children)for(e.children=new Array(o=i.length),r=o-1;r>=0;--r)s.push(n=e.children[r]=new ca(i[r],r)),n.parent=e;return(a.parent=new ca(null,0)).children=[a],a}function ha(t,e,n,i,r,o){for(var a,s,u,c,l,h,f,p,d,m,v,g=[],y=e.children,_=0,x=0,b=y.length,w=e.value;_<b;){u=r-n,c=o-i;do l=y[x++].value;while(!l&&x<b);for(h=f=l,m=Math.max(c/u,u/c)/(w*t),v=l*l*m,d=Math.max(f/v,v/h);x<b;++x){if(l+=s=y[x].value,s<h&&(h=s),s>f&&(f=s),v=l*l*m,p=Math.max(f/v,v/h),p>d){l-=s;break}d=p}g.push(a={value:l,dice:u<c,children:y.slice(_,x)}),a.dice?Ry(a,n,i,r,w?i+=c*l/w:o):ky(a,n,i,w?n+=u*l/w:r,o),w-=l,_=x}return g}function fa(t){return t.x+t.vx}function pa(t){return t.y+t.vy}function da(t){return t.index}function ma(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function va(t){return t.x}function ga(t){return t.y}function ya(){t.event.stopImmediatePropagation()}function _a(t,e){var n=t.document.documentElement,i=bg(t).on("dragstart.drag",null);e&&(i.on("click.drag",i_,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function xa(t,e,n,i,r,o,a,s,u,c){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=c}function ba(){return!t.event.button}function wa(){return this.parentNode}function Ma(e){return null==e?{x:t.event.x,y:t.event.y}:e}function Ea(t){return t[0]}function Ta(t){return t[1]}function Sa(){this._=null}function Pa(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Aa(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Ca(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function La(t){for(;t.L;)t=t.L;return t}function Ia(t,e,n,i){var r=[null,null],o=f_.push(r)-1;return r.left=t,r.right=e,n&&Na(r,t,e,n),i&&Na(r,e,t,i),l_[t.index].halfedges.push(o),l_[e.index].halfedges.push(o),r}function Ra(t,e,n){var i=[e,n];return i.left=t,i}function Na(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Oa(t,e,n,i,r){var o,a=t[0],s=t[1],u=a[0],c=a[1],l=s[0],h=s[1],f=0,p=1,d=l-u,m=h-c;if(o=e-u,d||!(o>0)){if(o/=d,d<0){if(o<f)return;o<p&&(p=o)}else if(d>0){if(o>p)return;o>f&&(f=o)}if(o=i-u,d||!(o<0)){if(o/=d,d<0){if(o>p)return;o>f&&(f=o)}else if(d>0){if(o<f)return;o<p&&(p=o)}if(o=n-c,m||!(o>0)){if(o/=m,m<0){if(o<f)return;o<p&&(p=o)}else if(m>0){if(o>p)return;o>f&&(f=o)}if(o=r-c,m||!(o<0)){if(o/=m,m<0){if(o>p)return;o>f&&(f=o)}else if(m>0){if(o<f)return;o<p&&(p=o)}return!(f>0||p<1)||(f>0&&(t[0]=[u+f*d,c+f*m]),p<1&&(t[1]=[u+p*d,c+p*m]),!0)}}}}}function Da(t,e,n,i,r){var o=t[1];if(o)return!0;var a,s,u=t[0],c=t.left,l=t.right,h=c[0],f=c[1],p=l[0],d=l[1],m=(h+p)/2,v=(f+d)/2;if(d===f){if(m<e||m>=i)return;if(h>p){if(u){if(u[1]>=r)return}else u=[m,n];o=[m,r]}else{if(u){if(u[1]<n)return}else u=[m,r];o=[m,n]}}else if(a=(h-p)/(d-f),s=v-a*m,a<-1||a>1)if(h>p){if(u){if(u[1]>=r)return}else u=[(n-s)/a,n];o=[(r-s)/a,r]}else{if(u){if(u[1]<n)return}else u=[(r-s)/a,r];o=[(n-s)/a,n]}else if(f<d){if(u){if(u[0]>=i)return}else u=[e,a*e+s];o=[i,a*i+s]}else{if(u){if(u[0]<e)return}else u=[i,a*i+s];o=[e,a*e+s]}return t[0]=u,t[1]=o,!0}function Ba(t,e,n,i){for(var r,o=f_.length;o--;)Da(r=f_[o],t,e,n,i)&&Oa(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>m_||Math.abs(r[0][1]-r[1][1])>m_)||delete f_[o]}function Ua(t){return l_[t.index]={site:t,halfedges:[]}}function Fa(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function ka(t,e){return e[+(e.left!==t.site)]}function za(t,e){return e[+(e.left===t.site)]}function Ga(){for(var t,e,n,i,r=0,o=l_.length;r<o;++r)if((t=l_[r])&&(i=(e=t.halfedges).length)){var a=new Array(i),s=new Array(i);for(n=0;n<i;++n)a[n]=n,s[n]=Fa(t,f_[e[n]]);for(a.sort(function(t,e){return s[e]-s[t]}),n=0;n<i;++n)s[n]=e[a[n]];for(n=0;n<i;++n)e[n]=s[n]}}function Ha(t,e,n,i){var r,o,a,s,u,c,l,h,f,p,d,m,v=l_.length,g=!0;for(r=0;r<v;++r)if(o=l_[r]){for(a=o.site,u=o.halfedges,s=u.length;s--;)f_[u[s]]||u.splice(s,1);for(s=0,c=u.length;s<c;)p=za(o,f_[u[s]]),d=p[0],m=p[1],l=ka(o,f_[u[++s%c]]),h=l[0],f=l[1],(Math.abs(d-h)>m_||Math.abs(m-f)>m_)&&(u.splice(s,0,f_.push(Ra(a,p,Math.abs(d-t)<m_&&i-m>m_?[t,Math.abs(h-t)<m_?f:i]:Math.abs(m-i)<m_&&n-d>m_?[Math.abs(f-i)<m_?h:n,i]:Math.abs(d-n)<m_&&m-e>m_?[n,Math.abs(h-n)<m_?f:e]:Math.abs(m-e)<m_&&d-t>m_?[Math.abs(f-e)<m_?h:t,e]:null))-1),++c);c&&(g=!1)}if(g){var y,_,x,b=1/0;for(r=0,g=null;r<v;++r)(o=l_[r])&&(a=o.site,y=a[0]-t,_=a[1]-e,x=y*y+_*_,x<b&&(b=x,g=o));if(g){var w=[t,e],M=[t,i],E=[n,i],T=[n,e];g.halfedges.push(f_.push(Ra(a=g.site,w,M))-1,f_.push(Ra(a,M,E))-1,f_.push(Ra(a,E,T))-1,f_.push(Ra(a,T,w))-1)}}for(r=0;r<v;++r)(o=l_[r])&&(o.halfedges.length||delete l_[r])}function ja(){Pa(this),this.x=this.y=this.arc=this.site=this.cy=null}function Xa(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r[0],s=r[1],u=i[0]-a,c=i[1]-s,l=o[0]-a,h=o[1]-s,f=2*(u*h-c*l);if(!(f>=-v_)){var p=u*u+c*c,d=l*l+h*h,m=(h*p-c*d)/f,v=(u*d-l*p)/f,g=p_.pop()||new ja;g.arc=t,g.site=r,g.x=m+a,g.y=(g.cy=v+s)+Math.sqrt(m*m+v*v),t.circle=g;for(var y=null,_=h_._;_;)if(g.y<_.y||g.y===_.y&&g.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}h_.insert(y,g),y||(u_=g)}}}}function Va(t){var e=t.circle;e&&(e.P||(u_=e.N),h_.remove(e),p_.push(e),Pa(e),t.circle=null)}function Ya(){Pa(this),this.edge=this.site=this.circle=null}function Wa(t){var e=d_.pop()||new Ya;return e.site=t,e}function qa(t){Va(t),c_.remove(t),d_.push(t),Pa(t)}function $a(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,a=t.N,s=[t];qa(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<m_&&Math.abs(i-u.circle.cy)<m_;)o=u.P,s.unshift(u),qa(u),u=o;s.unshift(u),Va(u);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<m_&&Math.abs(i-c.circle.cy)<m_;)a=c.N,s.push(c),qa(c),c=a;s.push(c),Va(c);var l,h=s.length;for(l=1;l<h;++l)c=s[l],u=s[l-1],Na(c.edge,u.site,c.site,r);u=s[0],c=s[h-1],c.edge=Ia(u.site,c.site,null,r),Xa(u),Xa(c)}function Za(t){for(var e,n,i,r,o=t[0],a=t[1],s=c_._;s;)if(i=Ja(s,a)-o,i>m_)s=s.L;else{if(r=o-Ka(s,a),!(r>m_)){i>-m_?(e=s.P,n=s):r>-m_?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}Ua(t);var u=Wa(t);if(c_.insert(e,u),e||n){if(e===n)return Va(e),n=Wa(e.site),c_.insert(u,n),u.edge=n.edge=Ia(e.site,u.site),Xa(e),void Xa(n);if(!n)return void(u.edge=Ia(e.site,u.site));Va(e),Va(n);var c=e.site,l=c[0],h=c[1],f=t[0]-l,p=t[1]-h,d=n.site,m=d[0]-l,v=d[1]-h,g=2*(f*v-p*m),y=f*f+p*p,_=m*m+v*v,x=[(v*y-p*_)/g+l,(f*_-m*y)/g+h];Na(n.edge,c,d,x),u.edge=Ia(c,t,null,x),n.edge=Ia(t,d,null,x),Xa(e),Xa(n)}}function Ja(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var a=t.P;if(!a)return-(1/0);n=a.site;var s=n[0],u=n[1],c=u-e;if(!c)return s;var l=s-i,h=1/o-1/c,f=l/c;return h?(-f+Math.sqrt(f*f-2*h*(l*l/(-2*c)-u+c/2+r-o/2)))/h+i:(i+s)/2}function Ka(t,e){var n=t.N;if(n)return Ja(n,e);var i=t.site;return i[1]===e?i[0]:1/0}function Qa(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function ts(t,e){return e[1]-t[1]||e[0]-t[0]}function es(t,e){var n,i,r,o=t.sort(ts).pop();for(f_=[],l_=new Array(t.length),c_=new Sa,h_=new Sa;;)if(r=u_,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(Za(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;$a(r.arc)}if(Ga(),e){var a=+e[0][0],s=+e[0][1],u=+e[1][0],c=+e[1][1];Ba(a,s,u,c),Ha(a,s,u,c)}this.edges=f_,this.cells=l_,c_=h_=f_=l_=null}function ns(t,e,n){this.target=t,this.type=e,this.transform=n}function is(t,e,n){this.k=t,this.x=e,this.y=n}function rs(t){return t.__zoom||__}function os(){t.event.stopImmediatePropagation()}function as(){return!t.event.button}function ss(){var t,e,n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,t=n.width.baseVal.value,e=n.height.baseVal.value):(t=n.clientWidth,e=n.clientHeight),[[0,0],[t,e]]}function us(){return this.__zoom||__}function cs(){t.event.stopImmediatePropagation()}function ls(t){return{type:t}}function hs(){return!t.event.button}function fs(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function ps(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function ds(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ms(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function vs(){return ys(C_)}function gs(){return ys(L_)}function ys(e){function n(t){var n=t.property("__brush",s).selectAll(".overlay").data([ls("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",R_.overlay).merge(n).each(function(){var t=ps(this).extent;bg(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([ls("selection")]).enter().append("rect").attr("class","selection").attr("cursor",R_.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return R_[t.type]}),t.each(i).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",a)}function i(){var t=bg(this),e=ps(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-f/2:e[0][0]-f/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-f/2:e[0][1]-f/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+f:f}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+f:f})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function r(t,e){return t.__brush.emitter||new o(t,e)}function o(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function a(){function n(){var t=kv(E);!B||w||M||(Math.abs(t[0]-F[0])>Math.abs(t[1]-F[1])?M=!0:w=!0),F=t,b=!0,E_(),o()}function o(){var t;switch(_=F[0]-U[0],x=F[1]-U[1],S){case S_:case T_:P&&(_=Math.max(R-h,Math.min(O-m,_)),f=h+_,v=m+_),A&&(x=Math.max(N-p,Math.min(D-g,x)),d=p+x,y=g+x);break;case P_:P<0?(_=Math.max(R-h,Math.min(O-h,_)),f=h+_,v=m):P>0&&(_=Math.max(R-m,Math.min(O-m,_)),f=h,v=m+_),A<0?(x=Math.max(N-p,Math.min(D-p,x)),d=p+x,y=g):A>0&&(x=Math.max(N-g,Math.min(D-g,x)),d=p,y=g+x);break;case A_:P&&(f=Math.max(R,Math.min(O,h-_*P)),v=Math.max(R,Math.min(O,m+_*P))),A&&(d=Math.max(N,Math.min(D,p-x*A)),y=Math.max(N,Math.min(D,g+x*A)))}v<f&&(P*=-1,t=h,h=m,m=t,t=f,f=v,v=t,T in N_&&G.attr("cursor",R_[T=N_[T]])),y<d&&(A*=-1,t=p,p=g,g=t,t=d,d=y,y=t,T in O_&&G.attr("cursor",R_[T=O_[T]])),C.selection&&(I=C.selection),w&&(f=I[0][0],v=I[1][0]),M&&(d=I[0][1],y=I[1][1]),I[0][0]===f&&I[0][1]===d&&I[1][0]===v&&I[1][1]===y||(C.selection=[[f,d],[v,y]],i.call(E),k.brush())}function a(){if(cs(),t.event.touches){if(t.event.touches.length)return;u&&clearTimeout(u),u=setTimeout(function(){u=null},500),z.on("touchmove.brush touchend.brush touchcancel.brush",null)}else _a(t.event.view,b),H.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);z.attr("pointer-events","all"),G.attr("cursor",R_.overlay),C.selection&&(I=C.selection),ds(I)&&(C.selection=null,i.call(E)),k.end()}function s(){switch(t.event.keyCode){case 16:B=P&&A;break;case 18:S===P_&&(P&&(m=v-_*P,h=f+_*P),A&&(g=y-x*A,p=d+x*A),S=A_,o());break;case 32:S!==P_&&S!==A_||(P<0?m=v-_:P>0&&(h=f-_),A<0?g=y-x:A>0&&(p=d-x),S=S_,G.attr("cursor",R_.selection),o());break;default:return}E_()}function c(){switch(t.event.keyCode){case 16:B&&(w=M=B=!1,o());break;case 18:S===A_&&(P<0?m=v:P>0&&(h=f),A<0?g=y:A>0&&(p=d),S=P_,o());break;case 32:S===S_&&(t.event.altKey?(P&&(m=v-_*P,h=f+_*P),A&&(g=y-x*A,p=d+x*A),S=A_):(P<0?m=v:P>0&&(h=f),A<0?g=y:A>0&&(p=d),S=P_),G.attr("cursor",R_[T]),o());break;default:return}E_()}if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return E_()}else if(u)return;if(l.apply(this,arguments)){var h,f,p,d,m,v,g,y,_,x,b,w,M,E=this,T=t.event.target.__data__.type,S="selection"===(t.event.metaKey?T="overlay":T)?T_:t.event.altKey?A_:P_,P=e===L_?null:D_[T],A=e===C_?null:B_[T],C=ps(E),L=C.extent,I=C.selection,R=L[0][0],N=L[0][1],O=L[1][0],D=L[1][1],B=P&&A&&t.event.shiftKey,U=kv(E),F=U,k=r(E,arguments).beforestart();"overlay"===T?C.selection=I=[[h=e===L_?R:U[0],p=e===C_?N:U[1]],[m=e===L_?O:h,g=e===C_?D:p]]:(h=I[0][0],p=I[0][1],m=I[1][0],g=I[1][1]),f=h,d=p,v=m,y=g;var z=bg(E).attr("pointer-events","none"),G=z.selectAll(".overlay").attr("cursor",R_[T]);if(t.event.touches)z.on("touchmove.brush",n,!0).on("touchend.brush touchcancel.brush",a,!0);else{var H=bg(t.event.view).on("keydown.brush",s,!0).on("keyup.brush",c,!0).on("mousemove.brush",n,!0).on("mouseup.brush",a,!0);r_(t.event.view)}cs(),Dg(E),i.call(E),k.start()}}function s(){var t=this.__brush||{selection:null};return t.extent=c.apply(this,arguments),t.dim=e,t}var u,c=fs,l=hs,h=Ie(n,"start","brush","end"),f=6;return n.move=function(t,n){t.selection?t.on("start.brush",function(){r(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){r(this,arguments).end()}).tween("brush",function(){function t(t){a.selection=1===t&&ds(c)?null:l(t),i.call(o),s.brush()}var o=this,a=o.__brush,s=r(o,arguments),u=a.selection,c=e.input("function"==typeof n?n.apply(this,arguments):n,a.extent),l=_p(u,c);return u&&c?t:t(1)}):t.each(function(){var t=this,o=arguments,a=t.__brush,s=e.input("function"==typeof n?n.apply(t,o):n,a.extent),u=r(t,o).beforestart();Dg(t),a.selection=null==s||ds(s)?null:s,i.call(t),u.start().brush().end()})},o.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0===--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){Vi(new M_(n,t,e.output(this.state.selection)),h.apply,h,[t,this.that,this.args])}},n.extent=function(t){return arguments.length?(c="function"==typeof t?t:w_([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),n):c},n.filter=function(t){return arguments.length?(l="function"==typeof t?t:w_(!!t),n):l},n.handleSize=function(t){return arguments.length?(f=+t,n):f},n.on=function(){var t=h.on.apply(h,arguments);return t===h?n:t},n}function _s(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function xs(t){return t.source}function bs(t){return t.target}function ws(t){return t.radius}function Ms(t){return t.startAngle}function Es(t){return t.endAngle}function Ts(){this.reset()}function Ss(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}function Ps(t){return t>1?0:t<-1?Cx:Math.acos(t)}function As(t){return t>1?Lx:t<-1?-Lx:Math.asin(t)}function Cs(t){return(t=jx(t/2))*t}function Ls(){}function Is(t,e){t&&qx.hasOwnProperty(t.type)&&qx[t.type](t,e)}function Rs(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Ns(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Rs(t[n],e,1);e.polygonEnd()}function Os(){Kx.point=Bs}function Ds(){Us($_,Z_)}function Bs(t,e){Kx.point=Us,$_=t,Z_=e,t*=Ox,e*=Ox,J_=t,K_=Fx(e=e/2+Ix),Q_=jx(e)}function Us(t,e){t*=Ox,e*=Ox,e=e/2+Ix;var n=t-J_,i=n>=0?1:-1,r=i*n,o=Fx(e),a=jx(e),s=Q_*a,u=K_*o+s*Fx(r),c=s*i*jx(r);Zx.add(Ux(c,u)),J_=t,K_=o,Q_=a}function Fs(t){return[Ux(t[1],t[0]),As(t[2])]}function ks(t){var e=t[0],n=t[1],i=Fx(n);return[i*Fx(e),i*jx(e),jx(n)]}function zs(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Gs(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Hs(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function js(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Xs(t){var e=Vx(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Vs(t,e){ux.push(cx=[tx=t,nx=t]),e<ex&&(ex=e),e>ix&&(ix=e)}function Ys(t,e){var n=ks([t*Ox,e*Ox]);if(sx){var i=Gs(sx,n),r=[i[1],-i[0],0],o=Gs(r,i);Xs(o),o=Fs(o);var a,s=t-rx,u=s>0?1:-1,c=o[0]*Nx*u,l=Dx(s)>180;l^(u*rx<c&&c<u*t)?(a=o[1]*Nx,a>ix&&(ix=a)):(c=(c+360)%360-180,l^(u*rx<c&&c<u*t)?(a=-o[1]*Nx,a<ex&&(ex=a)):(e<ex&&(ex=e),e>ix&&(ix=e))),l?t<rx?Ks(tx,t)>Ks(tx,nx)&&(nx=t):Ks(t,nx)>Ks(tx,nx)&&(tx=t):nx>=tx?(t<tx&&(tx=t),t>nx&&(nx=t)):t>rx?Ks(tx,t)>Ks(tx,nx)&&(nx=t):Ks(t,nx)>Ks(tx,nx)&&(tx=t)}else Vs(t,e);sx=n,rx=t}function Ws(){eb.point=Ys}function qs(){cx[0]=tx,cx[1]=nx,eb.point=Vs,sx=null}function $s(t,e){if(sx){var n=t-rx;tb.add(Dx(n)>180?n+(n>0?360:-360):n)}else ox=t,ax=e;Kx.point(t,e),Ys(t,e)}function Zs(){Kx.lineStart()}function Js(){$s(ox,ax),Kx.lineEnd(),Dx(tb)>Px&&(tx=-(nx=180)),cx[0]=tx,cx[1]=nx,sx=null}function Ks(t,e){return(e-=t)<0?e+360:e}function Qs(t,e){return t[0]-e[0]}function tu(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function eu(t,e){t*=Ox,e*=Ox;var n=Fx(e);nu(n*Fx(t),n*jx(t),jx(e))}function nu(t,e,n){++lx,fx+=(t-fx)/lx,px+=(e-px)/lx,dx+=(n-dx)/lx}function iu(){ib.point=ru}function ru(t,e){t*=Ox,e*=Ox;var n=Fx(e);Mx=n*Fx(t),Ex=n*jx(t),Tx=jx(e),ib.point=ou,nu(Mx,Ex,Tx)}function ou(t,e){t*=Ox,e*=Ox;var n=Fx(e),i=n*Fx(t),r=n*jx(t),o=jx(e),a=Ux(Vx((a=Ex*o-Tx*r)*a+(a=Tx*i-Mx*o)*a+(a=Mx*r-Ex*i)*a),Mx*i+Ex*r+Tx*o);hx+=a,mx+=a*(Mx+(Mx=i)),vx+=a*(Ex+(Ex=r)),gx+=a*(Tx+(Tx=o)),nu(Mx,Ex,Tx)}function au(){ib.point=eu}function su(){ib.point=cu}function uu(){lu(bx,wx),ib.point=eu}function cu(t,e){bx=t,wx=e,t*=Ox,e*=Ox,ib.point=lu;var n=Fx(e);Mx=n*Fx(t),Ex=n*jx(t),Tx=jx(e),nu(Mx,Ex,Tx)}function lu(t,e){t*=Ox,e*=Ox;var n=Fx(e),i=n*Fx(t),r=n*jx(t),o=jx(e),a=Ex*o-Tx*r,s=Tx*i-Mx*o,u=Mx*r-Ex*i,c=Vx(a*a+s*s+u*u),l=Mx*i+Ex*r+Tx*o,h=c&&-Ps(l)/c,f=Ux(c,l);yx+=h*a,_x+=h*s,xx+=h*u,hx+=f,mx+=f*(Mx+(Mx=i)),vx+=f*(Ex+(Ex=r)),gx+=f*(Tx+(Tx=o)),nu(Mx,Ex,Tx)}function hu(t,e){return[t>Cx?t-Rx:t<-Cx?t+Rx:t,e]}function fu(t,e,n){return(t%=Rx)?e||n?ab(du(t),mu(e,n)):du(t):e||n?mu(e,n):hu}function pu(t){return function(e,n){return e+=t,[e>Cx?e-Rx:e<-Cx?e+Rx:e,n]}}function du(t){var e=pu(t);return e.invert=pu(-t),e}function mu(t,e){function n(t,e){var n=Fx(e),s=Fx(t)*n,u=jx(t)*n,c=jx(e),l=c*i+s*r;return[Ux(u*o-l*a,s*i-c*r),As(l*o+u*a)]}var i=Fx(t),r=jx(t),o=Fx(e),a=jx(e);return n.invert=function(t,e){var n=Fx(e),s=Fx(t)*n,u=jx(t)*n,c=jx(e),l=c*o-u*a;return[Ux(u*o+c*a,s*i+l*r),As(l*i-s*r)]},n}function vu(t,e,n,i,r,o){if(n){var a=Fx(e),s=jx(e),u=i*n;null==r?(r=e+i*Rx,o=e-u/2):(r=gu(a,r),o=gu(a,o),(i>0?r<o:r>o)&&(r+=i*Rx));for(var c,l=r;i>0?l>o:l<o;l-=u)c=Fs([a,-s*Fx(l),-s*jx(l)]),t.point(c[0],c[1])}}function gu(t,e){e=ks(e),e[0]-=t,Xs(e);var n=Ps(-e[1]);return((-e[2]<0?-n:n)+Rx-Px)%Rx}function yu(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function _u(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function xu(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,s,c){var l=0,h=0;if(null==r||(l=a(r,s))!==(h=a(o,s))||u(r,o)<0^s>0){do c.point(0===l||3===l?t:n,l>1?i:e);while((l=(l+s+4)%4)!==h)}else c.point(o[0],o[1])}function a(i,r){return Dx(i[0]-t)<Px?r>0?0:3:Dx(i[0]-n)<Px?r>0?2:1:Dx(i[1]-e)<Px?r>0?1:0:r>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),i=a(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){function u(t,e){r(t,e)&&S.point(t,e)}function c(){for(var e=0,n=0,r=v.length;n<r;++n)for(var o,a,s=v[n],u=1,c=s.length,l=s[0],h=l[0],f=l[1];u<c;++u)o=h,a=f,l=s[u],h=l[0],f=l[1],a<=i?f>i&&(h-o)*(i-a)>(f-a)*(t-o)&&++e:f<=i&&(h-o)*(i-a)<(f-a)*(t-o)&&--e;return e}function l(){S=P,m=[],v=[],T=!0}function h(){var t=c(),e=T&&t,n=(m=Jc(m)).length;(e||n)&&(a.polygonStart(),e&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),n&&Mb(m,s,t,o,a),a.polygonEnd()),S=a,m=v=g=null}function f(){A.point=d,v&&v.push(g=[]),E=!0,M=!1,b=w=NaN}function p(){m&&(d(y,_),x&&M&&P.rejoin(),m.push(P.result())),A.point=u,M&&S.lineEnd()}function d(o,a){var s=r(o,a);if(v&&g.push([o,a]),E)y=o,_=a,x=s,E=!1,s&&(S.lineStart(),S.point(o,a));else if(s&&M)S.point(o,a);else{var u=[b=Math.max(Tb,Math.min(Eb,b)),w=Math.max(Tb,Math.min(Eb,w))],c=[o=Math.max(Tb,Math.min(Eb,o)),a=Math.max(Tb,Math.min(Eb,a))];bb(u,c,t,e,n,i)?(M||(S.lineStart(),S.point(u[0],u[1])),S.point(c[0],c[1]),s||S.lineEnd(),T=!1):s&&(S.lineStart(),S.point(o,a),T=!1)}b=o,w=a,M=s}var m,v,g,y,_,x,b,w,M,E,T,S=a,P=xb(),A={point:u,lineStart:f,lineEnd:p,polygonStart:l,polygonEnd:h};return A}}function bu(){Ab.point=Mu,Ab.lineEnd=wu}function wu(){Ab.point=Ab.lineEnd=Ls}function Mu(t,e){t*=Ox,e*=Ox,sb=t,ub=jx(e),cb=Fx(e),Ab.point=Eu}function Eu(t,e){t*=Ox,e*=Ox;var n=jx(e),i=Fx(e),r=Dx(t-sb),o=Fx(r),a=jx(r),s=i*a,u=cb*n-ub*i*o,c=ub*n+cb*i*o;Pb.add(Ux(Vx(s*s+u*u),c)),sb=t,ub=n,cb=i}function Tu(t,e,n){var i=Fc(t,e-Px,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Su(t,e,n){var i=Fc(t,e-Px,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Pu(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Fc(kx(o/v)*v,r,v).map(f).concat(Fc(kx(c/g)*g,u,g).map(p)).concat(Fc(kx(i/d)*d,n,d).filter(function(t){return Dx(t%v)>Px}).map(l)).concat(Fc(kx(s/m)*m,a,m).filter(function(t){return Dx(t%g)>Px}).map(h))}var n,i,r,o,a,s,u,c,l,h,f,p,d=10,m=d,v=90,g=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(p(u).slice(1),f(r).reverse().slice(1),p(c).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.extentMajor(e).extentMinor(e):t.extentMinor()},t.extentMajor=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],c=+e[0][1],u=+e[1][1],o>r&&(e=o,o=r,r=e),c>u&&(e=c,c=u,u=e),t.precision(y)):[[o,c],[r,u]]},t.extentMinor=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],i>n&&(e=i,i=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(y)):[[i,s],[n,a]]},t.step=function(e){return arguments.length?t.stepMajor(e).stepMinor(e):t.stepMinor()},t.stepMajor=function(e){return arguments.length?(v=+e[0],g=+e[1],t):[v,g]},t.stepMinor=function(e){return arguments.length?(d=+e[0],m=+e[1],t):[d,m]},t.precision=function(e){return arguments.length?(y=+e,l=Tu(s,a,90),h=Su(i,n,y),f=Tu(c,u,90),p=Su(o,r,y),t):y},t.extentMajor([[-180,-90+Px],[180,90-Px]]).extentMinor([[-180,-80-Px],[180,80+Px]])}function Au(){return Pu()()}function Cu(){Ub.point=Lu}function Lu(t,e){Ub.point=Iu,lb=fb=t,hb=pb=e}function Iu(t,e){Bb.add(pb*t-fb*e),fb=t,pb=e}function Ru(){Iu(lb,hb)}function Nu(t,e){t<Fb&&(Fb=t),t>zb&&(zb=t),e<kb&&(kb=e),e>Gb&&(Gb=e)}function Ou(t,e){jb+=t,Xb+=e,++Vb}function Du(){Kb.point=Bu}function Bu(t,e){Kb.point=Uu,Ou(vb=t,gb=e)}function Uu(t,e){var n=t-vb,i=e-gb,r=Vx(n*n+i*i);Yb+=r*(vb+t)/2,Wb+=r*(gb+e)/2,qb+=r,Ou(vb=t,gb=e)}function Fu(){Kb.point=Ou}function ku(){Kb.point=Gu}function zu(){Hu(db,mb)}function Gu(t,e){Kb.point=Hu,Ou(db=vb=t,mb=gb=e)}function Hu(t,e){var n=t-vb,i=e-gb,r=Vx(n*n+i*i);Yb+=r*(vb+t)/2,Wb+=r*(gb+e)/2,qb+=r,r=gb*t-vb*e,$b+=r*(vb+t),Zb+=r*(gb+e),Jb+=3*r,Ou(vb=t,gb=e)}function ju(t){this._context=t}function Xu(){this._string=[]}function Vu(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Yu(t){return t.length>1}function Wu(t,e){return((t=t.x)[0]<0?t[1]-Lx-Px:Lx-t[1])-((e=e.x)[0]<0?e[1]-Lx-Px:Lx-e[1])}function qu(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Cx:-Cx,u=Dx(o-n);Dx(u-Cx)<Px?(t.point(n,i=(i+a)/2>0?Lx:-Lx),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&u>=Cx&&(Dx(n-r)<Px&&(n-=r*Px),Dx(o-s)<Px&&(o-=s*Px),i=$u(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}function $u(t,e,n,i){var r,o,a=jx(t-n);return Dx(a)>Px?Bx((jx(e)*(o=Fx(i))*jx(n)-jx(i)*(r=Fx(e))*jx(t))/(r*o*a)):(e+i)/2}function Zu(t,e,n,i){var r;if(null==t)r=n*Lx,i.point(-Cx,r),i.point(0,r),i.point(Cx,r),i.point(Cx,0),i.point(Cx,-r),i.point(0,-r),i.point(-Cx,-r),i.point(-Cx,0),i.point(-Cx,r);else if(Dx(t[0]-e[0])>Px){var o=t[0]<e[0]?Cx:-Cx;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}function Ju(t){return function(e){var n=new Ku;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Ku(){}function Qu(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),$x(n,t.stream(Hb));var a=Hb.result(),s=Math.min(i/(a[1][0]-a[0][0]),r/(a[1][1]-a[0][1])),u=+e[0][0]+(i-s*(a[1][0]+a[0][0]))/2,c=+e[0][1]+(r-s*(a[1][1]+a[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*s).translate([u,c])}function tc(t,e,n){return Qu(t,[[0,0],e],n)}function ec(t){return Ju({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function nc(t,e){function n(i,r,o,a,s,u,c,l,h,f,p,d,m,v){var g=c-i,y=l-r,_=g*g+y*y;if(_>4*e&&m--){var x=a+f,b=s+p,w=u+d,M=Vx(x*x+b*b+w*w),E=As(w/=M),T=Dx(Dx(w)-1)<Px||Dx(o-h)<Px?(o+h)/2:Ux(b,x),S=t(T,E),P=S[0],A=S[1],C=P-i,L=A-r,I=y*C-g*L;(I*I/_>e||Dx((g*C+y*L)/_-.5)>.3||a*f+s*p+u*d<sw)&&(n(i,r,o,a,s,u,P,A,T,x/=M,b/=M,w,m,v),v.point(P,A),n(P,A,T,x,b,w,c,l,h,f,p,d,m,v))}}return function(e){function i(n,i){n=t(n,i),e.point(n[0],n[1])}function r(){g=NaN,w.point=o,e.lineStart()}function o(i,r){var o=ks([i,r]),a=t(i,r);n(g,y,v,_,x,b,g=a[0],y=a[1],v=i,_=o[0],x=o[1],b=o[2],aw,e),e.point(g,y)}function a(){w.point=i,e.lineEnd()}function s(){r(),w.point=u,w.lineEnd=c}function u(t,e){o(l=t,e),h=g,f=y,p=_,d=x,m=b,w.point=o}function c(){n(g,y,v,_,x,b,h,f,l,p,d,m,aw,e),w.lineEnd=a,a()}var l,h,f,p,d,m,v,g,y,_,x,b,w={point:i,lineStart:r,lineEnd:a,polygonStart:function(){e.polygonStart(),w.lineStart=s},polygonEnd:function(){e.polygonEnd(),w.lineStart=r}};return w}}function ic(t){return rc(function(){return t})()}function rc(t){function e(t){return t=l(t[0]*Ox,t[1]*Ox),[t[0]*v+s,u-t[1]*v]}function n(t){return t=l.invert((t[0]-s)/v,(u-t[1])/v),t&&[t[0]*Nx,t[1]*Nx]}function i(t,e){return t=a(t,e),[t[0]*v+s,u-t[1]*v]}function r(){l=ab(c=fu(b,w,M),a);var t=a(_,x);return s=g-t[0]*v,u=y+t[1]*v,o()}function o(){return d=m=null,e}var a,s,u,c,l,h,f,p,d,m,v=150,g=480,y=250,_=0,x=0,b=0,w=0,M=0,E=null,T=iw,S=null,P=Ob,A=.5,C=uw(i,A);return e.stream=function(t){return d&&m===t?d:d=cw(T(c,C(P(m=t))))},e.clipAngle=function(t){return arguments.length?(T=+t?rw(E=t*Ox,6*Ox):(E=null,iw),o()):E*Nx},e.clipExtent=function(t){return arguments.length?(P=null==t?(S=h=f=p=null,Ob):xu(S=+t[0][0],h=+t[0][1],f=+t[1][0],p=+t[1][1]),o()):null==S?null:[[S,h],[f,p]]},e.scale=function(t){return arguments.length?(v=+t,r()):v},e.translate=function(t){return arguments.length?(g=+t[0],y=+t[1],r()):[g,y]},e.center=function(t){return arguments.length?(_=t[0]%360*Ox,x=t[1]%360*Ox,r()):[_*Nx,x*Nx]},e.rotate=function(t){return arguments.length?(b=t[0]%360*Ox,w=t[1]%360*Ox,M=t.length>2?t[2]%360*Ox:0,r()):[b*Nx,w*Nx,M*Nx]},e.precision=function(t){return arguments.length?(C=uw(i,A=t*t),o()):Vx(A)},e.fitExtent=function(t,n){return Qu(e,t,n)},e.fitSize=function(t,n){return tc(e,t,n)},function(){return a=t.apply(this,arguments),e.invert=a.invert&&n,r()}}function oc(t){var e=0,n=Cx/3,i=rc(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Ox,n=t[1]*Ox):[e*Nx,n*Nx]},r}function ac(t){function e(t,e){return[t*n,jx(e)/n]}var n=Fx(t);return e.invert=function(t,e){return[t/n,As(e*n)]},e}function sc(t,e){function n(t,e){var n=Vx(o-2*r*jx(e))/r;return[n*jx(t*=r),a-n*Fx(t)]}var i=jx(t),r=(i+jx(e))/2;if(Dx(r)<Px)return ac(t);var o=1+i*(2*r-i),a=Vx(o)/r;return n.invert=function(t,e){var n=a-e;return[Ux(t,Dx(n))/r*Xx(n),As((o-(t*t+n*n)*r*r)/(2*r))]},n}function uc(t){var e=t.length;return{point:function(n,i){for(var r=-1;++r<e;)t[r].point(n,i)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function cc(t){return function(e,n){var i=Fx(e),r=Fx(n),o=t(i*r);return[o*r*jx(e),o*jx(n)]}}function lc(t){return function(e,n){var i=Vx(e*e+n*n),r=t(i),o=jx(r),a=Fx(r);return[Ux(e*o,i*a),As(i&&n*o/i)]}}function hc(t,e){return[t,Gx(Yx((Lx+e)/2))]}function fc(t){var e,n=ic(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(t){return arguments.length?(i(t),e&&n.clipExtent(null),n):i()},n.translate=function(t){return arguments.length?(r(t),e&&n.clipExtent(null),n):r()},n.clipExtent=function(t){if(!arguments.length)return e?null:o();if(e=null==t){var a=Cx*i(),s=r();t=[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]}return o(t),n},n.clipExtent(null)}function pc(t){return Yx((Lx+t)/2)}function dc(t,e){function n(t,e){o>0?e<-Lx+Px&&(e=-Lx+Px):e>Lx-Px&&(e=Lx-Px);var n=o/Hx(pc(e),r);return[n*jx(r*t),o-n*Fx(r*t)]}var i=Fx(t),r=t===e?jx(t):Gx(i/Fx(e))/Gx(pc(e)/pc(t)),o=i*Hx(pc(t),r)/r;return r?(n.invert=function(t,e){var n=o-e,i=Xx(r)*Vx(t*t+n*n);return[Ux(t,Dx(n))/r*Xx(n),2*Bx(Hx(o/i,1/r))-Lx]},n):hc}function mc(t,e){return[t,e]}function vc(t,e){function n(t,e){var n=o-e,i=r*t;return[n*jx(i),o-n*Fx(i)]}var i=Fx(t),r=t===e?jx(t):(i-Fx(e))/(e-t),o=i/r+t;return Dx(r)<Px?mc:(n.invert=function(t,e){var n=o-e;return[Ux(t,Dx(n))/r*Xx(n),o-Xx(r)*Vx(t*t+n*n)]},n)}function gc(t,e){var n=Fx(e),i=Fx(t)*n;return[n*jx(t)/i,jx(e)/i]}function yc(t,e,n,i){return 1===t&&1===e&&0===n&&0===i?Ob:Ju({point:function(r,o){this.stream.point(r*t+n,o*e+i)}})}function _c(t,e){return[Fx(e)*jx(t),jx(e)]}function xc(t,e){var n=Fx(e),i=1+Fx(t)*n;return[n*jx(t)/i,jx(e)/i]}function bc(t,e){return[Gx(Yx((Lx+e)/2)),-t]}var wc="4.4.0",Mc=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Ec=function(t){return 1===t.length&&(t=e(t)),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}},Tc=Ec(Mc),Sc=Tc.right,Pc=Tc.left,Ac=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Cc=function(t){return null===t?NaN:+t;
},Lc=function(t,e){var n,i,r=t.length,o=0,a=0,s=-1,u=0;if(null==e)for(;++s<r;)isNaN(n=Cc(t[s]))||(i=n-o,o+=i/++u,a+=i*(n-o));else for(;++s<r;)isNaN(n=Cc(e(t[s],s,t)))||(i=n-o,o+=i/++u,a+=i*(n-o));if(u>1)return a/(u-1)},Ic=function(t,e){var n=Lc(t,e);return n?Math.sqrt(n):n},Rc=function(t,e){var n,i,r,o=-1,a=t.length;if(null==e){for(;++o<a;)if(null!=(i=t[o])&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=t[o])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++o<a;)if(null!=(i=e(t[o],o,t))&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=e(t[o],o,t))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},Nc=Array.prototype,Oc=Nc.slice,Dc=Nc.map,Bc=function(t){return function(){return t}},Uc=function(t){return t},Fc=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o},kc=Math.sqrt(50),zc=Math.sqrt(10),Gc=Math.sqrt(2),Hc=function(t,e,i){var r=n(t,e,i);return Fc(Math.ceil(t/r)*r,Math.floor(e/r)*r+r/2,r)},jc=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},Xc=function(){function t(t){var r,o,a=t.length,s=new Array(a);for(r=0;r<a;++r)s[r]=e(t[r],r,t);var u=n(s),c=u[0],l=u[1],h=i(s,c,l);Array.isArray(h)||(h=Hc(c,l,h));for(var f=h.length;h[0]<=c;)h.shift(),--f;for(;h[f-1]>=l;)h.pop(),--f;var p,d=new Array(f+1);for(r=0;r<=f;++r)p=d[r]=[],p.x0=r>0?h[r-1]:c,p.x1=r<f?h[r]:l;for(r=0;r<a;++r)o=s[r],c<=o&&o<=l&&d[Sc(h,o,0,f)].push(t[r]);return d}var e=Uc,n=Rc,i=jc;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Bc(n),t):e},t.domain=function(e){return arguments.length?(n="function"==typeof e?e:Bc([e[0],e[1]]),t):n},t.thresholds=function(e){return arguments.length?(i="function"==typeof e?e:Bc(Array.isArray(e)?Oc.call(e):e),t):i},t},Vc=function(t,e,n){if(null==n&&(n=Cc),i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),a=+n(t[o],o,t),s=+n(t[o+1],o+1,t);return a+(s-a)*(r-o)}},Yc=function(t,e,n){return t=Dc.call(t,Cc).sort(Mc),Math.ceil((n-e)/(2*(Vc(t,.75)-Vc(t,.25))*Math.pow(t.length,-1/3)))},Wc=function(t,e,n){return Math.ceil((n-e)/(3.5*Ic(t)*Math.pow(t.length,-1/3)))},qc=function(t,e){var n,i,r=-1,o=t.length;if(null==e){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=e(t[r],r,t))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e(t[r],r,t))&&i>n&&(n=i)}return n},$c=function(t,e){var n,i=0,r=t.length,o=-1,a=r;if(null==e)for(;++o<r;)isNaN(n=Cc(t[o]))?--a:i+=n;else for(;++o<r;)isNaN(n=Cc(e(t[o],o,t)))?--a:i+=n;if(a)return i/a},Zc=function(t,e){var n,i=[],r=t.length,o=-1;if(null==e)for(;++o<r;)isNaN(n=Cc(t[o]))||i.push(n);else for(;++o<r;)isNaN(n=Cc(e(t[o],o,t)))||i.push(n);return Vc(i.sort(Mc),.5)},Jc=function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--a]=i[e];return n},Kc=function(t,e){var n,i,r=-1,o=t.length;if(null==e){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=e(t[r],r,t))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e(t[r],r,t))&&n>i&&(n=i)}return n},Qc=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},tl=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},el=function(t,e){if(n=t.length){var n,i,r=0,o=0,a=t[o];for(e||(e=Mc);++r<n;)(e(i=t[r],a)<0||0!==e(a,a))&&(a=i,o=r);return 0===e(a,a)?o:void 0}},nl=function(t,e,n){for(var i,r,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},il=function(t,e){var n,i=0,r=t.length,o=-1;if(null==e)for(;++o<r;)(n=+t[o])&&(i+=n);else for(;++o<r;)(n=+e(t[o],o,t))&&(i+=n);return i},rl=function(t){if(!(o=t.length))return[];for(var e=-1,n=Kc(t,i),r=new Array(n);++e<n;)for(var o,a=-1,s=r[e]=new Array(o);++a<o;)s[a]=t[a][e];return r},ol=function(){return rl(arguments)},al="$";r.prototype=o.prototype={constructor:r,has:function(t){return al+t in this},get:function(t){return this[al+t]},set:function(t,e){return this[al+t]=e,this},remove:function(t){var e=al+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===al&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===al&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===al&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===al&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===al&&++t;return t},empty:function(){for(var t in this)if(t[0]===al)return!1;return!0},each:function(t){for(var e in this)e[0]===al&&t(this[e],e.slice(1),this)}};var sl=function(){function t(e,r,a,s){if(r>=l.length)return null!=i?i(e):null!=n?e.sort(n):e;for(var u,c,h,f=-1,p=e.length,d=l[r++],m=o(),v=a();++f<p;)(h=m.get(u=d(c=e[f])+""))?h.push(c):m.set(u,[c]);return m.each(function(e,n){s(v,n,t(e,r,a,s))}),v}function e(t,n){if(++n>l.length)return t;var r,o=h[n-1];return null!=i&&n>=l.length?r=t.entries():(r=[],t.each(function(t,i){r.push({key:i,values:e(t,n)})})),null!=o?r.sort(function(t,e){return o(t.key,e.key)}):r}var n,i,r,l=[],h=[];return r={object:function(e){return t(e,0,a,s)},map:function(e){return t(e,0,u,c)},entries:function(n){return e(t(n,0,u,c),0)},key:function(t){return l.push(t),r},sortKeys:function(t){return h[l.length-1]=t,r},sortValues:function(t){return n=t,r},rollup:function(t){return i=t,r}}},ul=o.prototype;l.prototype=h.prototype={constructor:l,has:ul.has,add:function(t){return t+="",this[al+t]=t,this},remove:ul.remove,clear:ul.clear,values:ul.keys,size:ul.size,empty:ul.empty,each:ul.each};var cl=function(t){var e=[];for(var n in t)e.push(n);return e},ll=function(t){var e=[];for(var n in t)e.push(t[n]);return e},hl=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},fl=function(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return Math.random()*e+t}},pl=function(t,e){var n,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var r;if(null!=n)r=n,n=null;else do n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r;while(!i||i>1);return t+e*r*Math.sqrt(-2*Math.log(i)/i)}},dl=function(){var t=pl.apply(this,arguments);return function(){return Math.exp(t())}},ml=function(t){return function(){for(var e=0,n=0;n<t;++n)e+=Math.random();return e}},vl=function(t){var e=ml(t);return function(){return e()/t}},gl=function(t){return function(){return-Math.log(1-Math.random())/t}},yl=3,_l=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(yl),xl=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(yl),bl=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(yl),wl=Math.PI,Ml=wl/2,El=4/11,Tl=6/11,Sl=8/11,Pl=.75,Al=9/11,Cl=10/11,Ll=.9375,Il=21/22,Rl=63/64,Nl=1/El/El,Ol=1.70158,Dl=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(Ol),Bl=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(Ol),Ul=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(Ol),Fl=2*Math.PI,kl=1,zl=.3,Gl=function t(e,n){function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Fl);return i.amplitude=function(e){return t(e,n*Fl)},i.period=function(n){return t(e,n)},i}(kl,zl),Hl=function t(e,n){function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Fl);return i.amplitude=function(e){return t(e,n*Fl)},i.period=function(n){return t(e,n)},i}(kl,zl),jl=function t(e,n){function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Fl);return i.amplitude=function(e){return t(e,n*Fl)},i.period=function(n){return t(e,n)},i}(kl,zl),Xl=function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[1]*r[0]-e[0]*r[1];return o/2},Vl=function(t){for(var e,n,i=-1,r=t.length,o=0,a=0,s=t[r-1],u=0;++i<r;)e=s,s=t[i],u+=n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return u*=3,[o/u,a/u]},Yl=function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])},Wl=function(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),r=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(I),e=0;e<n;++e)r[e]=[i[e][0],-i[e][1]];var o=R(i),a=R(r),s=a[0]===o[0],u=a[a.length-1]===o[o.length-1],c=[];for(e=o.length-1;e>=0;--e)c.push(t[i[o[e]][2]]);for(e=+s;e<a.length-u;++e)c.push(t[i[a[e]][2]]);return c},ql=function(t,e){for(var n,i,r=t.length,o=t[r-1],a=e[0],s=e[1],u=o[0],c=o[1],l=!1,h=0;h<r;++h)o=t[h],n=o[0],i=o[1],i>s!=c>s&&a<(u-n)*(s-i)/(c-i)+n&&(l=!l),u=n,c=i;return l},$l=function(t){for(var e,n,i=-1,r=t.length,o=t[r-1],a=o[0],s=o[1],u=0;++i<r;)e=a,n=s,o=t[i],a=o[0],s=o[1],e-=a,n-=s,u+=Math.sqrt(e*e+n*n);return u},Zl=Math.PI,Jl=2*Zl,Kl=1e-6,Ql=Jl-Kl;N.prototype=O.prototype={constructor:N,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,u=i-e,c=o-t,l=a-e,h=c*c+l*l;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Kl)if(Math.abs(l*s-u*c)>Kl&&r){var f=n-o,p=i-a,d=s*s+u*u,m=f*f+p*p,v=Math.sqrt(d),g=Math.sqrt(h),y=r*Math.tan((Zl-Math.acos((d+h-m)/(2*v*g)))/2),_=y/g,x=y/v;Math.abs(_-1)>Kl&&(this._+="L"+(t+_*c)+","+(e+_*l)),this._+="A"+r+","+r+",0,0,"+ +(l*f>c*p)+","+(this._x1=t+x*s)+","+(this._y1=e+x*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,o){t=+t,e=+e,n=+n;var a=n*Math.cos(i),s=n*Math.sin(i),u=t+a,c=e+s,l=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>Kl||Math.abs(this._y1-c)>Kl)&&(this._+="L"+u+","+c),n&&(h>Ql?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):(h<0&&(h=h%Jl+Jl),this._+="A"+n+","+n+",0,"+ +(h>=Zl)+","+l+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var th=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return D(this.cover(e,n),e,n,t)},eh=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{if(!(n>t||t>r||i>e||e>o))return this;var a,s,u=r-n,c=this._root;switch(s=(e<(i+o)/2)<<1|t<(n+r)/2){case 0:do a=new Array(4),a[s]=c,c=a;while(u*=2,r=n+u,o=i+u,t>r||e>o);break;case 1:do a=new Array(4),a[s]=c,c=a;while(u*=2,n=r-u,o=i+u,n>t||e>o);break;case 2:do a=new Array(4),a[s]=c,c=a;while(u*=2,r=n+u,i=o-u,t>r||i>e);break;case 3:do a=new Array(4),a[s]=c,c=a;while(u*=2,n=r-u,i=o-u,n>t||i>e)}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},nh=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},ih=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},rh=function(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r},oh=function(t,e,n){var i,r,o,a,s,u,c,l=this._x0,h=this._y0,f=this._x1,p=this._y1,d=[],m=this._root;for(m&&d.push(new rh(m,l,h,f,p)),null==n?n=1/0:(l=t-n,h=e-n,f=t+n,p=e+n,n*=n);u=d.pop();)if(!(!(m=u.node)||(r=u.x0)>f||(o=u.y0)>p||(a=u.x1)<l||(s=u.y1)<h))if(m.length){var v=(r+a)/2,g=(o+s)/2;d.push(new rh(m[3],v,g,a,s),new rh(m[2],r,g,v,s),new rh(m[1],v,o,a,g),new rh(m[0],r,o,v,g)),(c=(e>=g)<<1|t>=v)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=u)}else{var y=t-+this._x.call(null,m.data),_=e-+this._y.call(null,m.data),x=y*y+_*_;if(x<n){var b=Math.sqrt(n=x);l=t-b,h=e-b,f=t+b,p=e+b,i=m.data}}return i},ah=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,i,r,o,a,s,u,c,l,h,f,p=this._root,d=this._x0,m=this._y0,v=this._x1,g=this._y1;if(!p)return this;if(p.length)for(;;){if((c=o>=(s=(d+v)/2))?d=s:v=s,(l=a>=(u=(m+g)/2))?m=u:g=u,e=p,!(p=p[h=l<<1|c]))return this;if(!p.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;p.data!==t;)if(i=p,!(p=p.next))return this;return(r=p.next)&&delete p.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[f]=p:this._root=p),this):(this._root=r,this)},sh=function(){return this._root},uh=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},ch=function(t){var e,n,i,r,o,a,s=[],u=this._root;for(u&&s.push(new rh(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,i=e.x0,r=e.y0,o=e.x1,a=e.y1)&&u.length){var c=(i+o)/2,l=(r+a)/2;(n=u[3])&&s.push(new rh(n,c,l,o,a)),(n=u[2])&&s.push(new rh(n,i,l,c,a)),(n=u[1])&&s.push(new rh(n,c,r,o,l)),(n=u[0])&&s.push(new rh(n,i,r,c,l))}return this},lh=function(t){var e,n=[],i=[];for(this._root&&n.push(new rh(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var o,a=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(a+u)/2,h=(s+c)/2;(o=r[0])&&n.push(new rh(o,a,s,l,h)),(o=r[1])&&n.push(new rh(o,l,s,u,h)),(o=r[2])&&n.push(new rh(o,a,h,l,c)),(o=r[3])&&n.push(new rh(o,l,h,u,c))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},hh=function(t){return arguments.length?(this._x=t,this):this._x},fh=function(t){return arguments.length?(this._y=t,this):this._y},ph=z.prototype=G.prototype;ph.copy=function(){var t,e,n=new G(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=H(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=H(e));return n},ph.add=th,ph.addAll=B,ph.cover=eh,ph.data=nh,ph.extent=ih,ph.find=oh,ph.remove=ah,ph.removeAll=U,ph.root=sh,ph.size=uh,ph.visit=ch,ph.visitAfter=lh,ph.x=hh,ph.y=fh;var dh=[].slice,mh={};j.prototype=$.prototype={constructor:j,defer:function(t){if("function"!=typeof t||this._call)throw new Error;if(null!=this._error)return this;var e=dh.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),X(this),this},abort:function(){return null==this._error&&W(this,new Error("abort")),this},await:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=function(e,n){t.apply(null,[e].concat(n))},q(this),this},awaitAll:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=t,q(this),this}};var vh=function(t){return function(){return t}},gh=1e-12,yh=Math.PI,_h=yh/2,xh=2*yh,bh=function(){function t(){var t,c,l=+e.apply(this,arguments),h=+n.apply(this,arguments),f=o.apply(this,arguments)-_h,p=a.apply(this,arguments)-_h,d=Math.abs(p-f),m=p>f;if(u||(u=t=O()),h<l&&(c=h,h=l,l=c),h>gh)if(d>xh-gh)u.moveTo(h*Math.cos(f),h*Math.sin(f)),u.arc(0,0,h,f,p,!m),l>gh&&(u.moveTo(l*Math.cos(p),l*Math.sin(p)),u.arc(0,0,l,p,f,m));else{var v,g,y=f,_=p,x=f,b=p,w=d,M=d,E=s.apply(this,arguments)/2,T=E>gh&&(r?+r.apply(this,arguments):Math.sqrt(l*l+h*h)),S=Math.min(Math.abs(h-l)/2,+i.apply(this,arguments)),P=S,A=S;if(T>gh){var C=et(T/l*Math.sin(E)),L=et(T/h*Math.sin(E));(w-=2*C)>gh?(C*=m?1:-1,x+=C,b-=C):(w=0,x=b=(f+p)/2),(M-=2*L)>gh?(L*=m?1:-1,y+=L,_-=L):(M=0,y=_=(f+p)/2)}var I=h*Math.cos(y),R=h*Math.sin(y),N=l*Math.cos(b),D=l*Math.sin(b);if(S>gh){var B=h*Math.cos(_),U=h*Math.sin(_),F=l*Math.cos(x),k=l*Math.sin(x);if(d<yh){var z=w>gh?nt(I,R,F,k,B,U,N,D):[N,D],G=I-z[0],H=R-z[1],j=B-z[0],X=U-z[1],V=1/Math.sin(Math.acos((G*j+H*X)/(Math.sqrt(G*G+H*H)*Math.sqrt(j*j+X*X)))/2),Y=Math.sqrt(z[0]*z[0]+z[1]*z[1]);P=Math.min(S,(l-Y)/(V-1)),A=Math.min(S,(h-Y)/(V+1))}}M>gh?A>gh?(v=it(F,k,I,R,h,A,m),g=it(B,U,N,D,h,A,m),u.moveTo(v.cx+v.x01,v.cy+v.y01),A<S?u.arc(v.cx,v.cy,A,Math.atan2(v.y01,v.x01),Math.atan2(g.y01,g.x01),!m):(u.arc(v.cx,v.cy,A,Math.atan2(v.y01,v.x01),Math.atan2(v.y11,v.x11),!m),u.arc(0,0,h,Math.atan2(v.cy+v.y11,v.cx+v.x11),Math.atan2(g.cy+g.y11,g.cx+g.x11),!m),u.arc(g.cx,g.cy,A,Math.atan2(g.y11,g.x11),Math.atan2(g.y01,g.x01),!m))):(u.moveTo(I,R),u.arc(0,0,h,y,_,!m)):u.moveTo(I,R),l>gh&&w>gh?P>gh?(v=it(N,D,B,U,l,-P,m),g=it(I,R,F,k,l,-P,m),u.lineTo(v.cx+v.x01,v.cy+v.y01),P<S?u.arc(v.cx,v.cy,P,Math.atan2(v.y01,v.x01),Math.atan2(g.y01,g.x01),!m):(u.arc(v.cx,v.cy,P,Math.atan2(v.y01,v.x01),Math.atan2(v.y11,v.x11),!m),u.arc(0,0,l,Math.atan2(v.cy+v.y11,v.cx+v.x11),Math.atan2(g.cy+g.y11,g.cx+g.x11),m),u.arc(g.cx,g.cy,P,Math.atan2(g.y11,g.x11),Math.atan2(g.y01,g.x01),!m))):u.arc(0,0,l,b,x,m):u.lineTo(N,D)}else u.moveTo(0,0);if(u.closePath(),t)return u=null,t+""||null}var e=Z,n=J,i=vh(0),r=null,o=K,a=Q,s=tt,u=null;return t.centroid=function(){var t=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-yh/2;return[Math.cos(i)*t,Math.sin(i)*t]},t.innerRadius=function(n){return arguments.length?(e="function"==typeof n?n:vh(+n),t):e},t.outerRadius=function(e){return arguments.length?(n="function"==typeof e?e:vh(+e),t):n},t.cornerRadius=function(e){return arguments.length?(i="function"==typeof e?e:vh(+e),t):i},t.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:vh(+e),t):r},t.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:vh(+e),t):o},t.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:vh(+e),t):a},t.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:vh(+e),t):s},t.context=function(e){return arguments.length?(u=null==e?null:e,t):u},t};rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var wh=function(t){return new rt(t)},Mh=function(){function t(t){var s,u,c,l=t.length,h=!1;for(null==r&&(a=o(c=O())),s=0;s<=l;++s)!(s<l&&i(u=t[s],s,t))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(u,s,t),+n(u,s,t));if(c)return a=null,c+""||null}var e=ot,n=at,i=vh(!0),r=null,o=wh,a=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:vh(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:vh(+e),t):n},t.defined=function(e){return arguments.length?(i="function"==typeof e?e:vh(!!e),t):i},t.curve=function(e){return arguments.length?(o=e,null!=r&&(a=o(r)),t):o},t.context=function(e){return arguments.length?(null==e?r=a=null:a=o(r=e),t):r},t},Eh=function(){function t(t){var e,l,h,f,p,d=t.length,m=!1,v=new Array(d),g=new Array(d);for(null==s&&(c=u(p=O())),e=0;e<=d;++e){if(!(e<d&&a(f=t[e],e,t))===m)if(m=!m)l=e,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),h=e-1;h>=l;--h)c.point(v[h],g[h]);c.lineEnd(),c.areaEnd()}m&&(v[e]=+n(f,e,t),g[e]=+r(f,e,t),c.point(i?+i(f,e,t):v[e],o?+o(f,e,t):g[e]))}if(p)return c=null,p+""||null}function e(){return Mh().defined(a).curve(u).context(s)}var n=ot,i=null,r=vh(0),o=at,a=vh(!0),s=null,u=wh,c=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:vh(+e),i=null,t):n},t.x0=function(e){return arguments.length?(n="function"==typeof e?e:vh(+e),t):n},t.x1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:vh(+e),t):i},t.y=function(e){return arguments.length?(r="function"==typeof e?e:vh(+e),o=null,t):r},t.y0=function(e){return arguments.length?(r="function"==typeof e?e:vh(+e),t):r},t.y1=function(e){return arguments.length?(o=null==e?null:"function"==typeof e?e:vh(+e),t):o},t.lineX0=t.lineY0=function(){return e().x(n).y(r)},t.lineY1=function(){return e().x(n).y(o)},t.lineX1=function(){return e().x(i).y(r)},t.defined=function(e){return arguments.length?(a="function"==typeof e?e:vh(!!e),t):a},t.curve=function(e){return arguments.length?(u=e,null!=s&&(c=u(s)),t):u},t.context=function(e){return arguments.length?(null==e?s=c=null:c=u(s=e),t):s},t},Th=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Sh=function(t){return t},Ph=function(){function t(t){var s,u,c,l,h,f=t.length,p=0,d=new Array(f),m=new Array(f),v=+r.apply(this,arguments),g=Math.min(xh,Math.max(-xh,o.apply(this,arguments)-v)),y=Math.min(Math.abs(g)/f,a.apply(this,arguments)),_=y*(g<0?-1:1);for(s=0;s<f;++s)(h=m[d[s]=s]=+e(t[s],s,t))>0&&(p+=h);for(null!=n?d.sort(function(t,e){return n(m[t],m[e])}):null!=i&&d.sort(function(e,n){return i(t[e],t[n])}),s=0,c=p?(g-f*_)/p:0;s<f;++s,v=l)u=d[s],h=m[u],l=v+(h>0?h*c:0)+_,m[u]={data:t[u],index:s,value:h,startAngle:v,endAngle:l,padAngle:y};return m}var e=Sh,n=Th,i=null,r=vh(0),o=vh(xh),a=vh(0);return t.value=function(n){return arguments.length?(e="function"==typeof n?n:vh(+n),t):e},t.sortValues=function(e){return arguments.length?(n=e,i=null,t):n},t.sort=function(e){return arguments.length?(i=e,n=null,t):i},t.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:vh(+e),t):r},t.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:vh(+e),t):o},t.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:vh(+e),t):a},t},Ah=ut(wh);st.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var Ch=function(){return ct(Mh().curve(Ah))},Lh=function(){var t=Eh().curve(Ah),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return ct(n())},delete t.lineX0,t.lineEndAngle=function(){return ct(i())},delete t.lineX1,t.lineInnerRadius=function(){return ct(r())},delete t.lineY0,t.lineOuterRadius=function(){return ct(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(ut(t)):e()._curve},t},Ih={draw:function(t,e){var n=Math.sqrt(e/yh);t.moveTo(n,0),t.arc(0,0,n,0,xh)}},Rh={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Nh=Math.sqrt(1/3),Oh=2*Nh,Dh={draw:function(t,e){var n=Math.sqrt(e/Oh),i=n*Nh;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},Bh=.8908130915292852,Uh=Math.sin(yh/10)/Math.sin(7*yh/10),Fh=Math.sin(xh/10)*Uh,kh=-Math.cos(xh/10)*Uh,zh={draw:function(t,e){var n=Math.sqrt(e*Bh),i=Fh*n,r=kh*n;t.moveTo(0,-n),t.lineTo(i,r);for(var o=1;o<5;++o){var a=xh*o/5,s=Math.cos(a),u=Math.sin(a);t.lineTo(u*n,-s*n),t.lineTo(s*i-u*r,u*i+s*r)}t.closePath()}},Gh={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},Hh=Math.sqrt(3),jh={draw:function(t,e){var n=-Math.sqrt(e/(3*Hh));t.moveTo(0,2*n),t.lineTo(-Hh*n,-n),t.lineTo(Hh*n,-n),t.closePath()}},Xh=-.5,Vh=Math.sqrt(3)/2,Yh=1/Math.sqrt(12),Wh=3*(Yh/2+1),qh={draw:function(t,e){var n=Math.sqrt(e/Wh),i=n/2,r=n*Yh,o=i,a=n*Yh+n,s=-o,u=a;t.moveTo(i,r),t.lineTo(o,a),t.lineTo(s,u),t.lineTo(Xh*i-Vh*r,Vh*i+Xh*r),t.lineTo(Xh*o-Vh*a,Vh*o+Xh*a),t.lineTo(Xh*s-Vh*u,Vh*s+Xh*u),t.lineTo(Xh*i+Vh*r,Xh*r-Vh*i),t.lineTo(Xh*o+Vh*a,Xh*a-Vh*o),t.lineTo(Xh*s+Vh*u,Xh*u-Vh*s),t.closePath()}},$h=[Ih,Rh,Dh,Gh,zh,jh,qh],Zh=function(){function t(){var t;if(i||(i=t=O()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),t)return i=null,t+""||null}var e=vh(Ih),n=vh(64),i=null;return t.type=function(n){return arguments.length?(e="function"==typeof n?n:vh(n),t):e},t.size=function(e){return arguments.length?(n="function"==typeof e?e:vh(+e),t):n},t.context=function(e){return arguments.length?(i=null==e?null:e,t):i},t},Jh=function(){};ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Kh=function(t){return new ht(t)};ft.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:lt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Qh=function(t){return new ft(t)};pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:lt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var tf=function(t){return new pt(t)};dt.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],o=e[0],a=t[n]-r,s=e[n]-o,u=-1;++u<=n;)i=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(r+i*a),this._beta*e[u]+(1-this._beta)*(o+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var ef=function t(e){function n(t){return 1===e?new ht(t):new dt(t,e)}return n.beta=function(e){return t(+e)},n}(.85);vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:mt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var nf=function t(e){function n(t){return new vt(t,e)}return n.tension=function(e){return t(+e)},n}(0);gt.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var rf=function t(e){function n(t){return new gt(t,e)}return n.tension=function(e){return t(+e)},n}(0);yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var of=function t(e){function n(t){return new yt(t,e)}return n.tension=function(e){return t(+e)},n}(0);xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var af=function t(e){function n(t){return e?new xt(t,e):new vt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);bt.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;
case 2:this._point=3,this._x5=t,this._y5=e;break;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var sf=function t(e){function n(t){return e?new bt(t,e):new gt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var uf=function t(e){function n(t){return e?new wt(t,e):new yt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);Mt.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var cf=function(t){return new Mt(t)};At.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Pt(this,this._t0,St(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Pt(this,St(this,n=Tt(this,t,e)),n);break;default:Pt(this,this._t0,n=Tt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Ct.prototype=Object.create(At.prototype)).point=function(t,e){At.prototype.point.call(this,e,t)},Lt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}},Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=Ot(t),r=Ot(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var lf=function(t){return new Nt(t)};Dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var hf=function(t){return new Dt(t,.5)},ff=Array.prototype.slice,pf=function(t,e){if((i=t.length)>1)for(var n,i,r=1,o=t[e[0]],a=o.length;r<i;++r){n=o,o=t[e[r]];for(var s=0;s<a;++s)o[s][1]+=o[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}},df=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n},mf=function(){function t(t){var o,a,s=e.apply(this,arguments),u=t.length,c=s.length,l=new Array(c);for(o=0;o<c;++o){for(var h,f=s[o],p=l[o]=new Array(u),d=0;d<u;++d)p[d]=h=[0,+r(t[d],f,d,t)],h.data=t[d];p.key=f}for(o=0,a=n(l);o<c;++o)l[a[o]].index=o;return i(l,a),l}var e=vh([]),n=df,i=pf,r=Ft;return t.keys=function(n){return arguments.length?(e="function"==typeof n?n:vh(ff.call(n)),t):e},t.value=function(e){return arguments.length?(r="function"==typeof e?e:vh(+e),t):r},t.order=function(e){return arguments.length?(n=null==e?df:"function"==typeof e?e:vh(ff.call(e)),t):n},t.offset=function(e){return arguments.length?(i=null==e?pf:e,t):i},t},vf=function(t,e){if((i=t.length)>0){for(var n,i,r,o=0,a=t[0].length;o<a;++o){for(r=n=0;n<i;++n)r+=t[n][o][1]||0;if(r)for(n=0;n<i;++n)t[n][o][1]/=r}pf(t,e)}},gf=function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],o=r.length;i<o;++i){for(var a=0,s=0;a<n;++a)s+=t[a][i][1]||0;r[i][1]+=r[i][0]=-s/2}pf(t,e)}},yf=function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,o=0,a=1;a<i;++a){for(var s=0,u=0,c=0;s<r;++s){for(var l=t[e[s]],h=l[a][1]||0,f=l[a-1][1]||0,p=(h-f)/2,d=0;d<s;++d){var m=t[e[d]],v=m[a][1]||0,g=m[a-1][1]||0;p+=v-g}u+=h,c+=p*h}n[a-1][1]+=n[a-1][0]=o,u&&(o-=c/u)}n[a-1][1]+=n[a-1][0]=o,pf(t,e)}},_f=function(t){var e=t.map(kt);return df(t).sort(function(t,n){return e[t]-e[n]})},xf=function(t){return _f(t).reverse()},bf=function(t){var e,n,i=t.length,r=t.map(kt),o=df(t).sort(function(t,e){return r[e]-r[t]}),a=0,s=0,u=[],c=[];for(e=0;e<i;++e)n=o[e],a<s?(a+=r[n],u.push(n)):(s+=r[n],c.push(n));return c.reverse().concat(u)},wf=function(t){return df(t).reverse()},Mf=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},Ef=.7,Tf=1/Ef,Sf="\\s*([+-]?\\d+)\\s*",Pf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Af="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cf=/^#([0-9a-f]{3})$/,Lf=/^#([0-9a-f]{6})$/,If=new RegExp("^rgb\\("+[Sf,Sf,Sf]+"\\)$"),Rf=new RegExp("^rgb\\("+[Af,Af,Af]+"\\)$"),Nf=new RegExp("^rgba\\("+[Sf,Sf,Sf,Pf]+"\\)$"),Of=new RegExp("^rgba\\("+[Af,Af,Af,Pf]+"\\)$"),Df=new RegExp("^hsl\\("+[Pf,Af,Af]+"\\)$"),Bf=new RegExp("^hsla\\("+[Pf,Af,Af,Pf]+"\\)$"),Uf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Mf(Gt,Ht,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Mf(Wt,Yt,zt(Gt,{brighter:function(t){return t=null==t?Tf:Math.pow(Tf,t),new Wt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ef:Math.pow(Ef,t),new Wt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Mf(Jt,Zt,zt(Gt,{brighter:function(t){return t=null==t?Tf:Math.pow(Tf,t),new Jt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ef:Math.pow(Ef,t),new Jt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Wt(Kt(t>=240?t-240:t+120,r,i),Kt(t,r,i),Kt(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Ff=Math.PI/180,kf=180/Math.PI,zf=18,Gf=.95047,Hf=1,jf=1.08883,Xf=4/29,Vf=6/29,Yf=3*Vf*Vf,Wf=Vf*Vf*Vf;Mf(ee,te,zt(Gt,{brighter:function(t){return new ee(this.l+zf*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ee(this.l-zf*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=Hf*ie(t),e=Gf*ie(e),n=jf*ie(n),new Wt(re(3.2404542*e-1.5371385*t-.4985314*n),re(-.969266*e+1.8760108*t+.041556*n),re(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),Mf(ue,se,zt(Gt,{brighter:function(t){return new ue(this.h,this.c,this.l+zf*(null==t?1:t),this.opacity)},darker:function(t){return new ue(this.h,this.c,this.l-zf*(null==t?1:t),this.opacity)},rgb:function(){return Qt(this).rgb()}}));var qf=-.14861,$f=1.78277,Zf=-.29227,Jf=-.90649,Kf=1.97294,Qf=Kf*Jf,tp=Kf*$f,ep=$f*Zf-Jf*qf;Mf(he,le,zt(Gt,{brighter:function(t){return t=null==t?Tf:Math.pow(Tf,t),new he(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ef:Math.pow(Ef,t),new he(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ff,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Wt(255*(e+n*(qf*i+$f*r)),255*(e+n*(Zf*i+Jf*r)),255*(e+n*(Kf*i)),this.opacity)}}));var np,ip,rp,op,ap=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],a=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return fe((n-i/e)*e,a,r,o,s)}},sp=function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],a=t[(i+1)%e],s=t[(i+2)%e];return fe((n-i/e)*e,r,o,a,s)}},up=function(t){return function(){return t}},cp=function t(e){function n(t,e){var n=i((t=Yt(t)).r,(e=Yt(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),a=i(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+""}}var i=ve(e);return n.gamma=t,n}(1),lp=ye(ap),hp=ye(sp),fp=function(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(i),a=new Array(i);for(n=0;n<r;++n)o[n]=_p(t[n],e[n]);for(;n<i;++n)a[n]=e[n];return function(t){for(n=0;n<r;++n)a[n]=o[n](t);return a}},pp=function(t,e){var n=new Date;return t=+t,e-=t,function(i){return n.setTime(t+e*i),n}},dp=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},mp=function(t,e){var n,i={},r={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?i[n]=_p(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},vp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gp=new RegExp(vp.source,"g"),yp=function(t,e){var n,i,r,o=vp.lastIndex=gp.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=vp.exec(t))&&(i=gp.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:dp(n,i)})),o=gp.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?u[0]?xe(u[0].x):_e(e):(e=u.length,function(t){for(var n,i=0;i<e;++i)s[(n=u[i]).i]=n.x(t);return s.join("")})},_p=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?up(e):("number"===i?dp:"string"===i?(n=Ht(e))?(e=n,cp):yp:e instanceof Ht?cp:e instanceof Date?pp:Array.isArray(e)?fp:isNaN(e)?mp:dp)(t,e)},xp=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}},bp=180/Math.PI,wp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Mp=function(t,e,n,i,r,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,u/=s),t*i<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*bp,skewX:Math.atan(u)*bp,scaleX:a,scaleY:s}},Ep=Me(be,"px, ","px)","deg)"),Tp=Me(we,", ",")",")"),Sp=Math.SQRT2,Pp=2,Ap=4,Cp=1e-12,Lp=function(t,e){var n,i,r=t[0],o=t[1],a=t[2],s=e[0],u=e[1],c=e[2],l=s-r,h=u-o,f=l*l+h*h;if(f<Cp)i=Math.log(c/a)/Sp,n=function(t){return[r+t*l,o+t*h,a*Math.exp(Sp*t*i)]};else{var p=Math.sqrt(f),d=(c*c-a*a+Ap*f)/(2*a*Pp*p),m=(c*c-a*a-Ap*f)/(2*c*Pp*p),v=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(m*m+1)-m);i=(g-v)/Sp,n=function(t){var e=t*i,n=Ee(v),s=a/(Pp*p)*(n*Se(Sp*e+v)-Te(v));return[r+s*l,o+s*h,a*n/Ee(Sp*e+v)]}}return n.duration=1e3*i,n},Ip=Pe(me),Rp=Pe(ge),Np=Ce(me),Op=Ce(ge),Dp=Le(me),Bp=Le(ge),Up=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},Fp={value:function(){}};Re.prototype=Ie.prototype={constructor:Re,on:function(t,e){var n,i=this._,r=Ne(t+"",i),o=-1,a=r.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=r[o]).type)i[n]=De(i[n],t.name,e);else if(null==e)for(n in i)i[n]=De(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=r[o]).type)&&(n=Oe(i[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Re(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],o=0,n=i.length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var kp,zp,Gp=function(t){function e(t,e){var i,r,o=n(t,function(t,n){return i?i(t,n-1):(r=t,void(i=e?Ue(t,e):Be(t)))});return o.columns=r,o}function n(t,e){function n(){if(l>=c)return a;if(r)return r=!1,o;var e,n=l;if(34===t.charCodeAt(n)){for(var i=n;i++<c;)if(34===t.charCodeAt(i)){if(34!==t.charCodeAt(i+1))break;++i}return l=i+2,e=t.charCodeAt(i+1),13===e?(r=!0,10===t.charCodeAt(i+2)&&++l):10===e&&(r=!0),t.slice(n+1,i).replace(/""/g,'"')}for(;l<c;){var s=1;if(e=t.charCodeAt(l++),10===e)r=!0;else if(13===e)r=!0,10===t.charCodeAt(l)&&(++l,++s);else if(e!==u)continue;return t.slice(n,l-s)}return t.slice(n)}for(var i,r,o={},a={},s=[],c=t.length,l=0,h=0;(i=n())!==a;){for(var f=[];i!==o&&i!==a;)f.push(i),i=n();e&&null==(f=e(f,h++))||s.push(f)}return s}function i(e,n){return null==n&&(n=Fe(e)),[n.map(a).join(t)].concat(e.map(function(e){return n.map(function(t){return a(e[t])}).join(t)})).join("\n")}function r(t){return t.map(o).join("\n")}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":s.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return{parse:e,parseRows:n,format:i,formatRows:r}},Hp=Gp(","),jp=Hp.parse,Xp=Hp.parseRows,Vp=Hp.format,Yp=Hp.formatRows,Wp=Gp("\t"),qp=Wp.parse,$p=Wp.parseRows,Zp=Wp.format,Jp=Wp.formatRows,Kp=function(t,e){function n(t){var e,n=l.status;if(!n&&ze(l)||n>=200&&n<300||304===n){if(a)try{e=a.call(i,l)}catch(t){return void u.call("error",i,t)}else e=l;u.call("load",i,e)}else u.call("error",i,t)}var i,r,a,s,u=Ie("beforesend","progress","load","error"),c=o(),l=new XMLHttpRequest,h=null,f=null,p=0;if("undefined"==typeof XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=l.ontimeout=n:l.onreadystatechange=function(t){l.readyState>3&&n(t)},l.onprogress=function(t){u.call("progress",i,t)},i={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?c.get(t):(null==e?c.remove(t):c.set(t,e+""),i)},mimeType:function(t){return arguments.length?(r=null==t?null:t+"",i):r},responseType:function(t){return arguments.length?(s=t,i):s},timeout:function(t){return arguments.length?(p=+t,i):p},user:function(t){return arguments.length<1?h:(h=null==t?null:t+"",i)},password:function(t){return arguments.length<1?f:(f=null==t?null:t+"",i)},response:function(t){return a=t,i},get:function(t,e){return i.send("GET",t,e)},post:function(t,e){return i.send("POST",t,e)},send:function(e,n,o){return l.open(e,t,!0,h,f),null==r||c.has("accept")||c.set("accept",r+",*/*"),l.setRequestHeader&&c.each(function(t,e){l.setRequestHeader(e,t)}),null!=r&&l.overrideMimeType&&l.overrideMimeType(r),null!=s&&(l.responseType=s),p>0&&(l.timeout=p),null==o&&"function"==typeof n&&(o=n,n=null),null!=o&&1===o.length&&(o=ke(o)),null!=o&&i.on("error",o).on("load",function(t){o(null,t)}),u.call("beforesend",i,l),l.send(null==n?null:n),i},abort:function(){return l.abort(),i},on:function(){var t=u.on.apply(u,arguments);return t===u?i:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return i.get(e)}return i},Qp=function(t,e){return function(n,i){var r=Kp(n).mimeType(t).response(e);if(null!=i){if("function"!=typeof i)throw new Error("invalid callback: "+i);return r.get(i)}return r}},td=Qp("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),ed=Qp("application/json",function(t){return JSON.parse(t.responseText)}),nd=Qp("text/plain",function(t){return t.responseText}),id=Qp("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e}),rd=function(t,e){return function(n,i,r){arguments.length<3&&(r=i,i=null);var o=Kp(n).mimeType(t);return o.row=function(t){return arguments.length?o.response(Ge(e,i=t)):i},o.row(i),r?o.get(r):o}},od=rd("text/csv",jp),ad=rd("text/tab-separated-values",qp),sd=0,ud=0,cd=0,ld=1e3,hd=0,fd=0,pd=0,dd="object"==typeof performance&&performance.now?performance:Date,md="function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){setTimeout(t,17)};Xe.prototype=Ve.prototype={constructor:Xe,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?He():+n)+(null==e?0:+e),this._next||zp===this||(zp?zp._next=this:kp=this,zp=this),this._call=t,this._time=n,Ze()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ze())}};var vd=function(t,e,n){var i=new Xe;return e=null==e?0:+e,i.restart(function(n){i.stop(),t(n+e)},e,n),i},gd=function(t,e,n){var i=new Xe,r=e;return null==e?(i.restart(t,e,n),i):(e=+e,n=null==n?He():+n,i.restart(function o(a){a+=r,i.restart(o,r+=e,n),t(a)},e,n),i)},yd=new Date,_d=new Date,xd=Je(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});xd.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Je(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):xd:null};var bd=xd.range,wd=1e3,Md=6e4,Ed=36e5,Td=864e5,Sd=6048e5,Pd=Je(function(t){t.setTime(Math.floor(t/wd)*wd)},function(t,e){t.setTime(+t+e*wd)},function(t,e){return(e-t)/wd},function(t){return t.getUTCSeconds()}),Ad=Pd.range,Cd=Je(function(t){t.setTime(Math.floor(t/Md)*Md)},function(t,e){t.setTime(+t+e*Md)},function(t,e){return(e-t)/Md},function(t){return t.getMinutes()}),Ld=Cd.range,Id=Je(function(t){var e=t.getTimezoneOffset()*Md%Ed;e<0&&(e+=Ed),t.setTime(Math.floor((+t-e)/Ed)*Ed+e)},function(t,e){t.setTime(+t+e*Ed)},function(t,e){return(e-t)/Ed},function(t){return t.getHours()}),Rd=Id.range,Nd=Je(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Md)/Td},function(t){return t.getDate()-1}),Od=Nd.range,Dd=Ke(0),Bd=Ke(1),Ud=Ke(2),Fd=Ke(3),kd=Ke(4),zd=Ke(5),Gd=Ke(6),Hd=Dd.range,jd=Bd.range,Xd=Ud.range,Vd=Fd.range,Yd=kd.range,Wd=zd.range,qd=Gd.range,$d=Je(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Zd=$d.range,Jd=Je(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Jd.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Je(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Kd=Jd.range,Qd=Je(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Md)},function(t,e){return(e-t)/Md},function(t){return t.getUTCMinutes()}),tm=Qd.range,em=Je(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*Ed)},function(t,e){return(e-t)/Ed},function(t){return t.getUTCHours()}),nm=em.range,im=Je(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Td},function(t){return t.getUTCDate()-1}),rm=im.range,om=Qe(0),am=Qe(1),sm=Qe(2),um=Qe(3),cm=Qe(4),lm=Qe(5),hm=Qe(6),fm=om.range,pm=am.range,dm=sm.range,mm=um.range,vm=cm.range,gm=lm.range,ym=hm.range,_m=Je(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),xm=_m.range,bm=Je(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});bm.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Je(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var wm,Mm=bm.range,Em=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},Tm=function(t){return t=Em(Math.abs(t)),t?t[1]:NaN},Sm=function(t,e){return function(n,i){for(var r=n.length,o=[],a=0,s=t[0],u=0;r>0&&s>0&&(u+s+1>i&&(s=Math.max(1,i-u)),o.push(n.substring(r-=s,r+s)),!((u+=s+1)>i));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}},Pm=function(t,e){t=t.toPrecision(e);t:for(var n,i=t.length,r=1,o=-1;r<i;++r)switch(t[r]){case".":o=n=r;break;case"0":0===o&&(o=r),n=r;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(n+1):t},Am=function(t,e){var n=Em(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(wm=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Em(t,Math.max(0,e+o-1))[0]},Cm=function(t,e){var n=Em(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},Lm={"":Pm,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Cm(100*t,e)},r:Cm,s:Am,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Im=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,Rm=function(t){return new tn(t)};tn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Nm,Om=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Dm=function(t){function e(t){function e(t){var e,r,u,y=d,_=m;if("c"===p)_=v(t)+_,t="";else{t=+t;var x=(t<0||1/t<0)&&(t*=-1,!0);if(t=v(t,f),x)for(e=-1,r=t.length,x=!1;++e<r;)if(u=t.charCodeAt(e),48<u&&u<58||"x"===p&&96<u&&u<103||"X"===p&&64<u&&u<71){x=!0;break}if(y=(x?"("===s?s:"-":"-"===s||"("===s?"":s)+y,_=_+("s"===p?Om[8+wm/3]:"")+(x&&"("===s?")":""),g)for(e=-1,r=t.length;++e<r;)if(u=t.charCodeAt(e),48>u||u>57){_=(46===u?o+t.slice(e+1):t.slice(e))+_,t=t.slice(0,e);break}}h&&!c&&(t=i(t,1/0));var b=y.length+t.length+_.length,w=b<l?new Array(l-b+1).join(n):"";switch(h&&c&&(t=i(w+t,w.length?l-_.length:1/0),w=""),a){case"<":return y+t+_+w;case"=":return y+w+t+_;case"^":return w.slice(0,b=w.length>>1)+y+t+_+w.slice(b)}return w+y+t+_}t=Rm(t);var n=t.fill,a=t.align,s=t.sign,u=t.symbol,c=t.zero,l=t.width,h=t.comma,f=t.precision,p=t.type,d="$"===u?r[0]:"#"===u&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",m="$"===u?r[1]:/[%p]/.test(p)?"%":"",v=Lm[p],g=!p||/[defgprs%]/.test(p);return f=null==f?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),e.toString=function(){return t+""},e}function n(t,n){var i=e((t=Rm(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Tm(n)/3))),o=Math.pow(10,-r),a=Om[8+r/3];return function(t){return i(o*t)+a}}var i=t.grouping&&t.thousands?Sm(t.grouping,t.thousands):en,r=t.currency,o=t.decimal;return{format:e,formatPrefix:n}};nn({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Bm,Um=function(t){return Math.max(0,-Tm(Math.abs(t)))},Fm=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Tm(e)/3)))-Tm(Math.abs(t)))},km=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Tm(e)-Tm(t))+1},zm={"-":"",_:" ",0:"0"},Gm=/^\s*\d+/,Hm=/^%/,jm=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;ei({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Xm="%Y-%m-%dT%H:%M:%S.%LZ",Vm=Date.prototype.toISOString?ni:t.utcFormat(Xm),Ym=+new Date("2000-01-01T00:00:00.000Z")?ii:t.utcParse(Xm),Wm=Array.prototype,qm=Wm.map,$m=Wm.slice,Zm={name:"implicit"},Jm=function(t){return function(){return t}},Km=function(t){return+t},Qm=[0,1],tv=function(e,i,r){var o,a=e[0],s=e[e.length-1],u=n(a,s,null==i?10:i);switch(r=Rm(null==r?",f":r),r.type){case"s":var c=Math.max(Math.abs(a),Math.abs(s));return null!=r.precision||isNaN(o=Fm(u,c))||(r.precision=o),t.formatPrefix(r,c);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=km(u,Math.max(Math.abs(a),Math.abs(s))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=Um(u))||(r.precision=o-2*("%"===r.type))}return t.format(r)},ev=function(t,e){t=t.slice();var n,i=0,r=t.length-1,o=t[i],a=t[r];return a<o&&(n=i,i=r,r=n,n=o,o=a,a=n),t[i]=e.floor(o),t[r]=e.ceil(a),t},nv=1e3,iv=60*nv,rv=60*iv,ov=24*rv,av=7*ov,sv=30*ov,uv=365*ov,cv=function(){return Ni(Jd,$d,Dd,Nd,Id,Cd,Pd,xd,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},lv=function(){return Ni(bm,_m,om,im,em,Qd,Pd,xd,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},hv=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},fv=hv("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),pv=hv("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),dv=hv("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),mv=hv("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),vv=Bp(le(300,.5,0),le(-240,.5,1)),gv=Bp(le(-100,.75,.35),le(80,1.5,.8)),yv=Bp(le(260,.75,.35),le(80,1.5,.8)),_v=le(),xv=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return _v.h=360*t-100,_v.s=1.5-1.5*e,_v.l=.8-.9*e,_v+""},bv=Oi(hv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),wv=Oi(hv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Mv=Oi(hv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Ev=Oi(hv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Tv="http://www.w3.org/1999/xhtml",Sv={
svg:"http://www.w3.org/2000/svg",xhtml:Tv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Pv=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Sv.hasOwnProperty(e)?{space:Sv[e],local:t}:t},Av=function(t){var e=Pv(t);return(e.local?Ui:Bi)(e)},Cv=0;ki.prototype=Fi.prototype={constructor:ki,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Lv=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Iv=document.documentElement;if(!Iv.matches){var Rv=Iv.webkitMatchesSelector||Iv.msMatchesSelector||Iv.mozMatchesSelector||Iv.oMatchesSelector;Lv=function(t){return function(){return Rv.call(this,t)}}}}var Nv=Lv,Ov={};if(t.event=null,"undefined"!=typeof document){var Dv=document.documentElement;"onmouseenter"in Dv||(Ov={mouseenter:"mouseover",mouseleave:"mouseout"})}var Bv=function(t,e,n){var i,r,o=Hi(t+""),a=o.length;{if(!(arguments.length<2)){for(s=e?Xi:ji,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(i=0,u=s[c];i<a;++i)if((r=o[i]).type===u.type&&r.name===u.name)return u.value}},Uv=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},Fv=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]},kv=function(t){var e=Uv();return e.changedTouches&&(e=e.changedTouches[0]),Fv(t,e)},zv=function(t){return null==t?Yi:function(){return this.querySelector(t)}},Gv=function(t){"function"!=typeof t&&(t=zv(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],u=s.length,c=i[r]=new Array(u),l=0;l<u;++l)(o=s[l])&&(a=t.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new Ir(i,this._parents)},Hv=function(t){return null==t?Wi:function(){return this.querySelectorAll(t)}},jv=function(t){"function"!=typeof t&&(t=Hv(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,c=0;c<u;++c)(a=s[c])&&(i.push(t.call(a,a.__data__,c,s)),r.push(a));return new Ir(i,r)},Xv=function(t){"function"!=typeof t&&(t=Nv(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,u=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new Ir(i,this._parents)},Vv=function(t){return new Array(t.length)},Yv=function(){return new Ir(this._enter||this._groups.map(Vv),this._parents)};qi.prototype={constructor:qi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Wv=function(t){return function(){return t}},qv="$",$v=function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each(function(t){p[++c]=t}),p;var n=e?Zi:$i,i=this._parents,r=this._groups;"function"!=typeof t&&(t=Wv(t));for(var o=r.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var l=i[c],h=r[c],f=h.length,p=t.call(l,l&&l.__data__,c,i),d=p.length,m=s[c]=new Array(d),v=a[c]=new Array(d),g=u[c]=new Array(f);n(l,h,m,v,g,p,e);for(var y,_,x=0,b=0;x<d;++x)if(y=m[x]){for(x>=b&&(b=x+1);!(_=v[b])&&++b<d;);y._next=_||null}}return a=new Ir(a,i),a._enter=s,a._exit=u,a},Zv=function(){return new Ir(this._exit||this._groups.map(Vv),this._parents)},Jv=function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),p=0;p<h;++p)(u=c[p]||l[p])&&(f[p]=u);for(;s<i;++s)a[s]=e[s];return new Ir(a,this._parents)},Kv=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&a!==i.nextSibling&&a.parentNode.insertBefore(i,a),a=i);return this},Qv=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ji);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],u=s.length,c=r[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new Ir(r,this._parents).order()},tg=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},eg=function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},ng=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},ig=function(){var t=0;return this.each(function(){++t}),t},rg=function(){return!this.node()},og=function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},ag=function(t,e){var n=Pv(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Qi:Ki:"function"==typeof e?n.local?ir:nr:n.local?er:tr)(n,e))},sg=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView},ug=function(t,e,n){var i;return arguments.length>1?this.each((null==e?rr:"function"==typeof e?ar:or)(t,e,null==n?"":n)):sg(i=this.node()).getComputedStyle(i,null).getPropertyValue(t)},cg=function(t,e){return arguments.length>1?this.each((null==e?sr:"function"==typeof e?cr:ur)(t,e)):this.node()[t]};fr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var lg=function(t,e){var n=lr(t+"");if(arguments.length<2){for(var i=hr(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?gr:e?mr:vr)(n,e))},hg=function(t){return arguments.length?this.each(null==t?yr:("function"==typeof t?xr:_r)(t)):this.node().textContent},fg=function(t){return arguments.length?this.each(null==t?br:("function"==typeof t?Mr:wr)(t)):this.node().innerHTML},pg=function(){return this.each(Er)},dg=function(){return this.each(Tr)},mg=function(t){var e="function"==typeof t?t:Av(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},vg=function(t,e){var n="function"==typeof t?t:Av(t),i=null==e?Sr:"function"==typeof e?e:zv(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},gg=function(){return this.each(Pr)},yg=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},_g=function(t,e){return this.each(("function"==typeof e?Lr:Cr)(t,e))},xg=[null];Ir.prototype=Rr.prototype={constructor:Ir,select:Gv,selectAll:jv,filter:Xv,data:$v,enter:Yv,exit:Zv,merge:Jv,order:Kv,sort:Qv,call:tg,nodes:eg,node:ng,size:ig,empty:rg,each:og,attr:ag,style:ug,property:cg,classed:lg,text:hg,html:fg,raise:pg,lower:dg,append:mg,insert:vg,remove:gg,datum:yg,on:Bv,dispatch:_g};var bg=function(t){return"string"==typeof t?new Ir([[document.querySelector(t)]],[document.documentElement]):new Ir([[t]],xg)},wg=function(t){return"string"==typeof t?new Ir([document.querySelectorAll(t)],[document.documentElement]):new Ir([null==t?[]:t],xg)},Mg=function(t,e,n){arguments.length<3&&(n=e,e=Uv().changedTouches);for(var i,r=0,o=e?e.length:0;r<o;++r)if((i=e[r]).identifier===n)return Fv(t,i);return null},Eg=function(t,e){null==e&&(e=Uv().touches);for(var n=0,i=e?e.length:0,r=new Array(i);n<i;++n)r[n]=Fv(t,e[n]);return r},Tg=Ie("start","end","interrupt"),Sg=[],Pg=0,Ag=1,Cg=2,Lg=3,Ig=4,Rg=5,Ng=6,Og=function(t,e,n,i,r,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};Br(t,n,{name:e,index:i,group:r,on:Tg,tween:Sg,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Pg})},Dg=function(t,e){var n,i,r,o=t.__transition,a=!0;if(o){e=null==e?null:e+"";for(r in o)(n=o[r]).name===e?(i=n.state>Cg&&n.state<Rg,n.state=Ng,n.timer.stop(),i&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete o[r]):a=!1;a&&delete t.__transition}},Bg=function(t){return this.each(function(){Dg(this,t)})},Ug=function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=Dr(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?Ur:Fr)(n,t,e))},Fg=function(t,e){var n;return("number"==typeof e?dp:e instanceof Ht?cp:(n=Ht(e))?(e=n,cp):yp)(t,e)},kg=function(t,e){var n=Pv(t),i="transform"===n?Tp:Fg;return this.attrTween(t,"function"==typeof e?(n.local?Vr:Xr)(n,i,kr(this,"attr."+t,e)):null==e?(n.local?Gr:zr)(n):(n.local?jr:Hr)(n,i,e))},zg=function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Pv(t);return this.tween(n,(i.local?Yr:Wr)(i,e))},Gg=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?qr:$r)(e,t)):Dr(this.node(),e).delay},Hg=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Zr:Jr)(e,t)):Dr(this.node(),e).duration},jg=function(t){var e=this._id;return arguments.length?this.each(Kr(e,t)):Dr(this.node(),e).ease},Xg=function(t){"function"!=typeof t&&(t=Nv(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,u=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new co(i,this._parents,this._name,this._id)},Vg=function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var u,c=e[s],l=n[s],h=c.length,f=a[s]=new Array(h),p=0;p<h;++p)(u=c[p]||l[p])&&(f[p]=u);for(;s<i;++s)a[s]=e[s];return new co(a,this._parents,this._name,this._id)},Yg=function(t,e){var n=this._id;return arguments.length<2?Dr(this.node(),n).on.on(t):this.each(to(n,t,e))},Wg=function(){return this.on("end.remove",eo(this._id))},qg=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=zv(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,u,c=i[a],l=c.length,h=o[a]=new Array(l),f=0;f<l;++f)(s=c[f])&&(u=t.call(s,s.__data__,f,c))&&("__data__"in s&&(u.__data__=s.__data__),h[f]=u,Og(h[f],e,n,f,h,Dr(s,n)));return new co(o,this._parents,e,n)},$g=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Hv(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var u,c=i[s],l=c.length,h=0;h<l;++h)if(u=c[h]){for(var f,p=t.call(u,u.__data__,h,c),d=Dr(u,n),m=0,v=p.length;m<v;++m)(f=p[m])&&Og(f,e,n,m,p,d);o.push(p),a.push(u)}return new co(o,a,e,n)},Zg=Rr.prototype.constructor,Jg=function(){return new Zg(this._groups,this._parents)},Kg=function(t,e,n){var i="transform"==(t+="")?Ep:Fg;return null==e?this.styleTween(t,no(t,i)).on("end.style."+t,io(t)):this.styleTween(t,"function"==typeof e?oo(t,i,kr(this,"style."+t,e)):ro(t,i,e),n)},Qg=function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,ao(t,e,null==n?"":n))},ty=function(t){return this.tween("text","function"==typeof t?uo(kr(this,"text",t)):so(null==t?"":t+""))},ey=function(){for(var t=this._name,e=this._id,n=ho(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=Dr(a,e);Og(a,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new co(i,this._parents,t,n)},ny=0,iy=Rr.prototype;co.prototype=lo.prototype={constructor:co,select:qg,selectAll:$g,filter:Xg,merge:Vg,selection:Jg,transition:ey,call:iy.call,nodes:iy.nodes,node:iy.node,size:iy.size,empty:iy.empty,each:iy.each,on:Yg,attr:kg,attrTween:zg,style:Kg,styleTween:Qg,text:ty,remove:Wg,tween:Ug,delay:Gg,duration:Hg,ease:jg};var ry={time:null,delay:0,duration:250,ease:y},oy=function(t){var e,n;t instanceof co?(e=t._id,t=t._name):(e=ho(),(n=ry).time=He(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Og(a,t,e,c,s,n||fo(a,e));return new co(i,this._parents,t,e)};Rr.prototype.interrupt=Bg,Rr.prototype.transition=oy;var ay=[null],sy=function(t,e){var n,i,r=t.__transition;if(r){e=null==e?null:e+"";for(i in r)if((n=r[i]).state>Ag&&n.name===e)return new co([[t]],ay,e,+i)}return null},uy=Array.prototype.slice,cy=function(t){return t},ly=1,hy=2,fy=3,py=4,dy=1e-6,my=function(){function t(t){var o,a=0;t.eachAfter(function(t){var n=t.children;n?(t.x=Eo(n),t.y=So(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)});var s=Ao(t),u=Co(t),c=s.x-e(s,u)/2,l=u.x+e(u,s)/2;return t.eachAfter(r?function(e){e.x=(e.x-t.x)*n,e.y=(t.y-e.y)*i}:function(e){e.x=(e.x-c)/(l-c)*n,e.y=(1-(t.y?e.y/t.y:1))*i})}var e=Mo,n=1,i=1,r=!1;return t.separation=function(n){return arguments.length?(e=n,t):e},t.size=function(e){return arguments.length?(r=!1,n=+e[0],i=+e[1],t):r?null:[n,i]},t.nodeSize=function(e){return arguments.length?(r=!0,n=+e[0],i=+e[1],t):r?[n,i]:null},t},vy=function(t){var e,n,i,r,o=this,a=[o];do for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(i=0,r=n.length;i<r;++i)a.push(n[i]);while(a.length);return this},gy=function(t){for(var e,n,i=this,r=[i];i=r.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)r.push(e[n]);return this},yy=function(t){for(var e,n,i,r=this,o=[r],a=[];r=o.pop();)if(a.push(r),e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n]);for(;r=a.pop();)t(r);return this},_y=function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})},xy=function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},by=function(t){for(var e=this,n=Lo(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},wy=function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},My=function(){var t=[];return this.each(function(e){t.push(e)}),t},Ey=function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},Ty=function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e};Bo.prototype=Io.prototype={constructor:Bo,each:vy,eachAfter:yy,eachBefore:gy,sum:_y,sort:xy,path:by,ancestors:wy,descendants:My,leaves:Ey,links:Ty,copy:Ro};var Sy=function(t){for(var e,n=(t=t.slice()).length,i=null,r=i;n;){var o=new Uo(t[n-1]);r=r?r.next=o:i=o,t[e]=t[--n]}return{head:i,tail:r}},Py=function(t){return ko(Sy(t),[])},Ay=function(t){return Wo(t),t},Cy=function(t){return function(){return t}},Ly=function(){function t(t){return t.x=n/2,t.y=i/2,e?t.eachBefore(Ko(e)).eachAfter(Qo(r,.5)).eachBefore(ta(1)):t.eachBefore(Ko(Jo)).eachAfter(Qo(Zo,1)).eachAfter(Qo(r,t.r/Math.min(n,i))).eachBefore(ta(Math.min(n,i)/(2*t.r))),t}var e=null,n=1,i=1,r=Zo;return t.radius=function(n){return arguments.length?(e=qo(n),t):e},t.size=function(e){return arguments.length?(n=+e[0],i=+e[1],t):[n,i]},t.padding=function(e){return arguments.length?(r="function"==typeof e?e:Cy(+e),t):r},t},Iy=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Ry=function(t,e,n,i,r){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(i-e)/t.value;++s<u;)o=a[s],o.y0=n,o.y1=r,o.x0=e,o.x1=e+=o.value*c},Ny=function(){function t(t){var a=t.height+1;return t.x0=t.y0=r,t.x1=n,t.y1=i/a,t.eachBefore(e(i,a)),o&&t.eachBefore(Iy),t}function e(t,e){return function(n){n.children&&Ry(n,n.x0,t*(n.depth+1)/e,n.x1,t*(n.depth+2)/e);var i=n.x0,o=n.y0,a=n.x1-r,s=n.y1-r;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),n.x0=i,n.y0=o,n.x1=a,n.y1=s}}var n=1,i=1,r=0,o=!1;return t.round=function(e){return arguments.length?(o=!!e,t):o},t.size=function(e){return arguments.length?(n=+e[0],i=+e[1],t):[n,i]},t.padding=function(e){return arguments.length?(r=+e,t):r},t},Oy="$",Dy={depth:-1},By={},Uy=function(){function t(t){var i,r,o,a,s,u,c,l=t.length,h=new Array(l),f={};for(r=0;r<l;++r)i=t[r],s=h[r]=new Bo(i),null!=(u=e(i,r,t))&&(u+="")&&(c=Oy+(s.id=u),f[c]=c in f?By:s);for(r=0;r<l;++r)if(s=h[r],u=n(t[r],r,t),null!=u&&(u+="")){if(a=f[Oy+u],!a)throw new Error("missing: "+u);if(a===By)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Dy,o.eachBefore(function(t){t.depth=t.parent.depth+1,--l}).eachBefore(Do),o.parent=null,l>0)throw new Error("cycle");return o}var e=ea,n=na;return t.id=function(n){return arguments.length?(e=$o(n),t):e},t.parentId=function(e){return arguments.length?(n=$o(e),t):n},t};ca.prototype=Object.create(Bo.prototype);var Fy=function(){function t(t){var i=la(t);if(i.eachAfter(e),i.parent.m=-i.z,i.eachBefore(n),u)t.eachBefore(r);else{var c=t,l=t,h=t;t.eachBefore(function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)});var f=c===l?1:o(c,l)/2,p=f-c.x,d=a/(l.x+f+p),m=s/(h.depth||1);t.eachBefore(function(t){t.x=(t.x+p)*d,t.y=t.depth*m})}return t}function e(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e){sa(t);var a=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+o(t._,r._),t.m=t.z-a):t.z=a}else r&&(t.z=r.z+o(t._,r._));t.parent.A=i(t,r,t.parent.A||n[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function i(t,e,n){if(e){for(var i,r=t,a=t,s=e,u=r.parent.children[0],c=r.m,l=a.m,h=s.m,f=u.m;s=oa(s),r=ra(r),s&&r;)u=ra(u),a=oa(a),a.a=t,i=s.z+h-r.z-c+o(s._,r._),i>0&&(aa(ua(s,t,n),t,i),c+=i,l+=i),h+=s.m,c+=r.m,f+=u.m,l+=a.m;s&&!oa(a)&&(a.t=s,a.m+=h-l),r&&!ra(u)&&(u.t=r,u.m+=c-f,n=t)}return n}function r(t){t.x*=a,t.y=t.depth*s}var o=ia,a=1,s=1,u=null;return t.separation=function(e){return arguments.length?(o=e,t):o},t.size=function(e){return arguments.length?(u=!1,a=+e[0],s=+e[1],t):u?null:[a,s]},t.nodeSize=function(e){return arguments.length?(u=!0,a=+e[0],s=+e[1],t):u?[a,s]:null},t},ky=function(t,e,n,i,r){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-n)/t.value;++s<u;)o=a[s],o.x0=e,o.x1=i,o.y0=n,o.y1=n+=o.value*c},zy=(1+Math.sqrt(5))/2,Gy=function t(e){function n(t,n,i,r,o){ha(e,t,n,i,r,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(zy),Hy=function(){function t(t){return t.x0=t.y0=0,t.x1=r,t.y1=o,t.eachBefore(e),a=[0],i&&t.eachBefore(Iy),t}function e(t){var e=a[t.depth],i=t.x0+e,r=t.y0+e,o=t.x1-e,f=t.y1-e;o<i&&(i=o=(i+o)/2),f<r&&(r=f=(r+f)/2),t.x0=i,t.y0=r,t.x1=o,t.y1=f,t.children&&(e=a[t.depth+1]=s(t)/2,i+=h(t)-e,r+=u(t)-e,o-=c(t)-e,f-=l(t)-e,o<i&&(i=o=(i+o)/2),f<r&&(r=f=(r+f)/2),n(t,i,r,o,f))}var n=Gy,i=!1,r=1,o=1,a=[0],s=Zo,u=Zo,c=Zo,l=Zo,h=Zo;return t.round=function(e){return arguments.length?(i=!!e,t):i},t.size=function(e){return arguments.length?(r=+e[0],o=+e[1],t):[r,o]},t.tile=function(e){return arguments.length?(n=$o(e),t):n},t.padding=function(e){return arguments.length?t.paddingInner(e).paddingOuter(e):t.paddingInner()},t.paddingInner=function(e){return arguments.length?(s="function"==typeof e?e:Cy(+e),t):s},t.paddingOuter=function(e){return arguments.length?t.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):t.paddingTop()},t.paddingTop=function(e){return arguments.length?(u="function"==typeof e?e:Cy(+e),t):u},t.paddingRight=function(e){return arguments.length?(c="function"==typeof e?e:Cy(+e),t):c},t.paddingBottom=function(e){return arguments.length?(l="function"==typeof e?e:Cy(+e),t):l},t.paddingLeft=function(e){return arguments.length?(h="function"==typeof e?e:Cy(+e),t):h},t},jy=function(t,e,n,i,r){function o(t,e,n,i,r,a,s){if(t>=e-1){var c=u[t];return c.x0=i,c.y0=r,c.x1=a,c.y1=s,void 0}for(var h=l[t],f=n/2+h,p=t+1,d=e-1;p<d;){var m=p+d>>>1;l[m]<f?p=m+1:d=m}var v=l[p]-h,g=n-v;if(s-r>a-i){var y=(r*g+s*v)/n;o(t,p,v,i,r,a,y),o(p,e,g,i,y,a,s)}else{var _=(i*g+a*v)/n;o(t,p,v,i,r,_,s),o(p,e,g,_,r,a,s)}}var a,s,u=t.children,c=u.length,l=new Array(c+1);for(l[0]=s=a=0;a<c;++a)l[a+1]=s+=u[a].value;o(0,c,t.value,e,n,i,r)},Xy=function(t,e,n,i,r){(1&t.depth?ky:Ry)(t,e,n,i,r)},Vy=function t(e){function n(t,n,i,r,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,c,l,h=-1,f=a.length,p=t.value;++h<f;){for(s=a[h],u=s.children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?Ry(s,n,i,r,i+=(o-i)*s.value/p):ky(s,n,i,n+=(r-n)*s.value/p,o),p-=s.value}else t._squarify=a=ha(e,t,n,i,r,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(zy),Yy=function(t,e){function n(){var n,r,o=i.length,a=0,s=0;for(n=0;n<o;++n)r=i[n],a+=r.x,s+=r.y;for(a=a/o-t,s=s/o-e,n=0;n<o;++n)r=i[n],r.x-=a,r.y-=s}var i;return null==t&&(t=0),null==e&&(e=0),n.initialize=function(t){i=t},n.x=function(e){return arguments.length?(t=+e,n):t},n.y=function(t){return arguments.length?(e=+t,n):e},n},Wy=function(t){return function(){return t}},qy=function(){return 1e-6*(Math.random()-.5)},$y=function(t){function e(){function t(t,e,n,i,r){var o=t.data,s=t.r,p=h+s;{if(!o)return e>c+p||i<c-p||n>l+p||r<l-p;if(o.index>u.index){var d=c-o.x-o.vx,m=l-o.y-o.vy,v=d*d+m*m;v<p*p&&(0===d&&(d=qy(),v+=d*d),0===m&&(m=qy(),v+=m*m),v=(p-(v=Math.sqrt(v)))/v*a,u.vx+=(d*=v)*(p=(s*=s)/(f+s)),u.vy+=(m*=v)*p,o.vx-=d*(p=1-p),o.vy-=m*p)}}}for(var e,i,u,c,l,h,f,p=r.length,d=0;d<s;++d)for(i=z(r,fa,pa).visitAfter(n),e=0;e<p;++e)u=r[e],h=o[u.index],f=h*h,c=u.x+u.vx,l=u.y+u.vy,i.visit(t)}function n(t){if(t.data)return t.r=o[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function i(){if(r){var e,n,i=r.length;for(o=new Array(i),e=0;e<i;++e)n=r[e],o[n.index]=+t(n,e,r)}}var r,o,a=1,s=1;return"function"!=typeof t&&(t=Wy(null==t?1:+t)),e.initialize=function(t){r=t,i()},e.iterations=function(t){return arguments.length?(s=+t,e):s},e.strength=function(t){return arguments.length?(a=+t,e):a},e.radius=function(n){return arguments.length?(t="function"==typeof n?n:Wy(+n),i(),e):t},e},Zy=function(t){function e(t){return 1/Math.min(l[t.source.index],l[t.target.index])}function n(e){for(var n=0,i=t.length;n<m;++n)for(var r,o,a,c,l,f,p,d=0;d<i;++d)r=t[d],o=r.source,a=r.target,c=a.x+a.vx-o.x-o.vx||qy(),l=a.y+a.vy-o.y-o.vy||qy(),f=Math.sqrt(c*c+l*l),f=(f-u[d])/f*e*s[d],c*=f,l*=f,a.vx-=c*(p=h[d]),a.vy-=l*p,o.vx+=c*(p=1-p),o.vy+=l*p}function i(){if(c){var e,n,i=c.length,p=t.length,d=o(c,f);for(e=0,l=new Array(i);e<p;++e)n=t[e],n.index=e,"object"!=typeof n.source&&(n.source=ma(d,n.source)),"object"!=typeof n.target&&(n.target=ma(d,n.target)),l[n.source.index]=(l[n.source.index]||0)+1,l[n.target.index]=(l[n.target.index]||0)+1;for(e=0,h=new Array(p);e<p;++e)n=t[e],h[e]=l[n.source.index]/(l[n.source.index]+l[n.target.index]);s=new Array(p),r(),u=new Array(p),a()}}function r(){if(c)for(var e=0,n=t.length;e<n;++e)s[e]=+p(t[e],e,t)}function a(){if(c)for(var e=0,n=t.length;e<n;++e)u[e]=+d(t[e],e,t)}var s,u,c,l,h,f=da,p=e,d=Wy(30),m=1;return null==t&&(t=[]),n.initialize=function(t){c=t,i()},n.links=function(e){return arguments.length?(t=e,i(),n):t},n.id=function(t){return arguments.length?(f=t,n):f},n.iterations=function(t){return arguments.length?(m=+t,n):m},n.strength=function(t){return arguments.length?(p="function"==typeof t?t:Wy(+t),r(),n):p},n.distance=function(t){return arguments.length?(d="function"==typeof t?t:Wy(+t),a(),n):d},n},Jy=10,Ky=Math.PI*(3-Math.sqrt(5)),Qy=function(t){function e(){n(),d.call("tick",a),s<u&&(p.stop(),d.call("end",a))}function n(){var e,n,i=t.length;for(s+=(l-s)*c,f.each(function(t){t(s)}),e=0;e<i;++e)n=t[e],null==n.fx?n.x+=n.vx*=h:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=h:(n.y=n.fy,n.vy=0)}function i(){for(var e,n=0,i=t.length;n<i;++n){if(e=t[n],e.index=n,isNaN(e.x)||isNaN(e.y)){var r=Jy*Math.sqrt(n),o=n*Ky;e.x=r*Math.cos(o),e.y=r*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function r(e){return e.initialize&&e.initialize(t),e}var a,s=1,u=.001,c=1-Math.pow(u,1/300),l=0,h=.6,f=o(),p=Ve(e),d=Ie("tick","end");return null==t&&(t=[]),i(),a={tick:n,restart:function(){return p.restart(e),a},stop:function(){return p.stop(),a},nodes:function(e){return arguments.length?(t=e,i(),f.each(r),a):t},alpha:function(t){return arguments.length?(s=+t,a):s},alphaMin:function(t){return arguments.length?(u=+t,a):u},alphaDecay:function(t){return arguments.length?(c=+t,a):+c},alphaTarget:function(t){return arguments.length?(l=+t,a):l},velocityDecay:function(t){return arguments.length?(h=1-t,a):1-h},force:function(t,e){return arguments.length>1?(null==e?f.remove(t):f.set(t,r(e)),a):f.get(t)},find:function(e,n,i){var r,o,a,s,u,c=0,l=t.length;for(null==i?i=1/0:i*=i,c=0;c<l;++c)s=t[c],r=e-s.x,o=n-s.y,a=r*r+o*o,a<i&&(u=s,i=a);return u},on:function(t,e){return arguments.length>1?(d.on(t,e),a):d.on(t)}}},t_=function(){function t(t){var e,s=r.length,u=z(r,va,ga).visitAfter(n);for(a=t,e=0;e<s;++e)o=r[e],u.visit(i)}function e(){if(r){var t,e,n=r.length;for(s=new Array(n),t=0;t<n;++t)e=r[t],s[e.index]=+u(e,t,r)}}function n(t){var e,n,i,r,o,a=0;if(t.length){for(i=r=o=0;o<4;++o)(e=t[o])&&(n=e.value)&&(a+=n,i+=n*e.x,r+=n*e.y);t.x=i/a,t.y=r/a}else{e=t,e.x=e.data.x,e.y=e.data.y;do a+=s[e.data.index];while(e=e.next)}t.value=a}function i(t,e,n,i){if(!t.value)return!0;var r=t.x-o.x,u=t.y-o.y,f=i-e,p=r*r+u*u;if(f*f/h<p)return p<l&&(0===r&&(r=qy(),p+=r*r),0===u&&(u=qy(),p+=u*u),p<c&&(p=Math.sqrt(c*p)),o.vx+=r*t.value*a/p,o.vy+=u*t.value*a/p),!0;if(!(t.length||p>=l)){(t.data!==o||t.next)&&(0===r&&(r=qy(),p+=r*r),0===u&&(u=qy(),p+=u*u),p<c&&(p=Math.sqrt(c*p)));do t.data!==o&&(f=s[t.data.index]*a/p,o.vx+=r*f,o.vy+=u*f);while(t=t.next)}}var r,o,a,s,u=Wy(-30),c=1,l=1/0,h=.81;return t.initialize=function(t){r=t,e()},t.strength=function(n){return arguments.length?(u="function"==typeof n?n:Wy(+n),e(),t):u},t.distanceMin=function(e){return arguments.length?(c=e*e,t):Math.sqrt(c)},t.distanceMax=function(e){return arguments.length?(l=e*e,t):Math.sqrt(l)},t.theta=function(e){return arguments.length?(h=e*e,t):Math.sqrt(h)},t},e_=function(t){function e(t){for(var e,n=0,a=i.length;n<a;++n)e=i[n],e.vx+=(o[n]-e.x)*r[n]*t}function n(){if(i){var e,n=i.length;for(r=new Array(n),o=new Array(n),e=0;e<n;++e)r[e]=isNaN(o[e]=+t(i[e],e,i))?0:+a(i[e],e,i)}}var i,r,o,a=Wy(.1);return"function"!=typeof t&&(t=Wy(null==t?0:+t)),e.initialize=function(t){i=t,n()},e.strength=function(t){return arguments.length?(a="function"==typeof t?t:Wy(+t),n(),e):a},e.x=function(i){return arguments.length?(t="function"==typeof i?i:Wy(+i),n(),e):t},e},n_=function(t){function e(t){for(var e,n=0,a=i.length;n<a;++n)e=i[n],e.vy+=(o[n]-e.y)*r[n]*t}function n(){if(i){var e,n=i.length;for(r=new Array(n),o=new Array(n),e=0;e<n;++e)r[e]=isNaN(o[e]=+t(i[e],e,i))?0:+a(i[e],e,i)}}var i,r,o,a=Wy(.1);return"function"!=typeof t&&(t=Wy(null==t?0:+t)),e.initialize=function(t){i=t,n()},e.strength=function(t){return arguments.length?(a="function"==typeof t?t:Wy(+t),n(),e):a},e.y=function(i){return arguments.length?(t="function"==typeof i?i:Wy(+i),n(),e):t},e},i_=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},r_=function(t){var e=t.document.documentElement,n=bg(t).on("dragstart.drag",i_,!0);"onselectstart"in e?n.on("selectstart.drag",i_,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")},o_=function(t){return function(){return t}};xa.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var a_=function(){function e(t){t.on("mousedown.drag",n).on("touchstart.drag",o).on("touchmove.drag",a).on("touchend.drag touchcancel.drag",s).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function n(){if(!l&&h.apply(this,arguments)){var e=u("mouse",f.apply(this,arguments),kv,this,arguments);e&&(bg(t.event.view).on("mousemove.drag",i,!0).on("mouseup.drag",r,!0),r_(t.event.view),ya(),c=!1,e("start"))}}function i(){i_(),c=!0,d.mouse("drag")}function r(){bg(t.event.view).on("mousemove.drag mouseup.drag",null),_a(t.event.view,c),i_(),d.mouse("end")}function o(){if(h.apply(this,arguments)){var e,n,i=t.event.changedTouches,r=f.apply(this,arguments),o=i.length;for(e=0;e<o;++e)(n=u(i[e].identifier,r,Mg,this,arguments))&&(ya(),n("start"))}}function a(){var e,n,i=t.event.changedTouches,r=i.length;for(e=0;e<r;++e)(n=d[i[e].identifier])&&(i_(),n("drag"))}function s(){var e,n,i=t.event.changedTouches,r=i.length;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),e=0;e<r;++e)(n=d[i[e].identifier])&&(ya(),n("end"))}function u(n,i,r,o,a){var s,u,c,l=r(i,n),h=m.copy();if(Vi(new xa(e,"beforestart",s,n,v,l[0],l[1],0,0,h),function(){return null!=(t.event.subject=s=p.apply(o,a))&&(u=s.x-l[0]||0,c=s.y-l[1]||0,!0)}))return function t(f){var p,m=l;switch(f){case"start":d[n]=t,p=v++;break;case"end":delete d[n],--v;case"drag":l=r(i,n),p=v}Vi(new xa(e,f,s,n,p,l[0]+u,l[1]+c,l[0]-m[0],l[1]-m[1],h),h.apply,h,[f,o,a])}}var c,l,h=ba,f=wa,p=Ma,d={},m=Ie("start","drag","end"),v=0;return e.filter=function(t){return arguments.length?(h="function"==typeof t?t:o_(!!t),e):h},e.container=function(t){return arguments.length?(f="function"==typeof t?t:o_(t),e):f},e.subject=function(t){return arguments.length?(p="function"==typeof t?t:o_(t),e):p},e.on=function(){var t=m.on.apply(m,arguments);return t===m?e:t},e},s_=function(t){return function(){return t}};Sa.prototype={constructor:Sa,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=La(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Aa(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Ca(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Ca(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Aa(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?La(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,Aa(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Ca(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Aa(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,Ca(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Aa(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Ca(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var u_,c_,l_,h_,f_,p_=[],d_=[],m_=1e-6,v_=1e-12;es.prototype={constructor:es,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return ka(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){for(var r,o=n.site,a=n.halfedges,s=-1,u=a.length,c=e[a[u-1]],l=c.left===o?c.right:c.left;++s<u;)r=l,c=e[a[s]],l=c.left===o?c.right:c.left,r&&l&&i<r.index&&i<l.index&&Qa(o,r,l)<0&&t.push([o.data,r.data,l.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){var i,r=this,o=r._found||0,a=r.cells[o]||r.cells[o=0],s=t-a.site[0],u=e-a.site[1],c=s*s+u*u;do a=r.cells[i=o],o=null,a.halfedges.forEach(function(n){var i=r.edges[n],s=i.left;if(s!==a.site&&s||(s=i.right)){var u=t-s[0],l=e-s[1],h=u*u+l*l;h<c&&(c=h,o=s.index)}});while(null!==o);return r._found=i,null==n||c<=n*n?a.site:null}};var g_=function(){function t(t){return new es(t.map(function(i,r){var o=[Math.round(e(i,r,t)/m_)*m_,Math.round(n(i,r,t)/m_)*m_];return o.index=r,o.data=i,o}),i)}var e=Ea,n=Ta,i=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:s_(+n),t):e},t.y=function(e){
return arguments.length?(n="function"==typeof e?e:s_(+e),t):n},t.extent=function(e){return arguments.length?(i=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},t.size=function(e){return arguments.length?(i=null==e?null:[[0,0],[+e[0],+e[1]]],t):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},t},y_=function(t){return function(){return t}};is.prototype={constructor:is,scale:function(t){return 1===t?this:new is(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new is(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var __=new is(1,0,0);rs.prototype=is.prototype;var x_=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},b_=function(){function e(t){t.on("wheel.zoom",c).on("mousedown.zoom",l).on("dblclick.zoom",h).on("touchstart.zoom",f).on("touchmove.zoom",p).on("touchend.zoom touchcancel.zoom",d).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",us)}function n(t,e){return e=Math.max(_,Math.min(x,e)),e===t.k?t:new is(e,t.x,t.y)}function i(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new is(t.k,i,r)}function r(t,e){var n=t.invertX(e[0][0])-b,i=t.invertX(e[1][0])-w,r=t.invertY(e[0][1])-M,o=t.invertY(e[1][1])-E;return t.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o))}function o(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function a(t,e,n){t.on("start.zoom",function(){s(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){s(this,arguments).end()}).tween("zoom",function(){var t=this,i=arguments,r=s(t,i),a=y.apply(t,i),u=n||o(a),c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),l=t.__zoom,h="function"==typeof e?e.apply(t,i):e,f=S(l.invert(u).concat(c/l.k),h.invert(u).concat(c/h.k));return function(t){if(1===t)t=h;else{var e=f(t),n=c/e[2];t=new is(n,u[0]-e[0]*n,u[1]-e[1]*n)}r.zoom(null,t)}})}function s(t,e){for(var n,i=0,r=P.length;i<r;++i)if((n=P[i]).that===t)return n;return new u(t,e)}function u(t,e){this.that=t,this.args=e,this.index=-1,this.active=0,this.extent=y.apply(t,e)}function c(){function e(){o.wheel=null,o.end()}if(g.apply(this,arguments)){var o=s(this,arguments),a=this.__zoom,u=Math.max(_,Math.min(x,a.k*Math.pow(2,-t.event.deltaY*(t.event.deltaMode?120:1)/500))),c=kv(this);if(o.wheel)o.mouse[0][0]===c[0]&&o.mouse[0][1]===c[1]||(o.mouse[1]=a.invert(o.mouse[0]=c)),clearTimeout(o.wheel);else{if(a.k===u)return;o.mouse=[c,a.invert(c)],Dg(this),o.start()}x_(),o.wheel=setTimeout(e,L),o.zoom("mouse",r(i(n(a,u),o.mouse[0],o.mouse[1]),o.extent))}}function l(){function e(){x_(),o.moved=!0,o.zoom("mouse",r(i(o.that.__zoom,o.mouse[0]=kv(o.that),o.mouse[1]),o.extent))}function n(){a.on("mousemove.zoom mouseup.zoom",null),_a(t.event.view,o.moved),x_(),o.end()}if(!v&&g.apply(this,arguments)){var o=s(this,arguments),a=bg(t.event.view).on("mousemove.zoom",e,!0).on("mouseup.zoom",n,!0),u=kv(this);r_(t.event.view),os(),o.mouse=[u,this.__zoom.invert(u)],Dg(this),o.start()}}function h(){if(g.apply(this,arguments)){var o=this.__zoom,s=kv(this),u=o.invert(s),c=o.k*(t.event.shiftKey?.5:2),l=r(i(n(o,c),s,u),y.apply(this,arguments));x_(),T>0?bg(this).transition().duration(T).call(a,l,s):bg(this).call(e.transform,l)}}function f(){if(g.apply(this,arguments)){var e,n,i,r=s(this,arguments),o=t.event.changedTouches,a=o.length;for(os(),e=0;e<a;++e)n=o[e],i=Mg(this,o,n.identifier),i=[i,this.__zoom.invert(i),n.identifier],r.touch0?r.touch1||(r.touch1=i):r.touch0=i;return m&&(m=clearTimeout(m),!r.touch1)?(r.end(),i=bg(this).on("dblclick.zoom"),void(i&&i.apply(this,arguments))):void(t.event.touches.length===a&&(m=setTimeout(function(){m=null},C),Dg(this),r.start()))}}function p(){var e,o,a,u,c=s(this,arguments),l=t.event.changedTouches,h=l.length;for(x_(),m&&(m=clearTimeout(m)),e=0;e<h;++e)o=l[e],a=Mg(this,l,o.identifier),c.touch0&&c.touch0[2]===o.identifier?c.touch0[0]=a:c.touch1&&c.touch1[2]===o.identifier&&(c.touch1[0]=a);if(o=c.that.__zoom,c.touch1){var f=c.touch0[0],p=c.touch0[1],d=c.touch1[0],v=c.touch1[1],g=(g=d[0]-f[0])*g+(g=d[1]-f[1])*g,y=(y=v[0]-p[0])*y+(y=v[1]-p[1])*y;o=n(o,Math.sqrt(g/y)),a=[(f[0]+d[0])/2,(f[1]+d[1])/2],u=[(p[0]+v[0])/2,(p[1]+v[1])/2]}else{if(!c.touch0)return;a=c.touch0[0],u=c.touch0[1]}c.zoom("touch",r(i(o,a,u),c.extent))}function d(){var e,n,i=s(this,arguments),r=t.event.changedTouches,o=r.length;for(os(),v&&clearTimeout(v),v=setTimeout(function(){v=null},C),e=0;e<o;++e)n=r[e],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0||i.end()}var m,v,g=as,y=ss,_=0,x=1/0,b=-x,w=x,M=b,E=w,T=250,S=Lp,P=[],A=Ie("start","zoom","end"),C=500,L=150;return e.transform=function(t,e){var n=t.selection?t.selection():t;n.property("__zoom",us),t!==n?a(t,e):n.interrupt().each(function(){s(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},e.scaleBy=function(t,n){e.scaleTo(t,function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e})},e.scaleTo=function(t,a){e.transform(t,function(){var t=y.apply(this,arguments),e=this.__zoom,s=o(t),u=e.invert(s),c="function"==typeof a?a.apply(this,arguments):a;return r(i(n(e,c),s,u),t)})},e.translateBy=function(t,n,i){e.transform(t,function(){return r(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof i?i.apply(this,arguments):i),y.apply(this,arguments))})},u.prototype={start:function(){return 1===++this.active&&(this.index=P.push(this)-1,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(P.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){Vi(new ns(e,t,this.that.__zoom),A.apply,A,[t,this.that,this.args])}},e.filter=function(t){return arguments.length?(g="function"==typeof t?t:y_(!!t),e):g},e.extent=function(t){return arguments.length?(y="function"==typeof t?t:y_([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):y},e.scaleExtent=function(t){return arguments.length?(_=+t[0],x=+t[1],e):[_,x]},e.translateExtent=function(t){return arguments.length?(b=+t[0][0],w=+t[1][0],M=+t[0][1],E=+t[1][1],e):[[b,M],[w,E]]},e.duration=function(t){return arguments.length?(T=+t,e):T},e.interpolate=function(t){return arguments.length?(S=t,e):S},e.on=function(){var t=A.on.apply(A,arguments);return t===A?e:t},e},w_=function(t){return function(){return t}},M_=function(t,e,n){this.target=t,this.type=e,this.selection=n},E_=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},T_={name:"drag"},S_={name:"space"},P_={name:"handle"},A_={name:"center"},C_={name:"x",handles:["e","w"].map(ls),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},L_={name:"y",handles:["n","s"].map(ls),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},I_={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(ls),input:function(t){return t},output:function(t){return t}},R_={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},N_={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},O_={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},D_={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},B_={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},U_=function(){return ys(I_)},F_=Math.cos,k_=Math.sin,z_=Math.PI,G_=z_/2,H_=2*z_,j_=Math.max,X_=function(){function t(t){var o,a,s,u,c,l,h=t.length,f=[],p=Fc(h),d=[],m=[],v=m.groups=new Array(h),g=new Array(h*h);for(o=0,c=-1;++c<h;){for(a=0,l=-1;++l<h;)a+=t[c][l];f.push(a),d.push(Fc(h)),o+=a}for(n&&p.sort(function(t,e){return n(f[t],f[e])}),i&&d.forEach(function(e,n){e.sort(function(e,r){return i(t[n][e],t[n][r])})}),o=j_(0,H_-e*h)/o,u=o?e:H_/h,a=0,c=-1;++c<h;){for(s=a,l=-1;++l<h;){var y=p[c],_=d[y][l],x=t[y][_],b=a,w=a+=x*o;g[_*h+y]={index:y,subindex:_,startAngle:b,endAngle:w,value:x}}v[y]={index:y,startAngle:s,endAngle:a,value:f[y]},a+=u}for(c=-1;++c<h;)for(l=c-1;++l<h;){var M=g[l*h+c],E=g[c*h+l];(M.value||E.value)&&m.push(M.value<E.value?{source:E,target:M}:{source:M,target:E})}return r?m.sort(r):m}var e=0,n=null,i=null,r=null;return t.padAngle=function(n){return arguments.length?(e=j_(0,n),t):e},t.sortGroups=function(e){return arguments.length?(n=e,t):n},t.sortSubgroups=function(e){return arguments.length?(i=e,t):i},t.sortChords=function(e){return arguments.length?(null==e?r=null:(r=_s(e))._=e,t):r&&r._},t},V_=Array.prototype.slice,Y_=function(t){return function(){return t}},W_=function(){function t(){var t,s=V_.call(arguments),u=e.apply(this,s),c=n.apply(this,s),l=+i.apply(this,(s[0]=u,s)),h=r.apply(this,s)-G_,f=o.apply(this,s)-G_,p=l*F_(h),d=l*k_(h),m=+i.apply(this,(s[0]=c,s)),v=r.apply(this,s)-G_,g=o.apply(this,s)-G_;if(a||(a=t=O()),a.moveTo(p,d),a.arc(0,0,l,h,f),h===v&&f===g||(a.quadraticCurveTo(0,0,m*F_(v),m*k_(v)),a.arc(0,0,m,v,g)),a.quadraticCurveTo(0,0,p,d),a.closePath(),t)return a=null,t+""||null}var e=xs,n=bs,i=ws,r=Ms,o=Es,a=null;return t.radius=function(e){return arguments.length?(i="function"==typeof e?e:Y_(+e),t):i},t.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Y_(+e),t):r},t.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:Y_(+e),t):o},t.source=function(n){return arguments.length?(e=n,t):e},t.target=function(e){return arguments.length?(n=e,t):n},t.context=function(e){return arguments.length?(a=null==e?null:e,t):a},t},q_=function(){return new Ts};Ts.prototype={constructor:Ts,reset:function(){this.s=this.t=0},add:function(t){Ss(Sx,t,this.t),Ss(this,Sx.s,this.s),this.s?this.t+=Sx.t:this.s=Sx.t},valueOf:function(){return this.s}};var $_,Z_,J_,K_,Q_,tx,ex,nx,ix,rx,ox,ax,sx,ux,cx,lx,hx,fx,px,dx,mx,vx,gx,yx,_x,xx,bx,wx,Mx,Ex,Tx,Sx=new Ts,Px=1e-6,Ax=1e-12,Cx=Math.PI,Lx=Cx/2,Ix=Cx/4,Rx=2*Cx,Nx=180/Cx,Ox=Cx/180,Dx=Math.abs,Bx=Math.atan,Ux=Math.atan2,Fx=Math.cos,kx=Math.ceil,zx=Math.exp,Gx=Math.log,Hx=Math.pow,jx=Math.sin,Xx=Math.sign||function(t){return t>0?1:t<0?-1:0},Vx=Math.sqrt,Yx=Math.tan,Wx={Feature:function(t,e){Is(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Is(n[i].geometry,e)}},qx={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Rs(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Rs(n[i],e,0)},Polygon:function(t,e){Ns(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Ns(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Is(n[i],e)}},$x=function(t,e){t&&Wx.hasOwnProperty(t.type)?Wx[t.type](t,e):Is(t,e)},Zx=q_(),Jx=q_(),Kx={point:Ls,lineStart:Ls,lineEnd:Ls,polygonStart:function(){Zx.reset(),Kx.lineStart=Os,Kx.lineEnd=Ds},polygonEnd:function(){var t=+Zx;Jx.add(t<0?Rx+t:t),this.lineStart=this.lineEnd=this.point=Ls},sphere:function(){Jx.add(Rx)}},Qx=function(t){return Jx.reset(),$x(t,Kx),2*Jx},tb=q_(),eb={point:Vs,lineStart:Ws,lineEnd:qs,polygonStart:function(){eb.point=$s,eb.lineStart=Zs,eb.lineEnd=Js,tb.reset(),Kx.polygonStart()},polygonEnd:function(){Kx.polygonEnd(),eb.point=Vs,eb.lineStart=Ws,eb.lineEnd=qs,Zx<0?(tx=-(nx=180),ex=-(ix=90)):tb>Px?ix=90:tb<-Px&&(ex=-90),cx[0]=tx,cx[1]=nx}},nb=function(t){var e,n,i,r,o,a,s;if(ix=nx=-(tx=ex=1/0),ux=[],$x(t,eb),n=ux.length){for(ux.sort(Qs),e=1,i=ux[0],o=[i];e<n;++e)r=ux[e],tu(i,r[0])||tu(i,r[1])?(Ks(i[0],r[1])>Ks(i[0],i[1])&&(i[1]=r[1]),Ks(r[0],i[1])>Ks(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-(1/0),n=o.length-1,e=0,i=o[n];e<=n;i=r,++e)r=o[e],(s=Ks(i[1],r[0]))>a&&(a=s,tx=r[0],nx=i[1])}return ux=cx=null,tx===1/0||ex===1/0?[[NaN,NaN],[NaN,NaN]]:[[tx,ex],[nx,ix]]},ib={sphere:Ls,point:eu,lineStart:iu,lineEnd:au,polygonStart:function(){ib.lineStart=su,ib.lineEnd=uu},polygonEnd:function(){ib.lineStart=iu,ib.lineEnd=au}},rb=function(t){lx=hx=fx=px=dx=mx=vx=gx=yx=_x=xx=0,$x(t,ib);var e=yx,n=_x,i=xx,r=e*e+n*n+i*i;return r<Ax&&(e=mx,n=vx,i=gx,hx<Px&&(e=fx,n=px,i=dx),r=e*e+n*n+i*i,r<Ax)?[NaN,NaN]:[Ux(n,e)*Nx,As(i/Vx(r))*Nx]},ob=function(t){return function(){return t}},ab=function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n};hu.invert=hu;var sb,ub,cb,lb,hb,fb,pb,db,mb,vb,gb,yb=function(t){function e(e){return e=t(e[0]*Ox,e[1]*Ox),e[0]*=Nx,e[1]*=Nx,e}return t=fu(t[0]*Ox,t[1]*Ox,t.length>2?t[2]*Ox:0),e.invert=function(e){return e=t.invert(e[0]*Ox,e[1]*Ox),e[0]*=Nx,e[1]*=Nx,e},e},_b=function(){function t(t,e){n.push(t=i(t,e)),t[0]*=Nx,t[1]*=Nx}function e(){var t=r.apply(this,arguments),e=o.apply(this,arguments)*Ox,u=a.apply(this,arguments)*Ox;return n=[],i=fu(-t[0]*Ox,-t[1]*Ox,0).invert,vu(s,e,u,1),t={type:"Polygon",coordinates:[n]},n=i=null,t}var n,i,r=ob([0,0]),o=ob(90),a=ob(6),s={point:t};return e.center=function(t){return arguments.length?(r="function"==typeof t?t:ob([+t[0],+t[1]]),e):r},e.radius=function(t){return arguments.length?(o="function"==typeof t?t:ob(+t),e):o},e.precision=function(t){return arguments.length?(a="function"==typeof t?t:ob(+t),e):a},e},xb=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Ls,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},bb=function(t,e,n,i,r,o){var a,s=t[0],u=t[1],c=e[0],l=e[1],h=0,f=1,p=c-s,d=l-u;if(a=n-s,p||!(a>0)){if(a/=p,p<0){if(a<h)return;a<f&&(f=a)}else if(p>0){if(a>f)return;a>h&&(h=a)}if(a=r-s,p||!(a<0)){if(a/=p,p<0){if(a>f)return;a>h&&(h=a)}else if(p>0){if(a<h)return;a<f&&(f=a)}if(a=i-u,d||!(a>0)){if(a/=d,d<0){if(a<h)return;a<f&&(f=a)}else if(d>0){if(a>f)return;a>h&&(h=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>f)return;a>h&&(h=a)}else if(d>0){if(a<h)return;a<f&&(f=a)}return h>0&&(t[0]=s+h*p,t[1]=u+h*d),f<1&&(e[0]=s+f*p,e[1]=u+f*d),!0}}}}},wb=function(t,e){return Dx(t[0]-e[0])<Px&&Dx(t[1]-e[1])<Px},Mb=function(t,e,n,i,r){var o,a,s=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],a=t[e];if(wb(i,a)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);return void r.lineEnd()}s.push(n=new yu(i,t,null,!0)),u.push(n.o=new yu(i,null,n,!1)),s.push(n=new yu(a,t,null,!1)),u.push(n.o=new yu(a,null,n,!0))}}),s.length){for(u.sort(e),_u(s),_u(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var c,l,h=s[0];;){for(var f=h,p=!0;f.v;)if((f=f.n)===h)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=c.length;o<a;++o)r.point((l=c[o])[0],l[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(p)for(c=f.p.z,o=c.length-1;o>=0;--o)r.point((l=c[o])[0],l[1]);else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,c=f.z,p=!p}while(!f.v);r.lineEnd()}}},Eb=1e9,Tb=-Eb,Sb=function(){var t,e,n,i=0,r=0,o=960,a=500;return n={stream:function(n){return t&&e===n?t:t=xu(i,r,o,a)(e=n)},extent:function(s){return arguments.length?(i=+s[0][0],r=+s[0][1],o=+s[1][0],a=+s[1][1],t=e=null,n):[[i,r],[o,a]]}}},Pb=q_(),Ab={sphere:Ls,point:Ls,lineStart:bu,lineEnd:Ls,polygonStart:Ls,polygonEnd:Ls},Cb=function(t){return Pb.reset(),$x(t,Ab),+Pb},Lb=[null,null],Ib={type:"LineString",coordinates:Lb},Rb=function(t,e){return Lb[0]=t,Lb[1]=e,Cb(Ib)},Nb=function(t,e){var n=t[0]*Ox,i=t[1]*Ox,r=e[0]*Ox,o=e[1]*Ox,a=Fx(i),s=jx(i),u=Fx(o),c=jx(o),l=a*Fx(n),h=a*jx(n),f=u*Fx(r),p=u*jx(r),d=2*As(Vx(Cs(o-i)+a*u*Cs(r-n))),m=jx(d),v=d?function(t){var e=jx(t*=d)/m,n=jx(d-t)/m,i=n*l+e*f,r=n*h+e*p,o=n*s+e*c;return[Ux(r,i)*Nx,Ux(o,Vx(i*i+r*r))*Nx]}:function(){return[n*Nx,i*Nx]};return v.distance=d,v},Ob=function(t){return t},Db=q_(),Bb=q_(),Ub={point:Ls,lineStart:Ls,lineEnd:Ls,polygonStart:function(){Ub.lineStart=Cu,Ub.lineEnd=Ru},polygonEnd:function(){Ub.lineStart=Ub.lineEnd=Ub.point=Ls,Db.add(Dx(Bb)),Bb.reset()},result:function(){var t=Db/2;return Db.reset(),t}},Fb=1/0,kb=Fb,zb=-Fb,Gb=zb,Hb={point:Nu,lineStart:Ls,lineEnd:Ls,polygonStart:Ls,polygonEnd:Ls,result:function(){var t=[[Fb,kb],[zb,Gb]];return zb=Gb=-(kb=Fb=1/0),t}},jb=0,Xb=0,Vb=0,Yb=0,Wb=0,qb=0,$b=0,Zb=0,Jb=0,Kb={point:Ou,lineStart:Du,lineEnd:Fu,polygonStart:function(){Kb.lineStart=ku,Kb.lineEnd=zu},polygonEnd:function(){Kb.point=Ou,Kb.lineStart=Du,Kb.lineEnd=Fu},result:function(){var t=Jb?[$b/Jb,Zb/Jb]:qb?[Yb/qb,Wb/qb]:Vb?[jb/Vb,Xb/Vb]:[NaN,NaN];return jb=Xb=Vb=Yb=Wb=qb=$b=Zb=Jb=0,t}};ju.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Rx)}},result:Ls},Xu.prototype={_circle:Vu(4.5),pointRadius:function(t){return this._circle=Vu(t),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}}};var Qb=function(t,e){function n(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),$x(t,i(r))),r.result()}var i,r,o=4.5;return n.area=function(t){return $x(t,i(Ub)),Ub.result()},n.bounds=function(t){return $x(t,i(Hb)),Hb.result()},n.centroid=function(t){return $x(t,i(Kb)),Kb.result()},n.projection=function(e){return arguments.length?(i=null==e?(t=null,Ob):(t=e).stream,n):t},n.context=function(t){return arguments.length?(r=null==t?(e=null,new Xu):new ju(e=t),"function"!=typeof o&&r.pointRadius(o),n):e},n.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),n):o},n.projection(t).context(e)},tw=q_(),ew=function(t,e){var n=e[0],i=e[1],r=[jx(n),-Fx(n),0],o=0,a=0;tw.reset();for(var s=0,u=t.length;s<u;++s)if(l=(c=t[s]).length)for(var c,l,h=c[l-1],f=h[0],p=h[1]/2+Ix,d=jx(p),m=Fx(p),v=0;v<l;++v,f=y,d=x,m=b,h=g){var g=c[v],y=g[0],_=g[1]/2+Ix,x=jx(_),b=Fx(_),w=y-f,M=w>=0?1:-1,E=M*w,T=E>Cx,S=d*x;if(tw.add(Ux(S*M*jx(E),m*b+S*Fx(E))),o+=T?w+M*Rx:w,T^f>=n^y>=n){var P=Gs(ks(h),ks(g));Xs(P);var A=Gs(r,P);Xs(A);var C=(T^w>=0?-1:1)*As(A[2]);(i>C||i===C&&(P[0]||P[1]))&&(a+=T^w>=0?1:-1)}}return(o<-Px||o<Px&&tw<-Px)^1&a},nw=function(t,e,n,i){return function(r,o){function a(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function s(t,e){var n=r(t,e);v.point(n[0],n[1])}function u(){b.point=s,v.lineStart()}function c(){b.point=a,v.lineEnd()}function l(t,e){m.push([t,e]);var n=r(t,e);_.point(n[0],n[1])}function h(){_.lineStart(),m=[]}function f(){l(m[0][0],m[0][1]),_.lineEnd();var t,e,n,i,r=_.clean(),a=y.result(),s=a.length;if(m.pop(),p.push(m),m=null,s)if(1&r){if(n=a[0],(e=n.length-1)>0){for(x||(o.polygonStart(),x=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else s>1&&2&r&&a.push(a.pop().concat(a.shift())),d.push(a.filter(Yu))}var p,d,m,v=e(o),g=r.invert(i[0],i[1]),y=xb(),_=e(y),x=!1,b={point:a,lineStart:u,lineEnd:c,polygonStart:function(){b.point=l,b.lineStart=h,b.lineEnd=f,d=[],p=[]},polygonEnd:function(){b.point=a,b.lineStart=u,b.lineEnd=c,d=Jc(d);var t=ew(p,g);d.length?(x||(o.polygonStart(),x=!0),Mb(d,Wu,t,n,o)):t&&(x||(o.polygonStart(),x=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return b}},iw=nw(function(){return!0},qu,Zu,[-Cx,-Lx]),rw=function(t,e){function n(n,i,r,o){vu(o,t,e,r,n,i)}function i(t,e){return Fx(t)*Fx(e)>s}function r(t){var e,n,r,s,l;return{lineStart:function(){s=r=!1,l=1},point:function(h,f){var p,d=[h,f],m=i(h,f),v=u?m?0:a(h,f):m?a(h+(h<0?Cx:-Cx),f):0;if(!e&&(s=r=m)&&t.lineStart(),m!==r&&(p=o(e,d),(wb(e,p)||wb(d,p))&&(d[0]+=Px,d[1]+=Px,m=i(d[0],d[1]))),m!==r)l=0,m?(t.lineStart(),p=o(d,e),t.point(p[0],p[1])):(p=o(e,d),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(c&&e&&u^m){var g;v&n||!(g=o(d,e,!0))||(l=0,u?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1])))}!m||e&&wb(e,d)||t.point(d[0],d[1]),e=d,r=m,n=v},lineEnd:function(){r&&t.lineEnd(),e=null},clean:function(){return l|(s&&r)<<1}}}function o(t,e,n){var i=ks(t),r=ks(e),o=[1,0,0],a=Gs(i,r),u=zs(a,a),c=a[0],l=u-c*c;if(!l)return!n&&t;var h=s*u/l,f=-s*c/l,p=Gs(o,a),d=js(o,h),m=js(a,f);Hs(d,m);var v=p,g=zs(d,v),y=zs(v,v),_=g*g-y*(zs(d,d)-1);if(!(_<0)){var x=Vx(_),b=js(v,(-g-x)/y);if(Hs(b,d),b=Fs(b),!n)return b;var w,M=t[0],E=e[0],T=t[1],S=e[1];E<M&&(w=M,M=E,E=w);var P=E-M,A=Dx(P-Cx)<Px,C=A||P<Px;if(!A&&S<T&&(w=T,T=S,S=w),C?A?T+S>0^b[1]<(Dx(b[0]-M)<Px?T:S):T<=b[1]&&b[1]<=S:P>Cx^(M<=b[0]&&b[0]<=E)){var L=js(v,(-g+x)/y);return Hs(L,d),[b,Fs(L)]}}}function a(e,n){var i=u?t:Cx-t,r=0;return e<-i?r|=1:e>i&&(r|=2),n<-i?r|=4:n>i&&(r|=8),r}var s=Fx(t),u=s>0,c=Dx(s)>Px;return nw(i,r,n,u?[0,-t]:[-Cx,t-Cx])},ow=function(t){return{stream:Ju(t)}};Ku.prototype={constructor:Ku,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var aw=16,sw=Fx(30*Ox),uw=function(t,e){return+e?nc(t,e):ec(t)},cw=Ju({point:function(t,e){this.stream.point(t*Ox,e*Ox)}}),lw=function(){return oc(sc).scale(155.424).center([0,33.6442])},hw=function(){return lw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},fw=function(){function t(t){var e=t[0],n=t[1];return s=null,r.point(e,n),s||(o.point(e,n),s)||(a.point(e,n),s)}function e(){return n=i=null,t}var n,i,r,o,a,s,u=hw(),c=lw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=lw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){s=[t,e]}};return t.invert=function(t){var e=u.scale(),n=u.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?c:r>=.166&&r<.234&&i>=-.214&&i<-.115?l:u).invert(t)},t.stream=function(t){return n&&i===t?n:n=uc([u.stream(i=t),c.stream(t),l.stream(t)])},t.precision=function(t){return arguments.length?(u.precision(t),c.precision(t),l.precision(t),e()):u.precision()},t.scale=function(e){return arguments.length?(u.scale(e),c.scale(.35*e),l.scale(e),t.translate(u.translate())):u.scale()},t.translate=function(t){if(!arguments.length)return u.translate();var n=u.scale(),i=+t[0],s=+t[1];return r=u.translate(t).clipExtent([[i-.455*n,s-.238*n],[i+.455*n,s+.238*n]]).stream(h),o=c.translate([i-.307*n,s+.201*n]).clipExtent([[i-.425*n+Px,s+.12*n+Px],[i-.214*n-Px,s+.234*n-Px]]).stream(h),a=l.translate([i-.205*n,s+.212*n]).clipExtent([[i-.214*n+Px,s+.166*n+Px],[i-.115*n-Px,s+.234*n-Px]]).stream(h),e()},t.fitExtent=function(e,n){return Qu(t,e,n)},t.fitSize=function(e,n){return tc(t,e,n)},t.scale(1070)},pw=cc(function(t){return Vx(2/(1+t))});pw.invert=lc(function(t){return 2*As(t/2)});var dw=function(){return ic(pw).scale(124.75).clipAngle(179.999)},mw=cc(function(t){return(t=Ps(t))&&t/jx(t)});mw.invert=lc(function(t){return t});var vw=function(){return ic(mw).scale(79.4188).clipAngle(179.999)};hc.invert=function(t,e){return[t,2*Bx(zx(e))-Lx]};var gw=function(){return fc(hc).scale(961/Rx)},yw=function(){return oc(dc).scale(109.5).parallels([30,30])};mc.invert=mc;var _w=function(){return ic(mc).scale(152.63)},xw=function(){return oc(vc).scale(131.154).center([0,13.9389])};gc.invert=lc(Bx);var bw=function(){return ic(gc).scale(144.049).clipAngle(60)},ww=function(){function t(){return r=o=null,a}var e,n,i,r,o,a,s=1,u=0,c=0,l=1,h=1,f=Ob,p=null,d=Ob;return a={stream:function(t){return r&&o===t?r:r=f(d(o=t))},clipExtent:function(r){return arguments.length?(d=null==r?(p=e=n=i=null,Ob):xu(p=+r[0][0],e=+r[0][1],n=+r[1][0],i=+r[1][1]),t()):null==p?null:[[p,e],[n,i]]},scale:function(e){return arguments.length?(f=yc((s=+e)*l,s*h,u,c),t()):s},translate:function(e){return arguments.length?(f=yc(s*l,s*h,u=+e[0],c=+e[1]),t()):[u,c]},reflectX:function(e){return arguments.length?(f=yc(s*(l=e?-1:1),s*h,u,c),t()):l<0},reflectY:function(e){return arguments.length?(f=yc(s*l,s*(h=e?-1:1),u,c),t()):h<0},fitExtent:function(t,e){return Qu(a,t,e)},fitSize:function(t,e){return tc(a,t,e)}}};_c.invert=lc(As);var Mw=function(){return ic(_c).scale(249.5).clipAngle(90+Px)};xc.invert=lc(function(t){return 2*Bx(t)});var Ew=function(){return ic(xc).scale(250).clipAngle(142)};bc.invert=function(t,e){return[-e,2*Bx(zx(t))-Lx]};var Tw=function(){var t=fc(bc),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90]).scale(159.155)};t.version=wc,t.bisect=Sc,t.bisectRight=Sc,t.bisectLeft=Pc,t.ascending=Mc,t.bisector=Ec,t.descending=Ac,t.deviation=Ic,t.extent=Rc,t.histogram=Xc,t.thresholdFreedmanDiaconis=Yc,t.thresholdScott=Wc,t.thresholdSturges=jc,t.max=qc,t.mean=$c,t.median=Zc,t.merge=Jc,t.min=Kc,t.pairs=Qc,t.permute=tl,t.quantile=Vc,t.range=Fc,t.scan=el,t.shuffle=nl,t.sum=il,t.ticks=Hc,t.tickStep=n,t.transpose=rl,t.variance=Lc,t.zip=ol,t.entries=hl,t.keys=cl,t.values=ll,t.map=o,t.set=h,t.nest=sl,t.randomUniform=fl,t.randomNormal=pl,t.randomLogNormal=dl,t.randomBates=vl,t.randomIrwinHall=ml,t.randomExponential=gl,t.easeLinear=f,t.easeQuad=m,t.easeQuadIn=p,t.easeQuadOut=d,t.easeQuadInOut=m,t.easeCubic=y,t.easeCubicIn=v,t.easeCubicOut=g,t.easeCubicInOut=y,t.easePoly=bl,t.easePolyIn=_l,t.easePolyOut=xl,t.easePolyInOut=bl,t.easeSin=b,t.easeSinIn=_,t.easeSinOut=x,t.easeSinInOut=b,t.easeExp=E,t.easeExpIn=w,t.easeExpOut=M,t.easeExpInOut=E,t.easeCircle=P,t.easeCircleIn=T,t.easeCircleOut=S,t.easeCircleInOut=P,t.easeBounce=C,t.easeBounceIn=A,t.easeBounceOut=C,t.easeBounceInOut=L,t.easeBack=Ul,t.easeBackIn=Dl,t.easeBackOut=Bl,t.easeBackInOut=Ul,t.easeElastic=Hl,t.easeElasticIn=Gl,t.easeElasticOut=Hl,t.easeElasticInOut=jl,t.polygonArea=Xl,t.polygonCentroid=Vl,t.polygonHull=Wl,t.polygonContains=ql,t.polygonLength=$l,t.path=O,t.quadtree=z,t.queue=$,t.arc=bh,t.area=Eh,t.line=Mh,t.pie=Ph,t.radialArea=Lh,t.radialLine=Ch,t.symbol=Zh,t.symbols=$h,t.symbolCircle=Ih,t.symbolCross=Rh,t.symbolDiamond=Dh,t.symbolSquare=Gh,t.symbolStar=zh,t.symbolTriangle=jh,t.symbolWye=qh,t.curveBasisClosed=Qh,t.curveBasisOpen=tf,t.curveBasis=Kh,t.curveBundle=ef,t.curveCardinalClosed=rf,t.curveCardinalOpen=of,t.curveCardinal=nf,t.curveCatmullRomClosed=sf,t.curveCatmullRomOpen=uf,t.curveCatmullRom=af,t.curveLinearClosed=cf,t.curveLinear=wh,t.curveMonotoneX=It,t.curveMonotoneY=Rt,t.curveNatural=lf,t.curveStep=hf,t.curveStepAfter=Ut,t.curveStepBefore=Bt,t.stack=mf,t.stackOffsetExpand=vf,t.stackOffsetNone=pf,t.stackOffsetSilhouette=gf,t.stackOffsetWiggle=yf,t.stackOrderAscending=_f,t.stackOrderDescending=xf,t.stackOrderInsideOut=bf,t.stackOrderNone=df,t.stackOrderReverse=wf,t.color=Ht,t.rgb=Yt,t.hsl=Zt,t.lab=te,t.hcl=se,t.cubehelix=le,t.interpolate=_p,t.interpolateArray=fp,t.interpolateDate=pp,t.interpolateNumber=dp,t.interpolateObject=mp,t.interpolateRound=xp,t.interpolateString=yp,t.interpolateTransformCss=Ep,t.interpolateTransformSvg=Tp,t.interpolateZoom=Lp,t.interpolateRgb=cp,t.interpolateRgbBasis=lp,t.interpolateRgbBasisClosed=hp,t.interpolateHsl=Ip,t.interpolateHslLong=Rp,t.interpolateLab=Ae,t.interpolateHcl=Np,t.interpolateHclLong=Op,t.interpolateCubehelix=Dp,t.interpolateCubehelixLong=Bp,t.interpolateBasis=ap,t.interpolateBasisClosed=sp,t.quantize=Up,t.dispatch=Ie,t.dsvFormat=Gp,t.csvParse=jp,t.csvParseRows=Xp,t.csvFormat=Vp,t.csvFormatRows=Yp,t.tsvParse=qp,t.tsvParseRows=$p,t.tsvFormat=Zp,t.tsvFormatRows=Jp,t.request=Kp,t.html=td,t.json=ed,t.text=nd,t.xml=id,t.csv=od,t.tsv=ad,t.now=He,t.timer=Ve,t.timerFlush=Ye,t.timeout=vd,t.interval=gd,t.timeInterval=Je,t.timeMillisecond=xd,t.timeMilliseconds=bd,t.timeSecond=Pd,t.timeSeconds=Ad,t.timeMinute=Cd,t.timeMinutes=Ld,t.timeHour=Id,t.timeHours=Rd,t.timeDay=Nd,t.timeDays=Od,t.timeWeek=Dd,t.timeWeeks=Hd,t.timeSunday=Dd,t.timeSundays=Hd,t.timeMonday=Bd,t.timeMondays=jd,t.timeTuesday=Ud,t.timeTuesdays=Xd;t.timeWednesday=Fd;t.timeWednesdays=Vd,t.timeThursday=kd,t.timeThursdays=Yd,t.timeFriday=zd,t.timeFridays=Wd,t.timeSaturday=Gd,t.timeSaturdays=qd,t.timeMonth=$d,t.timeMonths=Zd,t.timeYear=Jd,t.timeYears=Kd,t.utcMillisecond=xd,t.utcMilliseconds=bd,t.utcSecond=Pd,t.utcSeconds=Ad,t.utcMinute=Qd,t.utcMinutes=tm,t.utcHour=em,t.utcHours=nm,t.utcDay=im,t.utcDays=rm,t.utcWeek=om,t.utcWeeks=fm,t.utcSunday=om,t.utcSundays=fm,t.utcMonday=am,t.utcMondays=pm,t.utcTuesday=sm,t.utcTuesdays=dm,t.utcWednesday=um,t.utcWednesdays=mm,t.utcThursday=cm,t.utcThursdays=vm,t.utcFriday=lm,t.utcFridays=gm,t.utcSaturday=hm,t.utcSaturdays=ym,t.utcMonth=_m,t.utcMonths=xm,t.utcYear=bm,t.utcYears=Mm,t.formatLocale=Dm,t.formatDefaultLocale=nn,t.formatSpecifier=Rm,t.precisionFixed=Um,t.precisionPrefix=Fm,t.precisionRound=km,t.isoFormat=Vm,t.isoParse=Ym,t.timeFormatLocale=sn,t.timeFormatDefaultLocale=ei,t.scaleBand=oi,t.scalePoint=si,t.scaleIdentity=gi,t.scaleLinear=vi,t.scaleLog=Ei,t.scaleOrdinal=ri,t.scaleImplicit=Zm,t.scalePow=Si,t.scaleSqrt=Pi,t.scaleQuantile=Ai,t.scaleQuantize=Ci,t.scaleThreshold=Li,t.scaleTime=cv,t.scaleUtc=lv,t.schemeCategory10=fv,t.schemeCategory20b=pv,t.schemeCategory20c=dv,t.schemeCategory20=mv,t.scaleSequential=Di,t.interpolateCubehelixDefault=vv,t.interpolateRainbow=xv,t.interpolateWarm=gv,t.interpolateCool=yv,t.interpolateViridis=bv,t.interpolateMagma=wv,t.interpolateInferno=Mv,t.interpolatePlasma=Ev,t.creator=Av,t.customEvent=Vi,t.local=Fi,t.matcher=Nv,t.mouse=kv,t.namespace=Pv,t.namespaces=Sv,t.select=bg,t.selectAll=wg,t.selection=Rr,t.selector=zv,t.selectorAll=Hv,t.touch=Mg,t.touches=Eg,t.window=sg,t.active=sy,t.interrupt=Dg,t.transition=lo,t.axisTop=_o,t.axisRight=xo,t.axisBottom=bo,t.axisLeft=wo,t.cluster=my,t.hierarchy=Io,t.pack=Ly,t.packSiblings=Ay,t.packEnclose=Py,t.partition=Ny,t.stratify=Uy,t.tree=Fy,t.treemap=Hy,t.treemapBinary=jy,t.treemapDice=Ry,t.treemapSlice=ky,t.treemapSliceDice=Xy,t.treemapSquarify=Gy,t.treemapResquarify=Vy,t.forceCenter=Yy,t.forceCollide=$y,t.forceLink=Zy,t.forceManyBody=t_,t.forceSimulation=Qy,t.forceX=e_,t.forceY=n_,t.drag=a_,t.dragDisable=r_,t.dragEnable=_a,t.voronoi=g_,t.zoom=b_,t.zoomIdentity=__,t.zoomTransform=rs,t.brush=U_,t.brushX=vs,t.brushY=gs,t.brushSelection=ms,t.chord=X_,t.ribbon=W_,t.geoAlbers=hw,t.geoAlbersUsa=fw,t.geoArea=Qx,t.geoAzimuthalEqualArea=dw,t.geoAzimuthalEqualAreaRaw=pw,t.geoAzimuthalEquidistant=vw,t.geoAzimuthalEquidistantRaw=mw,t.geoBounds=nb,t.geoCentroid=rb,t.geoCircle=_b,t.geoClipExtent=Sb,t.geoConicConformal=yw,
t.geoConicConformalRaw=dc,t.geoConicEqualArea=lw,t.geoConicEqualAreaRaw=sc,t.geoConicEquidistant=xw,t.geoConicEquidistantRaw=vc,t.geoDistance=Rb,t.geoEquirectangular=_w,t.geoEquirectangularRaw=mc,t.geoGnomonic=bw,t.geoGnomonicRaw=gc,t.geoGraticule=Pu,t.geoGraticule10=Au,t.geoIdentity=ww,t.geoInterpolate=Nb,t.geoLength=Cb,t.geoMercator=gw,t.geoMercatorRaw=hc,t.geoOrthographic=Mw,t.geoOrthographicRaw=_c,t.geoPath=Qb,t.geoProjection=ic,t.geoProjectionMutator=rc,t.geoRotation=yb,t.geoStereographic=Ew,t.geoStereographicRaw=xc,t.geoStream=$x,t.geoTransform=ow,t.geoTransverseMercator=Tw,t.geoTransverseMercatorRaw=bc,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){var i,r;!function(o,a){i=a,r="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==r&&(t.exports=r))}("undefined"!=typeof window?window:this,function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var n=this._events=this._events||{},i=n[t]=n[t]||[];return i.indexOf(e)==-1&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var n=this._onceEvents=this._onceEvents||{},i=n[t]=n[t]||{};return i[e]=!0,this}},e.off=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var i=n.indexOf(e);return i!=-1&&n.splice(i,1),this}},e.emitEvent=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var i=0,r=n[i];e=e||[];for(var o=this._onceEvents&&this._onceEvents[t];r;){var a=o&&o[r];a&&(this.off(t,r),delete o[r]),r.apply(this,e),i+=a?0:1,r=n[i]}return this}},t})},function(t,e,n){(function(e){/*!
	 * Vue.js v2.1.8
	 * (c) 2014-2016 Evan You
	 * Released under the MIT License.
	 */
"use strict";function n(t){return null==t?"":"object"==typeof t?JSON.stringify(t,null,2):String(t)}function i(t){var e=parseFloat(t,10);return e||0===e?e:t}function r(t,e){for(var n=Object.create(null),i=t.split(","),r=0;r<i.length;r++)n[i[r]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}function o(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}function a(t,e){return rr.call(t,e)}function s(t){return"string"==typeof t||"number"==typeof t}function u(t){var e=Object.create(null);return function(n){var i=e[n];return i||(e[n]=t(n))}}function c(t,e){function n(n){var i=arguments.length;return i?i>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n}function l(t,e){e=e||0;for(var n=t.length-e,i=new Array(n);n--;)i[n]=t[n+e];return i}function h(t,e){for(var n in e)t[n]=e[n];return t}function f(t){return null!==t&&"object"==typeof t}function p(t){return lr.call(t)===hr}function d(t){for(var e={},n=0;n<t.length;n++)t[n]&&h(e,t[n]);return e}function m(){}function v(t){return t.reduce(function(t,e){return t.concat(e.staticKeys||[])},[]).join(",")}function g(t,e){var n=f(t),i=f(e);return n&&i?JSON.stringify(t)===JSON.stringify(e):!n&&!i&&String(t)===String(e)}function y(t,e){for(var n=0;n<t.length;n++)if(g(t[n],e))return n;return-1}function _(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function x(t,e,n,i){Object.defineProperty(t,e,{value:n,enumerable:!!i,writable:!0,configurable:!0})}function b(t){if(!mr.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}function w(t){return/native code/.test(t.toString())}function M(t){Lr.target&&Ir.push(Lr.target),Lr.target=t}function E(){Lr.target=Ir.pop()}function T(t,e){t.__proto__=e}function S(t,e,n){for(var i=0,r=n.length;i<r;i++){var o=n[i];x(t,o,e[o])}}function P(t,e){if(f(t)){var n;return a(t,"__ob__")&&t.__ob__ instanceof Br?n=t.__ob__:Dr.shouldConvert&&!Er()&&(Array.isArray(t)||p(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Br(t)),e&&n&&n.vmCount++,n}}function A(t,e,n,i){var r=new Lr,o=Object.getOwnPropertyDescriptor(t,e);if(!o||o.configurable!==!1){var a=o&&o.get,s=o&&o.set,u=P(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):n;return Lr.target&&(r.depend(),u&&u.dep.depend(),Array.isArray(e)&&I(e)),e},set:function(e){var i=a?a.call(t):n;e===i||e!==e&&i!==i||(s?s.call(t,e):n=e,u=P(e),r.notify())}})}}function C(t,e,n){if(Array.isArray(t))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(a(t,e))return void(t[e]=n);var i=t.__ob__;if(!(t._isVue||i&&i.vmCount))return i?(A(i.value,e,n),i.dep.notify(),n):void(t[e]=n)}function L(t,e){var n=t.__ob__;t._isVue||n&&n.vmCount||a(t,e)&&(delete t[e],n&&n.dep.notify())}function I(t){for(var e=void 0,n=0,i=t.length;n<i;n++)e=t[n],e&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&I(e)}function R(t,e){if(!e)return t;for(var n,i,r,o=Object.keys(e),s=0;s<o.length;s++)n=o[s],i=t[n],r=e[n],a(t,n)?p(i)&&p(r)&&R(i,r):C(t,n,r);return t}function N(t,e){return e?t?t.concat(e):Array.isArray(e)?e:[e]:t}function O(t,e){var n=Object.create(t||null);return e?h(n,e):n}function D(t){var e=t.props;if(e){var n,i,r,o={};if(Array.isArray(e))for(n=e.length;n--;)i=e[n],"string"==typeof i&&(r=ar(i),o[r]={type:null});else if(p(e))for(var a in e)i=e[a],r=ar(a),o[r]=p(i)?i:{type:i};t.props=o}}function B(t){var e=t.directives;if(e)for(var n in e){var i=e[n];"function"==typeof i&&(e[n]={bind:i,update:i})}}function U(t,e,n){function i(i){var r=Ur[i]||Fr;l[i]=r(t[i],e[i],n,i)}D(e),B(e);var r=e.extends;if(r&&(t="function"==typeof r?U(t,r.options,n):U(t,r,n)),e.mixins)for(var o=0,s=e.mixins.length;o<s;o++){var u=e.mixins[o];u.prototype instanceof Xt&&(u=u.options),t=U(t,u,n)}var c,l={};for(c in t)i(c);for(c in e)a(t,c)||i(c);return l}function F(t,e,n,i){if("string"==typeof n){var r=t[e];if(a(r,n))return r[n];var o=ar(n);if(a(r,o))return r[o];var s=sr(o);if(a(r,s))return r[s];var u=r[n]||r[o]||r[s];return u}}function k(t,e,n,i){var r=e[t],o=!a(n,t),s=n[t];if(H(Boolean,r.type)&&(o&&!a(r,"default")?s=!1:H(String,r.type)||""!==s&&s!==cr(t)||(s=!0)),void 0===s){s=z(i,r,t);var u=Dr.shouldConvert;Dr.shouldConvert=!0,P(s),Dr.shouldConvert=u}return s}function z(t,e,n){if(a(e,"default")){var i=e.default;return f(i),t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t[n]?t[n]:"function"==typeof i&&e.type!==Function?i.call(t):i}}function G(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e&&e[1]}function H(t,e){if(!Array.isArray(e))return G(e)===G(t);for(var n=0,i=e.length;n<i;n++)if(G(e[n])===G(t))return!0;return!1}function j(){zr.length=0,Gr={},Hr=jr=!1}function X(){for(jr=!0,zr.sort(function(t,e){return t.id-e.id}),Xr=0;Xr<zr.length;Xr++){var t=zr[Xr],e=t.id;Gr[e]=null,t.run()}Tr&&dr.devtools&&Tr.emit("flush"),j()}function V(t){var e=t.id;if(null==Gr[e]){if(Gr[e]=!0,jr){for(var n=zr.length-1;n>=0&&zr[n].id>t.id;)n--;zr.splice(Math.max(n,Xr)+1,0,t)}else zr.push(t);Hr||(Hr=!0,Sr(X))}}function Y(t){qr.clear(),W(t,qr)}function W(t,e){var n,i,r=Array.isArray(t);if((r||f(t))&&Object.isExtensible(t)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(r)for(n=t.length;n--;)W(t[n],e);else for(i=Object.keys(t),n=i.length;n--;)W(t[i[n]],e)}}function q(t){t._watchers=[];var e=t.$options;e.props&&$(t,e.props),e.methods&&Q(t,e.methods),e.data?Z(t):P(t._data={},!0),e.computed&&J(t,e.computed),e.watch&&tt(t,e.watch)}function $(t,e){var n=t.$options.propsData||{},i=t.$options._propKeys=Object.keys(e),r=!t.$parent;Dr.shouldConvert=r;for(var o=function(r){var o=i[r];A(t,o,k(o,e,n,t))},a=0;a<i.length;a++)o(a);Dr.shouldConvert=!0}function Z(t){var e=t.$options.data;e=t._data="function"==typeof e?e.call(t):e||{},p(e)||(e={});for(var n=Object.keys(e),i=t.$options.props,r=n.length;r--;)i&&a(i,n[r])||it(t,n[r]);P(e,!0)}function J(t,e){for(var n in e){var i=e[n];"function"==typeof i?($r.get=K(i,t),$r.set=m):($r.get=i.get?i.cache!==!1?K(i.get,t):c(i.get,t):m,$r.set=i.set?c(i.set,t):m),Object.defineProperty(t,n,$r)}}function K(t,e){var n=new Yr(e,t,m,{lazy:!0});return function(){return n.dirty&&n.evaluate(),Lr.target&&n.depend(),n.value}}function Q(t,e){for(var n in e)t[n]=null==e[n]?m:c(e[n],t)}function tt(t,e){for(var n in e){var i=e[n];if(Array.isArray(i))for(var r=0;r<i.length;r++)et(t,n,i[r]);else et(t,n,i)}}function et(t,e,n){var i;p(n)&&(i=n,n=n.handler),"string"==typeof n&&(n=t[n]),t.$watch(e,n,i)}function nt(t){var e={};e.get=function(){return this._data},Object.defineProperty(t.prototype,"$data",e),t.prototype.$set=C,t.prototype.$delete=L,t.prototype.$watch=function(t,e,n){var i=this;n=n||{},n.user=!0;var r=new Yr(i,t,e,n);return n.immediate&&e.call(i,r.value),function(){r.teardown()}}}function it(t,e){_(e)||Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return t._data[e]},set:function(n){t._data[e]=n}})}function rt(t){return new Zr(void 0,void 0,void 0,String(t))}function ot(t){var e=new Zr(t.tag,t.data,t.children,t.text,t.elm,t.context,t.componentOptions);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isCloned=!0,e}function at(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=ot(t[n]);return e}function st(t,e,n,i){i+=e;var r=t.__injected||(t.__injected={});if(!r[i]){r[i]=!0;var o=t[e];o?t[e]=function(){o.apply(this,arguments),n.apply(this,arguments)}:t[e]=n}}function ut(t,e,n,i,r){var o,a,s,u,c,l,h;for(o in t)if(a=t[o],s=e[o],a)if(s){if(a!==s)if(Array.isArray(s)){s.length=a.length;for(var f=0;f<s.length;f++)s[f]=a[f];t[o]=s}else s.fn=a,t[o]=s}else h="~"===o.charAt(0),c=h?o.slice(1):o,l="!"===c.charAt(0),c=l?c.slice(1):c,Array.isArray(a)?n(c,a.invoker=ct(a),h,l):(a.invoker||(u=a,a=t[o]={},a.fn=u,a.invoker=lt(a)),n(c,a.invoker,h,l));else;for(o in e)t[o]||(h="~"===o.charAt(0),c=h?o.slice(1):o,l="!"===c.charAt(0),c=l?c.slice(1):c,i(c,e[o].invoker,l))}function ct(t){return function(e){for(var n=arguments,i=1===arguments.length,r=0;r<t.length;r++)i?t[r](e):t[r].apply(null,n)}}function lt(t){return function(e){var n=1===arguments.length;n?t.fn(e):t.fn.apply(null,arguments)}}function ht(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}function ft(t){return s(t)?[rt(t)]:Array.isArray(t)?pt(t):void 0}function pt(t,e){var n,i,r,o=[];for(n=0;n<t.length;n++)i=t[n],null!=i&&"boolean"!=typeof i&&(r=o[o.length-1],Array.isArray(i)?o.push.apply(o,pt(i,(e||"")+"_"+n)):s(i)?r&&r.text?r.text+=String(i):""!==i&&o.push(rt(i)):i.text&&r&&r.text?o[o.length-1]=rt(r.text+i.text):(i.tag&&null==i.key&&null!=e&&(i.key="__vlist"+e+"_"+n+"__"),o.push(i)));return o}function dt(t){return t&&t.filter(function(t){return t&&t.componentOptions})[0]}function mt(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&yt(t,e)}function vt(t,e,n){n?Wr.$once(t,e):Wr.$on(t,e)}function gt(t,e){Wr.$off(t,e)}function yt(t,e,n){Wr=t,ut(e,n||{},vt,gt,t)}function _t(t){var e=/^hook:/;t.prototype.$on=function(t,n){var i=this;return(i._events[t]||(i._events[t]=[])).push(n),e.test(t)&&(i._hasHookEvent=!0),i},t.prototype.$once=function(t,e){function n(){i.$off(t,n),e.apply(i,arguments)}var i=this;return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;var i=n._events[t];if(!i)return n;if(1===arguments.length)return n._events[t]=null,n;for(var r,o=i.length;o--;)if(r=i[o],r===e||r.fn===e){i.splice(o,1);break}return n},t.prototype.$emit=function(t){var e=this,n=e._events[t];if(n){n=n.length>1?l(n):n;for(var i=l(arguments,1),r=0,o=n.length;r<o;r++)n[r].apply(e,i)}return e}}function xt(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function bt(t){t.prototype._mount=function(t,e){var n=this;return n.$el=t,n.$options.render||(n.$options.render=Jr),wt(n,"beforeMount"),n._watcher=new Yr(n,function(){n._update(n._render(),e)},m),e=!1,null==n.$vnode&&(n._isMounted=!0,wt(n,"mounted")),n},t.prototype._update=function(t,e){var n=this;n._isMounted&&wt(n,"beforeUpdate");var i=n.$el,r=n._vnode,o=Kr;Kr=n,n._vnode=t,r?n.$el=n.__patch__(r,t):n.$el=n.__patch__(n.$el,t,e,!1,n.$options._parentElm,n.$options._refElm),Kr=o,i&&(i.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el),n._isMounted&&wt(n,"updated")},t.prototype._updateFromParent=function(t,e,n,i){var r=this,o=!(!r.$options._renderChildren&&!i);if(r.$options._parentVnode=n,r.$vnode=n,r._vnode&&(r._vnode.parent=n),r.$options._renderChildren=i,t&&r.$options.props){Dr.shouldConvert=!1;for(var a=r.$options._propKeys||[],s=0;s<a.length;s++){var u=a[s];r[u]=k(u,r.$options.props,t,r)}Dr.shouldConvert=!0,r.$options.propsData=t}if(e){var c=r.$options._parentListeners;r.$options._parentListeners=e,yt(r,e,c)}o&&(r.$slots=zt(i,n.context),r.$forceUpdate())},t.prototype.$forceUpdate=function(){var t=this;t._watcher&&t._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){wt(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||o(e.$children,t),t._watcher&&t._watcher.teardown();for(var n=t._watchers.length;n--;)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,wt(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.__patch__(t._vnode,null)}}}function wt(t,e){var n=t.$options[e];if(n)for(var i=0,r=n.length;i<r;i++)n[i].call(t);t._hasHookEvent&&t.$emit("hook:"+e)}function Mt(t,e,n,i,r){if(t){var o=n.$options._base;if(f(t)&&(t=o.extend(t)),"function"==typeof t){if(!t.cid)if(t.resolved)t=t.resolved;else if(t=Lt(t,o,function(){n.$forceUpdate()}),!t)return;jt(t),e=e||{};var a=It(e,t);if(t.options.functional)return Et(t,a,e,n,i);var s=e.on;e.on=e.nativeOn,t.options.abstract&&(e={}),Nt(e);var u=t.options.name||r,c=new Zr("vue-component-"+t.cid+(u?"-"+u:""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:a,listeners:s,tag:r,children:i});return c}}}function Et(t,e,n,i,r){var o={},a=t.options.props;if(a)for(var s in a)o[s]=k(s,a,e);var u=Object.create(i),c=function(t,e,n,i){return Dt(u,t,e,n,i,!0)},l=t.options.render.call(null,c,{props:o,data:n,parent:i,children:r,slots:function(){return zt(r,i)}});return l instanceof Zr&&(l.functionalContext=i,n.slot&&((l.data||(l.data={})).slot=n.slot)),l}function Tt(t,e,n,i){var r=t.componentOptions,o={_isComponent:!0,parent:e,propsData:r.propsData,_componentTag:r.tag,_parentVnode:t,_parentListeners:r.listeners,_renderChildren:r.children,_parentElm:n||null,_refElm:i||null},a=t.data.inlineTemplate;return a&&(o.render=a.render,o.staticRenderFns=a.staticRenderFns),new r.Ctor(o)}function St(t,e,n,i){if(!t.child||t.child._isDestroyed){var r=t.child=Tt(t,Kr,n,i);r.$mount(e?t.elm:void 0,e)}else if(t.data.keepAlive){var o=t;Pt(o,o)}}function Pt(t,e){var n=e.componentOptions,i=e.child=t.child;i._updateFromParent(n.propsData,n.listeners,e,n.children)}function At(t){t.child._isMounted||(t.child._isMounted=!0,wt(t.child,"mounted")),t.data.keepAlive&&(t.child._inactive=!1,wt(t.child,"activated"))}function Ct(t){t.child._isDestroyed||(t.data.keepAlive?(t.child._inactive=!0,wt(t.child,"deactivated")):t.child.$destroy())}function Lt(t,e,n){if(!t.requested){t.requested=!0;var i=t.pendingCallbacks=[n],r=!0,o=function(n){if(f(n)&&(n=e.extend(n)),t.resolved=n,!r)for(var o=0,a=i.length;o<a;o++)i[o](n)},a=function(t){},s=t(o,a);return s&&"function"==typeof s.then&&!t.resolved&&s.then(o,a),r=!1,t.resolved}t.pendingCallbacks.push(n)}function It(t,e){var n=e.options.props;if(n){var i={},r=t.attrs,o=t.props,a=t.domProps;if(r||o||a)for(var s in n){var u=cr(s);Rt(i,o,s,u,!0)||Rt(i,r,s,u)||Rt(i,a,s,u)}return i}}function Rt(t,e,n,i,r){if(e){if(a(e,n))return t[n]=e[n],r||delete e[n],!0;if(a(e,i))return t[n]=e[i],r||delete e[i],!0}return!1}function Nt(t){t.hook||(t.hook={});for(var e=0;e<to.length;e++){var n=to[e],i=t.hook[n],r=Qr[n];t.hook[n]=i?Ot(r,i):r}}function Ot(t,e){return function(n,i,r,o){t(n,i,r,o),e(n,i,r,o)}}function Dt(t,e,n,i,r,o){return(Array.isArray(n)||s(n))&&(r=i,i=n,n=void 0),o&&(r=no),Bt(t,e,n,i,r)}function Bt(t,e,n,i,r){if(n&&n.__ob__)return Jr();if(!e)return Jr();Array.isArray(i)&&"function"==typeof i[0]&&(n=n||{},n.scopedSlots={default:i[0]},i.length=0),r===no?i=ft(i):r===eo&&(i=ht(i));var o,a;if("string"==typeof e){var s;a=dr.getTagNamespace(e),o=dr.isReservedTag(e)?new Zr(dr.parsePlatformTagName(e),n,i,void 0,void 0,t):(s=F(t.$options,"components",e))?Mt(s,n,t,i,e):new Zr(e,n,i,void 0,void 0,t)}else o=Mt(e,n,t,i);return o?(a&&Ut(o,a),o):Jr()}function Ut(t,e){if(t.ns=e,"foreignObject"!==t.tag&&t.children)for(var n=0,i=t.children.length;n<i;n++){var r=t.children[n];r.tag&&!r.ns&&Ut(r,e)}}function Ft(t){t.$vnode=null,t._vnode=null,t._staticTrees=null;var e=t.$options._parentVnode,n=e&&e.context;t.$slots=zt(t.$options._renderChildren,n),t.$scopedSlots={},t._c=function(e,n,i,r){return Dt(t,e,n,i,r,!1)},t.$createElement=function(e,n,i,r){return Dt(t,e,n,i,r,!0)},t.$options.el&&t.$mount(t.$options.el)}function kt(t){function e(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i]&&"string"!=typeof t[i]&&r(t[i],e+"_"+i,n);else r(t,e,n)}function r(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}t.prototype.$nextTick=function(t){return Sr(t,this)},t.prototype._render=function(){var t=this,e=t.$options,n=e.render,i=e.staticRenderFns,r=e._parentVnode;if(t._isMounted)for(var o in t.$slots)t.$slots[o]=at(t.$slots[o]);r&&r.data.scopedSlots&&(t.$scopedSlots=r.data.scopedSlots),i&&!t._staticTrees&&(t._staticTrees=[]),t.$vnode=r;var a;try{a=n.call(t._renderProxy,t.$createElement)}catch(e){if(!dr.errorHandler)throw e;dr.errorHandler.call(null,e,t),a=t._vnode}return a instanceof Zr||(a=Jr()),a.parent=r,a},t.prototype._s=n,t.prototype._v=rt,t.prototype._n=i,t.prototype._e=Jr,t.prototype._q=g,t.prototype._i=y,t.prototype._m=function(t,n){var i=this._staticTrees[t];return i&&!n?Array.isArray(i)?at(i):ot(i):(i=this._staticTrees[t]=this.$options.staticRenderFns[t].call(this._renderProxy),e(i,"__static__"+t,!1),i)},t.prototype._o=function(t,n,i){return e(t,"__once__"+n+(i?"_"+i:""),!0),t},t.prototype._f=function(t){return F(this.$options,"filters",t,!0)||pr},t.prototype._l=function(t,e){var n,i,r,o,a;if(Array.isArray(t)||"string"==typeof t)for(n=new Array(t.length),i=0,r=t.length;i<r;i++)n[i]=e(t[i],i);else if("number"==typeof t)for(n=new Array(t),i=0;i<t;i++)n[i]=e(i+1,i);else if(f(t))for(o=Object.keys(t),n=new Array(o.length),i=0,r=o.length;i<r;i++)a=o[i],n[i]=e(t[a],a,i);return n},t.prototype._t=function(t,e,n,i){var r=this.$scopedSlots[t];if(r)return n=n||{},i&&h(n,i),r(n)||e;var o=this.$slots[t];return o||e},t.prototype._b=function(t,e,n,i){if(n)if(f(n)){Array.isArray(n)&&(n=d(n));for(var r in n)if("class"===r||"style"===r)t[r]=n[r];else{var o=i||dr.mustUseProp(e,r)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={});o[r]=n[r]}}else;return t},t.prototype._k=function(t,e,n){var i=dr.keyCodes[e]||n;return Array.isArray(i)?i.indexOf(t)===-1:i!==t}}function zt(t,e){var n={};if(!t)return n;for(var i,r,o=[],a=0,s=t.length;a<s;a++)if(r=t[a],(r.context===e||r.functionalContext===e)&&r.data&&(i=r.data.slot)){var u=n[i]||(n[i]=[]);"template"===r.tag?u.push.apply(u,r.children):u.push(r)}else o.push(r);return o.length&&(1!==o.length||" "!==o[0].text&&!o[0].isComment)&&(n.default=o),n}function Gt(t){t.prototype._init=function(t){var e=this;e._uid=io++,e._isVue=!0,t&&t._isComponent?Ht(e,t):e.$options=U(jt(e.constructor),t||{},e),e._renderProxy=e,e._self=e,xt(e),mt(e),wt(e,"beforeCreate"),q(e),wt(e,"created"),Ft(e)}}function Ht(t,e){var n=t.$options=Object.create(t.constructor.options);n.parent=e.parent,n.propsData=e.propsData,n._parentVnode=e._parentVnode,n._parentListeners=e._parentListeners,n._renderChildren=e._renderChildren,n._componentTag=e._componentTag,n._parentElm=e._parentElm,n._refElm=e._refElm,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function jt(t){var e=t.options;if(t.super){var n=t.super.options,i=t.superOptions,r=t.extendOptions;n!==i&&(t.superOptions=n,r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._scopeId=e._scopeId,e=t.options=U(n,r),e.name&&(e.components[e.name]=t))}return e}function Xt(t){this._init(t)}function Vt(t){t.use=function(t){if(!t.installed){var e=l(arguments,1);return e.unshift(this),"function"==typeof t.install?t.install.apply(t,e):t.apply(null,e),t.installed=!0,this}}}function Yt(t){t.mixin=function(t){this.options=U(this.options,t)}}function Wt(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,i=n.cid,r=t._Ctor||(t._Ctor={});if(r[i])return r[i];var o=t.name||n.options.name,a=function(t){this._init(t)};return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.cid=e++,a.options=U(n.options,t),a.super=n,a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,dr._assetTypes.forEach(function(t){a[t]=n[t]}),o&&(a.options.components[o]=a),a.superOptions=n.options,a.extendOptions=t,r[i]=a,a}}function qt(t){dr._assetTypes.forEach(function(e){t[e]=function(t,n){return n?("component"===e&&p(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"==typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}})}function $t(t,e){return"string"==typeof t?t.split(",").indexOf(e)>-1:t.test(e)}function Zt(t){var e={};e.get=function(){return dr},Object.defineProperty(t,"config",e),t.util=kr,t.set=C,t.delete=L,t.nextTick=Sr,t.options=Object.create(null),dr._assetTypes.forEach(function(e){t.options[e+"s"]=Object.create(null)}),t.options._base=t,h(t.options.components,ao),Vt(t),Yt(t),Wt(t),qt(t)}function Jt(t){for(var e=t.data,n=t,i=t;i.child;)i=i.child._vnode,i.data&&(e=Kt(i.data,e));for(;n=n.parent;)n.data&&(e=Kt(e,n.data));return Qt(e)}function Kt(t,e){return{staticClass:te(t.staticClass,e.staticClass),class:t.class?[t.class,e.class]:e.class}}function Qt(t){var e=t.class,n=t.staticClass;return n||e?te(n,ee(e)):""}function te(t,e){return t?e?t+" "+e:t:e||""}function ee(t){var e="";if(!t)return e;if("string"==typeof t)return t;if(Array.isArray(t)){for(var n,i=0,r=t.length;i<r;i++)t[i]&&(n=ee(t[i]))&&(e+=n+" ");return e.slice(0,-1)}if(f(t)){for(var o in t)t[o]&&(e+=o+" ");return e.slice(0,-1)}return e}function ne(t){return xo(t)?"svg":"math"===t?"math":void 0}function ie(t){if(!gr)return!0;if(wo(t))return!1;if(t=t.toLowerCase(),null!=Mo[t])return Mo[t];var e=document.createElement(t);return t.indexOf("-")>-1?Mo[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Mo[t]=/HTMLUnknownElement/.test(e.toString())}function re(t){if("string"==typeof t){if(t=document.querySelector(t),!t)return document.createElement("div")}return t}function oe(t,e){var n=document.createElement(t);return"select"!==t?n:(e.data&&e.data.attrs&&"multiple"in e.data.attrs&&n.setAttribute("multiple","multiple"),n)}function ae(t,e){return document.createElementNS(yo[t],e)}function se(t){return document.createTextNode(t)}function ue(t){return document.createComment(t)}function ce(t,e,n){t.insertBefore(e,n)}function le(t,e){t.removeChild(e)}function he(t,e){t.appendChild(e)}function fe(t){return t.parentNode}function pe(t){return t.nextSibling}function de(t){return t.tagName}function me(t,e){t.textContent=e}function ve(t,e,n){t.setAttribute(e,n)}function ge(t,e){var n=t.data.ref;if(n){var i=t.context,r=t.child||t.elm,a=i.$refs;e?Array.isArray(a[n])?o(a[n],r):a[n]===r&&(a[n]=void 0):t.data.refInFor?Array.isArray(a[n])&&a[n].indexOf(r)<0?a[n].push(r):a[n]=[r]:a[n]=r}}function ye(t){return null==t}function _e(t){return null!=t}function xe(t,e){return t.key===e.key&&t.tag===e.tag&&t.isComment===e.isComment&&!t.data==!e.data}function be(t,e,n){var i,r,o={};for(i=e;i<=n;++i)r=t[i].key,_e(r)&&(o[r]=i);return o}function we(t){function e(t){return new Zr(P.tagName(t).toLowerCase(),{},[],void 0,t)}function n(t,e){function n(){0===--n.listeners&&i(t)}return n.listeners=e,n}function i(t){var e=P.parentNode(t);e&&P.removeChild(e,t)}function o(t,e,n,i,r){if(t.isRootInsert=!r,!a(t,e,n,i)){var o=t.data,s=t.children,u=t.tag;_e(u)?(t.elm=t.ns?P.createElementNS(t.ns,u):P.createElement(u,t),d(t),l(t,s,e),_e(o)&&f(t,e),c(n,t.elm,i)):t.isComment?(t.elm=P.createComment(t.text),c(n,t.elm,i)):(t.elm=P.createTextNode(t.text),c(n,t.elm,i))}}function a(t,e,n,i){var r=t.data;if(_e(r)){var o=_e(t.child)&&r.keepAlive;if(_e(r=r.hook)&&_e(r=r.init)&&r(t,!1,n,i),_e(t.child))return p(t,e),o&&u(t,e,n,i),!0}}function u(t,e,n,i){for(var r,o=t;o.child;)if(o=o.child._vnode,_e(r=o.data)&&_e(r=r.transition)){for(r=0;r<T.activate.length;++r)T.activate[r](So,o);e.push(o);break}c(n,t.elm,i)}function c(t,e,n){t&&(n?P.insertBefore(t,e,n):P.appendChild(t,e))}function l(t,e,n){if(Array.isArray(e))for(var i=0;i<e.length;++i)o(e[i],n,t.elm,null,!0);else s(t.text)&&P.appendChild(t.elm,P.createTextNode(t.text))}function h(t){for(;t.child;)t=t.child._vnode;return _e(t.tag)}function f(t,e){for(var n=0;n<T.create.length;++n)T.create[n](So,t);M=t.data.hook,_e(M)&&(M.create&&M.create(So,t),M.insert&&e.push(t))}function p(t,e){t.data.pendingInsert&&e.push.apply(e,t.data.pendingInsert),t.elm=t.child.$el,h(t)?(f(t,e),d(t)):(ge(t),e.push(t))}function d(t){var e;_e(e=t.context)&&_e(e=e.$options._scopeId)&&P.setAttribute(t.elm,e,""),_e(e=Kr)&&e!==t.context&&_e(e=e.$options._scopeId)&&P.setAttribute(t.elm,e,"")}function m(t,e,n,i,r,a){for(;i<=r;++i)o(n[i],a,t,e)}function v(t){var e,n,i=t.data;if(_e(i))for(_e(e=i.hook)&&_e(e=e.destroy)&&e(t),e=0;e<T.destroy.length;++e)T.destroy[e](t);if(_e(e=t.children))for(n=0;n<t.children.length;++n)v(t.children[n])}function g(t,e,n,r){for(;n<=r;++n){var o=e[n];_e(o)&&(_e(o.tag)?(y(o),v(o)):i(o.elm))}}function y(t,e){if(e||_e(t.data)){var r=T.remove.length+1;for(e?e.listeners+=r:e=n(t.elm,r),_e(M=t.child)&&_e(M=M._vnode)&&_e(M.data)&&y(M,e),M=0;M<T.remove.length;++M)T.remove[M](t,e);_e(M=t.data.hook)&&_e(M=M.remove)?M(t,e):e()}else i(t.elm)}function _(t,e,n,i,r){for(var a,s,u,c,l=0,h=0,f=e.length-1,p=e[0],d=e[f],v=n.length-1,y=n[0],_=n[v],b=!r;l<=f&&h<=v;)ye(p)?p=e[++l]:ye(d)?d=e[--f]:xe(p,y)?(x(p,y,i),p=e[++l],y=n[++h]):xe(d,_)?(x(d,_,i),d=e[--f],_=n[--v]):xe(p,_)?(x(p,_,i),b&&P.insertBefore(t,p.elm,P.nextSibling(d.elm)),p=e[++l],_=n[--v]):xe(d,y)?(x(d,y,i),b&&P.insertBefore(t,d.elm,p.elm),d=e[--f],y=n[++h]):(ye(a)&&(a=be(e,l,f)),s=_e(y.key)?a[y.key]:null,ye(s)?(o(y,i,t,p.elm),y=n[++h]):(u=e[s],xe(u,y)?(x(u,y,i),e[s]=void 0,b&&P.insertBefore(t,y.elm,p.elm),y=n[++h]):(o(y,i,t,p.elm),y=n[++h])));l>f?(c=ye(n[v+1])?null:n[v+1].elm,m(t,c,n,h,v,i)):h>v&&g(t,e,l,f)}function x(t,e,n,i){if(t!==e){if(e.isStatic&&t.isStatic&&e.key===t.key&&(e.isCloned||e.isOnce))return e.elm=t.elm,void(e.child=t.child);var r,o=e.data,a=_e(o);a&&_e(r=o.hook)&&_e(r=r.prepatch)&&r(t,e);var s=e.elm=t.elm,u=t.children,c=e.children;if(a&&h(e)){for(r=0;r<T.update.length;++r)T.update[r](t,e);_e(r=o.hook)&&_e(r=r.update)&&r(t,e)}ye(e.text)?_e(u)&&_e(c)?u!==c&&_(s,u,c,n,i):_e(c)?(_e(t.text)&&P.setTextContent(s,""),m(s,null,c,0,c.length-1,n)):_e(u)?g(s,u,0,u.length-1):_e(t.text)&&P.setTextContent(s,""):t.text!==e.text&&P.setTextContent(s,e.text),a&&_e(r=o.hook)&&_e(r=r.postpatch)&&r(t,e)}}function b(t,e,n){if(n&&t.parent)t.parent.data.pendingInsert=e;else for(var i=0;i<e.length;++i)e[i].data.hook.insert(e[i])}function w(t,e,n){e.elm=t;var i=e.tag,r=e.data,o=e.children;if(_e(r)&&(_e(M=r.hook)&&_e(M=M.init)&&M(e,!0),_e(M=e.child)))return p(e,n),!0;if(_e(i)){if(_e(o))if(t.hasChildNodes()){for(var a=!0,s=t.firstChild,u=0;u<o.length;u++){if(!s||!w(s,o[u],n)){a=!1;break}s=s.nextSibling}if(!a||s)return!1}else l(e,o,n);if(_e(r))for(var c in r)if(!A(c)){f(e,n);break}}else t.data!==e.text&&(t.data=e.text);return!0}var M,E,T={},S=t.modules,P=t.nodeOps;for(M=0;M<Po.length;++M)for(T[Po[M]]=[],E=0;E<S.length;++E)void 0!==S[E][Po[M]]&&T[Po[M]].push(S[E][Po[M]]);var A=r("attrs,style,class,staticClass,staticStyle,key");return function(t,n,i,r,a,s){if(!n)return void(t&&v(t));var u,c,l=!1,f=[];if(t){var p=_e(t.nodeType);if(!p&&xe(t,n))x(t,n,f,r);else{if(p){if(1===t.nodeType&&t.hasAttribute("server-rendered")&&(t.removeAttribute("server-rendered"),i=!0),i&&w(t,n,f))return b(n,f,!0),t;t=e(t)}if(u=t.elm,c=P.parentNode(u),o(n,f,c,P.nextSibling(u)),n.parent){for(var d=n.parent;d;)d.elm=n.elm,d=d.parent;if(h(n))for(var m=0;m<T.create.length;++m)T.create[m](So,n.parent)}null!==c?g(c,[t],0,0):_e(t.tag)&&v(t)}}else l=!0,o(n,f,a,s);return b(n,f,l),n.elm}}function Me(t,e){(t.data.directives||e.data.directives)&&Ee(t,e)}function Ee(t,e){var n,i,r,o=t===So,a=e===So,s=Te(t.data.directives,t.context),u=Te(e.data.directives,e.context),c=[],l=[];for(n in u)i=s[n],r=u[n],i?(r.oldValue=i.value,Pe(r,"update",e,t),r.def&&r.def.componentUpdated&&l.push(r)):(Pe(r,"bind",e,t),r.def&&r.def.inserted&&c.push(r));if(c.length){var h=function(){for(var n=0;n<c.length;n++)Pe(c[n],"inserted",e,t)};o?st(e.data.hook||(e.data.hook={}),"insert",h,"dir-insert"):h()}if(l.length&&st(e.data.hook||(e.data.hook={}),"postpatch",function(){for(var n=0;n<l.length;n++)Pe(l[n],"componentUpdated",e,t)},"dir-postpatch"),!o)for(n in s)u[n]||Pe(s[n],"unbind",t,t,a)}function Te(t,e){var n=Object.create(null);if(!t)return n;var i,r;for(i=0;i<t.length;i++)r=t[i],r.modifiers||(r.modifiers=Co),n[Se(r)]=r,r.def=F(e.$options,"directives",r.name,!0);return n}function Se(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function Pe(t,e,n,i,r){var o=t.def&&t.def[e];o&&o(n.elm,t,n,i,r)}function Ae(t,e){if(t.data.attrs||e.data.attrs){var n,i,r,o=e.elm,a=t.data.attrs||{},s=e.data.attrs||{};s.__ob__&&(s=e.data.attrs=h({},s));for(n in s)i=s[n],r=a[n],r!==i&&Ce(o,n,i);xr&&s.value!==a.value&&Ce(o,"value",s.value);for(n in a)null==s[n]&&(mo(n)?o.removeAttributeNS(po,vo(n)):ho(n)||o.removeAttribute(n))}}function Ce(t,e,n){fo(e)?go(n)?t.removeAttribute(e):t.setAttribute(e,e):ho(e)?t.setAttribute(e,go(n)||"false"===n?"false":"true"):mo(e)?go(n)?t.removeAttributeNS(po,vo(e)):t.setAttributeNS(po,e,n):go(n)?t.removeAttribute(e):t.setAttribute(e,n)}function Le(t,e){var n=e.elm,i=e.data,r=t.data;if(i.staticClass||i.class||r&&(r.staticClass||r.class)){var o=Jt(e),a=n._transitionClasses;a&&(o=te(o,ee(a))),o!==n._prevClass&&(n.setAttribute("class",o),n._prevClass=o)}}function Ie(t,e,n,i){if(n){var r=e;e=function(n){Re(t,e,i),1===arguments.length?r(n):r.apply(null,arguments)}}so.addEventListener(t,e,i)}function Re(t,e,n){so.removeEventListener(t,e,n)}function Ne(t,e){if(t.data.on||e.data.on){var n=e.data.on||{},i=t.data.on||{};so=e.elm,ut(n,i,Ie,Re,e.context)}}function Oe(t,e){if(t.data.domProps||e.data.domProps){var n,i,r=e.elm,o=t.data.domProps||{},a=e.data.domProps||{};a.__ob__&&(a=e.data.domProps=h({},a));for(n in o)null==a[n]&&(r[n]="");for(n in a)if(i=a[n],("textContent"!==n&&"innerHTML"!==n||(e.children&&(e.children.length=0),i!==o[n]))&&("checked"!==n||Be(r,i)))if("value"===n){r._value=i;var s=null==i?"":String(i);De(r,e,s)&&(r.value=s)}else r[n]=i}}function De(t,e,n){return!(t.composing||"option"!==e.tag&&!Be(t,n)&&!Ue(e,n))}function Be(t,e){return document.activeElement!==t&&t.value!==e}function Ue(t,e){var n=t.elm.value,r=t.elm._vModifiers;return r&&r.number||"number"===t.elm.type?i(n)!==i(e):r&&r.trim?n.trim()!==e.trim():n!==e}function Fe(t){var e=ke(t.style);return t.staticStyle?h(t.staticStyle,e):e}function ke(t){return Array.isArray(t)?d(t):"string"==typeof t?Do(t):t}function ze(t,e){var n,i={};if(e)for(var r=t;r.child;)r=r.child._vnode,r.data&&(n=Fe(r.data))&&h(i,n);(n=Fe(t.data))&&h(i,n);for(var o=t;o=o.parent;)o.data&&(n=Fe(o.data))&&h(i,n);return i}function Ge(t,e){var n=e.data,i=t.data;if(n.staticStyle||n.style||i.staticStyle||i.style){var r,o,a=e.elm,s=t.data.staticStyle,u=t.data.style||{},c=s||u,l=ke(e.data.style)||{};e.data.style=l.__ob__?h({},l):l;var f=ze(e,!0);for(o in c)null==f[o]&&Fo(a,o,"");for(o in f)r=f[o],r!==c[o]&&Fo(a,o,null==r?"":r)}}function He(t,e){if(e&&e.trim())if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach(function(e){return t.classList.add(e)}):t.classList.add(e);else{var n=" "+t.getAttribute("class")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function je(t,e){if(e&&e.trim())if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach(function(e){return t.classList.remove(e)}):t.classList.remove(e);else{for(var n=" "+t.getAttribute("class")+" ",i=" "+e+" ";n.indexOf(i)>=0;)n=n.replace(i," ");t.setAttribute("class",n.trim())}}function Xe(t){$o(function(){$o(t)})}function Ve(t,e){(t._transitionClasses||(t._transitionClasses=[])).push(e),He(t,e)}function Ye(t,e){t._transitionClasses&&o(t._transitionClasses,e),je(t,e)}function We(t,e,n){var i=qe(t,e),r=i.type,o=i.timeout,a=i.propCount;if(!r)return n();var s=r===jo?Yo:qo,u=0,c=function(){t.removeEventListener(s,l),n()},l=function(e){e.target===t&&++u>=a&&c()};setTimeout(function(){u<a&&c()},o+1),t.addEventListener(s,l)}function qe(t,e){var n,i=window.getComputedStyle(t),r=i[Vo+"Delay"].split(", "),o=i[Vo+"Duration"].split(", "),a=$e(r,o),s=i[Wo+"Delay"].split(", "),u=i[Wo+"Duration"].split(", "),c=$e(s,u),l=0,h=0;e===jo?a>0&&(n=jo,l=a,h=o.length):e===Xo?c>0&&(n=Xo,l=c,h=u.length):(l=Math.max(a,c),n=l>0?a>c?jo:Xo:null,h=n?n===jo?o.length:u.length:0);var f=n===jo&&Zo.test(i[Vo+"Property"]);return{type:n,timeout:l,propCount:h,hasTransform:f}}function $e(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return Ze(e)+Ze(t[n])}))}function Ze(t){return 1e3*Number(t.slice(0,-1))}function Je(t,e){var n=t.elm;n._leaveCb&&(n._leaveCb.cancelled=!0,n._leaveCb());var i=Qe(t.data.transition);if(i&&!n._enterCb&&1===n.nodeType){for(var r=i.css,o=i.type,a=i.enterClass,s=i.enterToClass,u=i.enterActiveClass,c=i.appearClass,l=i.appearToClass,h=i.appearActiveClass,f=i.beforeEnter,p=i.enter,d=i.afterEnter,m=i.enterCancelled,v=i.beforeAppear,g=i.appear,y=i.afterAppear,_=i.appearCancelled,x=Kr,b=Kr.$vnode;b&&b.parent;)b=b.parent,x=b.context;
var w=!x._isMounted||!t.isRootInsert;if(!w||g||""===g){var M=w?c:a,E=w?h:u,T=w?l:s,S=w?v||f:f,P=w&&"function"==typeof g?g:p,A=w?y||d:d,C=w?_||m:m,L=r!==!1&&!xr,I=P&&(P._length||P.length)>1,R=n._enterCb=tn(function(){L&&(Ye(n,T),Ye(n,E)),R.cancelled?(L&&Ye(n,M),C&&C(n)):A&&A(n),n._enterCb=null});t.data.show||st(t.data.hook||(t.data.hook={}),"insert",function(){var e=n.parentNode,i=e&&e._pending&&e._pending[t.key];i&&i.context===t.context&&i.tag===t.tag&&i.elm._leaveCb&&i.elm._leaveCb(),P&&P(n,R)},"transition-insert"),S&&S(n),L&&(Ve(n,M),Ve(n,E),Xe(function(){Ve(n,T),Ye(n,M),R.cancelled||I||We(n,o,R)})),t.data.show&&(e&&e(),P&&P(n,R)),L||I||R()}}}function Ke(t,e){function n(){g.cancelled||(t.data.show||((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),l&&l(i),m&&(Ve(i,s),Ve(i,c),Xe(function(){Ve(i,u),Ye(i,s),g.cancelled||v||We(i,a,g)})),h&&h(i,g),m||v||g())}var i=t.elm;i._enterCb&&(i._enterCb.cancelled=!0,i._enterCb());var r=Qe(t.data.transition);if(!r)return e();if(!i._leaveCb&&1===i.nodeType){var o=r.css,a=r.type,s=r.leaveClass,u=r.leaveToClass,c=r.leaveActiveClass,l=r.beforeLeave,h=r.leave,f=r.afterLeave,p=r.leaveCancelled,d=r.delayLeave,m=o!==!1&&!xr,v=h&&(h._length||h.length)>1,g=i._leaveCb=tn(function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),m&&(Ye(i,u),Ye(i,c)),g.cancelled?(m&&Ye(i,s),p&&p(i)):(e(),f&&f(i)),i._leaveCb=null});d?d(n):n()}}function Qe(t){if(t){if("object"==typeof t){var e={};return t.css!==!1&&h(e,Jo(t.name||"v")),h(e,t),e}return"string"==typeof t?Jo(t):void 0}}function tn(t){var e=!1;return function(){e||(e=!0,t())}}function en(t,e){e.data.show||Je(e)}function nn(t,e,n){var i=e.value,r=t.multiple;if(!r||Array.isArray(i)){for(var o,a,s=0,u=t.options.length;s<u;s++)if(a=t.options[s],r)o=y(i,on(a))>-1,a.selected!==o&&(a.selected=o);else if(g(on(a),i))return void(t.selectedIndex!==s&&(t.selectedIndex=s));r||(t.selectedIndex=-1)}}function rn(t,e){for(var n=0,i=e.length;n<i;n++)if(g(on(e[n]),t))return!1;return!0}function on(t){return"_value"in t?t._value:t.value}function an(t){t.target.composing=!0}function sn(t){t.target.composing=!1,un(t.target,"input")}function un(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function cn(t){return!t.child||t.data&&t.data.transition?t:cn(t.child._vnode)}function ln(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?ln(dt(e.children)):t}function hn(t){var e={},n=t.$options;for(var i in n.propsData)e[i]=t[i];var r=n._parentListeners;for(var o in r)e[ar(o)]=r[o].fn;return e}function fn(t,e){return/\d-keep-alive$/.test(e.tag)?t("keep-alive"):null}function pn(t){for(;t=t.parent;)if(t.data.transition)return!0}function dn(t,e){return e.key===t.key&&e.tag===t.tag}function mn(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function vn(t){t.data.newPos=t.elm.getBoundingClientRect()}function gn(t){var e=t.data.pos,n=t.data.newPos,i=e.left-n.left,r=e.top-n.top;if(i||r){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+i+"px,"+r+"px)",o.transitionDuration="0s"}}function yn(t,e){var n=document.createElement("div");return n.innerHTML='<div a="'+t+'">',n.innerHTML.indexOf(e)>0}function _n(t){return la=la||document.createElement("div"),la.innerHTML=t,la.textContent}function xn(t,e){return e&&(t=t.replace(os,"\n")),t.replace(is,"<").replace(rs,">").replace(as,"&").replace(ss,'"')}function bn(t,e){function n(e){h+=e,t=t.substring(e)}function i(){var e=t.match(ba);if(e){var i={tagName:e[1],attrs:[],start:h};n(e[0].length);for(var r,o;!(r=t.match(wa))&&(o=t.match(ya));)n(o[0].length),i.attrs.push(o);if(r)return i.unarySlash=r[1],n(r[0].length),i.end=h,i}}function r(t){var n=t.tagName,i=t.unarySlash;c&&("p"===s&&da(n)&&o("",s),pa(n)&&s===n&&o("",n));for(var r=l(n)||"html"===n&&"head"===s||!!i,a=t.attrs.length,h=new Array(a),f=0;f<a;f++){var p=t.attrs[f];Pa&&p[0].indexOf('""')===-1&&(""===p[3]&&delete p[3],""===p[4]&&delete p[4],""===p[5]&&delete p[5]);var d=p[3]||p[4]||p[5]||"";h[f]={name:p[1],value:xn(d,e.shouldDecodeNewlines)}}r||(u.push({tag:n,attrs:h}),s=n,i=""),e.start&&e.start(n,h,r,t.start,t.end)}function o(t,n,i,r){var o;if(null==i&&(i=h),null==r&&(r=h),n){var a=n.toLowerCase();for(o=u.length-1;o>=0&&u[o].tag.toLowerCase()!==a;o--);}else o=0;if(o>=0){for(var c=u.length-1;c>=o;c--)e.end&&e.end(u[c].tag,i,r);u.length=o,s=o&&u[o-1].tag}else"br"===n.toLowerCase()?e.start&&e.start(n,[],!0,i,r):"p"===n.toLowerCase()&&(e.start&&e.start(n,[],!1,i,r),e.end&&e.end(n,i,r))}for(var a,s,u=[],c=e.expectHTML,l=e.isUnaryTag||fr,h=0;t;){if(a=t,s&&es(s,e.sfc,u)){var f=s.toLowerCase(),p=ns[f]||(ns[f]=new RegExp("([\\s\\S]*?)(</"+f+"[^>]*>)","i")),d=0,m=t.replace(p,function(t,n,i){return d=i.length,"script"!==f&&"style"!==f&&"noscript"!==f&&(n=n.replace(/<!--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),e.chars&&e.chars(n),""});h+=t.length-m.length,t=m,o("</"+f+">",f,h-d,h)}else{var v=t.indexOf("<");if(0===v){if(Ta.test(t)){var g=t.indexOf("-->");if(g>=0){n(g+3);continue}}if(Sa.test(t)){var y=t.indexOf("]>");if(y>=0){n(y+2);continue}}var _=t.match(Ea);if(_){n(_[0].length);continue}var x=t.match(Ma);if(x){var b=h;n(x[0].length),o(x[0],x[1],b,h);continue}var w=i();if(w){r(w);continue}}var M=void 0,E=void 0,T=void 0;if(v>0){for(E=t.slice(v);!(Ma.test(E)||ba.test(E)||Ta.test(E)||Sa.test(E)||(T=E.indexOf("<",1),T<0));)v+=T,E=t.slice(v);M=t.substring(0,v),n(v)}v<0&&(M=t,t=""),e.chars&&M&&e.chars(M)}if(t===a&&e.chars){e.chars(t);break}}o()}function wn(t){function e(){(a||(a=[])).push(t.slice(d,r).trim()),d=r+1}var n,i,r,o,a,s=!1,u=!1,c=!1,l=!1,h=0,f=0,p=0,d=0;for(r=0;r<t.length;r++)if(i=n,n=t.charCodeAt(r),s)39===n&&92!==i&&(s=!1);else if(u)34===n&&92!==i&&(u=!1);else if(c)96===n&&92!==i&&(c=!1);else if(l)47===n&&92!==i&&(l=!1);else if(124!==n||124===t.charCodeAt(r+1)||124===t.charCodeAt(r-1)||h||f||p){switch(n){case 34:u=!0;break;case 39:s=!0;break;case 96:c=!0;break;case 40:p++;break;case 41:p--;break;case 91:f++;break;case 93:f--;break;case 123:h++;break;case 125:h--}if(47===n){for(var m=r-1,v=void 0;m>=0&&(v=t.charAt(m)," "===v);m--);v&&/[\w$]/.test(v)||(l=!0)}}else void 0===o?(d=r+1,o=t.slice(0,r).trim()):e();if(void 0===o?o=t.slice(0,r).trim():0!==d&&e(),a)for(r=0;r<a.length;r++)o=Mn(o,a[r]);return o}function Mn(t,e){var n=e.indexOf("(");if(n<0)return'_f("'+e+'")('+t+")";var i=e.slice(0,n),r=e.slice(n+1);return'_f("'+i+'")('+t+","+r}function En(t,e){var n=e?ls(e):us;if(n.test(t)){for(var i,r,o=[],a=n.lastIndex=0;i=n.exec(t);){r=i.index,r>a&&o.push(JSON.stringify(t.slice(a,r)));var s=wn(i[1].trim());o.push("_s("+s+")"),a=r+i[0].length}return a<t.length&&o.push(JSON.stringify(t.slice(a))),o.join("+")}}function Tn(t){console.error("[Vue parser]: "+t)}function Sn(t,e){return t?t.map(function(t){return t[e]}).filter(function(t){return t}):[]}function Pn(t,e,n){(t.props||(t.props=[])).push({name:e,value:n})}function An(t,e,n){(t.attrs||(t.attrs=[])).push({name:e,value:n})}function Cn(t,e,n,i,r,o){(t.directives||(t.directives=[])).push({name:e,rawName:n,value:i,arg:r,modifiers:o})}function Ln(t,e,n,i,r){i&&i.capture&&(delete i.capture,e="!"+e),i&&i.once&&(delete i.once,e="~"+e);var o;i&&i.native?(delete i.native,o=t.nativeEvents||(t.nativeEvents={})):o=t.events||(t.events={});var a={value:n,modifiers:i},s=o[e];Array.isArray(s)?r?s.unshift(a):s.push(a):s?o[e]=r?[a,s]:[s,a]:o[e]=a}function In(t,e,n){var i=Rn(t,":"+e)||Rn(t,"v-bind:"+e);if(null!=i)return wn(i);if(n!==!1){var r=Rn(t,e);if(null!=r)return JSON.stringify(r)}}function Rn(t,e){var n;if(null!=(n=t.attrsMap[e]))for(var i=t.attrsList,r=0,o=i.length;r<o;r++)if(i[r].name===e){i.splice(r,1);break}return n}function Nn(t){if(Ca=t,Aa=Ca.length,Ia=Ra=Na=0,t.indexOf("[")<0||t.lastIndexOf("]")<Aa-1)return{exp:t,idx:null};for(;!Dn();)La=On(),Bn(La)?Fn(La):91===La&&Un(La);return{exp:t.substring(0,Ra),idx:t.substring(Ra+1,Na)}}function On(){return Ca.charCodeAt(++Ia)}function Dn(){return Ia>=Aa}function Bn(t){return 34===t||39===t}function Un(t){var e=1;for(Ra=Ia;!Dn();)if(t=On(),Bn(t))Fn(t);else if(91===t&&e++,93===t&&e--,0===e){Na=Ia;break}}function Fn(t){for(var e=t;!Dn()&&(t=On(),t!==e););}function kn(t,e){Oa=e.warn||Tn,Da=e.getTagNamespace||fr,Ba=e.mustUseProp||fr,Ua=e.isPreTag||fr,Fa=Sn(e.modules,"preTransformNode"),ka=Sn(e.modules,"transformNode"),za=Sn(e.modules,"postTransformNode"),Ga=e.delimiters;var n,i,r=[],o=e.preserveWhitespace!==!1,a=!1,s=!1;return bn(t,{expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,shouldDecodeNewlines:e.shouldDecodeNewlines,start:function(t,o,u){function c(t){}var l=i&&i.ns||Da(t);_r&&"svg"===l&&(o=ii(o));var h={type:1,tag:t,attrsList:o,attrsMap:ei(o),parent:i,children:[]};l&&(h.ns=l),ni(h)&&!Er()&&(h.forbidden=!0);for(var f=0;f<Fa.length;f++)Fa[f](h,e);if(a||(zn(h),h.pre&&(a=!0)),Ua(h.tag)&&(s=!0),a)Gn(h);else{Xn(h),Vn(h),$n(h),Hn(h),h.plain=!h.key&&!o.length,jn(h),Zn(h),Jn(h);for(var p=0;p<ka.length;p++)ka[p](h,e);Kn(h)}if(n?r.length||n.if&&(h.elseif||h.else)&&(c(h),qn(n,{exp:h.elseif,block:h})):(n=h,c(n)),i&&!h.forbidden)if(h.elseif||h.else)Yn(h,i);else if(h.slotScope){i.plain=!1;var d=h.slotTarget||"default";(i.scopedSlots||(i.scopedSlots={}))[d]=h}else i.children.push(h),h.parent=i;u||(i=h,r.push(h));for(var m=0;m<za.length;m++)za[m](h,e)},end:function(){var t=r[r.length-1],e=t.children[t.children.length-1];e&&3===e.type&&" "===e.text&&t.children.pop(),r.length-=1,i=r[r.length-1],t.pre&&(a=!1),Ua(t.tag)&&(s=!1)},chars:function(t){if(i&&(!_r||"textarea"!==i.tag||i.attrsMap.placeholder!==t)){var e=i.children;if(t=s||t.trim()?ys(t):o&&e.length?" ":""){var n;!a&&" "!==t&&(n=En(t,Ga))?e.push({type:2,expression:n,text:t}):" "===t&&" "===e[e.length-1].text||i.children.push({type:3,text:t})}}}}),n}function zn(t){null!=Rn(t,"v-pre")&&(t.pre=!0)}function Gn(t){var e=t.attrsList.length;if(e)for(var n=t.attrs=new Array(e),i=0;i<e;i++)n[i]={name:t.attrsList[i].name,value:JSON.stringify(t.attrsList[i].value)};else t.pre||(t.plain=!0)}function Hn(t){var e=In(t,"key");e&&(t.key=e)}function jn(t){var e=In(t,"ref");e&&(t.ref=e,t.refInFor=Qn(t))}function Xn(t){var e;if(e=Rn(t,"v-for")){var n=e.match(fs);if(!n)return;t.for=n[2].trim();var i=n[1].trim(),r=i.match(ps);r?(t.alias=r[1].trim(),t.iterator1=r[2].trim(),r[3]&&(t.iterator2=r[3].trim())):t.alias=i}}function Vn(t){var e=Rn(t,"v-if");if(e)t.if=e,qn(t,{exp:e,block:t});else{null!=Rn(t,"v-else")&&(t.else=!0);var n=Rn(t,"v-else-if");n&&(t.elseif=n)}}function Yn(t,e){var n=Wn(e.children);n&&n.if&&qn(n,{exp:t.elseif,block:t})}function Wn(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}function qn(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function $n(t){var e=Rn(t,"v-once");null!=e&&(t.once=!0)}function Zn(t){if("slot"===t.tag)t.slotName=In(t,"name");else{var e=In(t,"slot");e&&(t.slotTarget='""'===e?'"default"':e),"template"===t.tag&&(t.slotScope=Rn(t,"scope"))}}function Jn(t){var e;(e=In(t,"is"))&&(t.component=e),null!=Rn(t,"inline-template")&&(t.inlineTemplate=!0)}function Kn(t){var e,n,i,r,o,a,s,u,c=t.attrsList;for(e=0,n=c.length;e<n;e++)if(i=r=c[e].name,o=c[e].value,hs.test(i))if(t.hasBindings=!0,s=ti(i),s&&(i=i.replace(gs,"")),ds.test(i))i=i.replace(ds,""),o=wn(o),u=!1,s&&(s.prop&&(u=!0,i=ar(i),"innerHtml"===i&&(i="innerHTML")),s.camel&&(i=ar(i))),u||Ba(t.tag,i)?Pn(t,i,o):An(t,i,o);else if(ms.test(i))i=i.replace(ms,""),Ln(t,i,o,s);else{i=i.replace(hs,"");var l=i.match(vs);l&&(a=l[1])&&(i=i.slice(0,-(a.length+1))),Cn(t,i,r,o,a,s)}else{An(t,i,JSON.stringify(o)),Ba(t.tag,i)&&("value"===i?Pn(t,i,JSON.stringify(o)):Pn(t,i,"true"))}}function Qn(t){for(var e=t;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}function ti(t){var e=t.match(gs);if(e){var n={};return e.forEach(function(t){n[t.slice(1)]=!0}),n}}function ei(t){for(var e={},n=0,i=t.length;n<i;n++)e[t[n].name]=t[n].value;return e}function ni(t){return"style"===t.tag||"script"===t.tag&&(!t.attrsMap.type||"text/javascript"===t.attrsMap.type)}function ii(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];_s.test(i.name)||(i.name=i.name.replace(xs,""),e.push(i))}return e}function ri(t,e){t&&(Ha=bs(e.staticKeys||""),ja=e.isReservedTag||fr,ai(t),si(t,!1))}function oi(t){return r("type,tag,attrsList,attrsMap,plain,parent,children,attrs"+(t?","+t:""))}function ai(t){if(t.static=ci(t),1===t.type){if(!ja(t.tag)&&"slot"!==t.tag&&null==t.attrsMap["inline-template"])return;for(var e=0,n=t.children.length;e<n;e++){var i=t.children[e];ai(i),i.static||(t.static=!1)}}}function si(t,e){if(1===t.type){if((t.static||t.once)&&(t.staticInFor=e),t.static&&t.children.length&&(1!==t.children.length||3!==t.children[0].type))return void(t.staticRoot=!0);if(t.staticRoot=!1,t.children)for(var n=0,i=t.children.length;n<i;n++)si(t.children[n],e||!!t.for);t.ifConditions&&ui(t.ifConditions,e)}}function ui(t,e){for(var n=1,i=t.length;n<i;n++)si(t[n].block,e)}function ci(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||ir(t.tag)||!ja(t.tag)||li(t)||!Object.keys(t).every(Ha))))}function li(t){for(;t.parent;){if(t=t.parent,"template"!==t.tag)return!1;if(t.for)return!0}return!1}function hi(t,e){var n=e?"nativeOn:{":"on:{";for(var i in t)n+='"'+i+'":'+fi(i,t[i])+",";return n.slice(0,-1)+"}"}function fi(t,e){if(e){if(Array.isArray(e))return"["+e.map(function(e){return fi(t,e)}).join(",")+"]";if(e.modifiers){var n="",i=[];for(var r in e.modifiers)Ts[r]?n+=Ts[r]:i.push(r);i.length&&(n=pi(i)+n);var o=Ms.test(e.value)?e.value+"($event)":e.value;return"function($event){"+n+o+"}"}return ws.test(e.value)||Ms.test(e.value)?e.value:"function($event){"+e.value+"}"}return"function(){}"}function pi(t){return"if("+t.map(di).join("&&")+")return;"}function di(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var n=Es[t];return"_k($event.keyCode,"+JSON.stringify(t)+(n?","+JSON.stringify(n):"")+")"}function mi(t,e){t.wrapData=function(n){return"_b("+n+",'"+t.tag+"',"+e.value+(e.modifiers&&e.modifiers.prop?",true":"")+")"}}function vi(t,e){var n=$a,i=$a=[],r=Za;Za=0,Ja=e,Xa=e.warn||Tn,Va=Sn(e.modules,"transformCode"),Ya=Sn(e.modules,"genData"),Wa=e.directives||{},qa=e.isReservedTag||fr;var o=t?gi(t):'_c("div")';return $a=n,Za=r,{render:"with(this){return "+o+"}",staticRenderFns:i}}function gi(t){if(t.staticRoot&&!t.staticProcessed)return yi(t);if(t.once&&!t.onceProcessed)return _i(t);if(t.for&&!t.forProcessed)return wi(t);if(t.if&&!t.ifProcessed)return xi(t);if("template"!==t.tag||t.slotTarget){if("slot"===t.tag)return Oi(t);var e;if(t.component)e=Di(t.component,t);else{var n=t.plain?void 0:Mi(t),i=t.inlineTemplate?null:Ai(t,!0);e="_c('"+t.tag+"'"+(n?","+n:"")+(i?","+i:"")+")"}for(var r=0;r<Va.length;r++)e=Va[r](t,e);return e}return Ai(t)||"void 0"}function yi(t){return t.staticProcessed=!0,$a.push("with(this){return "+gi(t)+"}"),"_m("+($a.length-1)+(t.staticInFor?",true":"")+")"}function _i(t){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return xi(t);if(t.staticInFor){for(var e="",n=t.parent;n;){if(n.for){e=n.key;break}n=n.parent}return e?"_o("+gi(t)+","+Za++ +(e?","+e:"")+")":gi(t)}return yi(t)}function xi(t){return t.ifProcessed=!0,bi(t.ifConditions.slice())}function bi(t){function e(t){return t.once?_i(t):gi(t)}if(!t.length)return"_e()";var n=t.shift();return n.exp?"("+n.exp+")?"+e(n.block)+":"+bi(t):""+e(n.block)}function wi(t){var e=t.for,n=t.alias,i=t.iterator1?","+t.iterator1:"",r=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,"_l(("+e+"),function("+n+i+r+"){return "+gi(t)+"})"}function Mi(t){var e="{",n=Ei(t);n&&(e+=n+","),t.key&&(e+="key:"+t.key+","),t.ref&&(e+="ref:"+t.ref+","),t.refInFor&&(e+="refInFor:true,"),t.pre&&(e+="pre:true,"),t.component&&(e+='tag:"'+t.tag+'",');for(var i=0;i<Ya.length;i++)e+=Ya[i](t);if(t.attrs&&(e+="attrs:{"+Bi(t.attrs)+"},"),t.props&&(e+="domProps:{"+Bi(t.props)+"},"),t.events&&(e+=hi(t.events)+","),t.nativeEvents&&(e+=hi(t.nativeEvents,!0)+","),t.slotTarget&&(e+="slot:"+t.slotTarget+","),t.scopedSlots&&(e+=Si(t.scopedSlots)+","),t.inlineTemplate){var r=Ti(t);r&&(e+=r+",")}return e=e.replace(/,$/,"")+"}",t.wrapData&&(e=t.wrapData(e)),e}function Ei(t){var e=t.directives;if(e){var n,i,r,o,a="directives:[",s=!1;for(n=0,i=e.length;n<i;n++){r=e[n],o=!0;var u=Wa[r.name]||Ss[r.name];u&&(o=!!u(t,r,Xa)),o&&(s=!0,a+='{name:"'+r.name+'",rawName:"'+r.rawName+'"'+(r.value?",value:("+r.value+"),expression:"+JSON.stringify(r.value):"")+(r.arg?',arg:"'+r.arg+'"':"")+(r.modifiers?",modifiers:"+JSON.stringify(r.modifiers):"")+"},")}return s?a.slice(0,-1)+"]":void 0}}function Ti(t){var e=t.children[0];if(1===e.type){var n=vi(e,Ja);return"inlineTemplate:{render:function(){"+n.render+"},staticRenderFns:["+n.staticRenderFns.map(function(t){return"function(){"+t+"}"}).join(",")+"]}"}}function Si(t){return"scopedSlots:{"+Object.keys(t).map(function(e){return Pi(e,t[e])}).join(",")+"}"}function Pi(t,e){return t+":function("+String(e.attrsMap.scope)+"){return "+("template"===e.tag?Ai(e)||"void 0":gi(e))+"}"}function Ai(t,e){var n=t.children;if(n.length){var i=n[0];if(1===n.length&&i.for&&"template"!==i.tag&&"slot"!==i.tag)return gi(i);var r=Ci(n);return"["+n.map(Ri).join(",")+"]"+(e&&r?","+r:"")}}function Ci(t){for(var e=0,n=0;n<t.length;n++){var i=t[n];if(Li(i)||i.if&&i.ifConditions.some(function(t){return Li(t.block)})){e=2;break}(Ii(i)||i.if&&i.ifConditions.some(function(t){return Ii(t.block)}))&&(e=1)}return e}function Li(t){return t.for||"template"===t.tag||"slot"===t.tag}function Ii(t){return 1===t.type&&!qa(t.tag)}function Ri(t){return 1===t.type?gi(t):Ni(t)}function Ni(t){return"_v("+(2===t.type?t.expression:Ui(JSON.stringify(t.text)))+")"}function Oi(t){var e=t.slotName||'"default"',n=Ai(t),i="_t("+e+(n?","+n:""),r=t.attrs&&"{"+t.attrs.map(function(t){return ar(t.name)+":"+t.value}).join(",")+"}",o=t.attrsMap["v-bind"];return!r&&!o||n||(i+=",null"),r&&(i+=","+r),o&&(i+=(r?"":",null")+","+o),i+")"}function Di(t,e){var n=e.inlineTemplate?null:Ai(e,!0);return"_c("+t+","+Mi(e)+(n?","+n:"")+")"}function Bi(t){for(var e="",n=0;n<t.length;n++){var i=t[n];e+='"'+i.name+'":'+Ui(i.value)+","}return e.slice(0,-1)}function Ui(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function Fi(t,e){var n=kn(t.trim(),e);ri(n,e);var i=vi(n,e);return{ast:n,render:i.render,staticRenderFns:i.staticRenderFns}}function ki(t,e){var n=(e.warn||Tn,Rn(t,"class"));n&&(t.staticClass=JSON.stringify(n));var i=In(t,"class",!1);i&&(t.classBinding=i)}function zi(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}function Gi(t,e){var n=(e.warn||Tn,Rn(t,"style"));if(n){t.staticStyle=JSON.stringify(Do(n))}var i=In(t,"style",!1);i&&(t.styleBinding=i)}function Hi(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}function ji(t,e,n){Ka=n;var i=e.value,r=e.modifiers,o=t.tag,a=t.attrsMap.type;return"select"===o?Wi(t,i,r):"input"===o&&"checkbox"===a?Xi(t,i,r):"input"===o&&"radio"===a?Vi(t,i,r):Yi(t,i,r),!0}function Xi(t,e,n){var i=n&&n.number,r=In(t,"value")||"null",o=In(t,"true-value")||"true",a=In(t,"false-value")||"false";Pn(t,"checked","Array.isArray("+e+")?_i("+e+","+r+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),Ln(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+a+");if(Array.isArray($$a)){var $$v="+(i?"_n("+r+")":r)+",$$i=_i($$a,$$v);if($$c){$$i<0&&("+e+"=$$a.concat($$v))}else{$$i>-1&&("+e+"=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{"+e+"=$$c}",null,!0)}function Vi(t,e,n){var i=n&&n.number,r=In(t,"value")||"null";r=i?"_n("+r+")":r,Pn(t,"checked","_q("+e+","+r+")"),Ln(t,"change",qi(e,r),null,!0)}function Yi(t,e,n){var i=t.attrsMap.type,r=n||{},o=r.lazy,a=r.number,s=r.trim,u=o||_r&&"range"===i?"change":"input",c=!o&&"range"!==i,l="input"===t.tag||"textarea"===t.tag,h=l?"$event.target.value"+(s?".trim()":""):s?"(typeof $event === 'string' ? $event.trim() : $event)":"$event";h=a||"number"===i?"_n("+h+")":h;var f=qi(e,h);l&&c&&(f="if($event.target.composing)return;"+f),Pn(t,"value",l?"_s("+e+")":"("+e+")"),Ln(t,u,f,null,!0),(s||a||"number"===i)&&Ln(t,"blur","$forceUpdate()")}function Wi(t,e,n){var i=n&&n.number,r='Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i?"_n(val)":"val")+"})"+(null==t.attrsMap.multiple?"[0]":""),o=qi(e,r);Ln(t,"change",o,null,!0)}function qi(t,e){var n=Nn(t);return null===n.idx?t+"="+e:"var $$exp = "+n.exp+", $$idx = "+n.idx+";if (!Array.isArray($$exp)){"+t+"="+e+"}else{$$exp.splice($$idx, 1, "+e+")}"}function $i(t,e){e.value&&Pn(t,"textContent","_s("+e.value+")")}function Zi(t,e){e.value&&Pn(t,"innerHTML","_s("+e.value+")")}function Ji(t,e){return e=e?h(h({},Rs),e):Rs,Fi(t,e)}function Ki(t,e,n){var i=(e&&e.warn||Ar,e&&e.delimiters?String(e.delimiters)+t:t);if(Is[i])return Is[i];var r={},o=Ji(t,e);r.render=Qi(o.render);var a=o.staticRenderFns.length;r.staticRenderFns=new Array(a);for(var s=0;s<a;s++)r.staticRenderFns[s]=Qi(o.staticRenderFns[s]);return Is[i]=r}function Qi(t){try{return new Function(t)}catch(t){return m}}function tr(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}var er,nr,ir=r("slot,component",!0),rr=Object.prototype.hasOwnProperty,or=/-(\w)/g,ar=u(function(t){return t.replace(or,function(t,e){return e?e.toUpperCase():""})}),sr=u(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),ur=/([^-])([A-Z])/g,cr=u(function(t){return t.replace(ur,"$1-$2").replace(ur,"$1-$2").toLowerCase()}),lr=Object.prototype.toString,hr="[object Object]",fr=function(){return!1},pr=function(t){return t},dr={optionMergeStrategies:Object.create(null),silent:!1,devtools:!1,errorHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:fr,isUnknownElement:fr,getTagNamespace:m,parsePlatformTagName:pr,mustUseProp:fr,_assetTypes:["component","directive","filter"],_lifecycleHooks:["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated"],_maxUpdateCount:100},mr=/[^\w.$]/,vr="__proto__"in{},gr="undefined"!=typeof window,yr=gr&&window.navigator.userAgent.toLowerCase(),_r=yr&&/msie|trident/.test(yr),xr=yr&&yr.indexOf("msie 9.0")>0,br=yr&&yr.indexOf("edge/")>0,wr=yr&&yr.indexOf("android")>0,Mr=yr&&/iphone|ipad|ipod|ios/.test(yr),Er=function(){return void 0===er&&(er=!gr&&"undefined"!=typeof e&&"server"===e.process.env.VUE_ENV),er},Tr=gr&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__,Sr=function(){function t(){i=!1;var t=n.slice(0);n.length=0;for(var e=0;e<t.length;e++)t[e]()}var e,n=[],i=!1;if("undefined"!=typeof Promise&&w(Promise)){var r=Promise.resolve(),o=function(t){console.error(t)};e=function(){r.then(t).catch(o),Mr&&setTimeout(m)}}else if("undefined"==typeof MutationObserver||!w(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())e=function(){setTimeout(t,0)};else{var a=1,s=new MutationObserver(t),u=document.createTextNode(String(a));s.observe(u,{characterData:!0}),e=function(){a=(a+1)%2,u.data=String(a)}}return function(t,r){var o;if(n.push(function(){t&&t.call(r),o&&o(r)}),i||(i=!0,e()),!t&&"undefined"!=typeof Promise)return new Promise(function(t){o=t})}}();nr="undefined"!=typeof Set&&w(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return this.set[t]===!0},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var Pr,Ar=m,Cr=0,Lr=function(){this.id=Cr++,this.subs=[]};Lr.prototype.addSub=function(t){this.subs.push(t)},Lr.prototype.removeSub=function(t){o(this.subs,t)},Lr.prototype.depend=function(){Lr.target&&Lr.target.addDep(this)},Lr.prototype.notify=function(){for(var t=this.subs.slice(),e=0,n=t.length;e<n;e++)t[e].update()},Lr.target=null;var Ir=[],Rr=Array.prototype,Nr=Object.create(Rr);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){var e=Rr[t];x(Nr,t,function(){for(var n=arguments,i=arguments.length,r=new Array(i);i--;)r[i]=n[i];var o,a=e.apply(this,r),s=this.__ob__;switch(t){case"push":o=r;break;case"unshift":o=r;break;case"splice":o=r.slice(2)}return o&&s.observeArray(o),s.dep.notify(),a})});var Or=Object.getOwnPropertyNames(Nr),Dr={shouldConvert:!0,isSettingProps:!1},Br=function(t){if(this.value=t,this.dep=new Lr,this.vmCount=0,x(t,"__ob__",this),Array.isArray(t)){var e=vr?T:S;e(t,Nr,Or),this.observeArray(t)}else this.walk(t)};Br.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)A(t,e[n],t[e[n]])},Br.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)P(t[e])};var Ur=dr.optionMergeStrategies;Ur.data=function(t,e,n){return n?t||e?function(){var i="function"==typeof e?e.call(n):e,r="function"==typeof t?t.call(n):void 0;return i?R(i,r):r}:void 0:e?"function"!=typeof e?t:t?function(){return R(e.call(this),t.call(this))}:e:t},dr._lifecycleHooks.forEach(function(t){Ur[t]=N}),dr._assetTypes.forEach(function(t){Ur[t+"s"]=O}),Ur.watch=function(t,e){if(!e)return t;if(!t)return e;var n={};h(n,t);for(var i in e){var r=n[i],o=e[i];r&&!Array.isArray(r)&&(r=[r]),n[i]=r?r.concat(o):[o]}return n},Ur.props=Ur.methods=Ur.computed=function(t,e){if(!e)return t;if(!t)return e;var n=Object.create(null);return h(n,t),h(n,e),n};var Fr=function(t,e){return void 0===e?t:e},kr=Object.freeze({defineReactive:A,_toString:n,toNumber:i,makeMap:r,isBuiltInTag:ir,remove:o,hasOwn:a,isPrimitive:s,cached:u,camelize:ar,capitalize:sr,hyphenate:cr,bind:c,toArray:l,extend:h,isObject:f,isPlainObject:p,toObject:d,noop:m,no:fr,identity:pr,genStaticKeys:v,looseEqual:g,looseIndexOf:y,isReserved:_,def:x,parsePath:b,hasProto:vr,inBrowser:gr,UA:yr,isIE:_r,isIE9:xr,isEdge:br,isAndroid:wr,isIOS:Mr,isServerRendering:Er,devtools:Tr,nextTick:Sr,get _Set(){return nr},mergeOptions:U,resolveAsset:F,get warn(){return Ar},get formatComponentName(){return Pr},validateProp:k}),zr=[],Gr={},Hr=!1,jr=!1,Xr=0,Vr=0,Yr=function(t,e,n,i){this.vm=t,t._watchers.push(this),i?(this.deep=!!i.deep,this.user=!!i.user,this.lazy=!!i.lazy,this.sync=!!i.sync):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++Vr,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new nr,this.newDepIds=new nr,this.expression="","function"==typeof e?this.getter=e:(this.getter=b(e),this.getter||(this.getter=function(){})),this.value=this.lazy?void 0:this.get()};Yr.prototype.get=function(){M(this);var t=this.getter.call(this.vm,this.vm);return this.deep&&Y(t),E(),this.cleanupDeps(),t},Yr.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},Yr.prototype.cleanupDeps=function(){for(var t=this,e=this.deps.length;e--;){var n=t.deps[e];t.newDepIds.has(n.id)||n.removeSub(t)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},Yr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():V(this)},Yr.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||f(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){if(!dr.errorHandler)throw t;dr.errorHandler.call(null,t,this.vm)}else this.cb.call(this.vm,t,e)}}},Yr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},Yr.prototype.depend=function(){for(var t=this,e=this.deps.length;e--;)t.deps[e].depend()},Yr.prototype.teardown=function(){var t=this;if(this.active){this.vm._isBeingDestroyed||o(this.vm._watchers,this);for(var e=this.deps.length;e--;)t.deps[e].removeSub(t);this.active=!1}};var Wr,qr=new nr,$r={enumerable:!0,configurable:!0,get:m,set:m},Zr=function(t,e,n,i,r,o,a){this.tag=t,this.data=e,this.children=n,this.text=i,this.elm=r,this.ns=void 0,this.context=o,this.functionalContext=void 0,this.key=e&&e.key,this.componentOptions=a,this.child=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1},Jr=function(){var t=new Zr;return t.text="",t.isComment=!0,t},Kr=null,Qr={init:St,prepatch:Pt,insert:At,destroy:Ct},to=Object.keys(Qr),eo=1,no=2,io=0;Gt(Xt),nt(Xt),_t(Xt),bt(Xt),kt(Xt);var ro=[String,RegExp],oo={name:"keep-alive",abstract:!0,props:{include:ro,exclude:ro},created:function(){this.cache=Object.create(null)},render:function(){var t=dt(this.$slots.default);if(t&&t.componentOptions){var e=t.componentOptions,n=e.Ctor.options.name||e.tag;if(n&&(this.include&&!$t(this.include,n)||this.exclude&&$t(this.exclude,n)))return t;var i=null==t.key?e.Ctor.cid+(e.tag?"::"+e.tag:""):t.key;this.cache[i]?t.child=this.cache[i].child:this.cache[i]=t,t.data.keepAlive=!0}return t},destroyed:function(){var t=this;for(var e in this.cache){var n=t.cache[e];wt(n.child,"deactivated"),n.child.$destroy()}}},ao={KeepAlive:oo};Zt(Xt),Object.defineProperty(Xt.prototype,"$isServer",{get:Er}),Xt.version="2.1.8";var so,uo,co=r("input,textarea,option,select"),lo=function(t,e){return"value"===e&&co(t)||"selected"===e&&"option"===t||"checked"===e&&"input"===t||"muted"===e&&"video"===t},ho=r("contenteditable,draggable,spellcheck"),fo=r("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),po="http://www.w3.org/1999/xlink",mo=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},vo=function(t){return mo(t)?t.slice(6,t.length):""},go=function(t){return null==t||t===!1},yo={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},_o=r("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template"),xo=r("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),bo=function(t){return"pre"===t},wo=function(t){return _o(t)||xo(t)},Mo=Object.create(null),Eo=Object.freeze({createElement:oe,createElementNS:ae,createTextNode:se,createComment:ue,insertBefore:ce,removeChild:le,appendChild:he,parentNode:fe,nextSibling:pe,tagName:de,setTextContent:me,setAttribute:ve}),To={create:function(t,e){ge(e)},update:function(t,e){t.data.ref!==e.data.ref&&(ge(t,!0),ge(e))},destroy:function(t){ge(t,!0)}},So=new Zr("",{},[]),Po=["create","activate","update","remove","destroy"],Ao={create:Me,update:Me,destroy:function(t){Me(t,So)}},Co=Object.create(null),Lo=[To,Ao],Io={create:Ae,update:Ae},Ro={create:Le,update:Le},No={create:Ne,update:Ne},Oo={create:Oe,update:Oe},Do=u(function(t){var e={},n=/;(?![^(]*\))/g,i=/:(.+)/;return t.split(n).forEach(function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}),Bo=/^--/,Uo=/\s*!important$/,Fo=function(t,e,n){Bo.test(e)?t.style.setProperty(e,n):Uo.test(n)?t.style.setProperty(e,n.replace(Uo,""),"important"):t.style[zo(e)]=n},ko=["Webkit","Moz","ms"],zo=u(function(t){if(uo=uo||document.createElement("div"),t=ar(t),"filter"!==t&&t in uo.style)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<ko.length;n++){var i=ko[n]+e;if(i in uo.style)return i}}),Go={create:Ge,update:Ge},Ho=gr&&!xr,jo="transition",Xo="animation",Vo="transition",Yo="transitionend",Wo="animation",qo="animationend";
Ho&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Vo="WebkitTransition",Yo="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Wo="WebkitAnimation",qo="webkitAnimationEnd"));var $o=gr&&window.requestAnimationFrame||setTimeout,Zo=/\b(transform|all)(,|$)/,Jo=u(function(t){return{enterClass:t+"-enter",leaveClass:t+"-leave",appearClass:t+"-enter",enterToClass:t+"-enter-to",leaveToClass:t+"-leave-to",appearToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveActiveClass:t+"-leave-active",appearActiveClass:t+"-enter-active"}}),Ko=gr?{create:en,activate:en,remove:function(t,e){t.data.show?e():Ke(t,e)}}:{},Qo=[Io,Ro,No,Oo,Go,Ko],ta=Qo.concat(Lo),ea=we({nodeOps:Eo,modules:ta});xr&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&un(t,"input")});var na={inserted:function(t,e,n){if("select"===n.tag){var i=function(){nn(t,e,n.context)};i(),(_r||br)&&setTimeout(i,0)}else"textarea"!==n.tag&&"text"!==t.type||(t._vModifiers=e.modifiers,e.modifiers.lazy||(wr||(t.addEventListener("compositionstart",an),t.addEventListener("compositionend",sn)),xr&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){nn(t,e,n.context);var i=t.multiple?e.value.some(function(e){return rn(e,t.options)}):e.value!==e.oldValue&&rn(e.value,t.options);i&&un(t,"change")}}},ia={bind:function(t,e,n){var i=e.value;n=cn(n);var r=n.data&&n.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;i&&r&&!xr?(n.data.show=!0,Je(n,function(){t.style.display=o})):t.style.display=i?o:"none"},update:function(t,e,n){var i=e.value,r=e.oldValue;if(i!==r){n=cn(n);var o=n.data&&n.data.transition;o&&!xr?(n.data.show=!0,i?Je(n,function(){t.style.display=t.__vOriginalDisplay}):Ke(n,function(){t.style.display="none"})):t.style.display=i?t.__vOriginalDisplay:"none"}},unbind:function(t,e,n,i,r){r||(t.style.display=t.__vOriginalDisplay)}},ra={model:na,show:ia},oa={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String},aa={name:"transition",props:oa,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(function(t){return t.tag}),n.length)){var i=this.mode,r=n[0];if(pn(this.$vnode))return r;var o=ln(r);if(!o)return r;if(this._leaving)return fn(t,r);var a=o.key=null==o.key||o.isStatic?"__v"+(o.tag+this._uid)+"__":o.key,s=(o.data||(o.data={})).transition=hn(this),u=this._vnode,c=ln(u);if(o.data.directives&&o.data.directives.some(function(t){return"show"===t.name})&&(o.data.show=!0),c&&c.data&&!dn(o,c)){var l=c&&(c.data.transition=h({},s));if("out-in"===i)return this._leaving=!0,st(l,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()},a),fn(t,r);if("in-out"===i){var f,p=function(){f()};st(s,"afterEnter",p,a),st(s,"enterCancelled",p,a),st(l,"delayLeave",function(t){f=t},a)}}return r}}},sa=h({tag:String,moveClass:String},oa);delete sa.mode;var ua={props:sa,render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),i=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],a=hn(this),s=0;s<r.length;s++){var u=r[s];if(u.tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))o.push(u),n[u.key]=u,(u.data||(u.data={})).transition=a;else;}if(i){for(var c=[],l=[],h=0;h<i.length;h++){var f=i[h];f.data.transition=a,f.data.pos=f.elm.getBoundingClientRect(),n[f.key]?c.push(f):l.push(f)}this.kept=t(e,null,c),this.removed=l}return t(e,null,o)},beforeUpdate:function(){this.__patch__(this._vnode,this.kept,!1,!0),this._vnode=this.kept},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";if(t.length&&this.hasMove(t[0].elm,e)){t.forEach(mn),t.forEach(vn),t.forEach(gn);document.body.offsetHeight;t.forEach(function(t){if(t.data.moved){var n=t.elm,i=n.style;Ve(n,e),i.transform=i.WebkitTransform=i.transitionDuration="",n.addEventListener(Yo,n._moveCb=function t(i){i&&!/transform$/.test(i.propertyName)||(n.removeEventListener(Yo,t),n._moveCb=null,Ye(n,e))})}})}},methods:{hasMove:function(t,e){if(!Ho)return!1;if(null!=this._hasMove)return this._hasMove;Ve(t,e);var n=qe(t);return Ye(t,e),this._hasMove=n.hasTransform}}},ca={Transition:aa,TransitionGroup:ua};Xt.config.isUnknownElement=ie,Xt.config.isReservedTag=wo,Xt.config.getTagNamespace=ne,Xt.config.mustUseProp=lo,h(Xt.options.directives,ra),h(Xt.options.components,ca),Xt.prototype.__patch__=gr?ea:m,Xt.prototype.$mount=function(t,e){return t=t&&gr?re(t):void 0,this._mount(t,e)},setTimeout(function(){dr.devtools&&Tr&&Tr.emit("init",Xt)},0);var la,ha=!!gr&&yn("\n","&#10;"),fa=r("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr",!0),pa=r("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source",!0),da=r("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track",!0),ma=/([^\s"'<>\/=]+)/,va=/(?:=)/,ga=[/"([^"]*)"+/.source,/'([^']*)'+/.source,/([^\s"'=<>`]+)/.source],ya=new RegExp("^\\s*"+ma.source+"(?:\\s*("+va.source+")\\s*(?:"+ga.join("|")+"))?"),_a="[a-zA-Z_][\\w\\-\\.]*",xa="((?:"+_a+"\\:)?"+_a+")",ba=new RegExp("^<"+xa),wa=/^\s*(\/?)>/,Ma=new RegExp("^<\\/"+xa+"[^>]*>"),Ea=/^<!DOCTYPE [^>]+>/i,Ta=/^<!--/,Sa=/^<!\[/,Pa=!1;"x".replace(/x(.)?/g,function(t,e){Pa=""===e});var Aa,Ca,La,Ia,Ra,Na,Oa,Da,Ba,Ua,Fa,ka,za,Ga,Ha,ja,Xa,Va,Ya,Wa,qa,$a,Za,Ja,Ka,Qa=r("script,style",!0),ts=function(t){return"lang"===t.name&&"html"!==t.value},es=function(t,e,n){return!!Qa(t)||!(!e||1!==n.length)&&!("template"===t&&!n[0].attrs.some(ts))},ns={},is=/&lt;/g,rs=/&gt;/g,os=/&#10;/g,as=/&amp;/g,ss=/&quot;/g,us=/\{\{((?:.|\n)+?)\}\}/g,cs=/[-.*+?^${}()|[\]\/\\]/g,ls=u(function(t){var e=t[0].replace(cs,"\\$&"),n=t[1].replace(cs,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+n,"g")}),hs=/^v-|^@|^:/,fs=/(.*?)\s+(?:in|of)\s+(.*)/,ps=/\((\{[^}]*\}|[^,]*),([^,]*)(?:,([^,]*))?\)/,ds=/^:|^v-bind:/,ms=/^@|^v-on:/,vs=/:(.*)$/,gs=/\.[^.]+/g,ys=u(_n),_s=/^xmlns:NS\d+/,xs=/^NS\d+:/,bs=u(oi),ws=/^\s*([\w$_]+|\([^)]*?\))\s*=>|^function\s*\(/,Ms=/^\s*[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?']|\[".*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*\s*$/,Es={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Ts={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:"if($event.target !== $event.currentTarget)return;",ctrl:"if(!$event.ctrlKey)return;",shift:"if(!$event.shiftKey)return;",alt:"if(!$event.altKey)return;",meta:"if(!$event.metaKey)return;"},Ss={bind:mi,cloak:m},Ps=(new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b"),{staticKeys:["staticClass"],transformNode:ki,genData:zi}),As={staticKeys:["staticStyle"],transformNode:Gi,genData:Hi},Cs=[Ps,As],Ls={model:ji,text:$i,html:Zi},Is=Object.create(null),Rs={expectHTML:!0,modules:Cs,staticKeys:v(Cs),directives:Ls,isReservedTag:wo,isUnaryTag:fa,mustUseProp:lo,getTagNamespace:ne,isPreTag:bo},Ns=u(function(t){var e=re(t);return e&&e.innerHTML}),Os=Xt.prototype.$mount;Xt.prototype.$mount=function(t,e){if(t=t&&re(t),t===document.body||t===document.documentElement)return this;var n=this.$options;if(!n.render){var i=n.template;if(i)if("string"==typeof i)"#"===i.charAt(0)&&(i=Ns(i));else{if(!i.nodeType)return this;i=i.innerHTML}else t&&(i=tr(t));if(i){var r=Ki(i,{warn:Ar,shouldDecodeNewlines:ha,delimiters:n.delimiters},this),o=r.render,a=r.staticRenderFns;n.render=o,n.staticRenderFns=a}}return Os.call(this,t,e)},Xt.compile=Ki,t.exports=Xt}).call(e,function(){return this}())},function(t,e,n){var i,r;!function(o,a){i=[n(58),n(151)],r=function(t,e){return a(o,t,e)}.apply(e,i),!(void 0!==r&&(t.exports=r))}(window,function(t,e,n){function i(t,e){if(t=s(t),!t)throw"Bad element for Huebee: "+t;this.anchor=t,this.options={},this.option(i.defaults),this.option(e),this.create()}function r(){for(var t=document.querySelectorAll("[data-huebee]"),e=0;e<t.length;e++){var n,r=t[e],o=r.getAttribute("data-huebee");try{n=o&&JSON.parse(o)}catch(t){b&&b.error("Error parsing data-huebee on "+r.className+": "+t);continue}new i(r,n)}}function o(t){E.clearRect(0,0,1,1),E.fillStyle="#010203",E.fillStyle=t,E.fillRect(0,0,1,1);var e=E.getImageData(0,0,1,1).data;if(e=[e[0],e[1],e[2],e[3]],"1,2,3,255"!=e.join(",")){var n=l.apply(this,e);return{color:t.trim(),hue:n[0],sat:n[1],lum:n[2]}}}function a(t,e){for(var n in e)t[n]=e[n];return t}function s(t){return"string"==typeof t&&(t=document.querySelector(t)),t}function u(t,e,n){var i=c(t,e,n);return h(i)}function c(t,e,n){var i,r,o=(1-Math.abs(2*n-1))*e,a=t/60,s=o*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:i=[o,s,0];break;case 1:i=[s,o,0];break;case 2:i=[0,o,s];break;case 3:i=[0,s,o];break;case 4:i=[s,0,o];break;case 5:i=[o,0,s];break;default:i=[0,0,0]}return r=n-o/2,i=i.map(function(t){return t+r})}function l(t,e,n){t/=255,e/=255,n/=255;var i,r=Math.max(t,e,n),o=Math.min(t,e,n),a=r-o,s=.5*(r+o),u=0===a?0:a/(1-Math.abs(2*s-1));0===a?i=0:r===t?i=(e-n)/a%6:r===e?i=(n-t)/a+2:r===n&&(i=(t-e)/a+4);var c=60*i;return[c,parseFloat(u),parseFloat(s)]}function h(t){var e=t.map(function(t){t=Math.round(255*t);var e=t.toString(16).toUpperCase();return e=e.length<2?"0"+e:e});return"#"+e.join("")}function f(t){return"#"+t[1]+t[3]+t[5]}i.defaults={hues:12,hue0:0,shades:5,saturations:3,notation:"shortHex",setText:!0,setBGColor:!0};var p=i.prototype=Object.create(e.prototype);p.option=function(t){this.options=a(this.options,t)};var d=0,m={};p.create=function(){function t(t){t.target==i&&t.preventDefault()}var e=this.guid=++d;this.anchor.huebeeGUID=e,m[e]=this,this.setBGElems=this.getSetElems(this.options.setBGColor),this.setTextElems=this.getSetElems(this.options.setText),this.outsideCloseIt=this.outsideClose.bind(this),this.onDocKeydown=this.docKeydown.bind(this),this.closeIt=this.close.bind(this),this.openIt=this.open.bind(this),this.onElemTransitionend=this.elemTransitionend.bind(this),this.isInputAnchor="INPUT"==this.anchor.nodeName,this.options.staticOpen||(this.anchor.addEventListener("click",this.openIt),this.anchor.addEventListener("focus",this.openIt)),this.isInputAnchor&&this.anchor.addEventListener("input",this.inputInput.bind(this));var n=this.element=document.createElement("div");n.className="huebee ",n.className+=this.options.staticOpen?"is-static-open ":"is-hidden ",n.className+=this.options.className||"";var i=this.container=document.createElement("div");if(i.className="huebee__container",i.addEventListener("mousedown",t),i.addEventListener("touchstart",t),this.createCanvas(),this.cursor=document.createElement("div"),this.cursor.className="huebee__cursor is-hidden",i.appendChild(this.cursor),this.createCloseButton(),n.appendChild(i),!this.options.staticOpen){var r=getComputedStyle(this.anchor.parentNode);"relative"!=r.position&&"absolute"!=r.position&&(this.anchor.parentNode.style.position="relative")}var o=this.options.hues,a=this.options.customColors,s=a&&a.length;this.satY=s?Math.ceil(s/o)+1:0,this.updateColors(),this.setAnchorColor(),this.options.staticOpen&&this.open()},p.getSetElems=function(t){return t===!0?[this.anchor]:"string"==typeof t?document.querySelectorAll(t):void 0},p.createCanvas=function(){var t=this.canvas=document.createElement("canvas");t.className="huebee__canvas",this.ctx=t.getContext("2d");var e=this.canvasPointer=new n;e._bindStartEvent(t),e.on("pointerDown",this.canvasPointerDown.bind(this)),e.on("pointerMove",this.canvasPointerMove.bind(this)),this.container.appendChild(t)};var v="http://www.w3.org/2000/svg";p.createCloseButton=function(){if(!this.options.staticOpen){var t=document.createElementNS(v,"svg");t.setAttribute("class","huebee__close-button"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","24"),t.setAttribute("height","24");var e=document.createElementNS(v,"path");e.setAttribute("d","M 7,7 L 17,17 M 17,7 L 7,17"),e.setAttribute("class","huebee__close-button__x"),t.appendChild(e),t.addEventListener("click",this.closeIt),this.container.appendChild(t)}},p.updateColors=function(){this.swatches={},this.colorGrid={},this.updateColorModer();var t=this.options.shades,e=this.options.saturations,n=this.options.hues,i=this.options.customColors;if(i&&i.length){var r=0;i.forEach(function(t){var e=r%n,i=Math.floor(r/n),a=o(t);a&&(this.addSwatch(a,e,i),r++)}.bind(this))}for(var a=0;a<e;a++){var s=1-a/e,u=t*a+this.satY;this.updateSaturationGrid(a,s,u)}for(a=0;a<t+2;a++){var c=1-a/(t+1),l=this.colorModer(0,0,c),h=o(l);this.addSwatch(h,n+1,a)}},p.updateSaturationGrid=function(t,e,n){for(var i=this.options.shades,r=this.options.hues,a=this.options.hue0,s=0;s<i;s++)for(var u=0;u<r;u++){var c=Math.round(360*u/r+a)%360,l=1-(s+1)/(i+1),h=this.colorModer(c,e,l),f=o(h),p=s+n;this.addSwatch(f,u,p)}},p.addSwatch=function(t,e,n){this.swatches[e+","+n]=t,this.colorGrid[t.color.toUpperCase()]={x:e,y:n}};var g={hsl:function(t,e,n){return e=Math.round(100*e),n=Math.round(100*n),"hsl("+t+", "+e+"%, "+n+"%)"},hex:u,shortHex:function(t,e,n){var i=u(t,e,n);return f(i)}};p.updateColorModer=function(){this.colorModer=g[this.options.notation]||g.shortHex},p.renderColors=function(){var t=2*this.gridSize;for(var e in this.swatches){var n=this.swatches[e],i=e.split(","),r=i[0],o=i[1];this.ctx.fillStyle=n.color,this.ctx.fillRect(r*t,o*t,t,t)}},p.setAnchorColor=function(){this.isInputAnchor&&this.setColor(this.anchor.value)};var y=document.documentElement;p.open=function(){if(!this.isOpen){var t=this.anchor,e=this.element;this.options.staticOpen||(e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+t.offsetHeight+"px"),this.bindOpenEvents(!0),e.removeEventListener("transitionend",this.onElemTransitionend),t.parentNode.insertBefore(e,t.nextSibling);var n=getComputedStyle(e).transitionDuration;this.hasTransition=n&&"none"!=n&&parseFloat(n),this.isOpen=!0,this.updateSizes(),this.renderColors(),this.setAnchorColor();e.offsetHeight;e.classList.remove("is-hidden")}},p.bindOpenEvents=function(t){if(!this.options.staticOpen){var e=(t?"add":"remove")+"EventListener";y[e]("mousedown",this.outsideCloseIt),y[e]("touchstart",this.outsideCloseIt),document[e]("focusin",this.outsideCloseIt),document[e]("keydown",this.onDocKeydown),this.anchor[e]("blur",this.closeIt)}},p.updateSizes=function(){var t=this.options.hues,e=this.options.shades,n=this.options.saturations;this.cursorBorder=parseInt(getComputedStyle(this.cursor).borderTopWidth,10),this.gridSize=Math.round(this.cursor.offsetWidth-2*this.cursorBorder),this.canvasOffset={x:this.canvas.offsetLeft,y:this.canvas.offsetTop};var i=Math.max(e*n+this.satY,e+2),r=this.gridSize*(t+2);this.canvas.width=2*r,this.canvas.style.width=r+"px",this.canvas.height=this.gridSize*i*2},p.outsideClose=function(t){var e=this.anchor.contains(t.target),n=this.element.contains(t.target);e||n||this.close()};var _={13:!0,27:!0};p.docKeydown=function(t){_[t.keyCode]&&this.close()};var x="string"==typeof y.style.transform;p.close=function(){this.isOpen&&(x&&this.hasTransition?this.element.addEventListener("transitionend",this.onElemTransitionend):this.remove(),this.element.classList.add("is-hidden"),this.bindOpenEvents(!1),this.isOpen=!1)},p.remove=function(){var t=this.element.parentNode;t.contains(this.element)&&t.removeChild(this.element)},p.elemTransitionend=function(t){t.target==this.element&&(this.element.removeEventListener("transitionend",this.onElemTransitionend),this.remove())},p.inputInput=function(){this.setColor(this.anchor.value)},p.canvasPointerDown=function(t,e){t.preventDefault(),this.updateOffset(),this.canvasPointerChange(e)},p.updateOffset=function(){var e=this.canvas.getBoundingClientRect();this.offset={x:e.left+t.pageXOffset,y:e.top+t.pageYOffset}},p.canvasPointerMove=function(t,e){this.canvasPointerChange(e)},p.canvasPointerChange=function(t){var e=Math.round(t.pageX-this.offset.x),n=Math.round(t.pageY-this.offset.y),i=this.gridSize,r=Math.floor(e/i),o=Math.floor(n/i),a=this.swatches[r+","+o];this.setSwatch(a)},p.setColor=function(t){var e=o(t);this.setSwatch(e)},p.setSwatch=function(t){var e=t&&t.color;if(t){var n=e==this.color;this.color=e,this.hue=t.hue,this.sat=t.sat,this.lum=t.lum;var i=this.lum-.15*Math.cos((this.hue+70)/180*Math.PI);this.isLight=i>.5;var r=this.colorGrid[e.toUpperCase()];this.updateCursor(r),this.setTexts(),this.setBackgrounds(),n||this.emitEvent("change",[e,t.hue,t.sat,t.lum])}},p.setTexts=function(){if(this.setTextElems)for(var t=0;t<this.setTextElems.length;t++){var e=this.setTextElems[t],n="INPUT"==e.nodeName?"value":"textContent";e[n]=this.color}},p.setBackgrounds=function(){if(this.setBGElems)for(var t=this.isLight?"#222":"white",e=0;e<this.setBGElems.length;e++){var n=this.setBGElems[e];n.style.backgroundColor=this.color,n.style.color=t}},p.updateCursor=function(t){if(this.isOpen){var e=t?"remove":"add";if(this.cursor.classList[e]("is-hidden"),t){var n=this.gridSize,i=this.canvasOffset,r=this.cursorBorder;this.cursor.style.left=t.x*n+i.x-r+"px",this.cursor.style.top=t.y*n+i.y-r+"px"}}};var b=t.console,w=document.readyState;"complete"==w||"interactive"==w?r():document.addEventListener("DOMContentLoaded",r),i.data=function(t){t=s(t);var e=t&&t.huebeeGUID;return e&&m[e]};var M=document.createElement("canvas");M.width=M.height=1;var E=M.getContext("2d");return i})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports={default:n(103),__esModule:!0}},function(t,e,n){t.exports={default:n(104),__esModule:!0}},function(t,e,n){t.exports={default:n(106),__esModule:!0}},function(t,e,n){t.exports={default:n(107),__esModule:!0}},function(t,e,n){var i=n(4),r=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},function(t,e,n){n(128),t.exports=n(4).Object.assign},function(t,e,n){n(129);var i=n(4).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){n(130);var i=n(4).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){n(131);var i=n(4).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){n(132),t.exports=n(4).Object.keys},function(t,e,n){n(135),n(133),n(136),n(137),t.exports=n(4).Symbol},function(t,e,n){n(134),n(138),t.exports=n(41).f("iterator")},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(11),r=n(126),o=n(125);t.exports=function(t){return function(e,n,a){var s,u=i(e),c=r(u.length),l=o(a,c);if(t&&n!=n){for(;c>l;)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var i=n(108);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(15),r=n(33),o=n(21);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){t.exports=n(7).document&&document.documentElement},function(t,e,n){var i=n(48);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){"use strict";var i=n(32),r=n(22),o=n(34),a={};n(14)(a,n(16)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(15),r=n(11);t.exports=function(t,e){for(var n,o=r(t),a=i(o),s=a.length,u=0;s>u;)if(o[n=a[u++]]===e)return n}},function(t,e,n){var i=n(23)("meta"),r=n(20),o=n(9),a=n(10).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(13)(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[i].i},f=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[i].w},p=function(t){return c&&d.NEED&&u(t)&&!o(t,i)&&l(t),t},d=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:p}},function(t,e,n){"use strict";var i=n(15),r=n(33),o=n(21),a=n(38),s=n(51),u=Object.assign;t.exports=!u||n(13)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i})?function(t,e){for(var n=a(t),u=arguments.length,c=1,l=r.f,h=o.f;u>c;)for(var f,p=s(arguments[c++]),d=l?i(p).concat(l(p)):i(p),m=d.length,v=0;m>v;)h.call(p,f=d[v++])&&(n[f]=p[f]);return n}:u},function(t,e,n){var i=n(21),r=n(22),o=n(11),a=n(39),s=n(9),u=n(50),c=Object.getOwnPropertyDescriptor;e.f=n(6)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(11),r=n(54).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):r(i(t))}},function(t,e,n){var i=n(9),r=n(38),o=n(35)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var i=n(8),r=n(4),o=n(13);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var i=n(37),r=n(28);t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),u=i(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):(o-55296<<10)+(a-56320)+65536)}}},function(t,e,n){var i=n(37),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(37),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){"use strict";var i=n(109),r=n(116),o=n(30),a=n(11);t.exports=n(52)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var i=n(8);i(i.S+i.F,"Object",{assign:n(119)})},function(t,e,n){var i=n(8);i(i.S,"Object",{create:n(32)})},function(t,e,n){var i=n(8);i(i.S+i.F*!n(6),"Object",{defineProperties:n(53)})},function(t,e,n){var i=n(8);i(i.S+i.F*!n(6),"Object",{defineProperty:n(10).f})},function(t,e,n){var i=n(38),r=n(15);n(123)("keys",function(){return function(t){return r(i(t))}})},function(t,e){},function(t,e,n){"use strict";var i=n(124)(!0);n(52)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var i=n(7),r=n(9),o=n(6),a=n(8),s=n(56),u=n(118).KEY,c=n(13),l=n(36),h=n(34),f=n(23),p=n(16),d=n(41),m=n(40),v=n(117),g=n(112),y=n(114),_=n(19),x=n(11),b=n(39),w=n(22),M=n(32),E=n(121),T=n(120),S=n(10),P=n(15),A=T.f,C=S.f,L=E.f,I=i.Symbol,R=i.JSON,N=R&&R.stringify,O="prototype",D=p("_hidden"),B=p("toPrimitive"),U={}.propertyIsEnumerable,F=l("symbol-registry"),k=l("symbols"),z=l("op-symbols"),G=Object[O],H="function"==typeof I,j=i.QObject,X=!j||!j[O]||!j[O].findChild,V=o&&c(function(){return 7!=M(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=A(G,e);i&&delete G[e],C(t,e,n),i&&t!==G&&C(G,e,i)}:C,Y=function(t){var e=k[t]=M(I[O]);return e._k=t,e},W=H&&"symbol"==typeof I.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof I},q=function(t,e,n){return t===G&&q(z,e,n),_(t),e=b(e,!0),_(n),r(k,e)?(n.enumerable?(r(t,D)&&t[D][e]&&(t[D][e]=!1),n=M(n,{enumerable:w(0,!1)})):(r(t,D)||C(t,D,w(1,{})),t[D][e]=!0),V(t,e,n)):C(t,e,n)},$=function(t,e){_(t);for(var n,i=g(e=x(e)),r=0,o=i.length;o>r;)q(t,n=i[r++],e[n]);return t},Z=function(t,e){return void 0===e?M(t):$(M(t),e)},J=function(t){var e=U.call(this,t=b(t,!0));return!(this===G&&r(k,t)&&!r(z,t))&&(!(e||!r(this,t)||!r(k,t)||r(this,D)&&this[D][t])||e)},K=function(t,e){if(t=x(t),e=b(e,!0),t!==G||!r(k,e)||r(z,e)){var n=A(t,e);return!n||!r(k,e)||r(t,D)&&t[D][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=L(x(t)),i=[],o=0;n.length>o;)r(k,e=n[o++])||e==D||e==u||i.push(e);return i},tt=function(t){for(var e,n=t===G,i=L(n?z:x(t)),o=[],a=0;i.length>a;)!r(k,e=i[a++])||n&&!r(G,e)||o.push(k[e]);return o};H||(I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===G&&e.call(z,n),r(this,D)&&r(this[D],t)&&(this[D][t]=!1),V(this,t,w(1,n))};return o&&X&&V(G,t,{configurable:!0,set:e}),Y(t)},s(I[O],"toString",function(){return this._k}),T.f=K,S.f=q,n(54).f=E.f=Q,n(21).f=J,n(33).f=tt,o&&!n(31)&&s(G,"propertyIsEnumerable",J,!0),d.f=function(t){return Y(p(t))}),a(a.G+a.W+a.F*!H,{Symbol:I});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)p(et[nt++]);for(var et=P(p.store),nt=0;et.length>nt;)m(et[nt++]);a(a.S+a.F*!H,"Symbol",{for:function(t){return r(F,t+="")?F[t]:F[t]=I(t)},keyFor:function(t){if(W(t))return v(F,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){X=!0},useSimple:function(){X=!1}}),a(a.S+a.F*!H,"Object",{create:Z,defineProperty:q,defineProperties:$,getOwnPropertyDescriptor:K,getOwnPropertyNames:Q,getOwnPropertySymbols:tt}),R&&a(a.S+a.F*(!H||c(function(){var t=I();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!W(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return e=i[1],"function"==typeof e&&(n=e),!n&&y(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,N.apply(R,i)}}}),I[O][B]||n(14)(I[O],B,I[O].valueOf),h(I,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){n(40)("asyncIterator")},function(t,e,n){n(40)("observable")},function(t,e,n){n(127);for(var i=n(7),r=n(14),o=n(30),a=n(16)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var c=s[u],l=i[c],h=l&&l.prototype;h&&!h[a]&&r(h,a,c),o[c]=o.Array}},,,,,,,,,,,,function(t,e){"use strict";function n(t,e,n){re.biginteger_used=1,null!=t&&("number"==typeof t&&"undefined"==typeof e?this.fromInt(t):"number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new n(null)}function r(t,e,n,i,r,o){for(;--o>=0;){var a=e*this[t++]+n[i]+r;r=Math.floor(a/67108864),n[i++]=67108863&a}return r}function o(t,e,n,i,r,o){for(var a=32767&e,s=e>>15;--o>=0;){var u=32767&this[t],c=this[t++]>>15,l=s*u+c*a;u=a*u+((32767&l)<<15)+n[i]+(1073741823&r),r=(u>>>30)+(l>>>15)+s*c+(r>>>30),n[i++]=1073741823&u}return r}function a(t,e,n,i,r,o){for(var a=16383&e,s=e>>14;--o>=0;){var u=16383&this[t],c=this[t++]>>14,l=s*u+c*a;u=a*u+((16383&l)<<14)+n[i]+r,r=(u>>28)+(l>>14)+s*c,n[i++]=268435455&u}return r}function s(t){return me.charAt(t)}function u(t,e){var n=ve[t.charCodeAt(e)];return null==n?-1:n}function c(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function l(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function h(t){var e=i();return e.fromInt(t),e}function f(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var r=t.length,o=!1,a=0;--r>=0;){var s=8==i?255&t[r]:u(t,r);s<0?"-"==t.charAt(r)&&(o=!0):(o=!1,0==a?this[this.t++]=s:a+i>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,a+=i,a>=this.DB&&(a-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),o&&n.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function d(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,o="",a=this.t,u=this.DB-a*this.DB%e;if(a-- >0)for(u<this.DB&&(n=this[a]>>u)>0&&(r=!0,o=s(n));a>=0;)u<e?(n=(this[a]&(1<<u)-1)<<e-u,n|=this[--a]>>(u+=this.DB-e)):(n=this[a]>>(u-=e)&i,u<=0&&(u+=this.DB,--a)),n>0&&(r=!0),r&&(o+=s(n));return r?o:"0"}function m(){var t=i();return n.ZERO.subTo(this,t),t}function v(){return this.s<0?this.negate():this}function g(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(e=n-t.t,0!=e)return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0}function y(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function _(){return this.t<=0?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)}function x(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s}function b(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s}function w(t,e){var n,i=t%this.DB,r=this.DB-i,o=(1<<r)-1,a=Math.floor(t/this.DB),s=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+a+1]=this[n]>>r|s,s=(this[n]&o)<<i;for(n=a-1;n>=0;--n)e[n]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function M(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)return void(e.t=0);var i=t%this.DB,r=this.DB-i,o=(1<<i)-1;e[0]=this[n]>>i;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&o)<<r,e[a-n]=this[a]>>i;i>0&&(e[this.t-n-1]|=(this.s&o)<<r),e.t=this.t-n,e.clamp()}function E(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()}function T(t,e){var i=this.abs(),r=t.abs(),o=i.t;for(e.t=o+r.t;--o>=0;)e[o]=0;for(o=0;o<r.t;++o)e[o+i.t]=i.am(0,r[o],e,o,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&n.ZERO.subTo(e,e)}function S(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()}function P(t,e,r){var o=t.abs();if(!(o.t<=0)){var a=this.abs();if(a.t<o.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=i());var s=i(),u=this.s,c=t.s,l=this.DB-y(o[o.t-1]);l>0?(o.lShiftTo(l,s),a.lShiftTo(l,r)):(o.copyTo(s),a.copyTo(r));var h=s.t,f=s[h-1];if(0!=f){var p=f*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),d=this.FV/p,m=(1<<this.F1)/p,v=1<<this.F2,g=r.t,_=g-h,x=null==e?i():e;for(s.dlShiftTo(_,x),r.compareTo(x)>=0&&(r[r.t++]=1,r.subTo(x,r)),n.ONE.dlShiftTo(h,x),x.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--_>=0;){var b=r[--g]==f?this.DM:Math.floor(r[g]*d+(r[g-1]+v)*m);if((r[g]+=s.am(0,b,r,_,0,h))<b)for(s.dlShiftTo(_,x),r.subTo(x,r);r[g]<--b;)r.subTo(x,r)}null!=e&&(r.drShiftTo(h,e),u!=c&&n.ZERO.subTo(e,e)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),u<0&&n.ZERO.subTo(r,r)}}}function A(t){var e=i();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(n.ZERO)>0&&t.subTo(e,e),e}function C(t){this.m=t}function L(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t;
}function I(t){return t}function R(t){t.divRemTo(this.m,null,t)}function N(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function O(t,e){t.squareTo(e),this.reduce(e)}function D(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function B(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function U(t){var e=i();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(n.ZERO)>0&&this.m.subTo(e,e),e}function F(t){var e=i();return t.copyTo(e),this.reduce(e),e}function k(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(n=e+this.m.t,t[n]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function z(t,e){t.squareTo(e),this.reduce(e)}function G(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function H(){return 0==(this.t>0?1&this[0]:this.s)}function j(t,e){if(t>4294967295||t<1)return n.ONE;var r=i(),o=i(),a=e.convert(this),s=y(t)-1;for(a.copyTo(r);--s>=0;)if(e.sqrTo(r,o),(t&1<<s)>0)e.mulTo(o,a,r);else{var u=r;r=o,o=u}return e.revert(r)}function X(t,e){var n;return n=t<256||e.isEven()?new C(e):new B(e),this.exp(t,n)}function V(){var t=i();return this.copyTo(t),t}function Y(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function W(){return 0==this.t?this.s:this[0]<<24>>24}function q(){return 0==this.t?this.s:this[0]<<16>>16}function $(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Z(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function J(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=h(n),o=i(),a=i(),s="";for(this.divRemTo(r,o,a);o.signum()>0;)s=(n+a.intValue()).toString(t).substr(1)+s,o.divRemTo(r,o,a);return a.intValue().toString(t)+s}function K(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),r=Math.pow(e,i),o=!1,a=0,s=0,c=0;c<t.length;++c){var l=u(t,c);l<0?"-"==t.charAt(c)&&0==this.signum()&&(o=!0):(s=e*s+l,++a>=i&&(this.dMultiply(r),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),o&&n.ZERO.subTo(this,this)}function Q(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(n.ONE.shiftLeft(t-1),st,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(n.ONE.shiftLeft(t-1),this);else{var r=new Array,o=7&t;r.length=(t>>3)+1,e.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}}function tt(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e}function et(t){return 0==this.compareTo(t)}function nt(t){return this.compareTo(t)<0?this:t}function it(t){return this.compareTo(t)>0?this:t}function rt(t,e,n){var i,r,o=Math.min(t.t,this.t);for(i=0;i<o;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=o;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=o;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()}function ot(t,e){return t&e}function at(t){var e=i();return this.bitwiseTo(t,ot,e),e}function st(t,e){return t|e}function ut(t){var e=i();return this.bitwiseTo(t,st,e),e}function ct(t,e){return t^e}function lt(t){var e=i();return this.bitwiseTo(t,ct,e),e}function ht(t,e){return t&~e}function ft(t){var e=i();return this.bitwiseTo(t,ht,e),e}function pt(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function dt(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function mt(t){var e=i();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function vt(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function gt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+vt(this[t]);return this.s<0?this.t*this.DB:-1}function yt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function _t(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=yt(this[n]^e);return t}function xt(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bt(t,e){var i=n.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function wt(t){return this.changeBit(t,st)}function Mt(t){return this.changeBit(t,ht)}function Et(t){return this.changeBit(t,ct)}function Tt(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()}function St(t){var e=i();return this.addTo(t,e),e}function Pt(t){var e=i();return this.subTo(t,e),e}function At(t){var e=i();return this.multiplyTo(t,e),e}function Ct(){var t=i();return this.squareTo(t),t}function Lt(t){var e=i();return this.divRemTo(t,e,null),e}function It(t){var e=i();return this.divRemTo(t,null,e),e}function Rt(t){var e=i(),n=i();return this.divRemTo(t,e,n),new Array(e,n)}function Nt(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ot(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Dt(){}function Bt(t){return t}function Ut(t,e,n){t.multiplyTo(e,n)}function Ft(t,e){t.squareTo(e)}function kt(t){return this.exp(t,new Dt)}function zt(t,e,n){var i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0;var r;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()}function Gt(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)}function Ht(t){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function jt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function Xt(t){return t}function Vt(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Yt(t,e){t.squareTo(e),this.reduce(e)}function Wt(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function qt(t,e){var n,r,o=t.bitLength(),a=h(1);if(o<=0)return a;n=o<18?1:o<48?3:o<144?4:o<768?5:6,r=o<8?new C(e):e.isEven()?new Ht(e):new B(e);var s=new Array,u=3,c=n-1,l=(1<<n)-1;if(s[1]=r.convert(this),n>1){var f=i();for(r.sqrTo(s[1],f);u<=l;)s[u]=i(),r.mulTo(f,s[u-2],s[u]),u+=2}var p,d,m=t.t-1,v=!0,g=i();for(o=y(t[m])-1;m>=0;){for(o>=c?p=t[m]>>o-c&l:(p=(t[m]&(1<<o+1)-1)<<c-o,m>0&&(p|=t[m-1]>>this.DB+o-c)),u=n;0==(1&p);)p>>=1,--u;if((o-=u)<0&&(o+=this.DB,--m),v)s[p].copyTo(a),v=!1;else{for(;u>1;)r.sqrTo(a,g),r.sqrTo(g,a),u-=2;u>0?r.sqrTo(a,g):(d=a,a=g,g=d),r.mulTo(g,s[p],a)}for(;m>=0&&0==(t[m]&1<<o);)r.sqrTo(a,g),d=a,a=g,g=d,--o<0&&(o=this.DB-1,--m)}return r.revert(a)}function $t(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return e;for(r<o&&(o=r),o>0&&(e.rShiftTo(o,e),n.rShiftTo(o,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n}function Zt(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n}function Jt(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return n.ZERO;for(var i=t.clone(),r=this.clone(),o=h(1),a=h(0),s=h(0),u=h(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;r.isEven();)r.rShiftTo(1,r),e?(s.isEven()&&u.isEven()||(s.addTo(this,s),u.subTo(t,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);i.compareTo(r)>=0?(i.subTo(r,i),e&&o.subTo(s,o),a.subTo(u,a)):(r.subTo(i,r),e&&s.subTo(o,s),u.subTo(a,u))}return 0!=r.compareTo(n.ONE)?n.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u}function Kt(t){var e,n=this.abs();if(1==n.t&&n[0]<=ge[ge.length-1]){for(e=0;e<ge.length;++e)if(n[0]==ge[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<ge.length;){for(var i=ge[e],r=e+1;r<ge.length&&i<ye;)i*=ge[r++];for(i=n.modInt(i);e<r;)if(i%ge[e++]==0)return!1}return n.millerRabin(t)}function Qt(t){var e=this.subtract(n.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var o=e.shiftRight(r);t=t+1>>1,t>ge.length&&(t=ge.length);for(var a=i(),s=0;s<t;++s){a.fromInt(ge[Math.floor(Math.random()*ge.length)]);var u=a.modPow(o,this);if(0!=u.compareTo(n.ONE)&&0!=u.compareTo(e)){for(var c=1;c++<r&&0!=u.compareTo(e);)if(u=u.modPowInt(2,this),0==u.compareTo(n.ONE))return!1;if(0!=u.compareTo(e))return!1}}return!0}var te=!1,ee=!1,ne=!0,ie=!1,re={},oe=!1;"undefined"!=typeof t&&t.exports?(t.exports=re,oe=!0):"undefined"!=typeof document?window.ClipperLib=re:self.ClipperLib=re;var ae;if(oe){var se="chrome";ae="Netscape"}else{var se=navigator.userAgent.toString().toLowerCase();ae=navigator.appName}var ue={};se.indexOf("chrome")!=-1&&se.indexOf("chromium")==-1?ue.chrome=1:ue.chrome=0,se.indexOf("chromium")!=-1?ue.chromium=1:ue.chromium=0,se.indexOf("safari")!=-1&&se.indexOf("chrome")==-1&&se.indexOf("chromium")==-1?ue.safari=1:ue.safari=0,se.indexOf("firefox")!=-1?ue.firefox=1:ue.firefox=0,se.indexOf("firefox/17")!=-1?ue.firefox17=1:ue.firefox17=0,se.indexOf("firefox/15")!=-1?ue.firefox15=1:ue.firefox15=0,se.indexOf("firefox/3")!=-1?ue.firefox3=1:ue.firefox3=0,se.indexOf("opera")!=-1?ue.opera=1:ue.opera=0,se.indexOf("msie 10")!=-1?ue.msie10=1:ue.msie10=0,se.indexOf("msie 9")!=-1?ue.msie9=1:ue.msie9=0,se.indexOf("msie 8")!=-1?ue.msie8=1:ue.msie8=0,se.indexOf("msie 7")!=-1?ue.msie7=1:ue.msie7=0,se.indexOf("msie ")!=-1?ue.msie=1:ue.msie=0,re.biginteger_used=null;var ce,le=0xdeadbeefcafe,he=15715070==(16777215&le);he&&"Microsoft Internet Explorer"==ae?(n.prototype.am=o,ce=30):he&&"Netscape"!=ae?(n.prototype.am=r,ce=26):(n.prototype.am=a,ce=28),n.prototype.DB=ce,n.prototype.DM=(1<<ce)-1,n.prototype.DV=1<<ce;var fe=52;n.prototype.FV=Math.pow(2,fe),n.prototype.F1=fe-ce,n.prototype.F2=2*ce-fe;var pe,de,me="0123456789abcdefghijklmnopqrstuvwxyz",ve=new Array;for(pe="0".charCodeAt(0),de=0;de<=9;++de)ve[pe++]=de;for(pe="a".charCodeAt(0),de=10;de<36;++de)ve[pe++]=de;for(pe="A".charCodeAt(0),de=10;de<36;++de)ve[pe++]=de;C.prototype.convert=L,C.prototype.revert=I,C.prototype.reduce=R,C.prototype.mulTo=N,C.prototype.sqrTo=O,B.prototype.convert=U,B.prototype.revert=F,B.prototype.reduce=k,B.prototype.mulTo=G,B.prototype.sqrTo=z,n.prototype.copyTo=c,n.prototype.fromInt=l,n.prototype.fromString=f,n.prototype.clamp=p,n.prototype.dlShiftTo=x,n.prototype.drShiftTo=b,n.prototype.lShiftTo=w,n.prototype.rShiftTo=M,n.prototype.subTo=E,n.prototype.multiplyTo=T,n.prototype.squareTo=S,n.prototype.divRemTo=P,n.prototype.invDigit=D,n.prototype.isEven=H,n.prototype.exp=j,n.prototype.toString=d,n.prototype.negate=m,n.prototype.abs=v,n.prototype.compareTo=g,n.prototype.bitLength=_,n.prototype.mod=A,n.prototype.modPowInt=X,n.ZERO=h(0),n.ONE=h(1),Dt.prototype.convert=Bt,Dt.prototype.revert=Bt,Dt.prototype.mulTo=Ut,Dt.prototype.sqrTo=Ft,Ht.prototype.convert=jt,Ht.prototype.revert=Xt,Ht.prototype.reduce=Vt,Ht.prototype.mulTo=Wt,Ht.prototype.sqrTo=Yt;var ge=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ye=(1<<26)/ge[ge.length-1];n.prototype.chunkSize=$,n.prototype.toRadix=J,n.prototype.fromRadix=K,n.prototype.fromNumber=Q,n.prototype.bitwiseTo=rt,n.prototype.changeBit=bt,n.prototype.addTo=Tt,n.prototype.dMultiply=Nt,n.prototype.dAddOffset=Ot,n.prototype.multiplyLowerTo=zt,n.prototype.multiplyUpperTo=Gt,n.prototype.modInt=Zt,n.prototype.millerRabin=Qt,n.prototype.clone=V,n.prototype.intValue=Y,n.prototype.byteValue=W,n.prototype.shortValue=q,n.prototype.signum=Z,n.prototype.toByteArray=tt,n.prototype.equals=et,n.prototype.min=nt,n.prototype.max=it,n.prototype.and=at,n.prototype.or=ut,n.prototype.xor=lt,n.prototype.andNot=ft,n.prototype.not=pt,n.prototype.shiftLeft=dt,n.prototype.shiftRight=mt,n.prototype.getLowestSetBit=gt,n.prototype.bitCount=_t,n.prototype.testBit=xt,n.prototype.setBit=wt,n.prototype.clearBit=Mt,n.prototype.flipBit=Et,n.prototype.add=St,n.prototype.subtract=Pt,n.prototype.multiply=At,n.prototype.divide=Lt,n.prototype.remainder=It,n.prototype.divideAndRemainder=Rt,n.prototype.modPow=qt,n.prototype.modInverse=Jt,n.prototype.pow=kt,n.prototype.gcd=$t,n.prototype.isProbablePrime=Kt,n.prototype.square=Ct;var _e=n;if(_e.prototype.IsNegative=function(){return this.compareTo(_e.ZERO)==-1},_e.op_Equality=function(t,e){return 0==t.compareTo(e)},_e.op_Inequality=function(t,e){return 0!=t.compareTo(e)},_e.op_GreaterThan=function(t,e){return t.compareTo(e)>0},_e.op_LessThan=function(t,e){return t.compareTo(e)<0},_e.op_Addition=function(t,e){return new _e(t).add(new _e(e))},_e.op_Subtraction=function(t,e){return new _e(t).subtract(new _e(e))},_e.Int128Mul=function(t,e){return new _e(t).multiply(new _e(e))},_e.op_Division=function(t,e){return t.divide(e)},_e.prototype.ToDouble=function(){return parseFloat(this.toString())},"undefined"==typeof xe)var xe=function(t,e){var n;if("undefined"==typeof Object.getOwnPropertyNames){for(n in e.prototype)"undefined"!=typeof t.prototype[n]&&t.prototype[n]!=Object.prototype[n]||(t.prototype[n]=e.prototype[n]);for(n in e)"undefined"==typeof t[n]&&(t[n]=e[n]);t.$baseCtor=e}else{for(var i=Object.getOwnPropertyNames(e.prototype),r=0;r<i.length;r++)"undefined"==typeof Object.getOwnPropertyDescriptor(t.prototype,i[r])&&Object.defineProperty(t.prototype,i[r],Object.getOwnPropertyDescriptor(e.prototype,i[r]));for(n in e)"undefined"==typeof t[n]&&(t[n]=e[n]);t.$baseCtor=e}};re.Path=function(){return[]},re.Paths=function(){return[]},re.DoublePoint=function(){var t=arguments;this.X=0,this.Y=0,1==t.length?(this.X=t[0].X,this.Y=t[0].Y):2==t.length&&(this.X=t[0],this.Y=t[1])},re.DoublePoint0=function(){this.X=0,this.Y=0},re.DoublePoint1=function(t){this.X=t.X,this.Y=t.Y},re.DoublePoint2=function(t,e){this.X=t,this.Y=e},re.PolyNode=function(){this.m_Parent=null,this.m_polygon=new re.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},re.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},re.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},re.PolyNode.prototype.Contour=function(){return this.m_polygon},re.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},re.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},re.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},re.PolyNode.prototype.Childs=function(){return this.m_Childs},re.PolyNode.prototype.Parent=function(){return this.m_Parent},re.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},re.PolyTree=function(){this.m_AllPolys=[],re.PolyNode.call(this)},re.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},re.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},re.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},xe(re.PolyTree,re.PolyNode),re.Math_Abs_Int64=re.Math_Abs_Int32=re.Math_Abs_Double=function(t){return Math.abs(t)},re.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)},ue.msie||ue.opera||ue.safari?re.Cast_Int32=function(t){return 0|t}:re.Cast_Int32=function(t){return~~t},ue.chrome?re.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):~~t}:ue.firefox&&"function"==typeof Number.toInteger?re.Cast_Int64=function(t){return Number.toInteger(t)}:ue.msie7||ue.msie8?re.Cast_Int64=function(t){return parseInt(t,10)}:ue.msie?re.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):0|t}:re.Cast_Int64=function(t){return t<0?Math.ceil(t):Math.floor(t)},re.Clear=function(t){t.length=0},re.PI=3.141592653589793,re.PI2=6.283185307179586,re.IntPoint=function(){var t=arguments,e=t.length;if(this.X=0,this.Y=0,ee)if(this.Z=0,3==e)this.X=t[0],this.Y=t[1],this.Z=t[2];else if(2==e)this.X=t[0],this.Y=t[1],this.Z=0;else if(1==e)if(t[0]instanceof re.DoublePoint){var n=t[0];this.X=re.Clipper.Round(n.X),this.Y=re.Clipper.Round(n.Y),this.Z=0}else{var i=t[0];"undefined"==typeof i.Z&&(i.Z=0),this.X=i.X,this.Y=i.Y,this.Z=i.Z}else this.X=0,this.Y=0,this.Z=0;else if(2==e)this.X=t[0],this.Y=t[1];else if(1==e)if(t[0]instanceof re.DoublePoint){var n=t[0];this.X=re.Clipper.Round(n.X),this.Y=re.Clipper.Round(n.Y)}else{var i=t[0];this.X=i.X,this.Y=i.Y}else this.X=0,this.Y=0},re.IntPoint.op_Equality=function(t,e){return t.X==e.X&&t.Y==e.Y},re.IntPoint.op_Inequality=function(t,e){return t.X!=e.X||t.Y!=e.Y},ee?(re.IntPoint0=function(){this.X=0,this.Y=0,this.Z=0},re.IntPoint1=function(t){this.X=t.X,this.Y=t.Y,this.Z=t.Z},re.IntPoint1dp=function(t){this.X=re.Clipper.Round(t.X),this.Y=re.Clipper.Round(t.Y),this.Z=0},re.IntPoint2=function(t,e){this.X=t,this.Y=e,this.Z=0},re.IntPoint3=function(t,e,n){this.X=t,this.Y=e,this.Z=n}):(re.IntPoint0=function(){this.X=0,this.Y=0},re.IntPoint1=function(t){this.X=t.X,this.Y=t.Y},re.IntPoint1dp=function(t){this.X=re.Clipper.Round(t.X),this.Y=re.Clipper.Round(t.Y)},re.IntPoint2=function(t,e){this.X=t,this.Y=e}),re.IntRect=function(){var t=arguments,e=t.length;4==e?(this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3]):1==e?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},re.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},re.IntRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},re.IntRect4=function(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i},re.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},re.PolyType={ptSubject:0,ptClip:1},re.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},re.JoinType={jtSquare:0,jtRound:1,jtMiter:2},re.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},ie&&(re.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3}),re.EdgeSide={esLeft:0,esRight:1},re.Direction={dRightToLeft:0,dLeftToRight:1},re.TEdge=function(){this.Bot=new re.IntPoint,this.Curr=new re.IntPoint,this.Top=new re.IntPoint,this.Delta=new re.IntPoint,this.Dx=0,this.PolyTyp=re.PolyType.ptSubject,this.Side=re.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},re.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new re.IntPoint},re.MyIntersectNodeSort=function(){},re.MyIntersectNodeSort.Compare=function(t,e){return e.Pt.Y-t.Pt.Y},re.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},re.Scanbeam=function(){this.Y=0,this.Next=null},re.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},re.OutPt=function(){this.Idx=0,this.Pt=new re.IntPoint,this.Next=null,this.Prev=null},re.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new re.IntPoint},re.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},re.ClipperBase.horizontal=-9007199254740992,re.ClipperBase.Skip=-2,re.ClipperBase.Unassigned=-1,re.ClipperBase.tolerance=1e-20,te?(re.ClipperBase.loRange=46340,re.ClipperBase.hiRange=46340):(re.ClipperBase.loRange=47453132,re.ClipperBase.hiRange=0xfffffffffffff),re.ClipperBase.near_zero=function(t){return t>-re.ClipperBase.tolerance&&t<re.ClipperBase.tolerance},re.ClipperBase.IsHorizontal=function(t){return 0===t.Delta.Y},re.ClipperBase.prototype.PointIsVertex=function(t,e){var n=e;do{if(re.IntPoint.op_Equality(n.Pt,t))return!0;n=n.Next}while(n!=e);return!1},re.ClipperBase.prototype.PointOnLineSegment=function(t,e,n,i){return i?t.X==e.X&&t.Y==e.Y||t.X==n.X&&t.Y==n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&_e.op_Equality(_e.Int128Mul(t.X-e.X,n.Y-e.Y),_e.Int128Mul(n.X-e.X,t.Y-e.Y)):t.X==e.X&&t.Y==e.Y||t.X==n.X&&t.Y==n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&(t.X-e.X)*(n.Y-e.Y)==(n.X-e.X)*(t.Y-e.Y)},re.ClipperBase.prototype.PointOnPolygon=function(t,e,n){for(var i=e;;){if(this.PointOnLineSegment(t,i.Pt,i.Next.Pt,n))return!0;if(i=i.Next,i==e)break}return!1},re.ClipperBase.prototype.SlopesEqual=re.ClipperBase.SlopesEqual=function(){var t,e,n,i,r,o,a,s=arguments,u=s.length;return 3==u?(t=s[0],e=s[1],a=s[2],a?_e.op_Equality(_e.Int128Mul(t.Delta.Y,e.Delta.X),_e.Int128Mul(t.Delta.X,e.Delta.Y)):re.Cast_Int64(t.Delta.Y*e.Delta.X)==re.Cast_Int64(t.Delta.X*e.Delta.Y)):4==u?(n=s[0],i=s[1],r=s[2],a=s[3],a?_e.op_Equality(_e.Int128Mul(n.Y-i.Y,i.X-r.X),_e.Int128Mul(n.X-i.X,i.Y-r.Y)):re.Cast_Int64((n.Y-i.Y)*(i.X-r.X))-re.Cast_Int64((n.X-i.X)*(i.Y-r.Y))===0):(n=s[0],i=s[1],r=s[2],o=s[3],a=s[4],a?_e.op_Equality(_e.Int128Mul(n.Y-i.Y,r.X-o.X),_e.Int128Mul(n.X-i.X,r.Y-o.Y)):re.Cast_Int64((n.Y-i.Y)*(r.X-o.X))-re.Cast_Int64((n.X-i.X)*(r.Y-o.Y))===0)},re.ClipperBase.SlopesEqual3=function(t,e,n){return n?_e.op_Equality(_e.Int128Mul(t.Delta.Y,e.Delta.X),_e.Int128Mul(t.Delta.X,e.Delta.Y)):re.Cast_Int64(t.Delta.Y*e.Delta.X)==re.Cast_Int64(t.Delta.X*e.Delta.Y)},re.ClipperBase.SlopesEqual4=function(t,e,n,i){return i?_e.op_Equality(_e.Int128Mul(t.Y-e.Y,e.X-n.X),_e.Int128Mul(t.X-e.X,e.Y-n.Y)):re.Cast_Int64((t.Y-e.Y)*(e.X-n.X))-re.Cast_Int64((t.X-e.X)*(e.Y-n.Y))===0},re.ClipperBase.SlopesEqual5=function(t,e,n,i,r){return r?_e.op_Equality(_e.Int128Mul(t.Y-e.Y,n.X-i.X),_e.Int128Mul(t.X-e.X,n.Y-i.Y)):re.Cast_Int64((t.Y-e.Y)*(n.X-i.X))-re.Cast_Int64((t.X-e.X)*(n.Y-i.Y))===0},re.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;t<e;++t){for(var n=0,i=this.m_edges[t].length;n<i;++n)this.m_edges[t][n]=null;re.Clear(this.m_edges[t])}re.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},re.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var t=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},re.ClipperBase.prototype.RangeTest=function(t,e){e.Value?(t.X>re.ClipperBase.hiRange||t.Y>re.ClipperBase.hiRange||-t.X>re.ClipperBase.hiRange||-t.Y>re.ClipperBase.hiRange)&&re.Error("Coordinate outside allowed range in RangeTest()."):(t.X>re.ClipperBase.loRange||t.Y>re.ClipperBase.loRange||-t.X>re.ClipperBase.loRange||-t.Y>re.ClipperBase.loRange)&&(e.Value=!0,this.RangeTest(t,e))},re.ClipperBase.prototype.InitEdge=function(t,e,n,i){t.Next=e,t.Prev=n,t.Curr.X=i.X,t.Curr.Y=i.Y,t.OutIdx=-1},re.ClipperBase.prototype.InitEdge2=function(t,e){t.Curr.Y>=t.Next.Curr.Y?(t.Bot.X=t.Curr.X,t.Bot.Y=t.Curr.Y,t.Top.X=t.Next.Curr.X,t.Top.Y=t.Next.Curr.Y):(t.Top.X=t.Curr.X,t.Top.Y=t.Curr.Y,t.Bot.X=t.Next.Curr.X,t.Bot.Y=t.Next.Curr.Y),this.SetDx(t),t.PolyTyp=e},re.ClipperBase.prototype.FindNextLocMin=function(t){for(var e;;){for(;re.IntPoint.op_Inequality(t.Bot,t.Prev.Bot)||re.IntPoint.op_Equality(t.Curr,t.Top);)t=t.Next;if(t.Dx!=re.ClipperBase.horizontal&&t.Prev.Dx!=re.ClipperBase.horizontal)break;for(;t.Prev.Dx==re.ClipperBase.horizontal;)t=t.Prev;for(e=t;t.Dx==re.ClipperBase.horizontal;)t=t.Next;if(t.Top.Y!=t.Prev.Bot.Y){e.Prev.Bot.X<t.Bot.X&&(t=e);break}}return t},re.ClipperBase.prototype.ProcessBound=function(t,e){var n,i,r=t,o=t;if(t.Dx==re.ClipperBase.horizontal&&(i=e?t.Prev.Bot.X:t.Next.Bot.X,t.Bot.X!=i&&this.ReverseHorizontal(t)),o.OutIdx!=re.ClipperBase.Skip)if(e){for(;o.Top.Y==o.Next.Bot.Y&&o.Next.OutIdx!=re.ClipperBase.Skip;)o=o.Next;if(o.Dx==re.ClipperBase.horizontal&&o.Next.OutIdx!=re.ClipperBase.Skip){for(n=o;n.Prev.Dx==re.ClipperBase.horizontal;)n=n.Prev;n.Prev.Top.X==o.Next.Top.X?e||(o=n.Prev):n.Prev.Top.X>o.Next.Top.X&&(o=n.Prev)}for(;t!=o;)t.NextInLML=t.Next,t.Dx==re.ClipperBase.horizontal&&t!=r&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),t=t.Next;t.Dx==re.ClipperBase.horizontal&&t!=r&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),o=o.Next}else{for(;o.Top.Y==o.Prev.Bot.Y&&o.Prev.OutIdx!=re.ClipperBase.Skip;)o=o.Prev;if(o.Dx==re.ClipperBase.horizontal&&o.Prev.OutIdx!=re.ClipperBase.Skip){for(n=o;n.Next.Dx==re.ClipperBase.horizontal;)n=n.Next;n.Next.Top.X==o.Prev.Top.X?e||(o=n.Next):n.Next.Top.X>o.Prev.Top.X&&(o=n.Next)}for(;t!=o;)t.NextInLML=t.Prev,t.Dx==re.ClipperBase.horizontal&&t!=r&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),t=t.Prev;t.Dx==re.ClipperBase.horizontal&&t!=r&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),o=o.Prev}if(o.OutIdx==re.ClipperBase.Skip){if(t=o,e){for(;t.Top.Y==t.Next.Bot.Y;)t=t.Next;for(;t!=o&&t.Dx==re.ClipperBase.horizontal;)t=t.Prev}else{for(;t.Top.Y==t.Prev.Bot.Y;)t=t.Prev;for(;t!=o&&t.Dx==re.ClipperBase.horizontal;)t=t.Next}if(t==o)o=e?t.Next:t.Prev;else{t=e?o.Next:o.Prev;var a=new re.LocalMinima;a.Next=null,a.Y=t.Bot.Y,a.LeftBound=null,a.RightBound=t,a.RightBound.WindDelta=0,o=this.ProcessBound(a.RightBound,e),this.InsertLocalMinima(a)}}return o},re.ClipperBase.prototype.AddPath=function(t,e,n){ne?n||e!=re.PolyType.ptClip||re.Error("AddPath: Open paths must be subject."):n||re.Error("AddPath: Open paths have been disabled.");var i=t.length-1;if(n)for(;i>0&&re.IntPoint.op_Equality(t[i],t[0]);)--i;for(;i>0&&re.IntPoint.op_Equality(t[i],t[i-1]);)--i;if(n&&i<2||!n&&i<1)return!1;for(var r=new Array,o=0;o<=i;o++)r.push(new re.TEdge);var a=!0;r[1].Curr.X=t[1].X,r[1].Curr.Y=t[1].Y;var s={Value:this.m_UseFullRange};this.RangeTest(t[0],s),this.m_UseFullRange=s.Value,s.Value=this.m_UseFullRange,this.RangeTest(t[i],s),this.m_UseFullRange=s.Value,this.InitEdge(r[0],r[1],r[i],t[0]),this.InitEdge(r[i],r[0],r[i-1],t[i]);for(var o=i-1;o>=1;--o)s.Value=this.m_UseFullRange,this.RangeTest(t[o],s),this.m_UseFullRange=s.Value,this.InitEdge(r[o],r[o+1],r[o-1],t[o]);for(var u=r[0],c=u,l=u;;)if(re.IntPoint.op_Equality(c.Curr,c.Next.Curr)){if(c==c.Next)break;c==u&&(u=c.Next),c=this.RemoveEdge(c),l=c}else{if(c.Prev==c.Next)break;if(!n||!re.ClipperBase.SlopesEqual(c.Prev.Curr,c.Curr,c.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(c.Prev.Curr,c.Curr,c.Next.Curr)){if(c=c.Next,c==l)break}else c==u&&(u=c.Next),c=this.RemoveEdge(c),c=c.Prev,l=c}if(!n&&c==c.Next||n&&c.Prev==c.Next)return!1;n||(this.m_HasOpenPaths=!0,u.Prev.OutIdx=re.ClipperBase.Skip);c=u;do this.InitEdge2(c,e),c=c.Next,a&&c.Curr.Y!=u.Curr.Y&&(a=!1);while(c!=u);if(a){if(n)return!1;c.Prev.OutIdx=re.ClipperBase.Skip,c.Prev.Bot.X<c.Prev.Top.X&&this.ReverseHorizontal(c.Prev);var h=new re.LocalMinima;for(h.Next=null,h.Y=c.Bot.Y,h.LeftBound=null,h.RightBound=c,h.RightBound.Side=re.EdgeSide.esRight,h.RightBound.WindDelta=0;c.Next.OutIdx!=re.ClipperBase.Skip;)c.NextInLML=c.Next,c.Bot.X!=c.Prev.Top.X&&this.ReverseHorizontal(c),c=c.Next;return this.InsertLocalMinima(h),this.m_edges.push(r),!0}this.m_edges.push(r);for(var f,p=null;c=this.FindNextLocMin(c),c!=p;){null==p&&(p=c);var h=new re.LocalMinima;h.Next=null,h.Y=c.Bot.Y,c.Dx<c.Prev.Dx?(h.LeftBound=c.Prev,h.RightBound=c,f=!1):(h.LeftBound=c,h.RightBound=c.Prev,f=!0),h.LeftBound.Side=re.EdgeSide.esLeft,h.RightBound.Side=re.EdgeSide.esRight,n?h.LeftBound.Next==h.RightBound?h.LeftBound.WindDelta=-1:h.LeftBound.WindDelta=1:h.LeftBound.WindDelta=0,h.RightBound.WindDelta=-h.LeftBound.WindDelta,c=this.ProcessBound(h.LeftBound,f);var d=this.ProcessBound(h.RightBound,!f);h.LeftBound.OutIdx==re.ClipperBase.Skip?h.LeftBound=null:h.RightBound.OutIdx==re.ClipperBase.Skip&&(h.RightBound=null),this.InsertLocalMinima(h),f||(c=d)}return!0},re.ClipperBase.prototype.AddPaths=function(t,e,n){for(var i=!1,r=0,o=t.length;r<o;++r)this.AddPath(t[r],e,n)&&(i=!0);return i},re.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,n){return!(re.IntPoint.op_Equality(t,n)||re.IntPoint.op_Equality(t,e)||re.IntPoint.op_Equality(n,e))&&(t.X!=n.X?e.X>t.X==e.X<n.X:e.Y>t.Y==e.Y<n.Y)},re.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},re.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X,t.Delta.Y=t.Top.Y-t.Bot.Y,0===t.Delta.Y?t.Dx=re.ClipperBase.horizontal:t.Dx=t.Delta.X/t.Delta.Y},re.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t.Y>=this.m_MinimaList.Y)t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t.Y<e.Next.Y;)e=e.Next;t.Next=e.Next,e.Next=t}},re.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},re.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X,t.Bot.X=e,ee&&(e=t.Top.Z,t.Top.Z=t.Bot.Z,t.Bot.Z=e)},re.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var t=this.m_MinimaList;null!=t;){var e=t.LeftBound;null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=re.EdgeSide.esLeft,e.OutIdx=re.ClipperBase.Unassigned),e=t.RightBound,null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=re.EdgeSide.esRight,e.OutIdx=re.ClipperBase.Unassigned),t=t.Next}},re.Clipper=function(t){"undefined"==typeof t&&(t=0),this.m_PolyOuts=null,this.m_ClipType=re.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=re.PolyFillType.pftEvenOdd,this.m_SubjFillType=re.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,re.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=re.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,
this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!==(1&t),this.StrictlySimple=0!==(2&t),this.PreserveCollinear=0!==(4&t),ee&&(this.ZFillFunction=null)},re.Clipper.ioReverseSolution=1,re.Clipper.ioStrictlySimple=2,re.Clipper.ioPreserveCollinear=4,re.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),re.ClipperBase.prototype.Clear.call(this))},re.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var t=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=t}},re.Clipper.prototype.Reset=function(){re.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var t=this.m_MinimaList;null!==t;)this.InsertScanbeam(t.Y),t=t.Next},re.Clipper.prototype.InsertScanbeam=function(t){if(null===this.m_Scanbeam)this.m_Scanbeam=new re.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=t;else if(t>this.m_Scanbeam.Y){var e=new re.Scanbeam;e.Y=t,e.Next=this.m_Scanbeam,this.m_Scanbeam=e}else{for(var n=this.m_Scanbeam;null!==n.Next&&t<=n.Next.Y;)n=n.Next;if(t==n.Y)return;var e=new re.Scanbeam;e.Y=t,e.Next=n.Next,n.Next=e}},re.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,n=t[1]instanceof re.PolyTree;if(4==e&&!n){var i=t[0],r=t[1],o=t[2],a=t[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&re.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,re.Clear(r),this.m_SubjFillType=o,this.m_ClipFillType=a,this.m_ClipType=i,this.m_UsingPolyTree=!1;try{var s=this.ExecuteInternal();s&&this.BuildResult(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return s}if(4==e&&n){var i=t[0],u=t[1],o=t[2],a=t[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=o,this.m_ClipFillType=a,this.m_ClipType=i,this.m_UsingPolyTree=!0;try{var s=this.ExecuteInternal();s&&this.BuildResult2(u)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return s}if(2==e&&!n){var i=t[0],r=t[1];return this.Execute(i,r,re.PolyFillType.pftEvenOdd,re.PolyFillType.pftEvenOdd)}if(2==e&&n){var i=t[0],u=t[1];return this.Execute(i,u,re.PolyFillType.pftEvenOdd,re.PolyFillType.pftEvenOdd)}},re.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole==t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole==t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},re.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var t=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(t),re.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var e=this.PopScanbeam();if(!this.ProcessIntersections(t,e))return!1;this.ProcessEdgesAtTopOfScanbeam(e),t=e}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];null===r.Pts||r.IsOpen||(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)}this.JoinCommonEdges();for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];null===r.Pts||r.IsOpen||this.FixupOutPolygon(r)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{re.Clear(this.m_Joins),re.Clear(this.m_GhostJoins)}},re.Clipper.prototype.PopScanbeam=function(){var t=this.m_Scanbeam.Y,e=this.m_Scanbeam;return this.m_Scanbeam=this.m_Scanbeam.Next,e=null,t},re.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;t<e;++t)this.DisposeOutRec(t);re.Clear(this.m_PolyOuts)},re.Clipper.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];null!==e.Pts&&this.DisposeOutPts(e.Pts),e=null,this.m_PolyOuts[t]=null},re.Clipper.prototype.DisposeOutPts=function(t){if(null!==t){var e=null;for(t.Prev.Next=null;null!==t;)e=t,t=t.Next,e=null}},re.Clipper.prototype.AddJoin=function(t,e,n){var i=new re.Join;i.OutPt1=t,i.OutPt2=e,i.OffPt.X=n.X,i.OffPt.Y=n.Y,this.m_Joins.push(i)},re.Clipper.prototype.AddGhostJoin=function(t,e){var n=new re.Join;n.OutPt1=t,n.OffPt.X=e.X,n.OffPt.Y=e.Y,this.m_GhostJoins.push(n)},ee&&(re.Clipper.prototype.SetZ=function(t,e){t.Z=0,null!==this.ZFillFunction&&(e.OutIdx<0?this.ZFillFunction(e.Bot,e.Top,t):this.ZFillFunction(e.Top,e.Bot,t))}),re.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==t;){var e=this.m_CurrentLM.LeftBound,n=this.m_CurrentLM.RightBound;this.PopLocalMinima();var i=null;if(null===e?(this.InsertEdgeIntoAEL(n,null),this.SetWindingCount(n),this.IsContributing(n)&&(i=this.AddOutPt(n,n.Bot))):null==n?(this.InsertEdgeIntoAEL(e,null),this.SetWindingCount(e),this.IsContributing(e)&&(i=this.AddOutPt(e,e.Bot)),this.InsertScanbeam(e.Top.Y)):(this.InsertEdgeIntoAEL(e,null),this.InsertEdgeIntoAEL(n,e),this.SetWindingCount(e),n.WindCnt=e.WindCnt,n.WindCnt2=e.WindCnt2,this.IsContributing(e)&&(i=this.AddLocalMinPoly(e,n,e.Bot)),this.InsertScanbeam(e.Top.Y)),null!=n&&(re.ClipperBase.IsHorizontal(n)?this.AddEdgeToSEL(n):this.InsertScanbeam(n.Top.Y)),null!=e&&null!=n){if(null!==i&&re.ClipperBase.IsHorizontal(n)&&this.m_GhostJoins.length>0&&0!==n.WindDelta)for(var r=0,o=this.m_GhostJoins.length;r<o;r++){var a=this.m_GhostJoins[r];this.HorzSegmentsOverlap(a.OutPt1.Pt,a.OffPt,n.Bot,n.Top)&&this.AddJoin(a.OutPt1,i,a.OffPt)}if(e.OutIdx>=0&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X==e.Bot.X&&e.PrevInAEL.OutIdx>=0&&re.ClipperBase.SlopesEqual(e.PrevInAEL,e,this.m_UseFullRange)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta){var s=this.AddOutPt(e.PrevInAEL,e.Bot);this.AddJoin(i,s,e.Top)}if(e.NextInAEL!=n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&re.ClipperBase.SlopesEqual(n.PrevInAEL,n,this.m_UseFullRange)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta){var s=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(i,s,n.Top)}var u=e.NextInAEL;if(null!==u)for(;u!=n;)this.IntersectEdges(n,u,e.Curr,!1),u=u.NextInAEL}}}},re.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},re.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.Curr.X==t.Curr.X?e.Top.Y>t.Top.Y?e.Top.X<re.Clipper.TopX(t,e.Top.Y):t.Top.X>re.Clipper.TopX(e,t.Top.Y):e.Curr.X<t.Curr.X},re.Clipper.prototype.IsEvenOddFillType=function(t){return t.PolyTyp==re.PolyType.ptSubject?this.m_SubjFillType==re.PolyFillType.pftEvenOdd:this.m_ClipFillType==re.PolyFillType.pftEvenOdd},re.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.PolyTyp==re.PolyType.ptSubject?this.m_ClipFillType==re.PolyFillType.pftEvenOdd:this.m_SubjFillType==re.PolyFillType.pftEvenOdd},re.Clipper.prototype.IsContributing=function(t){var e,n;switch(t.PolyTyp==re.PolyType.ptSubject?(e=this.m_SubjFillType,n=this.m_ClipFillType):(e=this.m_ClipFillType,n=this.m_SubjFillType),e){case re.PolyFillType.pftEvenOdd:if(0===t.WindDelta&&1!=t.WindCnt)return!1;break;case re.PolyFillType.pftNonZero:if(1!=Math.abs(t.WindCnt))return!1;break;case re.PolyFillType.pftPositive:if(1!=t.WindCnt)return!1;break;default:if(t.WindCnt!=-1)return!1}switch(this.m_ClipType){case re.ClipType.ctIntersection:switch(n){case re.PolyFillType.pftEvenOdd:case re.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case re.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case re.ClipType.ctUnion:switch(n){case re.PolyFillType.pftEvenOdd:case re.PolyFillType.pftNonZero:return 0===t.WindCnt2;case re.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case re.ClipType.ctDifference:if(t.PolyTyp==re.PolyType.ptSubject)switch(n){case re.PolyFillType.pftEvenOdd:case re.PolyFillType.pftNonZero:return 0===t.WindCnt2;case re.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(n){case re.PolyFillType.pftEvenOdd:case re.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case re.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case re.ClipType.ctXor:if(0!==t.WindDelta)return!0;switch(n){case re.PolyFillType.pftEvenOdd:case re.PolyFillType.pftNonZero:return 0===t.WindCnt2;case re.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}}return!0},re.Clipper.prototype.SetWindingCount=function(t){for(var e=t.PrevInAEL;null!==e&&(e.PolyTyp!=t.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e)t.WindCnt=0===t.WindDelta?1:t.WindDelta,t.WindCnt2=0,e=this.m_ActiveEdges;else if(0===t.WindDelta&&this.m_ClipType!=re.ClipType.ctUnion)t.WindCnt=1,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(t)){if(0===t.WindDelta){for(var n=!0,i=e.PrevInAEL;null!==i;)i.PolyTyp==e.PolyTyp&&0!==i.WindDelta&&(n=!n),i=i.PrevInAEL;t.WindCnt=n?0:1}else t.WindCnt=t.WindDelta;t.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta:t.WindCnt=0===t.WindDelta?1:t.WindDelta:0===t.WindDelta?t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(t))for(;e!=t;)0!==e.WindDelta&&(t.WindCnt2=0===t.WindCnt2?1:0),e=e.NextInAEL;else for(;e!=t;)t.WindCnt2+=e.WindDelta,e=e.NextInAEL},re.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},re.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},re.Clipper.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!=t.PrevInAEL&&e.NextInAEL!=e.PrevInAEL){if(t.NextInAEL==e){var n=e.NextInAEL;null!==n&&(n.PrevInAEL=t);var i=t.PrevInAEL;null!==i&&(i.NextInAEL=e),e.PrevInAEL=i,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=n}else if(e.NextInAEL==t){var n=t.NextInAEL;null!==n&&(n.PrevInAEL=e);var i=e.PrevInAEL;null!==i&&(i.NextInAEL=t),t.PrevInAEL=i,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=n}else{var n=t.NextInAEL,i=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=n,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=i,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},re.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL==e){var n=e.NextInSEL;null!==n&&(n.PrevInSEL=t);var i=t.PrevInSEL;null!==i&&(i.NextInSEL=e),e.PrevInSEL=i,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=n}else if(e.NextInSEL==t){var n=t.NextInSEL;null!==n&&(n.PrevInSEL=e);var i=e.PrevInSEL;null!==i&&(i.NextInSEL=t),t.PrevInSEL=i,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=n}else{var n=t.NextInSEL,i=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=n,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=i,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},re.Clipper.prototype.AddLocalMaxPoly=function(t,e,n){this.AddOutPt(t,n),0==e.WindDelta&&this.AddOutPt(e,n),t.OutIdx==e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},re.Clipper.prototype.AddLocalMinPoly=function(t,e,n){var i,r,o;if(re.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx?(i=this.AddOutPt(t,n),e.OutIdx=t.OutIdx,t.Side=re.EdgeSide.esLeft,e.Side=re.EdgeSide.esRight,r=t,o=r.PrevInAEL==e?e.PrevInAEL:r.PrevInAEL):(i=this.AddOutPt(e,n),t.OutIdx=e.OutIdx,t.Side=re.EdgeSide.esRight,e.Side=re.EdgeSide.esLeft,r=e,o=r.PrevInAEL==t?t.PrevInAEL:r.PrevInAEL),null!==o&&o.OutIdx>=0&&re.Clipper.TopX(o,n.Y)==re.Clipper.TopX(r,n.Y)&&re.ClipperBase.SlopesEqual(r,o,this.m_UseFullRange)&&0!==r.WindDelta&&0!==o.WindDelta){var a=this.AddOutPt(o,n);this.AddJoin(i,a,r.Top)}return i},re.Clipper.prototype.CreateOutRec=function(){var t=new re.OutRec;return t.Idx=-1,t.IsHole=!1,t.IsOpen=!1,t.FirstLeft=null,t.Pts=null,t.BottomPt=null,t.PolyNode=null,this.m_PolyOuts.push(t),t.Idx=this.m_PolyOuts.length-1,t},re.Clipper.prototype.AddOutPt=function(t,e){var n=t.Side==re.EdgeSide.esLeft;if(t.OutIdx<0){var i=this.CreateOutRec();i.IsOpen=0===t.WindDelta;var r=new re.OutPt;return i.Pts=r,r.Idx=i.Idx,r.Pt.X=e.X,r.Pt.Y=e.Y,r.Next=r,r.Prev=r,i.IsOpen||this.SetHoleState(t,i),ee&&(re.IntPoint.op_Equality(e,t.Bot)?(r.Pt.X=t.Bot.X,r.Pt.Y=t.Bot.Y,r.Pt.Z=t.Bot.Z):re.IntPoint.op_Equality(e,t.Top)?(r.Pt.X=t.Top.X,r.Pt.Y=t.Top.Y,r.Pt.Z=t.Top.Z):this.SetZ(r.Pt,t)),t.OutIdx=i.Idx,r}var i=this.m_PolyOuts[t.OutIdx],o=i.Pts;if(n&&re.IntPoint.op_Equality(e,o.Pt))return o;if(!n&&re.IntPoint.op_Equality(e,o.Prev.Pt))return o.Prev;var r=new re.OutPt;return r.Idx=i.Idx,r.Pt.X=e.X,r.Pt.Y=e.Y,r.Next=o,r.Prev=o.Prev,r.Prev.Next=r,o.Prev=r,n&&(i.Pts=r),ee&&(re.IntPoint.op_Equality(e,t.Bot)?(r.Pt.X=t.Bot.X,r.Pt.Y=t.Bot.Y,r.Pt.Z=t.Bot.Z):re.IntPoint.op_Equality(e,t.Top)?(r.Pt.X=t.Top.X,r.Pt.Y=t.Top.Y,r.Pt.Z=t.Top.Z):this.SetZ(r.Pt,t)),r},re.Clipper.prototype.SwapPoints=function(t,e){var n=new re.IntPoint(t.Value);t.Value.X=e.Value.X,t.Value.Y=e.Value.Y,e.Value.X=n.X,e.Value.Y=n.Y},re.Clipper.prototype.HorzSegmentsOverlap=function(t,e,n,i){return t.X>n.X==t.X<i.X||(e.X>n.X==e.X<i.X||(n.X>t.X==n.X<e.X||(i.X>t.X==i.X<e.X||(t.X==n.X&&e.X==i.X||t.X==i.X&&e.X==n.X))))},re.Clipper.prototype.InsertPolyPtBetween=function(t,e,n){var i=new re.OutPt;return i.Pt.X=n.X,i.Pt.Y=n.Y,e==t.Next?(t.Next=i,e.Prev=i,i.Next=e,i.Prev=t):(e.Next=i,t.Prev=i,i.Next=t,i.Prev=e),i},re.Clipper.prototype.SetHoleState=function(t,e){for(var n=!1,i=t.PrevInAEL;null!==i;)i.OutIdx>=0&&0!=i.WindDelta&&(n=!n,null===e.FirstLeft&&(e.FirstLeft=this.m_PolyOuts[i.OutIdx])),i=i.PrevInAEL;n&&(e.IsHole=!0)},re.Clipper.prototype.GetDx=function(t,e){return t.Y==e.Y?re.ClipperBase.horizontal:(e.X-t.X)/(e.Y-t.Y)},re.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var n=t.Prev;re.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Prev;var i=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=t.Next;re.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Next;var r=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=e.Prev;re.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Prev;var o=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;re.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Next;var a=Math.abs(this.GetDx(e.Pt,n.Pt));return i>=o&&i>=a||r>=o&&r>=a},re.Clipper.prototype.GetBottomPt=function(t){for(var e=null,n=t.Next;n!=t;)n.Pt.Y>t.Pt.Y?(t=n,e=null):n.Pt.Y==t.Pt.Y&&n.Pt.X<=t.Pt.X&&(n.Pt.X<t.Pt.X?(e=null,t=n):n.Next!=t&&n.Prev!=t&&(e=n)),n=n.Next;if(null!==e)for(;e!=n;)for(this.FirstIsBottomPt(n,e)||(t=e),e=e.Next;re.IntPoint.op_Inequality(e.Pt,t.Pt);)e=e.Next;return t},re.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var n=t.BottomPt,i=e.BottomPt;return n.Pt.Y>i.Pt.Y?t:n.Pt.Y<i.Pt.Y?e:n.Pt.X<i.Pt.X?t:n.Pt.X>i.Pt.X?e:n.Next==n?e:i.Next==i?t:this.FirstIsBottomPt(n,i)?t:e},re.Clipper.prototype.Param1RightOfParam2=function(t,e){do if(t=t.FirstLeft,t==e)return!0;while(null!==t);return!1},re.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},re.Clipper.prototype.AppendPolygon=function(t,e){var n,i=this.m_PolyOuts[t.OutIdx],r=this.m_PolyOuts[e.OutIdx];n=this.Param1RightOfParam2(i,r)?r:this.Param1RightOfParam2(r,i)?i:this.GetLowermostRec(i,r);var o,a=i.Pts,s=a.Prev,u=r.Pts,c=u.Prev;t.Side==re.EdgeSide.esLeft?(e.Side==re.EdgeSide.esLeft?(this.ReversePolyPtLinks(u),u.Next=a,a.Prev=u,s.Next=c,c.Prev=s,i.Pts=c):(c.Next=a,a.Prev=c,u.Prev=s,s.Next=u,i.Pts=u),o=re.EdgeSide.esLeft):(e.Side==re.EdgeSide.esRight?(this.ReversePolyPtLinks(u),s.Next=c,c.Prev=s,u.Next=a,a.Prev=u):(s.Next=u,u.Prev=s,a.Prev=c,c.Next=a),o=re.EdgeSide.esRight),i.BottomPt=null,n==r&&(r.FirstLeft!=i&&(i.FirstLeft=r.FirstLeft),i.IsHole=r.IsHole),r.Pts=null,r.BottomPt=null,r.FirstLeft=i;var l=t.OutIdx,h=e.OutIdx;t.OutIdx=-1,e.OutIdx=-1;for(var f=this.m_ActiveEdges;null!==f;){if(f.OutIdx==h){f.OutIdx=l,f.Side=o;break}f=f.NextInAEL}r.Idx=i.Idx},re.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,n;e=t;do n=e.Next,e.Next=e.Prev,e.Prev=n,e=n;while(e!=t)}},re.Clipper.SwapSides=function(t,e){var n=t.Side;t.Side=e.Side,e.Side=n},re.Clipper.SwapPolyIndexes=function(t,e){var n=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=n},re.Clipper.prototype.IntersectEdges=function(t,e,n,i){var r=!i&&null===t.NextInLML&&t.Top.X==n.X&&t.Top.Y==n.Y,o=!i&&null===e.NextInLML&&e.Top.X==n.X&&e.Top.Y==n.Y,a=t.OutIdx>=0,s=e.OutIdx>=0;if(ne&&(0===t.WindDelta||0===e.WindDelta))return 0===t.WindDelta&&0===e.WindDelta?(r||o)&&a&&s&&this.AddLocalMaxPoly(t,e,n):t.PolyTyp==e.PolyTyp&&t.WindDelta!=e.WindDelta&&this.m_ClipType==re.ClipType.ctUnion?0===t.WindDelta?s&&(this.AddOutPt(t,n),a&&(t.OutIdx=-1)):a&&(this.AddOutPt(e,n),s&&(e.OutIdx=-1)):t.PolyTyp!=e.PolyTyp&&(0!==t.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==re.ClipType.ctUnion&&0!==e.WindCnt2?0!==e.WindDelta||1!=Math.abs(t.WindCnt)||this.m_ClipType==re.ClipType.ctUnion&&0!==t.WindCnt2||(this.AddOutPt(e,n),s&&(e.OutIdx=-1)):(this.AddOutPt(t,n),a&&(t.OutIdx=-1))),r&&(t.OutIdx<0?this.DeleteFromAEL(t):re.Error("Error intersecting polylines")),void(o&&(e.OutIdx<0?this.DeleteFromAEL(e):re.Error("Error intersecting polylines")));if(t.PolyTyp==e.PolyTyp)if(this.IsEvenOddFillType(t)){var u=t.WindCnt;t.WindCnt=e.WindCnt,e.WindCnt=u}else t.WindCnt+e.WindDelta===0?t.WindCnt=-t.WindCnt:t.WindCnt+=e.WindDelta,e.WindCnt-t.WindDelta===0?e.WindCnt=-e.WindCnt:e.WindCnt-=t.WindDelta;else this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2-=t.WindDelta;var c,l,h,f;t.PolyTyp==re.PolyType.ptSubject?(c=this.m_SubjFillType,h=this.m_ClipFillType):(c=this.m_ClipFillType,h=this.m_SubjFillType),e.PolyTyp==re.PolyType.ptSubject?(l=this.m_SubjFillType,f=this.m_ClipFillType):(l=this.m_ClipFillType,f=this.m_SubjFillType);var p,d;switch(c){case re.PolyFillType.pftPositive:p=t.WindCnt;break;case re.PolyFillType.pftNegative:p=-t.WindCnt;break;default:p=Math.abs(t.WindCnt)}switch(l){case re.PolyFillType.pftPositive:d=e.WindCnt;break;case re.PolyFillType.pftNegative:d=-e.WindCnt;break;default:d=Math.abs(e.WindCnt)}if(a&&s)r||o||0!==p&&1!=p||0!==d&&1!=d||t.PolyTyp!=e.PolyTyp&&this.m_ClipType!=re.ClipType.ctXor?this.AddLocalMaxPoly(t,e,n):(this.AddOutPt(t,n),this.AddOutPt(e,n),re.Clipper.SwapSides(t,e),re.Clipper.SwapPolyIndexes(t,e));else if(a)0!==d&&1!=d||(this.AddOutPt(t,n),re.Clipper.SwapSides(t,e),re.Clipper.SwapPolyIndexes(t,e));else if(s)0!==p&&1!=p||(this.AddOutPt(e,n),re.Clipper.SwapSides(t,e),re.Clipper.SwapPolyIndexes(t,e));else if(!(0!==p&&1!=p||0!==d&&1!=d||r||o)){var m,v;switch(h){case re.PolyFillType.pftPositive:m=t.WindCnt2;break;case re.PolyFillType.pftNegative:m=-t.WindCnt2;break;default:m=Math.abs(t.WindCnt2)}switch(f){case re.PolyFillType.pftPositive:v=e.WindCnt2;break;case re.PolyFillType.pftNegative:v=-e.WindCnt2;break;default:v=Math.abs(e.WindCnt2)}if(t.PolyTyp!=e.PolyTyp)this.AddLocalMinPoly(t,e,n);else if(1==p&&1==d)switch(this.m_ClipType){case re.ClipType.ctIntersection:m>0&&v>0&&this.AddLocalMinPoly(t,e,n);break;case re.ClipType.ctUnion:m<=0&&v<=0&&this.AddLocalMinPoly(t,e,n);break;case re.ClipType.ctDifference:(t.PolyTyp==re.PolyType.ptClip&&m>0&&v>0||t.PolyTyp==re.PolyType.ptSubject&&m<=0&&v<=0)&&this.AddLocalMinPoly(t,e,n);break;case re.ClipType.ctXor:this.AddLocalMinPoly(t,e,n)}else re.Clipper.SwapSides(t,e)}r!=o&&(r&&t.OutIdx>=0||o&&e.OutIdx>=0)&&(re.Clipper.SwapSides(t,e),re.Clipper.SwapPolyIndexes(t,e)),r&&this.DeleteFromAEL(t),o&&this.DeleteFromAEL(e)},re.Clipper.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,n=t.NextInAEL;null===e&&null===n&&t!=this.m_ActiveEdges||(null!==e?e.NextInAEL=n:this.m_ActiveEdges=n,null!==n&&(n.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},re.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,n=t.NextInSEL;null===e&&null===n&&t!=this.m_SortedEdges||(null!==e?e.NextInSEL=n:this.m_SortedEdges=n,null!==n&&(n.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},re.Clipper.prototype.UpdateEdgeIntoAEL=function(t){null===t.NextInLML&&re.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL,n=t.NextInAEL;return t.NextInLML.OutIdx=t.OutIdx,null!==e?e.NextInAEL=t.NextInLML:this.m_ActiveEdges=t.NextInLML,null!==n&&(n.PrevInAEL=t.NextInLML),t.NextInLML.Side=t.Side,t.NextInLML.WindDelta=t.WindDelta,t.NextInLML.WindCnt=t.WindCnt,t.NextInLML.WindCnt2=t.WindCnt2,t=t.NextInLML,t.Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.PrevInAEL=e,t.NextInAEL=n,re.ClipperBase.IsHorizontal(t)||this.InsertScanbeam(t.Top.Y),t},re.Clipper.prototype.ProcessHorizontals=function(t){for(var e=this.m_SortedEdges;null!==e;)this.DeleteFromSEL(e),this.ProcessHorizontal(e,t),e=this.m_SortedEdges},re.Clipper.prototype.GetHorzDirection=function(t,e){t.Bot.X<t.Top.X?(e.Left=t.Bot.X,e.Right=t.Top.X,e.Dir=re.Direction.dLeftToRight):(e.Left=t.Top.X,e.Right=t.Bot.X,e.Dir=re.Direction.dRightToLeft)},re.Clipper.prototype.PrepareHorzJoins=function(t,e){var n=this.m_PolyOuts[t.OutIdx].Pts;t.Side!=re.EdgeSide.esLeft&&(n=n.Prev),e&&(re.IntPoint.op_Equality(n.Pt,t.Top)?this.AddGhostJoin(n,t.Bot):this.AddGhostJoin(n,t.Top))},re.Clipper.prototype.ProcessHorizontal=function(t,e){var n={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,n);for(var i=n.Dir,r=n.Left,o=n.Right,a=t,s=null;null!==a.NextInLML&&re.ClipperBase.IsHorizontal(a.NextInLML);)a=a.NextInLML;for(null===a.NextInLML&&(s=this.GetMaximaPair(a));;){for(var u=t==a,c=this.GetNextInAEL(t,i);null!==c&&!(c.Curr.X==t.Top.X&&null!==t.NextInLML&&c.Dx<t.NextInLML.Dx);){var l=this.GetNextInAEL(c,i);if(i==re.Direction.dLeftToRight&&c.Curr.X<=o||i==re.Direction.dRightToLeft&&c.Curr.X>=r){if(t.OutIdx>=0&&0!=t.WindDelta&&this.PrepareHorzJoins(t,e),c==s&&u)return i==re.Direction.dLeftToRight?this.IntersectEdges(t,c,c.Top,!1):this.IntersectEdges(c,t,c.Top,!1),void(s.OutIdx>=0&&re.Error("ProcessHorizontal error"));if(i==re.Direction.dLeftToRight){var h=new re.IntPoint(c.Curr.X,t.Curr.Y);this.IntersectEdges(t,c,h,!0)}else{var h=new re.IntPoint(c.Curr.X,t.Curr.Y);this.IntersectEdges(c,t,h,!0)}this.SwapPositionsInAEL(t,c)}else if(i==re.Direction.dLeftToRight&&c.Curr.X>=o||i==re.Direction.dRightToLeft&&c.Curr.X<=r)break;c=l}if(t.OutIdx>=0&&0!==t.WindDelta&&this.PrepareHorzJoins(t,e),null===t.NextInLML||!re.ClipperBase.IsHorizontal(t.NextInLML))break;t=this.UpdateEdgeIntoAEL(t),t.OutIdx>=0&&this.AddOutPt(t,t.Bot);var n={Dir:i,Left:r,Right:o};this.GetHorzDirection(t,n),i=n.Dir,r=n.Left,o=n.Right}if(null!==t.NextInLML)if(t.OutIdx>=0){var f=this.AddOutPt(t,t.Top);if(t=this.UpdateEdgeIntoAEL(t),0===t.WindDelta)return;var p=t.PrevInAEL,l=t.NextInAEL;if(null!==p&&p.Curr.X==t.Bot.X&&p.Curr.Y==t.Bot.Y&&0!==p.WindDelta&&p.OutIdx>=0&&p.Curr.Y>p.Top.Y&&re.ClipperBase.SlopesEqual(t,p,this.m_UseFullRange)){var d=this.AddOutPt(p,t.Bot);this.AddJoin(f,d,t.Top)}else if(null!==l&&l.Curr.X==t.Bot.X&&l.Curr.Y==t.Bot.Y&&0!==l.WindDelta&&l.OutIdx>=0&&l.Curr.Y>l.Top.Y&&re.ClipperBase.SlopesEqual(t,l,this.m_UseFullRange)){var d=this.AddOutPt(l,t.Bot);this.AddJoin(f,d,t.Top)}}else t=this.UpdateEdgeIntoAEL(t);else null!==s?s.OutIdx>=0?(i==re.Direction.dLeftToRight?this.IntersectEdges(t,s,t.Top,!1):this.IntersectEdges(s,t,t.Top,!1),s.OutIdx>=0&&re.Error("ProcessHorizontal error")):(this.DeleteFromAEL(t),this.DeleteFromAEL(s)):(t.OutIdx>=0&&this.AddOutPt(t,t.Top),this.DeleteFromAEL(t))},re.Clipper.prototype.GetNextInAEL=function(t,e){return e==re.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL},re.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!=t&&t.Next.NextInLML!=t},re.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top.Y==e&&null===t.NextInLML},re.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y==e&&null!==t.NextInLML},re.Clipper.prototype.GetMaximaPair=function(t){var e=null;return re.IntPoint.op_Equality(t.Next.Top,t.Top)&&null===t.Next.NextInLML?e=t.Next:re.IntPoint.op_Equality(t.Prev.Top,t.Top)&&null===t.Prev.NextInLML&&(e=t.Prev),null===e||e.OutIdx!=-2&&(e.NextInAEL!=e.PrevInAEL||re.ClipperBase.IsHorizontal(e))?e:null},re.Clipper.prototype.ProcessIntersections=function(t,e){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(t,e),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(t){this.m_SortedEdges=null,this.m_IntersectList.length=0,re.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},re.Clipper.prototype.BuildIntersectList=function(t,e){if(null!==this.m_ActiveEdges){var n=this.m_ActiveEdges;for(this.m_SortedEdges=n;null!==n;)n.PrevInSEL=n.PrevInAEL,n.NextInSEL=n.NextInAEL,n.Curr.X=re.Clipper.TopX(n,e),n=n.NextInAEL;for(var i=!0;i&&null!==this.m_SortedEdges;){for(i=!1,n=this.m_SortedEdges;null!==n.NextInSEL;){var r=n.NextInSEL,o=new re.IntPoint;if(n.Curr.X>r.Curr.X){!this.IntersectPoint(n,r,o)&&n.Curr.X>r.Curr.X+1&&re.Error("Intersection error"),o.Y>t&&(o.Y=t,Math.abs(n.Dx)>Math.abs(r.Dx)?o.X=re.Clipper.TopX(r,t):o.X=re.Clipper.TopX(n,t));var a=new re.IntersectNode;a.Edge1=n,a.Edge2=r,a.Pt.X=o.X,a.Pt.Y=o.Y,this.m_IntersectList.push(a),this.SwapPositionsInSEL(n,r),i=!0}else n=r}if(null===n.PrevInSEL)break;n.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},re.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL==t.Edge2||t.Edge1.PrevInSEL==t.Edge2},re.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y},re.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var t=this.m_IntersectList.length,e=0;e<t;e++){if(!this.EdgesAdjacent(this.m_IntersectList[e])){for(var n=e+1;n<t&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n==t)return!1;var i=this.m_IntersectList[e];this.m_IntersectList[e]=this.m_IntersectList[n],this.m_IntersectList[n]=i}this.SwapPositionsInSEL(this.m_IntersectList[e].Edge1,this.m_IntersectList[e].Edge2)}return!0},re.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;t<e;t++){var n=this.m_IntersectList[t];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt,!0),this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};var be=function(t){return t<0?Math.ceil(t-.5):Math.round(t)},we=function(t){return t<0?Math.ceil(t-.5):Math.floor(t+.5)},Me=function(t){return t<0?-Math.round(Math.abs(t)):Math.round(t)},Ee=function(t){return t<0?(t-=.5,t<-2147483648?Math.ceil(t):0|t):(t+=.5,t>2147483647?Math.floor(t):0|t)};ue.msie?re.Clipper.Round=be:ue.chromium?re.Clipper.Round=Me:ue.safari?re.Clipper.Round=Ee:re.Clipper.Round=we,re.Clipper.TopX=function(t,e){return e==t.Top.Y?t.Top.X:t.Bot.X+re.Clipper.Round(t.Dx*(e-t.Bot.Y))},re.Clipper.prototype.IntersectPoint=function(t,e,n){n.X=0,n.Y=0;var i,r;if(re.ClipperBase.SlopesEqual(t,e,this.m_UseFullRange)||t.Dx==e.Dx)return e.Bot.Y>t.Bot.Y?(n.X=e.Bot.X,n.Y=e.Bot.Y):(n.X=t.Bot.X,n.Y=t.Bot.Y),!1;if(0===t.Delta.X)n.X=t.Bot.X,re.ClipperBase.IsHorizontal(e)?n.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,n.Y=re.Clipper.Round(n.X/e.Dx+r));else if(0===e.Delta.X)n.X=e.Bot.X,re.ClipperBase.IsHorizontal(t)?n.Y=t.Bot.Y:(i=t.Bot.Y-t.Bot.X/t.Dx,n.Y=re.Clipper.Round(n.X/t.Dx+i));else{i=t.Bot.X-t.Bot.Y*t.Dx,r=e.Bot.X-e.Bot.Y*e.Dx;var o=(r-i)/(t.Dx-e.Dx);n.Y=re.Clipper.Round(o),Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=re.Clipper.Round(t.Dx*o+i):n.X=re.Clipper.Round(e.Dx*o+r)}if(n.Y<t.Top.Y||n.Y<e.Top.Y){if(t.Top.Y>e.Top.Y)return n.Y=t.Top.Y,n.X=re.Clipper.TopX(e,t.Top.Y),n.X<t.Top.X;n.Y=e.Top.Y,Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=re.Clipper.TopX(t,n.Y):n.X=re.Clipper.TopX(e,n.Y)}return!0},re.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e=this.m_ActiveEdges;null!==e;){var n=this.IsMaxima(e,t);if(n){var i=this.GetMaximaPair(e);n=null===i||!re.ClipperBase.IsHorizontal(i)}if(n){var r=e.PrevInAEL;this.DoMaxima(e),e=null===r?this.m_ActiveEdges:r.NextInAEL}else{if(this.IsIntermediate(e,t)&&re.ClipperBase.IsHorizontal(e.NextInLML)?(e=this.UpdateEdgeIntoAEL(e),e.OutIdx>=0&&this.AddOutPt(e,e.Bot),this.AddEdgeToSEL(e)):(e.Curr.X=re.Clipper.TopX(e,t),e.Curr.Y=t),this.StrictlySimple){var r=e.PrevInAEL;if(e.OutIdx>=0&&0!==e.WindDelta&&null!==r&&r.OutIdx>=0&&r.Curr.X==e.Curr.X&&0!==r.WindDelta){var o=this.AddOutPt(r,e.Curr),a=this.AddOutPt(e,e.Curr);this.AddJoin(o,a,e.Curr)}}e=e.NextInAEL}}for(this.ProcessHorizontals(!0),e=this.m_ActiveEdges;null!==e;){if(this.IsIntermediate(e,t)){var o=null;e.OutIdx>=0&&(o=this.AddOutPt(e,e.Top)),e=this.UpdateEdgeIntoAEL(e);var r=e.PrevInAEL,s=e.NextInAEL;if(null!==r&&r.Curr.X==e.Bot.X&&r.Curr.Y==e.Bot.Y&&null!==o&&r.OutIdx>=0&&r.Curr.Y>r.Top.Y&&re.ClipperBase.SlopesEqual(e,r,this.m_UseFullRange)&&0!==e.WindDelta&&0!==r.WindDelta){var a=this.AddOutPt(r,e.Bot);this.AddJoin(o,a,e.Top)}else if(null!==s&&s.Curr.X==e.Bot.X&&s.Curr.Y==e.Bot.Y&&null!==o&&s.OutIdx>=0&&s.Curr.Y>s.Top.Y&&re.ClipperBase.SlopesEqual(e,s,this.m_UseFullRange)&&0!==e.WindDelta&&0!==s.WindDelta){var a=this.AddOutPt(s,e.Bot);this.AddJoin(o,a,e.Top)}}e=e.NextInAEL}},re.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPair(t);if(null===e)return t.OutIdx>=0&&this.AddOutPt(t,t.Top),void this.DeleteFromAEL(t);for(var n=t.NextInAEL,i=!0;null!==n&&n!=e;)this.IntersectEdges(t,n,t.Top,!0),this.SwapPositionsInAEL(t,n),n=t.NextInAEL;t.OutIdx==-1&&e.OutIdx==-1?(this.DeleteFromAEL(t),this.DeleteFromAEL(e)):t.OutIdx>=0&&e.OutIdx>=0?this.IntersectEdges(t,e,t.Top,!1):i&&0===t.WindDelta?(t.OutIdx>=0&&(this.AddOutPt(t,t.Top),t.OutIdx=-1),this.DeleteFromAEL(t),e.OutIdx>=0&&(this.AddOutPt(e,t.Top),e.OutIdx=-1),this.DeleteFromAEL(e)):re.Error("DoMaxima error")},re.Clipper.ReversePaths=function(t){for(var e=0,n=t.length;e<n;e++)t[e].reverse()},re.Clipper.Orientation=function(t){return re.Clipper.Area(t)>=0},re.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,n=t;do e++,n=n.Next;while(n!=t);return e},re.Clipper.prototype.BuildResult=function(t){re.Clear(t);for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e];if(null!==i.Pts){var r=i.Pts.Prev,o=this.PointCount(r);if(!(o<2)){for(var a=new Array(o),s=0;s<o;s++)a[s]=r.Pt,r=r.Prev;t.push(a)}}}},re.Clipper.prototype.BuildResult2=function(t){t.Clear();for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e],r=this.PointCount(i.Pts);if(!(i.IsOpen&&r<2||!i.IsOpen&&r<3)){this.FixHoleLinkage(i);var o=new re.PolyNode;t.m_AllPolys.push(o),i.PolyNode=o,o.m_polygon.length=r;for(var a=i.Pts.Prev,s=0;s<r;s++)o.m_polygon[s]=a.Pt,a=a.Prev}}for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e];null!==i.PolyNode&&(i.IsOpen?(i.PolyNode.IsOpen=!0,t.AddChild(i.PolyNode)):null!==i.FirstLeft&&null!=i.FirstLeft.PolyNode?i.FirstLeft.PolyNode.AddChild(i.PolyNode):t.AddChild(i.PolyNode))}},re.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;for(var n=t.Pts;;){if(n.Prev==n||n.Prev==n.Next)return this.DisposeOutPts(n),void(t.Pts=null);if(re.IntPoint.op_Equality(n.Pt,n.Next.Pt)||re.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||re.ClipperBase.SlopesEqual(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt))){e=null;var i=n;n.Prev.Next=n.Next,n.Next.Prev=n.Prev,
n=n.Prev,i=null}else{if(n==e)break;null===e&&(e=n),n=n.Next}}t.Pts=n},re.Clipper.prototype.DupOutPt=function(t,e){var n=new re.OutPt;return n.Pt.X=t.Pt.X,n.Pt.Y=t.Pt.Y,n.Idx=t.Idx,e?(n.Next=t.Next,n.Prev=t,t.Next.Prev=n,t.Next=n):(n.Prev=t.Prev,n.Next=t,t.Prev.Next=n,t.Prev=n),n},re.Clipper.prototype.GetOverlap=function(t,e,n,i,r){return t<e?n<i?(r.Left=Math.max(t,n),r.Right=Math.min(e,i)):(r.Left=Math.max(t,i),r.Right=Math.min(e,n)):n<i?(r.Left=Math.max(e,n),r.Right=Math.min(t,i)):(r.Left=Math.max(e,i),r.Right=Math.min(t,n)),r.Left<r.Right},re.Clipper.prototype.JoinHorz=function(t,e,n,i,r,o){var a=t.Pt.X>e.Pt.X?re.Direction.dRightToLeft:re.Direction.dLeftToRight,s=n.Pt.X>i.Pt.X?re.Direction.dRightToLeft:re.Direction.dLeftToRight;if(a==s)return!1;if(a==re.Direction.dLeftToRight){for(;t.Next.Pt.X<=r.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y==r.Y;)t=t.Next;o&&t.Pt.X!=r.X&&(t=t.Next),e=this.DupOutPt(t,!o),re.IntPoint.op_Inequality(e.Pt,r)&&(t=e,t.Pt.X=r.X,t.Pt.Y=r.Y,e=this.DupOutPt(t,!o))}else{for(;t.Next.Pt.X>=r.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y==r.Y;)t=t.Next;o||t.Pt.X==r.X||(t=t.Next),e=this.DupOutPt(t,o),re.IntPoint.op_Inequality(e.Pt,r)&&(t=e,t.Pt.X=r.X,t.Pt.Y=r.Y,e=this.DupOutPt(t,o))}if(s==re.Direction.dLeftToRight){for(;n.Next.Pt.X<=r.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y==r.Y;)n=n.Next;o&&n.Pt.X!=r.X&&(n=n.Next),i=this.DupOutPt(n,!o),re.IntPoint.op_Inequality(i.Pt,r)&&(n=i,n.Pt.X=r.X,n.Pt.Y=r.Y,i=this.DupOutPt(n,!o))}else{for(;n.Next.Pt.X>=r.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y==r.Y;)n=n.Next;o||n.Pt.X==r.X||(n=n.Next),i=this.DupOutPt(n,o),re.IntPoint.op_Inequality(i.Pt,r)&&(n=i,n.Pt.X=r.X,n.Pt.Y=r.Y,i=this.DupOutPt(n,o))}return a==re.Direction.dLeftToRight==o?(t.Prev=n,n.Next=t,e.Next=i,i.Prev=e):(t.Next=n,n.Prev=t,e.Prev=i,i.Next=e),!0},re.Clipper.prototype.JoinPoints=function(t,e,n){var i=t.OutPt1,r=new re.OutPt,o=t.OutPt2,a=new re.OutPt,s=t.OutPt1.Pt.Y==t.OffPt.Y;if(s&&re.IntPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&re.IntPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){for(r=t.OutPt1.Next;r!=i&&re.IntPoint.op_Equality(r.Pt,t.OffPt);)r=r.Next;var u=r.Pt.Y>t.OffPt.Y;for(a=t.OutPt2.Next;a!=o&&re.IntPoint.op_Equality(a.Pt,t.OffPt);)a=a.Next;var c=a.Pt.Y>t.OffPt.Y;return u!=c&&(u?(r=this.DupOutPt(i,!1),a=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=a,a.Prev=r,t.OutPt1=i,t.OutPt2=r,!0):(r=this.DupOutPt(i,!0),a=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=a,a.Next=r,t.OutPt1=i,t.OutPt2=r,!0))}if(s){for(r=i;i.Prev.Pt.Y==i.Pt.Y&&i.Prev!=r&&i.Prev!=o;)i=i.Prev;for(;r.Next.Pt.Y==r.Pt.Y&&r.Next!=i&&r.Next!=o;)r=r.Next;if(r.Next==i||r.Next==o)return!1;for(a=o;o.Prev.Pt.Y==o.Pt.Y&&o.Prev!=a&&o.Prev!=r;)o=o.Prev;for(;a.Next.Pt.Y==a.Pt.Y&&a.Next!=o&&a.Next!=i;)a=a.Next;if(a.Next==o||a.Next==i)return!1;var l={Left:null,Right:null};if(!this.GetOverlap(i.Pt.X,r.Pt.X,o.Pt.X,a.Pt.X,l))return!1;var h,f=l.Left,p=l.Right,d=new re.IntPoint;return i.Pt.X>=f&&i.Pt.X<=p?(d.X=i.Pt.X,d.Y=i.Pt.Y,h=i.Pt.X>r.Pt.X):o.Pt.X>=f&&o.Pt.X<=p?(d.X=o.Pt.X,d.Y=o.Pt.Y,h=o.Pt.X>a.Pt.X):r.Pt.X>=f&&r.Pt.X<=p?(d.X=r.Pt.X,d.Y=r.Pt.Y,h=r.Pt.X>i.Pt.X):(d.X=a.Pt.X,d.Y=a.Pt.Y,h=a.Pt.X>o.Pt.X),t.OutPt1=i,t.OutPt2=o,this.JoinHorz(i,r,o,a,d,h)}for(r=i.Next;re.IntPoint.op_Equality(r.Pt,i.Pt)&&r!=i;)r=r.Next;var m=r.Pt.Y>i.Pt.Y||!re.ClipperBase.SlopesEqual(i.Pt,r.Pt,t.OffPt,this.m_UseFullRange);if(m){for(r=i.Prev;re.IntPoint.op_Equality(r.Pt,i.Pt)&&r!=i;)r=r.Prev;if(r.Pt.Y>i.Pt.Y||!re.ClipperBase.SlopesEqual(i.Pt,r.Pt,t.OffPt,this.m_UseFullRange))return!1}for(a=o.Next;re.IntPoint.op_Equality(a.Pt,o.Pt)&&a!=o;)a=a.Next;var v=a.Pt.Y>o.Pt.Y||!re.ClipperBase.SlopesEqual(o.Pt,a.Pt,t.OffPt,this.m_UseFullRange);if(v){for(a=o.Prev;re.IntPoint.op_Equality(a.Pt,o.Pt)&&a!=o;)a=a.Prev;if(a.Pt.Y>o.Pt.Y||!re.ClipperBase.SlopesEqual(o.Pt,a.Pt,t.OffPt,this.m_UseFullRange))return!1}return r!=i&&a!=o&&r!=a&&(e!=n||m!=v)&&(m?(r=this.DupOutPt(i,!1),a=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=a,a.Prev=r,t.OutPt1=i,t.OutPt2=r,!0):(r=this.DupOutPt(i,!0),a=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=a,a.Next=r,t.OutPt1=i,t.OutPt2=r,!0))},re.Clipper.GetBounds=function(t){for(var e=0,n=t.length;e<n&&0==t[e].length;)e++;if(e==n)return new re.IntRect(0,0,0,0);var i=new re.IntRect;for(i.left=t[e][0].X,i.right=i.left,i.top=t[e][0].Y,i.bottom=i.top;e<n;e++)for(var r=0,o=t[e].length;r<o;r++)t[e][r].X<i.left?i.left=t[e][r].X:t[e][r].X>i.right&&(i.right=t[e][r].X),t[e][r].Y<i.top?i.top=t[e][r].Y:t[e][r].Y>i.bottom&&(i.bottom=t[e][r].Y);return i},re.Clipper.prototype.GetBounds2=function(t){var e=t,n=new re.IntRect;for(n.left=t.Pt.X,n.right=t.Pt.X,n.top=t.Pt.Y,n.bottom=t.Pt.Y,t=t.Next;t!=e;)t.Pt.X<n.left&&(n.left=t.Pt.X),t.Pt.X>n.right&&(n.right=t.Pt.X),t.Pt.Y<n.top&&(n.top=t.Pt.Y),t.Pt.Y>n.bottom&&(n.bottom=t.Pt.Y),t=t.Next;return n},re.Clipper.PointInPolygon=function(t,e){var n=0,i=e.length;if(i<3)return 0;for(var r=e[0],o=1;o<=i;++o){var a=o==i?e[0]:e[o];if(a.Y==t.Y&&(a.X==t.X||r.Y==t.Y&&a.X>t.X==r.X<t.X))return-1;if(r.Y<t.Y!=a.Y<t.Y)if(r.X>=t.X)if(a.X>t.X)n=1-n;else{var s=(r.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(r.Y-t.Y);if(0==s)return-1;s>0==a.Y>r.Y&&(n=1-n)}else if(a.X>t.X){var s=(r.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(r.Y-t.Y);if(0==s)return-1;s>0==a.Y>r.Y&&(n=1-n)}r=a}return n},re.Clipper.prototype.PointInPolygon=function(t,e){for(var n=0,i=e;;){var r=e.Pt.X,o=e.Pt.Y,a=e.Next.Pt.X,s=e.Next.Pt.Y;if(s==t.Y&&(a==t.X||o==t.Y&&a>t.X==r<t.X))return-1;if(o<t.Y!=s<t.Y)if(r>=t.X)if(a>t.X)n=1-n;else{var u=(r-t.X)*(s-t.Y)-(a-t.X)*(o-t.Y);if(0==u)return-1;u>0==s>o&&(n=1-n)}else if(a>t.X){var u=(r-t.X)*(s-t.Y)-(a-t.X)*(o-t.Y);if(0==u)return-1;u>0==s>o&&(n=1-n)}if(e=e.Next,i==e)break}return n},re.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var n=t;do{var i=this.PointInPolygon(n.Pt,e);if(i>=0)return 0!=i;n=n.Next}while(n!=t);return!0},re.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];null!==r.Pts&&r.FirstLeft==t&&this.Poly2ContainsPoly1(r.Pts,e.Pts)&&(r.FirstLeft=e)}},re.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var n=0,i=this.m_PolyOuts,r=i.length,o=i[n];n<r;n++,o=i[n])o.FirstLeft==t&&(o.FirstLeft=e)},re.Clipper.ParseFirstLeft=function(t){for(;null!=t&&null==t.Pts;)t=t.FirstLeft;return t},re.Clipper.prototype.JoinCommonEdges=function(){for(var t=0,e=this.m_Joins.length;t<e;t++){var n=this.m_Joins[t],i=this.GetOutRec(n.OutPt1.Idx),r=this.GetOutRec(n.OutPt2.Idx);if(null!=i.Pts&&null!=r.Pts){var o;if(o=i==r?i:this.Param1RightOfParam2(i,r)?r:this.Param1RightOfParam2(r,i)?i:this.GetLowermostRec(i,r),this.JoinPoints(n,i,r))if(i==r){if(i.Pts=n.OutPt1,i.BottomPt=null,r=this.CreateOutRec(),r.Pts=n.OutPt2,this.UpdateOutPtIdxs(r),this.m_UsingPolyTree)for(var a=0,s=this.m_PolyOuts.length;a<s-1;a++){var u=this.m_PolyOuts[a];null!=u.Pts&&re.Clipper.ParseFirstLeft(u.FirstLeft)==i&&u.IsHole!=i.IsHole&&this.Poly2ContainsPoly1(u.Pts,n.OutPt2)&&(u.FirstLeft=r)}this.Poly2ContainsPoly1(r.Pts,i.Pts)?(r.IsHole=!i.IsHole,r.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,i),(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)):this.Poly2ContainsPoly1(i.Pts,r.Pts)?(r.IsHole=i.IsHole,i.IsHole=!r.IsHole,r.FirstLeft=i.FirstLeft,i.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(i,r),(i.IsHole^this.ReverseSolution)==this.Area(i)>0&&this.ReversePolyPtLinks(i.Pts)):(r.IsHole=i.IsHole,r.FirstLeft=i.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(i,r))}else r.Pts=null,r.BottomPt=null,r.Idx=i.Idx,i.IsHole=o.IsHole,o==r&&(i.FirstLeft=r.FirstLeft),r.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,i)}}},re.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do e.Idx=t.Idx,e=e.Prev;while(e!=t.Pts)},re.Clipper.prototype.DoSimplePolygons=function(){for(var t=0;t<this.m_PolyOuts.length;){var e=this.m_PolyOuts[t++],n=e.Pts;if(null!==n)do{for(var i=n.Next;i!=e.Pts;){if(re.IntPoint.op_Equality(n.Pt,i.Pt)&&i.Next!=n&&i.Prev!=n){var r=n.Prev,o=i.Prev;n.Prev=o,o.Next=n,i.Prev=r,r.Next=i,e.Pts=n;var a=this.CreateOutRec();a.Pts=i,this.UpdateOutPtIdxs(a),this.Poly2ContainsPoly1(a.Pts,e.Pts)?(a.IsHole=!e.IsHole,a.FirstLeft=e):this.Poly2ContainsPoly1(e.Pts,a.Pts)?(a.IsHole=e.IsHole,e.IsHole=!a.IsHole,a.FirstLeft=e.FirstLeft,e.FirstLeft=a):(a.IsHole=e.IsHole,a.FirstLeft=e.FirstLeft),i=n}i=i.Next}n=n.Next}while(n!=e.Pts)}},re.Clipper.Area=function(t){var e=t.length;if(e<3)return 0;for(var n=0,i=0,r=e-1;i<e;++i)n+=(t[r].X+t[i].X)*(t[r].Y-t[i].Y),r=i;return.5*-n},re.Clipper.prototype.Area=function(t){var e=t.Pts;if(null==e)return 0;var n=0;do n+=(e.Prev.Pt.X+e.Pt.X)*(e.Prev.Pt.Y-e.Pt.Y),e=e.Next;while(e!=t.Pts);return.5*n},ie&&(re.Clipper.OffsetPaths=function(t,e,n,i,r){var o=new re.Paths,a=new re.ClipperOffset(r,r);return a.AddPaths(t,n,i),a.Execute(o,e),o}),re.Clipper.SimplifyPolygon=function(t,e){var n=new Array,i=new re.Clipper(0);return i.StrictlySimple=!0,i.AddPath(t,re.PolyType.ptSubject,!0),i.Execute(re.ClipType.ctUnion,n,e,e),n},re.Clipper.SimplifyPolygons=function(t,e){"undefined"==typeof e&&(e=re.PolyFillType.pftEvenOdd);var n=new Array,i=new re.Clipper(0);return i.StrictlySimple=!0,i.AddPaths(t,re.PolyType.ptSubject,!0),i.Execute(re.ClipType.ctUnion,n,e,e),n},re.Clipper.DistanceSqrd=function(t,e){var n=t.X-e.X,i=t.Y-e.Y;return n*n+i*i},re.Clipper.DistanceFromLineSqrd=function(t,e,n){var i=e.Y-n.Y,r=n.X-e.X,o=i*e.X+r*e.Y;return o=i*t.X+r*t.Y-o,o*o/(i*i+r*r)},re.Clipper.SlopesNearCollinear=function(t,e,n,i){return re.Clipper.DistanceFromLineSqrd(e,t,n)<i},re.Clipper.PointsAreClose=function(t,e,n){var i=t.X-e.X,r=t.Y-e.Y;return i*i+r*r<=n},re.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},re.Clipper.CleanPolygon=function(t,e){"undefined"==typeof e&&(e=1.415);var n=t.length;if(0==n)return new Array;for(var i=new Array(n),r=0;r<n;++r)i[r]=new re.OutPt;for(var r=0;r<n;++r)i[r].Pt=t[r],i[r].Next=i[(r+1)%n],i[r].Next.Prev=i[r],i[r].Idx=0;for(var o=e*e,a=i[0];0==a.Idx&&a.Next!=a.Prev;)re.Clipper.PointsAreClose(a.Pt,a.Prev.Pt,o)?(a=re.Clipper.ExcludeOp(a),n--):re.Clipper.PointsAreClose(a.Prev.Pt,a.Next.Pt,o)?(re.Clipper.ExcludeOp(a.Next),a=re.Clipper.ExcludeOp(a),n-=2):re.Clipper.SlopesNearCollinear(a.Prev.Pt,a.Pt,a.Next.Pt,o)?(a=re.Clipper.ExcludeOp(a),n--):(a.Idx=1,a=a.Next);n<3&&(n=0);for(var s=new Array(n),r=0;r<n;++r)s[r]=new re.IntPoint(a.Pt),a=a.Next;return i=null,s},re.Clipper.CleanPolygons=function(t,e){for(var n=new Array(t.length),i=0,r=t.length;i<r;i++)n[i]=re.Clipper.CleanPolygon(t[i],e);return n},re.Clipper.Minkowski=function(t,e,n,i){var r=i?1:0,o=t.length,a=e.length,s=new Array;if(n)for(var u=0;u<a;u++){for(var c=new Array(o),l=0,h=t.length,f=t[l];l<h;l++,f=t[l])c[l]=new re.IntPoint(e[u].X+f.X,e[u].Y+f.Y);s.push(c)}else for(var u=0;u<a;u++){for(var c=new Array(o),l=0,h=t.length,f=t[l];l<h;l++,f=t[l])c[l]=new re.IntPoint(e[u].X-f.X,e[u].Y-f.Y);s.push(c)}for(var p=new Array,u=0;u<a-1+r;u++)for(var l=0;l<o;l++){var d=new Array;d.push(s[u%a][l%o]),d.push(s[(u+1)%a][l%o]),d.push(s[(u+1)%a][(l+1)%o]),d.push(s[u%a][(l+1)%o]),re.Clipper.Orientation(d)||d.reverse(),p.push(d)}var m=new re.Clipper(0);return m.AddPaths(p,re.PolyType.ptSubject,!0),m.Execute(re.ClipType.ctUnion,s,re.PolyFillType.pftNonZero,re.PolyFillType.pftNonZero),s},re.Clipper.MinkowskiSum=function(){var t=arguments,e=t.length;if(3==e){var n=t[0],i=t[1],r=t[2];return re.Clipper.Minkowski(n,i,!0,r)}if(4==e){for(var o,n=t[0],a=t[1],s=t[2],r=t[3],u=new re.Clipper,c=0,l=a.length;c<l;++c){var o=re.Clipper.Minkowski(n,a[c],!0,r);u.AddPaths(o,re.PolyType.ptSubject,!0)}r&&u.AddPaths(a,re.PolyType.ptClip,!0);var h=new re.Paths;return u.Execute(re.ClipType.ctUnion,h,s,s),h}},re.Clipper.MinkowskiDiff=function(t,e,n){return re.Clipper.Minkowski(t,e,!1,n)},re.Clipper.PolyTreeToPaths=function(t){var e=new Array;return re.Clipper.AddPolyNodeToPaths(t,re.Clipper.NodeType.ntAny,e),e},re.Clipper.AddPolyNodeToPaths=function(t,e,n){var i=!0;switch(e){case re.Clipper.NodeType.ntOpen:return;case re.Clipper.NodeType.ntClosed:i=!t.IsOpen}t.m_polygon.length>0&&i&&n.push(t.m_polygon);for(var r=0,o=t.Childs(),a=o.length,s=o[r];r<a;r++,s=o[r])re.Clipper.AddPolyNodeToPaths(s,e,n)},re.Clipper.OpenPathsFromPolyTree=function(t){for(var e=new re.Paths,n=0,i=t.ChildCount();n<i;n++)t.Childs()[n].IsOpen&&e.push(t.Childs()[n].m_polygon);return e},re.Clipper.ClosedPathsFromPolyTree=function(t){var e=new re.Paths;return re.Clipper.AddPolyNodeToPaths(t,re.Clipper.NodeType.ntClosed,e),e},xe(re.Clipper,re.ClipperBase),re.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},re.ClipperOffset=function(t,e){"undefined"==typeof t&&(t=2),"undefined"==typeof e&&(e=re.ClipperOffset.def_arc_tolerance),this.m_destPolys=new re.Paths,this.m_srcPoly=new re.Path,this.m_destPoly=new re.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new re.IntPoint,this.m_polyNodes=new re.PolyNode,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest.X=-1},re.ClipperOffset.two_pi=6.28318530717959,re.ClipperOffset.def_arc_tolerance=.25,re.ClipperOffset.prototype.Clear=function(){re.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},re.ClipperOffset.Round=re.Clipper.Round,re.ClipperOffset.prototype.AddPath=function(t,e,n){var i=t.length-1;if(!(i<0)){var r=new re.PolyNode;if(r.m_jointype=e,r.m_endtype=n,n==re.EndType.etClosedLine||n==re.EndType.etClosedPolygon)for(;i>0&&re.IntPoint.op_Equality(t[0],t[i]);)i--;r.m_polygon.push(t[0]);for(var o=0,a=0,s=1;s<=i;s++)re.IntPoint.op_Inequality(r.m_polygon[o],t[s])&&(o++,r.m_polygon.push(t[s]),(t[s].Y>r.m_polygon[a].Y||t[s].Y==r.m_polygon[a].Y&&t[s].X<r.m_polygon[a].X)&&(a=o));if(!(n==re.EndType.etClosedPolygon&&o<2||n!=re.EndType.etClosedPolygon&&o<0)&&(this.m_polyNodes.AddChild(r),n==re.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new re.IntPoint(0,a);else{var u=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(r.m_polygon[a].Y>u.Y||r.m_polygon[a].Y==u.Y&&r.m_polygon[a].X<u.X)&&(this.m_lowest=new re.IntPoint(this.m_polyNodes.ChildCount()-1,a))}}},re.ClipperOffset.prototype.AddPaths=function(t,e,n){for(var i=0,r=t.length;i<r;i++)this.AddPath(t[i],e,n)},re.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!re.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];(e.m_endtype==re.EndType.etClosedPolygon||e.m_endtype==re.EndType.etClosedLine&&re.Clipper.Orientation(e.m_polygon))&&e.m_polygon.reverse()}else for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];e.m_endtype!=re.EndType.etClosedLine||re.Clipper.Orientation(e.m_polygon)||e.m_polygon.reverse()}},re.ClipperOffset.GetUnitNormal=function(t,e){var n=e.X-t.X,i=e.Y-t.Y;if(0==n&&0==i)return new re.DoublePoint(0,0);var r=1/Math.sqrt(n*n+i*i);return n*=r,i*=r,new re.DoublePoint(i,-n)},re.ClipperOffset.prototype.DoOffset=function(t){if(this.m_destPolys=new Array,this.m_delta=t,re.ClipperBase.near_zero(t))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var n=this.m_polyNodes.Childs()[e];n.m_endtype==re.EndType.etClosedPolygon&&this.m_destPolys.push(n.m_polygon)}else{this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var i;i=this.ArcTolerance<=0?re.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(t)*re.ClipperOffset.def_arc_tolerance?Math.abs(t)*re.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var r=3.14159265358979/Math.acos(1-i/Math.abs(t));this.m_sin=Math.sin(re.ClipperOffset.two_pi/r),this.m_cos=Math.cos(re.ClipperOffset.two_pi/r),this.m_StepsPerRad=r/re.ClipperOffset.two_pi,t<0&&(this.m_sin=-this.m_sin);for(var e=0;e<this.m_polyNodes.ChildCount();e++){var n=this.m_polyNodes.Childs()[e];this.m_srcPoly=n.m_polygon;var o=this.m_srcPoly.length;if(!(0==o||t<=0&&(o<3||n.m_endtype!=re.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!=o){this.m_normals.length=0;for(var a=0;a<o-1;a++)this.m_normals.push(re.ClipperOffset.GetUnitNormal(this.m_srcPoly[a],this.m_srcPoly[a+1]));if(n.m_endtype==re.EndType.etClosedLine||n.m_endtype==re.EndType.etClosedPolygon?this.m_normals.push(re.ClipperOffset.GetUnitNormal(this.m_srcPoly[o-1],this.m_srcPoly[0])):this.m_normals.push(new re.DoublePoint(this.m_normals[o-2])),n.m_endtype==re.EndType.etClosedPolygon){for(var s=o-1,a=0;a<o;a++)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.m_endtype==re.EndType.etClosedLine){for(var s=o-1,a=0;a<o;a++)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var u=this.m_normals[o-1],a=o-1;a>0;a--)this.m_normals[a]=new re.DoublePoint(-this.m_normals[a-1].X,-this.m_normals[a-1].Y);this.m_normals[0]=new re.DoublePoint(-u.X,-u.Y),s=0;for(var a=o-1;a>=0;a--)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var s=0,a=1;a<o-1;++a)s=this.OffsetPoint(a,s,n.m_jointype);var c;if(n.m_endtype==re.EndType.etOpenButt){var a=o-1;c=new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[a].X*t),re.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*t)),this.m_destPoly.push(c),c=new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[a].X-this.m_normals[a].X*t),re.ClipperOffset.Round(this.m_srcPoly[a].Y-this.m_normals[a].Y*t)),this.m_destPoly.push(c)}else{var a=o-1;s=o-2,this.m_sinA=0,this.m_normals[a]=new re.DoublePoint(-this.m_normals[a].X,-this.m_normals[a].Y),n.m_endtype==re.EndType.etOpenSquare?this.DoSquare(a,s):this.DoRound(a,s)}for(var a=o-1;a>0;a--)this.m_normals[a]=new re.DoublePoint(-this.m_normals[a-1].X,-this.m_normals[a-1].Y);this.m_normals[0]=new re.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),s=o-1;for(var a=s-1;a>0;--a)s=this.OffsetPoint(a,s,n.m_jointype);n.m_endtype==re.EndType.etOpenButt?(c=new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*t),re.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*t)),this.m_destPoly.push(c),c=new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*t),re.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*t)),this.m_destPoly.push(c)):(s=1,this.m_sinA=0,n.m_endtype==re.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(n.m_jointype==re.JoinType.jtRound)for(var l=1,h=0,a=1;a<=r;a++){this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[0].X+l*t),re.ClipperOffset.Round(this.m_srcPoly[0].Y+h*t)));var f=l;l=l*this.m_cos-this.m_sin*h,h=f*this.m_sin+h*this.m_cos}else for(var l=-1,h=-1,a=0;a<4;++a)this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[0].X+l*t),re.ClipperOffset.Round(this.m_srcPoly[0].Y+h*t))),l<0?l=1:h<0?h=1:l=-1;this.m_destPolys.push(this.m_destPoly)}}}},re.ClipperOffset.prototype.Execute=function(){var t=arguments,e=t[0]instanceof re.PolyTree;if(e){var n=t[0],i=t[1];n.Clear(),this.FixOrientations(),this.DoOffset(i);var r=new re.Clipper(0);if(r.AddPaths(this.m_destPolys,re.PolyType.ptSubject,!0),i>0)r.Execute(re.ClipType.ctUnion,n,re.PolyFillType.pftPositive,re.PolyFillType.pftPositive);else{var o=re.Clipper.GetBounds(this.m_destPolys),a=new re.Path;if(a.push(new re.IntPoint(o.left-10,o.bottom+10)),a.push(new re.IntPoint(o.right+10,o.bottom+10)),a.push(new re.IntPoint(o.right+10,o.top-10)),a.push(new re.IntPoint(o.left-10,o.top-10)),r.AddPath(a,re.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(re.ClipType.ctUnion,n,re.PolyFillType.pftNegative,re.PolyFillType.pftNegative),1==n.ChildCount()&&n.Childs()[0].ChildCount()>0){var s=n.Childs()[0];n.Childs()[0]=s.Childs()[0];for(var u=1;u<s.ChildCount();u++)n.AddChild(s.Childs()[u])}else n.Clear()}}else{var n=t[0],i=t[1];re.Clear(n),this.FixOrientations(),this.DoOffset(i);var r=new re.Clipper(0);if(r.AddPaths(this.m_destPolys,re.PolyType.ptSubject,!0),i>0)r.Execute(re.ClipType.ctUnion,n,re.PolyFillType.pftPositive,re.PolyFillType.pftPositive);else{var o=re.Clipper.GetBounds(this.m_destPolys),a=new re.Path;a.push(new re.IntPoint(o.left-10,o.bottom+10)),a.push(new re.IntPoint(o.right+10,o.bottom+10)),a.push(new re.IntPoint(o.right+10,o.top-10)),a.push(new re.IntPoint(o.left-10,o.top-10)),r.AddPath(a,re.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(re.ClipType.ctUnion,n,re.PolyFillType.pftNegative,re.PolyFillType.pftNegative),n.length>0&&n.splice(0,1)}}},re.ClipperOffset.prototype.OffsetPoint=function(t,e,n){if(this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return e;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),re.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),this.m_destPoly.push(new re.IntPoint(this.m_srcPoly[t])),this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),re.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)));else switch(n){case re.JoinType.jtMiter:var i=1+(this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y);i>=this.m_miterLim?this.DoMiter(t,e,i):this.DoSquare(t,e);break;case re.JoinType.jtSquare:this.DoSquare(t,e);break;case re.JoinType.jtRound:this.DoRound(t,e)}return e=t},re.ClipperOffset.prototype.DoSquare=function(t,e){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*n)),re.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*n)))),this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*n)),re.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*n))))},re.ClipperOffset.prototype.DoMiter=function(t,e,n){var i=this.m_delta/n;this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*i),re.ClipperOffset.Round(this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*i)))},re.ClipperOffset.prototype.DoRound=function(t,e){for(var n,i=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y),r=re.Cast_Int32(re.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(i))),o=this.m_normals[e].X,a=this.m_normals[e].Y,s=0;s<r;++s)this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+o*this.m_delta),re.ClipperOffset.Round(this.m_srcPoly[t].Y+a*this.m_delta))),n=o,o=o*this.m_cos-this.m_sin*a,a=n*this.m_sin+a*this.m_cos;this.m_destPoly.push(new re.IntPoint(re.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),re.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))},re.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}},re.JS={},re.JS.AreaOfPolygon=function(t,e){return e||(e=1),re.Clipper.Area(t)/(e*e)},re.JS.AreaOfPolygons=function(t,e){e||(e=1);for(var n=0,i=0;i<t.length;i++)n+=re.Clipper.Area(t[i]);return n/(e*e)},re.JS.BoundsOfPath=function(t,e){return re.JS.BoundsOfPaths([t],e)},re.JS.BoundsOfPaths=function(t,e){e||(e=1);var n=re.Clipper.GetBounds(t);return n.left/=e,n.bottom/=e,n.right/=e,n.top/=e,n},re.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var n=t[0]instanceof Array,t=re.JS.Clone(t);if("number"!=typeof e||null===e)return re.Error("Delta is not a number in Clean()."),t;if(0===t.length||1==t.length&&0===t[0].length||e<0)return t;n||(t=[t]);for(var i,r,o,a,s,u,c,l=t.length,h=[],f=0;f<l;f++)if(r=t[f],i=r.length,0!==i)if(i<3)o=r,h.push(o);else{for(o=r,a=e*e,s=r[0],u=1,c=1;c<i;c++)(r[c].X-s.X)*(r[c].X-s.X)+(r[c].Y-s.Y)*(r[c].Y-s.Y)<=a||(o[u]=r[c],s=r[c],u++);s=r[u-1],(r[0].X-s.X)*(r[0].X-s.X)+(r[0].Y-s.Y)*(r[0].Y-s.Y)<=a&&u--,u<i&&o.splice(u,i-u),o.length&&h.push(o)}return!n&&h.length?h=h[0]:n||0!==h.length?n&&0===h.length&&(h=[[]]):h=[],h},re.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1==t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var n,i,r,o,a=t.length,s=new Array(a);for(i=0;i<a;i++){for(n=t[i].length,o=new Array(n),r=0;r<n;r++)o[r]={X:t[i][r].X,Y:t[i][r].Y};s[i]=o}return e||(s=s[0]),s},re.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if("number"!=typeof e||null===e)return re.Error("Tolerance is not a number in Lighten()."),re.JS.Clone(t);if(0===t.length||1==t.length&&0===t[0].length||e<0)return re.JS.Clone(t);t[0]instanceof Array||(t=[t]);var n,i,r,o,a,s,u,c,l,h,f,p,d,m,v,g,y,_=t.length,x=e*e,b=[];for(n=0;n<_;n++)if(r=t[n],s=r.length,0!=s){for(o=0;o<1e6;o++){for(a=[],s=r.length,r[s-1].X!=r[0].X||r[s-1].Y!=r[0].Y?(p=1,r.push({X:r[0].X,Y:r[0].Y}),s=r.length):p=0,f=[],i=0;i<s-2;i++)u=r[i],l=r[i+1],c=r[i+2],g=u.X,y=u.Y,d=c.X-g,m=c.Y-y,0===d&&0===m||(v=((l.X-g)*d+(l.Y-y)*m)/(d*d+m*m),v>1?(g=c.X,y=c.Y):v>0&&(g+=d*v,y+=m*v)),d=l.X-g,m=l.Y-y,h=d*d+m*m,h<=x&&(f[i+1]=1,i++);for(a.push({X:r[0].X,Y:r[0].Y}),i=1;i<s-1;i++)f[i]||a.push({X:r[i].X,Y:r[i].Y});if(a.push({X:r[s-1].X,Y:r[s-1].Y}),p&&r.pop(),!f.length)break;r=a}s=a.length,a[s-1].X==a[0].X&&a[s-1].Y==a[0].Y&&a.pop(),a.length>2&&b.push(a)}return!t[0]instanceof Array&&(b=b[0]),"undefined"==typeof b&&(b=[[]]),b},re.JS.PerimeterOfPath=function(t,e,n){if("undefined"==typeof t)return 0;var i,r,o=Math.sqrt,a=0,s=0,u=0,c=0,l=0,h=t.length;if(h<2)return 0;for(e&&(t[h]=t[0],h++);--h;)i=t[h],s=i.X,u=i.Y,r=t[h-1],c=r.X,l=r.Y,a+=o((s-c)*(s-c)+(u-l)*(u-l));return e&&t.pop(),a/n},re.JS.PerimeterOfPaths=function(t,e,n){n||(n=1);for(var i=0,r=0;r<t.length;r++)i+=re.JS.PerimeterOfPath(t[r],e,n);return i},re.JS.ScaleDownPath=function(t,e){var n,i;for(e||(e=1),n=t.length;n--;)i=t[n],i.X=i.X/e,i.Y=i.Y/e},re.JS.ScaleDownPaths=function(t,e){var n,i,r;Math.round;for(e||(e=1),n=t.length;n--;)for(i=t[n].length;i--;)r=t[n][i],r.X=r.X/e,r.Y=r.Y/e},re.JS.ScaleUpPath=function(t,e){var n,i,r=Math.round;for(e||(e=1),n=t.length;n--;)i=t[n],i.X=r(i.X*e),i.Y=r(i.Y*e)},re.JS.ScaleUpPaths=function(t,e){var n,i,r,o=Math.round;for(e||(e=1),n=t.length;n--;)for(i=t[n].length;i--;)r=t[n][i],r.X=o(r.X*e),r.Y=o(r.Y*e)},re.ExPolygons=function(){return[]},re.ExPolygon=function(){this.outer=null,this.holes=null},re.JS.AddOuterPolyNodeToExPolygons=function(t,e){var n=new re.ExPolygon;n.outer=t.Contour();var i=t.Childs(),r=i.length;n.holes=new Array(r);var o,a,s,u,c,l;for(s=0;s<r;s++)for(o=i[s],n.holes[s]=o.Contour(),u=0,c=o.Childs(),l=c.length;u<l;u++)a=c[u],re.JS.AddOuterPolyNodeToExPolygons(a,e);e.push(n)},re.JS.ExPolygonsToPaths=function(t){var e,n,i,r,o=new re.Paths;for(e=0,i=t.length;e<i;e++)for(o.push(t[e].outer),n=0,r=t[e].holes.length;n<r;n++)o.push(t[e].holes[n]);return o},re.JS.PolyTreeToExPolygons=function(t){var e,n,i,r,o=new re.ExPolygons;for(n=0,i=t.Childs(),r=i.length;n<r;n++)e=i[n],re.JS.AddOuterPolyNodeToExPolygons(e,o);return o},t.exports=re},function(t,e,n){var i,r;/*!
	 * Unipointer v2.2.0
	 * base class for doing one thing with pointer event
	 * MIT license
	 */
!function(o,a){i=[n(58)],r=function(t){return a(o,t)}.apply(e,i),!(void 0!==r&&(t.exports=r))}(window,function(t,e){"use strict";function n(){}function i(){}var r=i.prototype=Object.create(e.prototype);r.bindStartEvent=function(t){this._bindStartEvent(t,!0)},r.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},r._bindStartEvent=function(e,n){n=void 0===n||!!n;var i=n?"addEventListener":"removeEventListener";t.PointerEvent?e[i]("pointerdown",this):(e[i]("mousedown",this),e[i]("touchstart",this))},r.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.getTouch=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.identifier==this.pointerIdentifier)return n}},r.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},r.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},r.onpointerdown=function(t){this._pointerDown(t,t)},r._pointerDown=function(t,e){this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},r.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var o={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return r._bindPostStartEvents=function(e){if(e){var n=o[e.type];n.forEach(function(e){t.addEventListener(e,this)},this),this._boundPointerEvents=n}},r._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(e){t.removeEventListener(e,this)},this),delete this._boundPointerEvents)},r.onmousemove=function(t){this._pointerMove(t,t)},r.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},r.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},r._pointerMove=function(t,e){this.pointerMove(t,e)},r.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},r.onmouseup=function(t){this._pointerUp(t,t)},r.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},r.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},r._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},r.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},r._pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this._unbindPostStartEvents(),this.pointerDone()},r.pointerDone=n,r.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},r.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},r._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},r.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},i.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},i})},,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=h[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(u(i.parts[o],e))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(u(i.parts[o],e));h[i.id]={id:i.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i],o=r[0],a=r[1],s=r[2],u=r[3],c={css:a,media:s,sourceMap:u};n[o]?n[o].parts.push(c):e.push(n[o]={id:o,parts:[c]})}return e}function o(t,e){var n=d(),i=g[g.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),g.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=g.indexOf(t);e>=0&&g.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function u(t,e){var n,i,r;if(e.singleton){var o=v++;n=m||(m=s(e)),i=c.bind(null,n,o,!1),r=c.bind(null,n,o,!0)}else n=s(e),i=l.bind(null,n),r=function(){a(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function c(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function l(t,e){var n=e.css,i=e.media,r=e.sourceMap;if(i&&t.setAttribute("media",i),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var h={},f=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),d=f(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0,g=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=r(t);return i(n,e),function(t){for(var o=[],a=0;a<n.length;a++){var s=n[a],u=h[s.id];u.refs--,o.push(u)}if(t){var c=r(t);i(c,e)}for(var a=0;a<o.length;a++){var u=o[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete h[u.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()}]);
//# sourceMappingURL=vendor.6981210d6cc72441fd4d.js.map</script>
	<script>webpackJsonp([2,0],[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(74),a=i(r),o=n(59),s=i(o),c=n(152),u=i(c);new s.default({store:a.default,el:"#app",template:"<App/>",components:{App:u.default}})},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),a=i(r),o=n(17),s=(i(o),n(86)),c=i(s),u={displayNameForKey:function(e,t){return this.map[e].keymap[t]?this.map[e].keymap[t].private?null:this.map[e].keymap[t].displayName:t},valueForKey:function(e,t,n,i){return this.map[n].keymap[i]&&this.map[n].keymap[i].get?this.map[n].keymap[i].get(e,t):e[i]},setValueForKey:function(e,t,n,i,r){var o={success:!0};if(this.map[n].keymap[i]&&this.map[n].keymap[i].validator){var s=this.map[n].keymap[i].validator(e,t,r);if(o.success=s.success,!s.success)return o.error=s.error,o}return"stories"===n?t.dispatch("models/updateStoryWithData",(0,a.default)({story:e},i,r)):"spaces"===n?t.dispatch("models/updateSpaceWithData",(0,a.default)({space:e},i,r)):"shading"===n?t.dispatch("models/updateShadingWithData",(0,a.default)({shading:e},i,r)):t.dispatch("models/updateObjectWithData",(0,a.default)({object:e},i,r)),o},keyIsPrivate:function(e,t){return!!this.map[e].keymap[t]&&this.map[e].keymap[t].private},keyIsReadonly:function(e,t){return!!this.map[e].keymap[t]&&this.map[e].keymap[t].readonly},inputTypeForKey:function(e,t){return this.map[e].keymap[t]&&!this.map[e].keymap[t].readonly?this.map[e].keymap[t].input_type:null},selectOptionsForKey:function(e,t,n,i){return this.map[n].keymap[i]&&!this.map[n].keymap[i].readonly&&"select"===this.map[n].keymap[i].input_type?this.map[n].keymap[i].select_data(e,t):[]},map:c.default,libraryObjectWithId:function(e,t){var n;for(var i in e.library)e.library.hasOwnProperty(i)&&!n&&e.library[i].find(function(e){return e.id===t})&&(n=e.library[i].find(function(e){return e.id===t}),n.type=i);if(!n&&e.stories.find(function(e){return e.id===t})&&(n=e.stories.find(function(e){return e.id===t}),n.type="story"),!n)for(var r=0;r<e.stories.length;r++){var a=e.stories[r];!n&&a.spaces.find(function(e){return e.id===t})&&(n=a.spaces.find(function(e){return e.id===t}),n.type="space"),!n&&a.shading.find(function(e){return e.id===t})&&(n=a.shading.find(function(e){return e.id===t}),n.type="shading")}return n},modelForFace:function(e,t){for(var n=0;n<e.stories.length;n++){var i=e.stories[n],r=i.shading.find(function(e){return e.face_id===t}),a=i.spaces.find(function(e){return e.face_id===t});if(r)return r.type="shading",r;if(a)return a.type="space",a}}};t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),a=i(r),o=n(150),s=i(o),c={clipScale:function(){return 1e5},initClip:function(e,t,n){var i=new s.default.Clipper,r=JSON.parse((0,a.default)([e.slice()])),o=JSON.parse((0,a.default)([t.slice()]));return s.default.JS.ScaleUpPaths(r,this.clipScale()),s.default.JS.ScaleUpPaths(o,this.clipScale()),i.AddPaths(r,s.default.PolyType.ptSubject,!0),i.AddPaths(o,s.default.PolyType.ptClip,!0),i},areaOfFace:function(e){return s.default.JS.AreaOfPolygon(e)},differenceOfFaces:function(e,t,n){var i=this,r=this.initClip(e,t,n),a=new s.default.Paths;if(r.Execute(s.default.ClipType.ctDifference,a,s.default.PolyFillType.pftEvenOdd,s.default.PolyFillType.pftEvenOdd),a.length&&a[0].length)return a[0].map(function(e){return{x:e.X/i.clipScale(),y:e.Y/i.clipScale(),X:e.X/i.clipScale(),Y:e.Y/i.clipScale()}})},intersectionOfFaces:function(e,t,n){var i=this,r=this.initClip(e,t,n),a=new s.default.Paths;if(r.Execute(s.default.ClipType.ctIntersection,a,s.default.PolyFillType.pftEvenOdd,s.default.PolyFillType.pftEvenOdd),a.length&&a[0].length)return a[0].map(function(e){return{x:e.X/i.clipScale(),y:e.Y/i.clipScale(),X:e.X/i.clipScale(),Y:e.Y/i.clipScale()}})},unionOfFaces:function(e,t,n){var i=this,r=this.initClip(e,t,n),a=new s.default.Paths;if(r.Execute(s.default.ClipType.ctUnion,a,s.default.PolyFillType.pftEvenOdd,s.default.PolyFillType.pftEvenOdd),a.length&&a[0].length)return a[0].map(function(e){return{x:e.X/i.clipScale(),y:e.Y/i.clipScale(),X:e.X/i.clipScale(),Y:e.Y/i.clipScale()}})},combineFacesByEdge:function(e,t){},verticesOnEdge:function(e,t){var n=this,i=this.vertexForId(e.v1,t),r=this.vertexForId(e.v2,t);return t.vertices.filter(function(e){if(!(i.x===e.x&&i.y===e.y||r.x===e.x&&r.y===e.y))return n.projectToEdge(e,i,r).dist<=1/n.clipScale()})},vertexForId:function(e,t){return t.vertices.find(function(t){return t.id===e})},edgeForId:function(e,t){return t.edges.find(function(t){return t.id===e})},faceForId:function(e,t){return t.faces.find(function(t){return t.id===e})},edgesForFace:function(e,t){var n=this;return e.edgeRefs.map(function(e){return n.edgeForId(e.edge_id,t)})},verticesForFace:function(e,t){var n=this;return e.edgeRefs.map(function(e){var i=n.edgeForId(e.edge_id,t),r=e.reverse?i.v2:i.v1;return n.vertexForId(r,t)})},edgesForVertex:function(e,t){return t.edges.filter(function(t){return t.v1===e||t.v2===e})},vertexWithXY:function(){},edgeWithVertices:function(e,t,n){},facesForVertex:function(e,t){var n=this;return t.faces.filter(function(i){return i.edgeRefs.find(function(i){var r=n.edgeForId(i.edge_id,t);return r.v1===e||r.v2===e})})},facesForEdge:function(e,t){return t.faces.filter(function(t){return t.edgeRefs.find(function(t){return t.edge_id===e})})},projectToEdge:function(e,t,n){var i,r,a=e.x,o=e.y,s=t.x,c=t.y,u=n.x,d=n.y,l=a-s,p=o-c,f=u-s,m=d-c,h=l*f+p*m,v=f*f+m*m||2,y=h/v;y<=0?(i=s,r=c):y>1?(i=u,r=d):(i=s+y*f,r=c+y*m);var g=a-i,_=o-r;return{dist:Math.sqrt(g*g+_*_),scalar:{x:i,y:r}}},normalizedEdges:function(e,t){var n=this,i=[];i.push(e.edgeRefs[0]);for(var r=function(){var r=i[o],c=n.edgeForId(r.edge_id,t),u=r.reverse?c.v1:c.v2,d=e.edgeRefs.find(function(e){if(e.edge_id!==c.id){var r=n.edgeForId(e.edge_id,t),a=n.vertexForId(u,t),o=n.vertexForId(r.v1,t),d=n.vertexForId(r.v2,t);return o.x===a.x&&o.y===a.y||d.x===a.x&&d.y===a.y?i.map(function(e){return e.edge_id}).indexOf(r.id)!==-1?void console.log(r.id):(s=o.x!==a.x||o.y!==a.y,!0):void 0}}),l=JSON.parse((0,a.default)(d));l.reverse=s,i.push(l)},o=0;o<e.edgeRefs.length-1;o++){var s;r()}return i},dc:function(e){return JSON.parse((0,a.default)(e))}};t.default=c},,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),a=i(r),o=n(94),s=i(o),c=n(24),u=i(c);t.default={Story:function(){return{id:a.default.generate(),handle:null,name:null,geometry_id:null,below_floor_plenum_height:0,floor_to_ceiling_height:0,multiplier:0,imageVisible:!1,spaces:[],windows:[],shading:[],image_ids:[],image_id:null}},Space:function(){return{id:a.default.generate(),color:(0,s.default)("space"),name:null,handle:null,face_id:null,daylighting_controls:[],building_unit_id:null,thermal_zone_id:null,space_type_id:null,construction_set_id:null}},Shading:function(){return{id:a.default.generate(),color:u.default.palette.shading,name:null,handle:null,face_id:null}},Image:function(e){return{id:a.default.generate(),src:e}},BuildingUnit:function(e){return{id:a.default.generate(),color:(0,s.default)("building_unit"),name:e}},ThermalZone:function(e){return{id:a.default.generate(),color:(0,s.default)("thermal_zone"),name:e}},SpaceType:function(e){return{id:a.default.generate(),color:(0,s.default)("space_type"),name:e}},Construction:function(e){return{id:a.default.generate(),name:e}},ConstructionSet:function(e){return{id:a.default.generate(),name:e}},Window:function(e){return{id:a.default.generate(),name:e}},DaylightingControl:function(e){return{id:a.default.generate(),name:e}}}},,,,,,,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={modes:{stories:"Story",spaces:"Space",shading:"Shading",building_units:"Building Unit",thermal_zones:"Thermal Zone",space_types:"Space Type"},palette:{shading:"#bbc3c7",neutral:"#bbc3c7",colors:["#002626","#007373","#000000","#004749","#009196","#8BC600","#b9ff14","#001516","#557a00","#E54C00","#ff7633","#993300","#EF9300","#ffb43d","#a36400"]}};t.default=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),a=i(r),o=n(3),s=i(o);t.default={Vertex:function(e,t){return{id:a.default.generate(),x:e,y:t,get X(){return this.x},get Y(){return this.y}}},Edge:function(e,t){return{id:a.default.generate(),v1:e,v2:t,isShared:function(e){return s.default.facesForEdge(this.id,e).length>1}}},Face:function(e){return{id:a.default.generate(),edgeRefs:e}},Geometry:function(){return{id:a.default.generate(),vertices:[],edges:[],faces:[]}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=1;t.default={setId:function(e){n=e},generate:function(){return function(){return String(n++)}}()}},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),a=i(r),o={displayNameForMode:function(e){return a.default.modes[e]},config:a.default};t.default=o},function(e,t){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return{invalidKeys:n,validatedPayload:t,validateLength:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i in e&&n.indexOf(i)===-1&&(i in e&&e[i].length>=r?t[i]=e[i]:(delete t[i],n.push(i)))},validateMin:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i in e&&n.indexOf(i)===-1&&(e[i]>r?t[i]=e[i]:(delete t[i],n.push(i)))},validateMax:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i in e&&n.indexOf(i)===-1&&(i in e&&e[i]<r?t[i]=e[i]:(delete t[i],n.push(i)))},validateFloat:function(i){i in e&&n.indexOf(i)===-1&&(i in e&&!isNaN(parseFloat(e[i]))?t[i]=parseFloat(e[i]):(delete t[i],n.push(i)))},validateInt:function(i){i in e&&n.indexOf(i)===-1&&(i in e&&!isNaN(parseInt(e[i]))?t[i]=parseInt(e[i]):(delete t[i],n.push(i)))},validateBoolean:function(i){i in e&&n.indexOf(i)===-1&&(i in e?t[i]=!!e[i]:(delete t[i],n.push(i)))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(160),s=i(o),c=n(155),u=i(c),d=n(154),l=i(d),p=n(153),f=i(p),m=n(161),h=i(m),v=n(156),y=i(v),g=n(158),_=i(g),b=n(157),S=i(b),x=n(159),w=i(x),j=n(5);t.default={name:"app",data:function(){return{backgroundModalVisible:!1,createObjectModalVisible:!1,assignObjectModalVisible:!1,assignObjectType:null,assignObjectTarget:null}},beforeCreate:function(){this.$store.dispatch("models/initStory"),this.$store.dispatch("models/initSpace",{story:this.$store.state.application.currentSelections.story}),this.$store.dispatch("application/setCurrentSpace",{space:this.$store.state.application.currentSelections.story.spaces[0]})},methods:{showModal:function(e,t){"background"===e?(this.backgroundModalVisible=!0,this.createObjectModalVisible=!1,this.assignObjectModalVisible=!1):"create-object"===e?(this.backgroundModalVisible=!1,this.createObjectModalVisible=!0,this.assignObjectModalVisible=!1):"assign-object"===e&&(this.backgroundModalVisible=!1,this.createObjectModalVisible=!1,this.assignObjectModalVisible=!0,this.assignObjectType=t.type,this.assignObjectTarget=t.target)}},computed:(0,a.default)({},(0,j.mapState)({tool:function(e){return e.application.currentSelections.tool}})),components:{"canvas-view":l.default,"view-3d":f.default,library:y.default,navigation:s.default,toolbar:h.default,inspector:u.default,"background-modal":_.default,"assign-object-modal":S.default,"create-object-modal":w.default}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(72),s=(i(o),n(71)),c=(i(s),n(5)),u=n(42);t.default={name:"canvas3d",data:function(){return{scene:null,camera:null,controls:null}},mounted:function(){var e=this;this.camera=new u.PerspectiveCamera(this.fov,this.$refs.canvas.offsetWidth/this.$refs.canvas.offsetHeight,.1,1e6),this.camera.position.z=15,this.renderer=new u.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(this.$refs.canvas.devicePixelRatio),this.renderer.setSize(this.$refs.canvas.offsetWidth,this.$refs.canvas.offsetHeight),this.renderer.sortObjects=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this.$refs.canvas.offsetWidth,this.$refs.canvas.offsetHeight),this.$refs.canvas.appendChild(this.renderer.domElement),this.scene=new u.Scene,this.scene.add(new u.AmbientLight(5263440));var t=new u.SpotLight(16777215,1.5);t.position.set(0,500,2e3),t.castShadow=!0,t.shadow=new u.LightShadow(new u.PerspectiveCamera(50,1,200,1e4)),t.shadow.bias=-22e-5,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,this.scene.add(t),this.camera.up=new u.Vector3(0,0,1),this.controls=new u.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=20,this.controls.maxDistance=50,this.controls.maxPolarAngle=Math.PI/2-.01;var n=new u.PlaneGeometry(200,200,2,2);n.faces=n.faces.slice(2,4);var i=new u.Mesh(n,new u.MeshBasicMaterial({color:2369836}));this.scene.add(i),this.scene.add(new u.AxisHelper(100));var r=function t(){requestAnimationFrame(t),e.controls.update(),e.renderer.render(e.scene,e.camera)};r(),window.addEventListener("resize",this.resizeCanvas),this.renderGeometry()},beforeDestroy:function(){window.removeEventListener("resize",this.resizeCanvas)},computed:(0,a.default)({},(0,c.mapState)({currentSpace:function(e){return e.application.currentSelections.space},currentShading:function(e){return e.application.currentSelections.shading},currentStory:function(e){return e.application.currentSelections.story}}),{zoom:{get:function(){return this.$store.state.project.view.zoom},set:function(e){this.$store.dispatch("project/setZoom",{zoom:e})}},fov:{get:function(){return this.$store.state.project.view.fov},set:function(e){this.$store.dispatch("project/setFov",{fov:e})}},filmOffset:{get:function(){return this.$store.state.project.view.filmOffset},set:function(e){this.$store.dispatch("project/setFilmOffset",{filmOffset:e})}},polygons:function(){var e=this;return this.$store.getters["application/currentStoryGeometry"].faces.map(function(t){return{face_id:t.id,points:t.edgeRefs.map(function(t){var n=e.$store.getters["application/currentStoryGeometry"].edges.find(function(e){return e.id===t.edge_id}),i=t.reverse?n.v2:n.v1;return e.$store.getters["application/currentStoryGeometry"].vertices.find(function(e){return e.id===i})})}})},vertices:function e(){var t=this,e=[];return this.$store.getters["application/currentStoryGeometry"].faces.forEach(function(n){n.edgeRefs.forEach(function(n){var i=t.$store.getters["application/currentStoryGeometry"].edges.find(function(e){return e.id===n.edge_id}),r=n.reverse?i.v2:i.v1,a=t.$store.getters["application/currentStoryGeometry"].vertices.find(function(e){return e.id===r});e.push(a)})}),e}}),methods:{renderGeometry:function(){var e=this;this.polygons.forEach(function(t){var n=new u.Shape;n.moveTo(t.points[0].x,t.points[0].y),t.points.forEach(function(e){return n.lineTo(e.x,e.y)});var i,r=new u.ExtrudeGeometry(n,{amount:1,bevelEnabled:!1});e.currentSpace&&t.face_id===e.currentSpace.face_id&&(i=6990869),e.currentShading&&t.face_id===e.currentShading.face_id&&(i=6990869);for(var a={x:0,y:0,z:3},o=0;o<r.vertices.length;o++)a.x+=r.vertices[o].x,a.y+=r.vertices[o].y;a.x/=r.vertices.length,a.y/=r.vertices.length,r.vertices.push(new u.Vector3(a.x,a.y,a.z));var s=new u.Mesh(new u.ConvexGeometry(r.vertices),new u.MeshLambertMaterial({color:i||14635574,opacity:.5,side:u.DoubleSide,transparent:!0}));e.scene.add(s)})},resizeCanvas:function(){this.camera.aspect=this.$refs.canvas.offsetWidth/this.$refs.canvas.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.$refs.canvas.offsetWidth,this.$refs.canvas.offsetHeight)}},watch:{filmOffset:function(){this.camera.filmOffset=this.filmOffset,this.camera.updateProjectionMatrix()},zoom:function(){this.camera.zoom=this.zoom,this.camera.updateProjectionMatrix()},fov:function(){this.camera.fov=this.fov,this.camera.updateProjectionMatrix()},polygons:function(){this.renderGeometry()}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(73),s=i(o),c=n(5),u=n(3),d=i(u),l=n(2),p=i(l),f=n(43),m=i(f);t.default={name:"canvas",data:function(){return{points:[],isDragging:!1}},mounted:function(){this.calcScales(),this.drawGridLines(),this.setBackground(),this.drawPolygons(),window.addEventListener("resize",this.calcScales)},beforeDestroy:function(){window.removeEventListener("resize",this.calcScales)},computed:(0,a.default)({},(0,c.mapState)({currentMode:function(e){return e.application.currentSelections.mode},currentTool:function(e){return e.application.currentSelections.tool},currentSpace:function(e){return e.application.currentSelections.space},currentShading:function(e){return e.application.currentSelections.shading},currentStory:function(e){return e.application.currentSelections.story},gridVisible:function(e){return e.project.grid.visible},x_spacing:function(e){return e.project.grid.x_spacing},y_spacing:function(e){return e.project.grid.y_spacing},scaleX:function(e){return e.application.scale.x},scaleY:function(e){return e.application.scale.y},viewbox:function(e){return e.project.view.min_x+" "+e.project.view.min_y+" "+(e.project.view.max_x-e.project.view.min_x)+" "+(e.project.view.max_y-e.project.view.min_y)},mapVisible:function(e){return e.project.map.visible},latitude:function(e){return e.project.map.latitude},longitude:function(e){return e.project.map.longitude},zoom:function(e){return e.project.map.zoom},imageVisible:function(e){return e.application.currentSelections.story.imageVisible},images:function(e){return e.models.images}}),{min_x:{get:function(){return this.$store.state.project.view.min_x},set:function(e){this.$store.dispatch("project/setViewMinX",{min_x:e})}},min_y:{get:function(){return this.$store.state.project.view.min_y},set:function(e){this.$store.dispatch("project/setViewMinY",{min_y:e})}},max_x:{get:function(){return this.$store.state.project.view.max_x},set:function(e){this.$store.dispatch("project/setViewMaxX",{max_x:e})}},max_y:{get:function(){return this.$store.state.project.view.max_y},set:function(e){this.$store.dispatch("project/setViewMaxY",{max_y:e})}},currentStoryGeometry:function(){return this.$store.getters["application/currentStoryGeometry"]},mapUrl:function(){return"https://maps.googleapis.com/maps/api/staticmap?center="+this.latitude+","+this.longitude+"&zoom="+this.zoom+"&size=600x300&key=AIzaSyBHevuNXeCuPXkiV3hq-pFKZSdSFLX6kF0"},backgroundSrc:function(){var e=this,t=this.images.find(function(t){return t.id===e.currentStory.image_id});return t?t.src:""},polygons:function(){var e=this;return this.currentStoryGeometry.faces.map(function(t){var n,i=p.default.modelForFace(e.$store.state.models,t.id),r=i.color;return"space"===i.type&&"thermal_zones"===e.currentMode?(n=p.default.libraryObjectWithId(e.$store.state.models,i.thermal_zone_id),r=n?n.color:m.default.config.palette.neutral):"space"===i.type&&"space_types"===e.currentMode?(n=p.default.libraryObjectWithId(e.$store.state.models,i.space_type_id),r=n?n.color:m.default.config.palette.neutral):"space"===i.type&&"building_units"===e.currentMode?(n=p.default.libraryObjectWithId(e.$store.state.models,i.building_unit_id),r=n?n.color:m.default.config.palette.neutral):r=i.color,{face_id:t.id,color:r,points:t.edgeRefs.map(function(t){var n=d.default.edgeForId(t.edge_id,e.currentStoryGeometry),i=t.reverse?n.v2:n.v1;return d.default.vertexForId(i,e.currentStoryGeometry)})}})}}),watch:{gridVisible:function(){this.drawGridLines()},mapVisible:function(){this.setBackground()},imageVisible:function(){this.setBackground()},mapUrl:function(){this.setBackground()},backgroundSrc:function(){this.setBackground()},x_spacing:function(){this.calcScales(),this.drawGridLines()},y_spacing:function(){this.calcScales(),this.drawGridLines()},viewbox:function(){this.calcScales(),this.drawGridLines(),this.drawPoints()},currentTool:function(){this.points=[]},currentSpace:function(){this.points=[],this.drawPolygons()},currentShading:function(){this.points=[],this.drawPolygons()},currentMode:function(){this.drawPolygons()},polygons:function(){this.drawPolygons()},points:function(){this.drawPoints()}},methods:s.default}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(5),s=n(3),c=i(s),u=n(2),d=i(u);t.default={name:"inspector",data:function(){return{tab:"attributes",geometryInspector:!0,storyInspector:!1}},methods:{destroyWindow:function(e){var t=this.currentStory.windows.slice();t.splice(e,1),this.$store.dispatch("models/updateStoryWithData",{story:this.currentStory,windows:t})},destroyDaylightingControl:function(e){var t=this.currentSpace.daylighting_controls.slice();t.splice(e,1),this.$store.dispatch("models/updateSpaceWithData",{space:this.currentSpace,daylighting_controls:t})},getComponent:function(e,t){return this.library[t].find(function(t){return t.id===e})},displayTypeForType:function(e){return d.default.map[e].displayName},startpoint:function(e){var t=this.edgeForId(e.edge_id);if(e.reverse){var n=this.vertexForId(t.v2);return"v2 "+n.id+" ("+n.x+","+n.y+")"}var i=this.vertexForId(t.v1);return"v1 "+i.id+" ("+i.x+","+i.y+")"},endpoint:function(e){var t=this.edgeForId(e.edge_id);if(e.reverse){var n=this.vertexForId(t.v1);return n.id+" (v1)  ("+n.x+","+n.y+")"}var i=this.vertexForId(t.v2);return i.id+" (v2)  ("+i.x+","+i.y+")"},edgeForId:function(e){return c.default.edgeForId(e,this.currentStoryGeometry)},vertexForId:function(e){var t=c.default.vertexForId(e,this.currentStoryGeometry);return t},updatecurrentStory:function(e,t){var n={story:this.currentStory};n[e]=t.target.value,t.target.value=this.currentStory[e],this.$store.dispatch("models/updateStoryWithData",n)},updatecurrentSpace:function(e,t){var n={space:this.currentSpace};n[e]=t.target.value,t.target.value=this.currentSpace[e],this.$store.dispatch("models/updateSpaceWithData",n)},updatecurrentShading:function(e,t){var n={shading:this.currentShading};n[e]=t.target.value,t.target.value=this.currentShading[e],this.$store.dispatch("models/updateShadingWithData",n)},assignObject:function(e,t){this.$emit("assignObject",{type:e,target:t})}},computed:(0,a.default)({currentSelectionsFace:function(){return this.$store.getters["application/currentSelectionsFace"]},currentStoryGeometry:function(){return this.$store.getters["application/currentStoryGeometry"]}},(0,o.mapState)({currentStory:function(e){return e.application.currentSelections.story},currentSpace:function(e){return e.application.currentSelections.space},currentShading:function(e){return e.application.currentSelections.shading},library:function(e){return e.models.library}}))}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(12),s=i(o),c=n(18),u=i(c),d=n(2),l=i(d),p=n(60);t.default={name:"library",data:function(){return{search:"",sortKey:"id",sortDescending:!0,type:null,validationErrors:[],huebs:{}}},mounted:function(){this.type=(0,u.default)(this.extendedLibrary)[8],this.configurePickers()},computed:{currentObject:{get:function(){switch(this.type){case"stories":return this.$store.state.application.currentSelections.story;case"spaces":return this.$store.state.application.currentSelections.space;case"shading":return this.$store.state.application.currentSelections.shading;case"building_units":return this.$store.state.application.currentSelections.building_unit;case"thermal_zones":return this.$store.state.application.currentSelections.thermal_zone;case"space_types":return this.$store.state.application.currentSelections.space_type}},set:function(e){switch(this.type){case"stories":this.$store.dispatch("application/setCurrentStory",{story:e});break;case"spaces":this.$store.dispatch("application/setCurrentSpace",{space:e});break;case"shading":this.$store.dispatch("application/setCurrentShading",{shading:e});break;case"building_units":this.$store.dispatch("application/setCurrentBuildingUnit",{building_unit:e});break;case"thermal_zones":this.$store.dispatch("application/setCurrentThermalZone",{thermal_zone:e});break;case"space_types":this.$store.dispatch("application/setCurrentSpaceType",{space_type:e})}}},extendedLibrary:function(){for(var e=[],t=[],n=0;n<this.$store.state.models.stories.length;n++)e=e.concat(this.$store.state.models.stories[n].spaces),t=t.concat(this.$store.state.models.stories[n].shading);return JSON.parse((0,s.default)((0,a.default)({},this.$store.state.models.library,{stories:this.$store.state.models.stories,spaces:e,shading:t})))},displayObjects:function(){var e=this,t=this.extendedLibrary[this.type]||[];return t.filter(function(t){return(0,u.default)(t).find(function(n){return~String(e.valueForKey(t,n)).toLowerCase().indexOf(e.search.toLowerCase())})}).sort(function(t,n){return e.sortDescending?t[e.sortKey]>n[e.sortKey]:t[e.sortKey]<n[e.sortKey]})},columns:function e(){var t=this,e=[];return this.displayObjects.forEach(function(n){(0,u.default)(n).forEach(function(n){~e.indexOf(n)||t.keyIsPrivate(t.type,n)||e.push(n)})}),e}},methods:{displayTypeForType:function(e){return l.default.map[e].displayName},displayNameForKey:function(e){return l.default.displayNameForKey(this.type,e)},keyIsReadonly:function(e,t){return l.default.keyIsReadonly(this.type,t)},keyIsPrivate:function(e,t){return l.default.keyIsPrivate(this.type,t)},valueForKey:function(e,t){return this.errorForObjectAndKey(e,t)?this.errorForObjectAndKey(e,t).value:l.default.valueForKey(e,this.$store.state,this.type,t)},setValueForKey:function(e,t,n){var i=l.default.setValueForKey(e,this.$store,this.type,t,n);i.success||this.validationErrors.push({object_id:e.id,key:t,value:n,message:i.error,visible:!1})},errorForObjectAndKey:function(e,t){return t?this.validationErrors.find(function(n){return n.object_id===e.id&&n.key===t}):this.validationErrors.find(function(t){return t.object_id===e.id})},toggleError:function(e,t,n){var i=this.errorForObjectAndKey(e,t);i&&(i.visible=n)},destroyObject:function(e){if("stories"===this.type&&this.$store.state.models.stories.length>1)this.$store.dispatch("models/destroyStory",{story:e});else if("spaces"===this.type){var t=this.$store.state.models.stories.find(function(t){return t.spaces.find(function(t){return t.id===e.id})});this.$store.dispatch("models/destroySpace",{space:e,story:t})}else if("shading"===this.type){var n=this.$store.state.models.stories.find(function(t){return t.shading.find(function(t){return t.id===e.id})});this.$store.dispatch("models/destroyShading",{shading:e,story:n})}else this.$store.dispatch("models/destroyObject",{object:e})},classForObjectRow:function(e){var t="";return this.errorForObjectAndKey(e,null)&&(t+=" error"),this.currentObject&&this.currentObject.id===e.id&&(t+=" current"),t},sortBy:function(e){this.sortDescending=this.sortKey!==e||!this.sortDescending,this.sortKey=e},inputTypeForKey:function(e){return l.default.inputTypeForKey(this.type,e)},selectOptionsForObjectAndKey:function(e,t){return l.default.selectOptionsForKey(e,this.$store.state,this.type,t)},configurePickers:function(){for(var e=this,t=document.querySelectorAll(".input-color > input"),n=function(n){var i=t[n].getAttribute("object-id");e.huebs[i]=new p(t[n],{saturations:1}),e.huebs[i].handler=function(t,n,r,a){var o=l.default.libraryObjectWithId(e.$store.state.models,i);e.setValueForKey(o,"color",t)},e.huebs[i].on("change",e.huebs[i].handler)},i=0;i<t.length;i++)n(i)}},watch:{displayObjects:function(){this.$nextTick(this.configurePickers)},type:function(){this.search="",this.sortKey="id",this.sortDescending=!0}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),a=i(r),o=n(1),s=i(o),c=n(5),u=n(17),d=i(u),l=n(2),p=(i(l),{building_units:{displayName:"Building Unit",propName:"building_unit_id",create:d.default.BuildingUnit},thermal_zones:{displayName:"Thermal Zone",propName:"thermal_zone_id",create:d.default.ThermalZone},space_types:{displayName:"Space Type",propName:"space_type_id",create:d.default.SpaceType},construction_sets:{displayName:"Construction Set",propName:"construction_set_id",create:d.default.ConstructionSet},constructions:{displayName:"Construction",create:d.default.Construction},windows:{displayName:"Window",create:d.default.Window},daylighting_controls:{displayName:"Daylighting Control",create:d.default.DaylightingControl}});t.default={name:"assignObjectModal",props:["type","target"],data:function(){return{currentObject:null}},mounted:function(){},computed:(0,s.default)({},(0,c.mapState)({library:function(e){return e.models.library},currentStory:function(e){return e.application.currentSelections.story},currentSpace:function(e){return e.application.currentSelections.space},currentShading:function(e){return e.application.currentSelections.shading}}),{objects:function(){return this.library[this.type]},displayType:function(){return p[this.type].displayName},columns:function e(){var e=[];return this.objects.forEach(function(t){(0,a.default)(t).forEach(function(t){~e.indexOf(t)||e.push(t)})}),e}}),methods:{assignObjectToTarget:function(){if(this.currentObject){if(this.target===this.currentStory){var e={story:this.currentStory};"windows"===this.type?e.windows=this.currentStory.windows.concat(this.currentObject):e[p[this.type].propName]=this.currentObject.id,this.$store.dispatch("models/updateStoryWithData",e)}else if(this.target===this.currentSpace){var e={space:this.currentSpace};"daylighting_controls"===this.type?e.daylighting_controls=this.currentSpace.daylighting_controls.concat(this.currentObject):e[p[this.type].propName]=this.currentObject.id,this.$store.dispatch("models/updateSpaceWithData",e)}else if(this.target===this.currentShading){var e={shading:this.currentShading};"daylighting_controls"===this.type?e.daylighting_controls=this.currentShading.daylighting_controls.concat(this.currentObject):e[p[this.type].propName]=this.currentObject.id,this.$store.dispatch("models/updateShadingWithData",e)}this.$emit("close")}}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(5),s=n(3);i(s);t.default={name:"backgroundModal",methods:{setBackground:function(e){"map"===e?(this.mapVisible=!0,this.imageVisible=!1):"image"===e?(this.mapVisible=!1,this.imageVisible=!0):(this.mapVisible=!1,this.imageVisible=!1)},uploadImage:function(e){var t=this,n=e.target.files[0],i=new FileReader;i.addEventListener("load",function(){t.src=i.result,t.$store.dispatch("models/createImageForStory",{story:t.currentStory,src:i.result})},!1),n&&i.readAsDataURL(n)}},computed:(0,a.default)({},(0,o.mapState)({currentStory:function(e){return e.application.currentSelections.story},images:function(e){return e.models.images}}),{mapVisible:{get:function(){return this.$store.state.project.map.visible},set:function(e){this.$store.dispatch("project/setMapVisible",{visible:e})}},imageVisible:{get:function(){return this.currentStory.imageVisible},set:function(e){this.$store.dispatch("models/updateStoryWithData",{story:this.currentStory,imageVisible:e})}},latitude:{get:function(){return this.$store.state.project.map.latitude},set:function(e){this.$store.dispatch("project/setMapLatitude",{latitude:parseFloat(e)})}},longitude:{get:function(){return this.$store.state.project.map.longitude},set:function(e){this.$store.dispatch("project/setMapLongitude",{longitude:parseFloat(e)})}},
zoom:{get:function(){return this.$store.state.project.map.zoom},set:function(e){this.$store.dispatch("project/setMapZoom",{zoom:parseFloat(e)})}}})}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(18),s=i(o),c=n(5),u=n(17),d=(i(u),n(2)),l=i(d);t.default={name:"createObjectModal",data:function(){return{displayType:null,objectName:null,fields:[]}},mounted:function(){this.displayType=this.displayTypeForType((0,s.default)(this.library)[0]),this.objectName=this.displayType+" "+(this.library[this.typeForDisplayType(this.displayType)].length+1)},computed:(0,a.default)({},(0,c.mapState)({library:function(e){return e.models.library}}),{objects:function(){return this.library[this.typeForDisplayType(this.displayType)]}}),methods:{displayTypeForType:function(e){return l.default.map[e].displayName},typeForDisplayType:function(e){var t=this;return(0,s.default)(l.default.map).find(function(e){return l.default.map[e].displayName===t.displayType})},addField:function(){this.fields.push({label:"",value:""})},createObject:function(){var e=this.typeForDisplayType(this.displayType),t=new l.default.map[e].init(this.objectName);this.fields.forEach(function(e){t[e.label]=e.value}),this.$store.dispatch("models/createObjectWithType",{type:e,object:t}),this.$emit("close")}},watch:{displayType:function(){this.objectName=this.displayType+" "+(this.library[this.typeForDisplayType(this.displayType)].length+1)}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(5),s=n(2),c=i(s),u=n(43),d=i(u);t.default={name:"navigation",data:function(){return{search:""}},mounted:function(){this.mode="spaces"},computed:(0,a.default)({},(0,o.mapState)({building_units:function(e){return e.models.library.building_units},space_types:function(e){return e.models.library.space_types},thermal_zones:function(e){return e.models.library.thermal_zones}}),{stories:function(){var e=this;return this.$store.state.models.stories.filter(function(t){return~t.name.toLowerCase().indexOf(e.search.toLowerCase())})},spaces:function(){return this.$store.state.application.currentSelections.story.spaces},shading:function(){return this.$store.state.application.currentSelections.story.shading},items:function e(){var t=this,e=[];switch(this.mode){case"stories":e=this.stories;break;case"spaces":e=this.spaces;break;case"shading":e=this.shading;break;case"building_units":e=this.building_units;break;case"thermal_zones":e=this.thermal_zones;break;case"space_types":e=this.space_types}return e.filter(function(e){return~e.name.toLowerCase().indexOf(t.search.toLowerCase())})},mode:{get:function(){return this.$store.state.application.currentSelections.mode},set:function(e){this.$store.dispatch("application/setApplicationMode",{mode:e})}},modes:function(){return this.$store.state.application.modes},currentStory:{get:function(){return this.$store.state.application.currentSelections.story},set:function(e){this.$store.dispatch("application/setCurrentStory",{story:e})}},currentSpace:{get:function(){return this.$store.state.application.currentSelections.space},set:function(e){this.$store.dispatch("application/setCurrentSpace",{space:e})}},currentShading:{get:function(){return this.$store.state.application.currentSelections.shading},set:function(e){this.$store.dispatch("application/setCurrentShading",{shading:e})}},currentThermalZone:{get:function(){return this.$store.state.application.currentSelections.thermal_zone},set:function(e){this.$store.dispatch("application/setCurrentThermalZone",{thermal_zone:e})}},currentBuildingUnit:{get:function(){return this.$store.state.application.currentSelections.building_unit},set:function(e){this.$store.dispatch("application/setCurrentBuildingUnit",{building_unit:e})}},currentSpaceType:{get:function(){return this.$store.state.application.currentSelections.space_type},set:function(e){this.$store.dispatch("application/setCurrentSpaceType",{space_type:e})}},currentSubSelection:function(){switch(this.mode){case"stories":return this.currentStory;case"spaces":return this.currentSpace;case"shading":return this.currentShading;case"building_units":return this.currentBuildingUnit;case"thermal_zones":return this.currentThermalZone;case"space_types":return this.currentSpaceType}}}),methods:{createItem:function(e){switch(e){case"stories":this.$store.dispatch("models/initStory");break;case"spaces":this.$store.dispatch("models/initSpace",{story:this.$store.state.application.currentSelections.story});break;case"shading":this.$store.dispatch("models/initShading",{story:this.$store.state.application.currentSelections.story});break;case"building_units":case"thermal_zones":case"space_types":var t=new c.default.map[this.mode].init(this.displayNameForMode(this.mode)+" "+(1+this.items.length));this.$store.dispatch("models/createObjectWithType",{type:this.mode,object:t})}this.selectItem(this.items[this.items.length-1])},destroyItem:function(e){switch(this.mode){case"stories":if(this.stories.length<=1)return;this.$store.dispatch("models/destroyStory",{story:e}),this.currentStory=this.stories[0];break;case"spaces":this.$store.dispatch("models/destroySpace",{space:e,story:this.$store.state.application.currentSelections.story});break;case"shading":this.$store.dispatch("models/destroyShading",{shading:e,story:this.$store.state.application.currentSelections.story});break;case"building_units":case"thermal_zones":case"space_types":this.$store.dispatch("models/destroyObject",{object:e})}},selectItem:function(e,t){switch(t){case"stories":this.currentStory=e;break;case"spaces":this.currentSpace=this.currentSpace&&this.currentSpace.id===e.id?null:e;break;case"shading":this.currentShading=this.currentShading&&this.currentShading.id===e.id?null:e;break;case"building_units":this.currentBuildingUnit=this.currentBuildingUnit&&this.currentBuildingUnit.id===e.id?null:e;break;case"thermal_zones":this.currentThermalZone=this.currentThermalZone&&this.currentThermalZone.id===e.id?null:e;break;case"space_types":this.currentSpaceType=this.currentSpaceType&&this.currentSpaceType.id===e.id?null:e}},clearSubSelections:function(){this.currentShading=null,this.currentSpace=null,this.currentBuildingUnit=null,this.currentThermalZone=null,this.currentSpaceType=null},displayNameForMode:function(e){return d.default.displayNameForMode(e)}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(5);t.default={name:"toolbar",data:function(){return{}},methods:{exportData:function(){var e=this.$store.getters.exportData;return console.log(e),e},importData:function(e){var t=this,n=e.target.files[0],i=new FileReader;i.addEventListener("load",function(){t.$store.dispatch("importData",{clientWidth:document.getElementById("svgcanvas").clientWidth,clientHeight:document.getElementById("svgcanvas").clientHeight,data:JSON.parse(i.result)})},!1),n&&i.readAsText(n)}},computed:(0,a.default)({},(0,o.mapState)({currentMode:function(e){return e.application.currentSelections.mode}}),{availableTools:function(){var e=this;return this.$store.state.application.tools.filter(function(t){return"spaces"===e.currentMode||"shading"===e.currentMode||"Rectangle"!=t&&"Polygon"!=t})},gridVisible:{get:function(){return this.$store.state.project.grid.visible},set:function(e){this.$store.dispatch("project/setGridVisible",{visible:e})}},tool:{get:function(){return this.$store.state.application.currentSelections.tool},set:function(e){this.$store.dispatch("application/setApplicationTool",{tool:e})}},x_spacing:{get:function(){return this.$store.state.project.grid.x_spacing+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setGridXSpacing",{x_spacing:e})}},y_spacing:{get:function(){return this.$store.state.project.grid.y_spacing+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setGridYSpacing",{y_spacing:e})}},min_x:{get:function(){return this.$store.state.project.view.min_x+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setViewMinX",{min_x:e})}},min_y:{get:function(){return this.$store.state.project.view.min_y+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setViewMinY",{min_y:e})}},max_x:{get:function(){return this.$store.state.project.view.max_x+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setViewMaxX",{max_x:e})}},max_y:{get:function(){return this.$store.state.project.view.max_y+" "+this.$store.state.project.config.units},set:function(e){this.$store.dispatch("project/setViewMaxY",{max_y:e})}},zoom:{get:function(){return this.$store.state.project.view.zoom},set:function(e){this.$store.dispatch("project/setZoom",{zoom:e})}},fov:{get:function(){return this.$store.state.project.view.fov},set:function(e){this.$store.dispatch("project/setFov",{fov:e})}},filmOffset:{get:function(){return this.$store.state.project.view.filmOffset},set:function(e){this.$store.dispatch("project/setFilmOffset",{filmOffset:e})}}})}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(46),a=i(r),o=n(42);o.ConvexGeometry=function(e){function t(t){var i=e[t].clone(),o=i.length();i.x+=o*a(),i.y+=o*a(),i.z+=o*a();for(var c=[],u=0;u<s.length;){var d=s[u];if(n(d,i)){for(var l=0;l<3;l++){for(var p=[d[l],d[(l+1)%3]],f=!0,m=0;m<c.length;m++)if(r(c[m],p)){c[m]=c[c.length-1],c.pop(),f=!1;break}f&&c.push(p)}s[u]=s[s.length-1],s.pop()}else u++}for(var m=0;m<c.length;m++)s.push([c[m][0],c[m][1],t])}function n(t,n){var r=e[t[0]],a=e[t[1]],o=e[t[2]],s=i(r,a,o),c=s.dot(r);return s.dot(n)>=c}function i(e,t,n){var i=new o.Vector3,r=new o.Vector3;return i.subVectors(n,t),r.subVectors(e,t),i.cross(r),i.normalize(),i}function r(e,t){return e[0]===t[1]&&e[1]===t[0]}function a(){return 2*(Math.random()-.5)*1e-6}o.Geometry.call(this);for(var s=[[0,1,2],[0,2,1]],c=3;c<e.length;c++)t(c);for(var u=0,d=new Array(e.length),c=0;c<s.length;c++)for(var l=s[c],p=0;p<3;p++)void 0===d[l[p]]&&(d[l[p]]=u++,this.vertices.push(e[l[p]])),l[p]=d[l[p]];for(var c=0;c<s.length;c++)this.faces.push(new o.Face3(s[c][0],s[c][1],s[c][2]));this.computeFaceNormals();for(var c=0;c<this.faces.length;c++){var l=this.faces[c],i=l.normal;l.vertexNormals[0]=i.clone(),l.vertexNormals[1]=i.clone(),l.vertexNormals[2]=i.clone()}},o.ConvexGeometry.prototype=(0,a.default)(o.Geometry.prototype),o.ConvexGeometry.prototype.constructor=o.ConvexGeometry},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(96),a=i(r),o=n(46),s=i(o),c=n(42);c.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*N.autoRotateSpeed}function i(){return Math.pow(.95,N.zoomSpeed)}function r(e){G.theta-=e}function a(e){G.phi-=e}function o(e){N.object instanceof c.PerspectiveCamera?U/=e:N.object instanceof c.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*e)),N.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function s(e){N.object instanceof c.PerspectiveCamera?U*=e:N.object instanceof c.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/e)),N.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function u(e){Y.set(e.clientX,e.clientY)}function d(e){q.set(e.clientX,e.clientY)}function l(e){Z.set(e.clientX,e.clientY)}function p(e){K.set(e.clientX,e.clientY),X.subVectors(K,Y);var t=N.domElement===document?N.domElement.body:N.domElement;r(2*Math.PI*X.x/t.clientWidth*N.rotateSpeed),a(2*Math.PI*X.y/t.clientHeight*N.rotateSpeed),Y.copy(K),N.update()}function f(e){Q.set(e.clientX,e.clientY),ee.subVectors(Q,q),ee.y>0?o(i()):ee.y<0&&s(i()),q.copy(Q),N.update()}function m(e){H.set(e.clientX,e.clientY),J.subVectors(H,Z),ie(J.x,J.y),Z.copy(H),N.update()}function h(e){}function v(e){e.deltaY<0?s(i()):e.deltaY>0&&o(i()),N.update()}function y(e){switch(e.keyCode){case N.keys.UP:ie(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:ie(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:ie(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:ie(-N.keyPanSpeed,0),N.update()}}function g(e){Y.set(e.touches[0].pageX,e.touches[0].pageY)}function _(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);q.set(0,i)}function b(e){Z.set(e.touches[0].pageX,e.touches[0].pageY)}function S(e){K.set(e.touches[0].pageX,e.touches[0].pageY),X.subVectors(K,Y);var t=N.domElement===document?N.domElement.body:N.domElement;r(2*Math.PI*X.x/t.clientWidth*N.rotateSpeed),a(2*Math.PI*X.y/t.clientHeight*N.rotateSpeed),Y.copy(K),N.update()}function x(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);Q.set(0,r),ee.subVectors(Q,q),ee.y>0?s(i()):ee.y<0&&o(i()),q.copy(Q),N.update()}function w(e){H.set(e.touches[0].pageX,e.touches[0].pageY),J.subVectors(H,Z),ie(J.x,J.y),Z.copy(H),N.update()}function j(e){}function O(e){if(N.enabled!==!1){if(e.preventDefault(),e.button===N.mouseButtons.ORBIT){if(N.enableRotate===!1)return;u(e),D=I.ROTATE}else if(e.button===N.mouseButtons.ZOOM){if(N.enableZoom===!1)return;d(e),D=I.DOLLY}else if(e.button===N.mouseButtons.PAN){if(N.enablePan===!1)return;l(e),D=I.PAN}D!==I.NONE&&(document.addEventListener("mousemove",F,!1),document.addEventListener("mouseup",M,!1),N.dispatchEvent(R))}}function F(e){if(N.enabled!==!1)if(e.preventDefault(),D===I.ROTATE){if(N.enableRotate===!1)return;p(e)}else if(D===I.DOLLY){if(N.enableZoom===!1)return;f(e)}else if(D===I.PAN){if(N.enablePan===!1)return;m(e)}}function M(e){N.enabled!==!1&&(h(e),document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",M,!1),N.dispatchEvent(V),D=I.NONE)}function E(e){N.enabled===!1||N.enableZoom===!1||D!==I.NONE&&D!==I.ROTATE||(e.preventDefault(),e.stopPropagation(),v(e),N.dispatchEvent(R),N.dispatchEvent(V))}function T(e){N.enabled!==!1&&N.enableKeys!==!1&&N.enablePan!==!1&&y(e)}function C(e){if(N.enabled!==!1){switch(e.touches.length){case 1:if(N.enableRotate===!1)return;g(e),D=I.TOUCH_ROTATE;break;case 2:if(N.enableZoom===!1)return;_(e),D=I.TOUCH_DOLLY;break;case 3:if(N.enablePan===!1)return;b(e),D=I.TOUCH_PAN;break;default:D=I.NONE}D!==I.NONE&&N.dispatchEvent(R)}}function $(e){if(N.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(N.enableRotate===!1)return;if(D!==I.TOUCH_ROTATE)return;S(e);break;case 2:if(N.enableZoom===!1)return;if(D!==I.TOUCH_DOLLY)return;x(e);break;case 3:if(N.enablePan===!1)return;if(D!==I.TOUCH_PAN)return;w(e);break;default:D=I.NONE}}function P(e){N.enabled!==!1&&(j(e),N.dispatchEvent(V),D=I.NONE)}function k(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new c.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:c.MOUSE.LEFT,ZOOM:c.MOUSE.MIDDLE,PAN:c.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return L.phi},this.getAzimuthalAngle=function(){return L.theta},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(z),N.update(),D=I.NONE},this.update=function(){var t=new c.Vector3,i=(new c.Quaternion).setFromUnitVectors(e.up,new c.Vector3(0,1,0)),a=i.clone().inverse(),o=new c.Vector3,s=new c.Quaternion;return function(){var e=N.object.position;return t.copy(e).sub(N.target),t.applyQuaternion(i),L.setFromVector3(t),N.autoRotate&&D===I.NONE&&r(n()),L.theta+=G.theta,L.phi+=G.phi,L.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,L.theta)),L.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,L.phi)),L.makeSafe(),L.radius*=U,L.radius=Math.max(N.minDistance,Math.min(N.maxDistance,L.radius)),N.target.add(B),t.setFromSpherical(L),t.applyQuaternion(a),e.copy(N.target).add(t),N.object.lookAt(N.target),N.enableDamping===!0?(G.theta*=1-N.dampingFactor,G.phi*=1-N.dampingFactor):G.set(0,0,0),U=1,B.set(0,0,0),!!(W||o.distanceToSquared(N.object.position)>A||8*(1-s.dot(N.object.quaternion))>A)&&(N.dispatchEvent(z),o.copy(N.object.position),s.copy(N.object.quaternion),W=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",k,!1),N.domElement.removeEventListener("mousedown",O,!1),N.domElement.removeEventListener("wheel",E,!1),N.domElement.removeEventListener("touchstart",C,!1),N.domElement.removeEventListener("touchend",P,!1),N.domElement.removeEventListener("touchmove",$,!1),document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",M,!1),window.removeEventListener("keydown",T,!1)};var N=this,z={type:"change"},R={type:"start"},V={type:"end"},I={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},D=I.NONE,A=1e-6,L=new c.Spherical,G=new c.Spherical,U=1,B=new c.Vector3,W=!1,Y=new c.Vector2,K=new c.Vector2,X=new c.Vector2,Z=new c.Vector2,H=new c.Vector2,J=new c.Vector2,q=new c.Vector2,Q=new c.Vector2,ee=new c.Vector2,te=function(){var e=new c.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),B.add(e)}}(),ne=function(){var e=new c.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),B.add(e)}}(),ie=function(){var e=new c.Vector3;return function(t,n){var i=N.domElement===document?N.domElement.body:N.domElement;if(N.object instanceof c.PerspectiveCamera){var r=N.object.position;e.copy(r).sub(N.target);var a=e.length();a*=Math.tan(N.object.fov/2*Math.PI/180),te(2*t*a/i.clientHeight,N.object.matrix),ne(2*n*a/i.clientHeight,N.object.matrix)}else N.object instanceof c.OrthographicCamera?(te(t*(N.object.right-N.object.left)/N.object.zoom/i.clientWidth,N.object.matrix),ne(n*(N.object.top-N.object.bottom)/N.object.zoom/i.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.domElement.addEventListener("contextmenu",k,!1),N.domElement.addEventListener("mousedown",O,!1),N.domElement.addEventListener("wheel",E,!1),N.domElement.addEventListener("touchstart",C,!1),N.domElement.addEventListener("touchend",P,!1),N.domElement.addEventListener("touchmove",$,!1),window.addEventListener("keydown",T,!1),this.update()},c.OrbitControls.prototype=(0,s.default)(c.EventDispatcher.prototype),c.OrbitControls.prototype.constructor=c.OrbitControls,(0,a.default)(c.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n,i=e<0?-1:1;return e=Math.abs(e),n=e%t<t/2?e-e%t:e+t-e%t,n*=i,Math.round(1e13*n)/1e13}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=i(a),s=n(2),c=i(s),u=n(57);t.default={highlightSnapTarget:function(e){u.selectAll("#canvas .highlight, #canvas .gridpoint").remove();var t=this.getEventRWU(e),n=this.findSnapTarget(t);if(n&&"edge"===n.type)u.select("#canvas svg").append("line").attr("x1",n.v1.x).attr("y1",n.v1.y).attr("x2",n.v2.x).attr("y2",n.v2.y).attr("stroke-width",1).classed("highlight",!0).attr("vector-effect","non-scaling-stroke"),u.select("#canvas svg").append("ellipse").attr("cx",n.scalar.x).attr("cy",n.scalar.y).attr("rx",this.calcRadius(2,"x")).attr("ry",this.calcRadius(2,"y")).classed("highlight",!0).attr("vector-effect","non-scaling-stroke");else if(n&&"vertex"===n.type)u.select("#canvas svg").append("ellipse").attr("cx",n.x).attr("cy",n.y).attr("rx",this.calcRadius(5,"x")).attr("ry",this.calcRadius(5,"y")).classed("highlight",!0).attr("vector-effect","non-scaling-stroke");else if(!n&&this.gridVisible){var i=this.min_x%this.x_spacing,a=this.min_y%this.y_spacing;n={x:r(this.scaleX(e.offsetX)-i,this.x_spacing)+i,y:r(this.scaleY(e.offsetY)-a,this.y_spacing)+a},u.select("#canvas svg").append("ellipse").attr("cx",n.x).attr("cy",n.y).attr("rx",this.calcRadius(2,"x")).attr("ry",this.calcRadius(2,"y")).classed("gridpoint",!0).attr("vector-effect","non-scaling-stroke")}},addPoint:function(e){if(!this.isDragging&&(this.currentSpace||this.currentShading)){var t=this.getEventRWU(e),n=this.findSnapTarget(t);if(n)"vertex"===n.type?t=n:"edge"===n.type&&(t=n.scalar,t.splittingEdge=n.edge);else if(this.gridVisible){var i=this.min_x%this.x_spacing,a=this.min_y%this.y_spacing;t.x=r(this.scaleX(e.offsetX)-i,this.x_spacing)+i,t.y=r(this.scaleY(e.offsetY)-a,this.y_spacing)+a}"Rectangle"!==this.currentTool&&"Polygon"!==this.currentTool&&"Eraser"!==this.currentTool||this.points.push(t),"Rectangle"!==this.currentTool&&"Eraser"!==this.currentTool||2!==this.points.length||("Rectangle"===this.currentTool?this.saveRectuangularFace():this.eraseRectangularSelection())}},saveRectuangularFace:function(){var e={points:[this.points[0],{x:this.points[1].x,y:this.points[0].y},this.points[1],{x:this.points[0].x,y:this.points[1].y}]};this.currentSpace?e.space=this.currentSpace:this.currentShading&&(e.shading=this.currentShading),this.$store.dispatch("geometry/createFaceFromPoints",e),this.points=[]},savePolygonFace:function(){var e={points:this.points};this.currentSpace?e.space=this.currentSpace:this.currentShading&&(e.shading=this.currentShading),this.$store.dispatch("geometry/createFaceFromPoints",e),this.points=[]},eraseRectangularSelection:function(){var e={points:[this.points[0],{x:this.points[1].x,y:this.points[0].y},this.points[1],{x:this.points[0].x,y:this.points[1].y}]};this.$store.dispatch("geometry/eraseSelection",e),this.points=[]},drawPoints:function(){var e=this;u.selectAll("#canvas ellipse").remove(),u.select("#canvas svg").selectAll("ellipse").data(this.points).enter().append("ellipse").attr("cx",function(e,t){return e.x}).attr("cy",function(e,t){return e.y}).attr("rx",this.calcRadius(2,"x")).attr("ry",this.calcRadius(2,"y")).attr("vector-effect","non-scaling-stroke").on("mouseover",function(e,t){this.setAttribute("fill","#839199")}).on("mouseout",function(e,t){this.setAttribute("fill","none")}),this.connectCanvasPoints(),u.select("#canvas svg").select("ellipse").on("click",function(){e.savePolygonFace(),u.event.stopPropagation()}).attr("rx",this.calcRadius(7,"x")).attr("ry",this.calcRadius(7,"y")).classed("origin",!0).attr("vector-effect","non-scaling-stroke").attr("fill","none")},connectCanvasPoints:function(){u.selectAll("#canvas path").remove(),u.select("#canvas svg").append("path").datum(this.points).attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("d",u.line().x(function(e){return e.x}).y(function(e){return e.y})).lower(),u.selectAll(".vertical, .horizontal").lower()},drawPolygons:function(){var e=this;u.select("#canvas svg").selectAll("polygon").remove(),u.select("#canvas svg").selectAll("polygon").data(this.polygons).enter().append("polygon").on("click",function(t){if("Select"===e.currentTool){var n=c.default.modelForFace(e.$store.state.models,t.face_id);"space"===n.type?e.$store.dispatch("application/setCurrentSpace",{space:n}):"shading"===n.type&&e.$store.dispatch("application/setCurrentShading",{shading:n})}}).attr("points",function(e,t){var n="";return e.points.forEach(function(e){n+=e.x+","+e.y+" "}),n}).attr("class",function(t,n){return e.currentSpace&&t.face_id===e.currentSpace.face_id?"currentSpace":e.currentShading&&t.face_id===e.currentShading.face_id?"currentShading":void 0}).attr("fill",function(e){return e.color}).attr("vector-effect","non-scaling-stroke"),u.selectAll("#canvas path").remove(),u.selectAll("#canvas ellipse").remove()},drawGridLines:function(){var e=this,t=u.select("#canvas svg");t.selectAll("line").remove(),this.$store.state.project.grid.visible&&(t.selectAll(".vertical").data(u.range(this.min_x/this.x_spacing,this.max_x/this.x_spacing)).enter().append("line").attr("x1",function(t){return t*e.x_spacing}).attr("x2",function(t){return t*e.x_spacing}).attr("y1",this.min_y).attr("y2",this.max_y).attr("class","vertical").attr("vector-effect","non-scaling-stroke"),t.selectAll(".horizontal").data(u.range(this.min_y/this.y_spacing,this.max_y/this.y_spacing)).enter().append("line").attr("x1",this.min_x).attr("x2",this.max_x).attr("y1",function(t){return t*e.y_spacing}).attr("y2",function(t){return t*e.y_spacing}).attr("class","horizontal").attr("vector-effect","non-scaling-stroke"),u.selectAll(".vertical, .horizontal").lower())},findSnapTarget:function(e){if(!this.isDragging){u.selectAll("#canvas .highlight").remove();var t=this.snappingVertexData(e),n=this.snappingEdgeData(e);return t&&n?t.dist<=n.dist?t:n:t?t:n?n:void 0}},snappingVertexData:function(e){var t,n=this,i=this.$store.getters["application/currentStoryGeometry"].vertices.filter(function(t){var i=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return i<n.$store.getters["project/snapTolerance"]&&r<n.$store.getters["project/snapTolerance"]});if(t=i.length>1?i.reduce(function(t,n){var i=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),a=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);return i*r<=a*o?t:n}):i[0]){var r=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y),o=r*r+a*a;return t.dist=Math.sqrt(o),t.type="vertex",t}},snappingEdgeData:function(e){var t,n=this,i=this.currentStoryGeometry.edges.map(function(t){var i=o.default.vertexForId(t.v1,n.currentStoryGeometry),r=o.default.vertexForId(t.v2,n.currentStoryGeometry),a=o.default.projectToEdge(e,i,r);return a?{dist:a.dist,scalar:a.scalar,edge:t,v1:i,v2:r}:null}).filter(function(e){return e&&e.dist<n.$store.getters["project/snapTolerance"]});if(t=i.length>1?i.reduce(function(e,t){return e.dist<=t.dist?e:t}):i[0])return t.type="edge",t},getEventRWU:function(e){var t;return t=e.clientX===e.offsetX?{x:this.scaleX(e.offsetX-this.$refs.grid.getBoundingClientRect().left),y:this.scaleY(e.offsetY-this.$refs.grid.getBoundingClientRect().top)}:{x:this.scaleX(e.offsetX),y:this.scaleY(e.offsetY)}},calcRadius:function(e,t){return"x"===t?this.scaleX(e):this.scaleY(e)},setBackground:function(){var e="";this.currentStory.imageVisible?e=this.backgroundSrc:this.mapVisible&&(e=this.mapUrl),this.$refs.grid.style.backgroundImage='url("'+e+'")'},calcScales:function(){this.isDragging||(this.$store.dispatch("application/setScaleX",{scaleX:u.scaleLinear().domain([0,this.$refs.grid.clientWidth]).range([this.min_x,this.max_x])}),this.$store.dispatch("application/setScaleY",{scaleY:u.scaleLinear().domain([0,this.$refs.grid.clientHeight]).range([this.min_y,this.max_y])}))}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=i(r),o=n(5),s=i(o),c=n(77),u=i(c),d=n(91),l=i(d),p=n(82),f=i(p),m=n(85),h=i(m),v=n(93),y=i(v),g=n(95),_=i(g);a.default.use(s.default);var b=new s.default.Store({strict:!1,modules:{application:u.default,project:l.default,geometry:f.default,models:h.default},getters:{exportData:y.default},actions:{importData:_.default},mutations:{importState:function(e,t){e.project=t.project,e.application=t.application,e.models=t.models,e.geometry=t.geometry}}});t.default=b},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={clearSubSelections:function(e,t){e.commit("setCurrentShading",{shading:null}),e.commit("setCurrentSpace",{space:null}),e.commit("setCurrentBuildingUnit",{building_unit:null}),e.commit("setCurrentThermalZone",{thermal_zone:null}),e.commit("setCurrentSpaceType",{space_type:null})},setCurrentStory:function(e,t){var n=e.rootState.models.stories.find(function(e){return e.id===t.story.id});~e.rootState.models.stories.map(function(e){return e.id}).indexOf(t.story.id)&&(e.commit("setCurrentStory",{story:n}),t.story.imageVisible&&e.dispatch("project/setMapVisible",{visible:!1},{root:!0}),e.dispatch("clearSubSelections"))},setCurrentSpace:function(e,t){var n=t.space?e.state.currentSelections.story.spaces.find(function(e){return e.id===t.space.id}):null;e.dispatch("clearSubSelections"),e.commit("setCurrentSpace",{space:n})},setCurrentShading:function(e,t){var n=t.shading?e.state.currentSelections.story.shading.find(function(e){return e.id===t.shading.id}):null;e.dispatch("clearSubSelections"),e.commit("setCurrentShading",{shading:n})},setCurrentBuildingUnit:function(e,t){var n=t.building_unit?e.rootState.models.library.building_units.find(function(e){return e.id===t.building_unit.id}):null;e.dispatch("clearSubSelections"),e.commit("setCurrentBuildingUnit",{building_unit:n})},setCurrentThermalZone:function(e,t){var n=t.thermal_zone?e.rootState.models.library.thermal_zones.find(function(e){return e.id===t.thermal_zone.id}):null;e.dispatch("clearSubSelections"),e.commit("setCurrentThermalZone",{thermal_zone:n})},setCurrentSpaceType:function(e,t){var n=t.space_type?e.rootState.models.library.space_types.find(function(e){return e.id===t.space_type.id}):null;e.dispatch("clearSubSelections"),e.commit("setCurrentSpaceType",{space_type:n})},setApplicationTool:function(e,t){~e.state.tools.indexOf(t.tool)&&e.commit("setApplicationTool",{tool:t.tool})},setApplicationMode:function(e,t){~e.state.modes.indexOf(t.mode)&&e.commit("setApplicationMode",{mode:t.mode})},setScaleX:function(e,t){e.commit("setScaleX",{scaleX:t.scaleX})},setScaleY:function(e,t){e.commit("setScaleY",{scaleY:t.scaleY})}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=i(r);t.default={currentStoryGeometry:function(e,t,n,i){return n.geometry.find(function(t){return t.id===e.currentSelections.story.geometry_id})},currentSelectionsFace:function(e,t,n,i){return e.currentSelections.space&&e.currentSelections.space.face_id?a.default.faceForId(e.currentSelections.space.face_id,t.currentStoryGeometry):e.currentSelections.shading&&e.currentSelections.shading.face_id?a.default.faceForId(e.currentSelections.shading.face_id,t.currentStoryGeometry):void 0;
}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(75),a=i(r),o=n(78),s=i(o),c=n(76),u=i(c);t.default={namespaced:!0,state:{currentSelections:{story:null,space:null,shading:null,building_unit:null,thermal_zone:null,space_type:null,tool:"Polygon",mode:"stories"},modes:["spaces","shading","building_units","thermal_zones","space_types"],tools:["Rectangle","Polygon","Eraser","Select","Place Component","Apply Property","3d","Background"],scale:{x:null,y:null}},actions:a.default,mutations:s.default,getters:u.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={setCurrentStory:function(e,t){e.currentSelections.story=t.story},setCurrentSpace:function(e,t){e.currentSelections.space=t.space},setCurrentShading:function(e,t){e.currentSelections.shading=t.shading},setCurrentBuildingUnit:function(e,t){e.currentSelections.building_unit=t.building_unit},setCurrentThermalZone:function(e,t){e.currentSelections.thermal_zone=t.thermal_zone},setCurrentSpaceType:function(e,t){e.currentSelections.space_type=t.space_type},setApplicationTool:function(e,t){e.currentSelections.tool=t.tool},setApplicationMode:function(e,t){e.currentSelections.mode=t.mode},setScaleX:function(e,t){e.scale.x=t.scaleX},setScaleY:function(e,t){e.scale.y=t.scaleY}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),a=i(r),o=n(1),s=i(o),c=n(25),u=i(c),d=n(3),l=i(d),p=n(2),f=i(p),m=n(80),h=i(m);t.default={initGeometry:function(e,t){e.commit("initGeometry",{geometry:new u.default.Geometry,story:e.rootState.models.stories.find(function(e){return e.id===t.story.id})})},eraseSelection:function(e,t){var n=t.points.map(function(e){return(0,s.default)({},e,{X:e.x,Y:e.y})}),i=e.rootGetters["application/currentStoryGeometry"];t.points.length<3||!l.default.areaOfFace(n)||i.faces.forEach(function(t){var r=l.default.verticesForFace(t,i);if(l.default.intersectionOfFaces(r,n,i)){var o,s=f.default.modelForFace(e.rootState.models,t.id);e.dispatch("space"===s.type?"models/updateSpaceWithData":"models/updateShadingWithData",(o={},(0,a.default)(o,s.type,s),(0,a.default)(o,"face_id",null),o),{root:!0}),e.dispatch("destroyFaceAndDescendents",{geometry:i,face:t});var c=l.default.differenceOfFaces(r,n,i);if(c){var u;e.dispatch("createFaceFromPoints",(u={},(0,a.default)(u,s.type,s),(0,a.default)(u,"geometry",i),(0,a.default)(u,"points",c),u))}}})},createFaceFromPoints:h.default,splitEdge:function(e,t){var n=e.rootGetters["application/currentStoryGeometry"],i=n.edges.find(function(e){return e.v1===t.edge.v1&&e.v2===t.vertex.id||e.v2===t.edge.v1&&e.v1===t.vertex.id});i||(i=new u.default.Edge,i.v1=t.edge.v1,i.v2=t.vertex.id,e.commit("createEdge",{geometry:n,edge:i}));var r=n.edges.find(function(e){return e.v2===t.edge.v2&&e.v1===t.vertex.id||e.v1===t.edge.v2&&e.v2===t.vertex.id});r||(r=new u.default.Edge,r.v1=t.vertex.id,r.v2=t.edge.v2,e.commit("createEdge",{geometry:n,edge:r}));var a=l.default.facesForEdge(t.edge.id,n);a.forEach(function(n){e.commit("createEdgeRef",{face:n,edgeRef:{edge_id:i.id,reverse:!1}}),e.commit("createEdgeRef",{face:n,edgeRef:{edge_id:r.id,reverse:!1}}),e.commit("destroyEdgeRef",{edge_id:t.edge.id,face:n})}),l.default.facesForEdge(t.edge.id,n).length<2&&e.dispatch("destroyEdge",{geometry:n,edge_id:t.edge.id})},destroyFaceAndDescendents:function(e,t){var n=t.geometry,i=t.face,r=l.default.verticesForFace(i,n).filter(function(e){return l.default.facesForVertex(e.id,n).length<2}),a=i.edgeRefs.filter(function(e){return l.default.facesForEdge(e.edge_id,n).length<2});e.dispatch("destroyFace",{geometry:n,face_id:i.id}),a.forEach(function(t){e.dispatch("destroyEdge",{geometry:n,edge_id:t.edge_id})}),r.forEach(function(t){e.dispatch("destroyVertex",{geometry:n,vertex_id:t.id})})},destroyFace:function(e,t){var n=e.rootState.application.currentSelections.story.spaces.find(function(e){return e.face_id===t.face_id});if(n)throw console.error("Attempting to delete face "+t.face_id+" referenced by space: ",l.default.dc(n)),new Error;e.commit("destroyFace",{geometry:t.geometry,face_id:t.face_id})},destroyVertex:function(e,t){var n=l.default.edgesForVertex(t.vertex_id,t.geometry);if(n.length)throw console.error("Attempting to delete vertex "+t.vertex_id+" referenced by edges: ",l.default.dc(n)),new Error;e.commit("destroyVertex",{geometry:t.geometry,vertex_id:t.vertex_id})},destroyEdge:function(e,t){var n=l.default.facesForEdge(t.edge_id,t.geometry);if(n.length)throw console.error("Attempting to delete edge "+t.edge_id+" referenced by faces: ",l.default.dc(n)),new Error;e.commit("destroyEdge",{geometry:t.geometry,edge_id:t.edge_id})}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=t.points.map(function(e){return(0,m.default)({},e,{X:e.x,Y:e.y})}),i=e.rootGetters["application/currentStoryGeometry"],r=b.default.libraryObjectWithId(e.rootState.models,t.space?t.space.id:t.shading.id);if(!(n.length<3)&&g.default.areaOfFace(n)){r.face_id&&(n=a(n,i,r,e)),e.dispatch("eraseSelection",{points:n});var u=o(n,i,e),d=s(u,i,r,e);d&&c(i,e)}}function a(e,t,n,i){for(var r,a=g.default.faceForId(n.face_id,t),o=g.default.verticesForFace(a,t),s=0;s<e.length;s++){var c=e[s].splittingEdge;c&&~a.edgeRefs.map(function(e){return e.edge_id}).indexOf(c.id)&&(console.log("do union, point splits edge",a.edgeRefs[a.edgeRefs.map(function(e){return e.edge_id}).indexOf(c.id)]),e=g.default.unionOfFaces(o,e,t))}return g.default.intersectionOfFaces(o,e,t)&&(e=g.default.unionOfFaces(o,e,t)),i.dispatch("space"===n.type?"models/updateSpaceWithData":"models/updateShadingWithData",(r={},(0,p.default)(r,n.type,n),(0,p.default)(r,"face_id",null),r),{root:!0}),i.dispatch("destroyFaceAndDescendents",{geometry:t,face:a}),e}function o(e,t,n){var i=e.map(function(i){var r=i.id&&g.default.vertexForId(i.id,t);return r||(r=new v.default.Vertex(i.x,i.y),e.filter(function(e){return e!==i&&e.x===r.x&&e.y===r.y}).forEach(function(e){e.id=r.id}),n.commit("createVertex",{vertex:r,geometry:t})),r}),r=i.map(function(e,r){var a=r+1<i.length?i[r+1]:i[0],o=t.edges.find(function(t){return t.v1===e.id&&t.v2===a.id||t.v2===e.id&&t.v1===a.id});if(o)return o=JSON.parse((0,d.default)(o)),o.reverse=o.v1!==e.id,o;var s=new v.default.Edge(e.id,a.id);return n.commit("createEdge",{edge:s,geometry:t}),s}),a=new v.default.Face(r.map(function(e){return{edge_id:e.id,reverse:e.reverse}}));return a}function s(e,t,n,i){for(var r=g.default.edgesForFace(e,t),a=g.default.verticesForFace(e,t),o=!0,s=0;s<r.length;s++){for(var c=r[s],u=g.default.verticesOnEdge(c,t),d=0;d<u.length;d++){var l=u[d];a.indexOf(l)!==-1&&(o=!1)}for(var f=function(e){var t=a[e];a.filter(function(e){return e.id===t.id}).length>=2&&(o=!1)},m=0;m<a.length;m++)f(m)}if(o){var h;i.commit("createFace",{face:e,geometry:t}),i.dispatch("space"===n.type?"models/updateSpaceWithData":"models/updateShadingWithData",(h={},(0,p.default)(h,n.type,n),(0,p.default)(h,"face_id",e.id),h),{root:!0})}else i.dispatch("destroyFaceAndDescendents",{geometry:t,face:e});return o}function c(e,t){function n(){var t=0;return e.edges.forEach(function(n){t+=g.default.verticesOnEdge(n,e).length}),t}for(var i=n();i;)e.edges.forEach(function(n){g.default.verticesOnEdge(n,e).forEach(function(e){t.dispatch("splitEdge",{vertex:e,edge:n})})}),i=n();e.faces.forEach(function(n){var i=g.default.normalizedEdges(n,e);t.commit("setEdgeRefsForFace",{face:n,edgeRefs:i})})}Object.defineProperty(t,"__esModule",{value:!0});var u=n(12),d=i(u),l=n(27),p=i(l),f=n(1),m=i(f);t.default=r;var h=n(25),v=i(h),y=n(3),g=i(y),_=n(2),b=i(_)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),a=i(r),o=n(25),s=(i(o),n(3)),c=i(s);t.default={exportData:function(e,t,n,i){var r=JSON.parse((0,a.default)(e));return r.forEach(function(e){e.vertices=e.vertices.map(function(t){return{id:t.id,x:Number(t.x),y:Number(t.y),edge_ids:c.default.edgesForVertex(t.id,e).map(function(e){return e.id})}}),e.edges=e.edges.map(function(t){return{id:t.id,vertex_ids:[t.v1,t.v2],face_ids:c.default.facesForEdge(t.id,e).map(function(e){return e.id})}}),e.faces=e.faces.map(function(e){return{id:e.id,edge_ids:e.edgeRefs.map(function(e){return e.edge_id}),edge_order:e.edgeRefs.map(function(e){return e.reverse?0:1})}})}),r}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(79),a=i(r),o=n(83),s=i(o),c=n(81),u=i(c);t.default={namespaced:!0,state:[],actions:a.default,mutations:s.default,getters:u.default}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);i(r);t.default={setEdgeRefsForFace:function(e,t){t.face.edgeRefs=t.edgeRefs},initGeometry:function(e,t){e.push(t.geometry),t.story.geometry_id=t.geometry.id},createVertex:function(e,t){t.geometry.vertices.push(t.vertex)},createEdge:function(e,t){t.geometry.edges.push(t.edge)},createEdgeRef:function(e,t){t.face.edgeRefs.push(t.edgeRef)},createFace:function(e,t){t.geometry.faces.push(t.face)},destroyVertex:function(e,t){t.geometry.vertices.splice(t.geometry.vertices.findIndex(function(e){return e.id===t.vertex_id}),1)},destroyEdge:function(e,t){t.geometry.edges.splice(t.geometry.edges.findIndex(function(e){return e.id===t.edge_id}),1)},destroyEdgeRef:function(e,t){t.face.edgeRefs.splice(t.face.edgeRefs.findIndex(function(e){return e.edge_id===t.edge_id}),1)},destroyFace:function(e,t){t.geometry.faces.splice(t.geometry.faces.findIndex(function(e){return e.id===t.face_id}),1)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),a=i(r),o=n(17),s=i(o),c=n(44),u=(i(c),n(2)),d=i(u);t.default={initStory:function(e){var t=new s.default.Story;t.name="Story "+(e.state.stories.length+1),e.commit("initStory",{story:t}),e.dispatch("application/setCurrentStory",{story:t},{root:!0}),e.dispatch("geometry/initGeometry",{story:t},{root:!0})},initSpace:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id}),i=new s.default.Space;i.name="Space "+(n.spaces.length+1),e.commit("initSpace",{story:n,space:i})},initShading:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id}),i=new s.default.Shading;i.name="Shading "+(n.shading.length+1),e.commit("initShading",{story:n,shading:i})},destroyStory:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id});e.commit("destroyStory",{story:n})},destroySpace:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id}),i=n.spaces.find(function(e){return e.id===t.space.id});e.commit("destroySpace",{space:i,story:n});var r=e.rootGetters["application/currentStoryGeometry"].faces.find(function(e){return e.id===i.face_id});r&&e.dispatch("geometry/destroyFaceAndDescendents",{face:r,geometry:e.rootGetters["application/currentStoryGeometry"]},{root:!0})},destroyShading:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id});n.spaces.find(function(e){return e.id===t.shading.id});e.commit("destroyShading",{shading:shading,story:n});var i=e.rootGetters["application/currentStoryGeometry"].faces.find(function(e){return e.id===shading.face_id});i&&e.dispatch("geometry/destroyFaceAndDescendents",{face:i,geometry:e.rootGetters["application/currentStoryGeometry"]},{root:!0})},destroyObject:function(e,t){e.commit("destroyObject",{object:t.object})},updateStoryWithData:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id}),i=(0,a.default)(n),r={};for(var o in t)t.hasOwnProperty(o)&&~i.indexOf(o)&&(r[o]=t[o]);r.story=n,e.commit("updateStoryWithData",r)},updateSpaceWithData:function(e,t){var n=e.rootState.application.currentSelections.story.spaces.find(function(e){return e.id===t.space.id}),i=(0,a.default)(n),r={};for(var o in t)t.hasOwnProperty(o)&&~i.indexOf(o)&&(r[o]=t[o]);r.space=n,e.commit("updateSpaceWithData",r)},updateShadingWithData:function(e,t){var n=e.rootState.application.currentSelections.story.shading.find(function(e){return e.id===t.shading.id}),i=(0,a.default)(n),r={};for(var o in t)t.hasOwnProperty(o)&&~i.indexOf(o)&&(r[o]=t[o]);r.shading=n,e.commit("updateShadingWithData",r)},updateObjectWithData:function(e,t){var n=d.default.libraryObjectWithId(e.state,t.object.id);t.object=n,e.commit("updateObjectWithData",t)},createImageForStory:function(e,t){var n=e.state.stories.find(function(e){return e.id===t.story.id}),i=new s.default.Image(t.src);e.commit("initImage",{image:i}),e.commit("updateStoryWithData",{story:n,image_id:i.id})},createObjectWithType:function(e,t){e.commit("initObject",{type:t.type,object:t.object})}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(84),a=i(r),o=n(87),s=i(o);t.default={namespaced:!0,state:{stories:[],images:[],library:{building_units:[{id:"1003",name:"Building Unit 1"},{id:"1004",name:"Building Unit 2"},{id:"1005",name:"Building Unit 3"}],thermal_zones:[{id:"1006",name:"Thermal Zone 1"},{id:"1007",name:"Thermal Zone 2"},{id:"1008",name:"Thermal Zone 3"}],space_types:[{id:"1009",name:"Space Type 1"},{id:"1010",name:"Space Type 2"},{id:"1011",name:"Space Type 3"},{id:"1012",name:"Space Type 4"}],construction_sets:[{id:"1013",name:"Construction Set 1"},{id:"1014",name:"Construction Set 2"}],constructions:[{id:"1015",name:"Construction 1"}],windows:[{id:"1016",name:"Window 1"},{id:"1017",name:"Window 2"},{id:"1021",name:"Window 3"}],daylighting_controls:[{id:"1018",name:"Daylighting Control 1"},{id:"1019",name:"Daylighting Control 2"},{id:"1020",name:"Daylighting Control 3"}]}},actions:a.default,mutations:s.default,getters:{}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),a=i(r),o=n(88),s=i(o),c={building_units:{displayName:"Building Unit",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},color:{displayName:"Color",readonly:!1,input_type:"color",private:!1,validator:s.default.color}},init:a.default.BuildingUnit},thermal_zones:{displayName:"Thermal Zone",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},color:{displayName:"Color",readonly:!1,input_type:"color",private:!1,validator:s.default.color}},init:a.default.ThermalZone},space_types:{displayName:"Space Type",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},color:{displayName:"Color",readonly:!1,input_type:"color",private:!1,validator:s.default.color}},init:a.default.SpaceType},construction_sets:{displayName:"Construction Set",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name}},init:a.default.ConstructionSet},constructions:{displayName:"Construction",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name}},init:a.default.Construction},windows:{displayName:"Window",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name}},init:a.default.Window},daylighting_controls:{displayName:"Daylighting Control",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name}},init:a.default.DaylightingControl},stories:{displayName:"Story",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},handle:{readonly:!0,private:!0},geometry_id:{readonly:!0,private:!0},below_floor_plenum_height:{displayName:"Below Floor Plenum Height",readonly:!1,input_type:"text",private:!1,validator:s.default.name},floor_to_ceiling_height:{displayName:"Floor To Ceiling Height",readonly:!1,input_type:"text",private:!1,validator:s.default.name},multiplier:{displayName:"Multiplier",readonly:!1,input_type:"text",private:!1,validator:s.default.name},spaces:{displayName:"Spaces",readonly:!0,private:!1,get:function(e,t){return e.spaces.map(function(e){return e.name}).join(", ")}},windows:{displayName:"Windows",readonly:!0,private:!1,get:function(e,t){return e.windows.map(function(e){return e.name}).join(", ")}},shading:{displayName:"Shading",readonly:!0,private:!1,get:function(e,t){return e.shading.map(function(e){return e.name}).join(", ")}},imageVisible:{readonly:!0,private:!0},image_ids:{readonly:!0,private:!0},image_id:{displayName:"Image",readonly:!1,input_type:"select",select_data:function(e,t){},private:!1,get:function(e,t){return e.shading.map(function(e){return e.name}).join(", ")}}}},spaces:{displayName:"Space",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},handle:{readonly:!0,private:!0},face_id:{readonly:!0,private:!0},daylighting_controls:{displayName:"Daylighting Controls",readonly:!0,private:!1,get:function(e,t){return e.daylighting_controls.map(function(e){return e.name}).join(", ")}},building_unit_id:{displayName:"Building Unit",readonly:!1,input_type:"select",select_data:function(e,t){var n={};return t.models.library.building_units.forEach(function(e){return n[e.name]=e.id}),n},private:!1,get:function(e,t){var n=t.models.library.building_units.find(function(t){return t.id===e.building_unit_id});return n?n.name:null}},thermal_zone_id:{displayName:"Thermal Zone",readonly:!1,input_type:"select",select_data:function(e,t){var n={};return t.models.library.thermal_zones.forEach(function(e){return n[e.name]=e.id}),n},private:!1,get:function(e,t){var n=t.models.library.thermal_zones.find(function(t){return t.id===e.thermal_zone_id});return n?n.name:null}},space_type_id:{displayName:"Space Type",readonly:!1,input_type:"select",select_data:function(e,t){var n={};return t.models.library.space_types.forEach(function(e){return n[e.name]=e.id}),n},private:!1,get:function(e,t){var n=t.models.library.space_types.find(function(t){return t.id===e.space_type_id});return n?n.name:null}},construction_set_id:{displayName:"Construction Set",readonly:!1,input_type:"select",select_data:function(e,t){var n={};return t.models.library.construction_sets.forEach(function(e){return n[e.name]=e.id}),n},private:!1,get:function(e,t){var n=t.models.library.construction_sets.find(function(t){return t.id===e.construction_set_id});return n?n.name:null}},color:{displayName:"Color",readonly:!1,input_type:"color",private:!1,validator:s.default.color}}},shading:{displayName:"Shading",keymap:{id:{displayName:"ID",readonly:!0,private:!1},name:{displayName:"Name",readonly:!1,input_type:"text",private:!1,validator:s.default.name},handle:{readonly:!0,private:!0},face_id:{readonly:!0,private:!0},color:{readonly:!0,private:!0}}}};t.default=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),a=i(r),o=n(2);i(o);t.default={initStory:function(e,t){e.stories.push(t.story)},initSpace:function(e,t){t.story.spaces.push(t.space)},initShading:function(e,t){t.story.shading.push(t.shading)},initImage:function(e,t){e.images.push(t.image)},initObject:function(e,t){e.library[t.type].push(t.object)},destroySpace:function(e,t){t.story.spaces.splice(t.story.spaces.findIndex(function(e){return e.id===t.space.id}),1)},destroyShading:function(e,t){t.story.shading.splice(t.story.shading.findIndex(function(e){return e.id===t.shading.id}),1)},destroyStory:function(e,t){e.stories.splice(e.stories.findIndex(function(e){return e.id===t.story.id}),1)},destroyObject:function(e,t){for(var n in e.library)e.library.hasOwnProperty(n)&&e.library[n].splice(e.library[n].findIndex(function(e){return e.id===t.object.id}),1)},updateStoryWithData:function(e,t){var n=t.story;delete t.story,(0,a.default)(n,t),"image_id"in t&&(~n.image_ids.indexOf(t.image_id)||n.image_ids.push(t.image_id))},updateSpaceWithData:function(e,t){var n=t.space;(0,a.default)(n,t),delete n.space},updateShadingWithData:function(e,t){var n=t.shading;(0,a.default)(n,t),delete n.shading},updateObjectWithData:function(e,t){var n=t.object;(0,a.default)(n,t),delete n.object}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:function(e,t,n){return n.length<5?{success:!1,error:"Names must be at least 5 characters long."}:{success:!0}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),a=i(r);t.default={setUnits:function(e,t){"m"!==t.units&&"ft"!==t.units||e.commit("setUnits",t)},setLanguage:function(e,t){"EN-US"===t.language&&e.commit("setLanguage",t)},setNorthAxis:function(e,t){var n=new a.default(t);n.validateFloat("north_axis"),e.commit("setNorthAxis",n.validatedPayload)},setMapVisible:function(e,t){"boolean"==typeof t.visible&&e.commit("setMapVisible",t)},setGridVisible:function(e,t){"boolean"==typeof t.visible&&e.commit("setGridVisible",t)},setGridXSpacing:function(e,t){var n=new a.default(t);n.validateInt("x_spacing"),n.validateMin("x_spacing",0),n.validateMax("x_spacing",e.state.view.max_x-e.state.view.min_x),e.commit("setGridXSpacing",n.validatedPayload)},setGridYSpacing:function(e,t){var n=new a.default(t);n.validateInt("y_spacing"),n.validateMin("y_spacing",0),n.validateMax("y_spacing",e.state.view.max_y-e.state.view.min_y),e.commit("setGridYSpacing",n.validatedPayload)},setViewMinX:function(e,t){var n=new a.default(t);n.validateInt("min_x"),n.validateMax("min_x",e.state.view.max_x),e.commit("setViewMinX",n.validatedPayload)},setViewMinY:function(e,t){var n=new a.default(t);n.validateInt("min_y"),n.validateMax("min_y",e.state.view.max_y),e.commit("setViewMinY",n.validatedPayload)},setViewMaxX:function(e,t){var n=new a.default(t);n.validateInt("max_x"),n.validateMin("max_x",e.state.view.min_x),e.commit("setViewMaxX",n.validatedPayload)},setViewMaxY:function(e,t){var n=new a.default(t);n.validateInt("max_y"),n.validateMin("max_y",e.state.view.min_y),e.commit("setViewMaxY",n.validatedPayload)},setFov:function(e,t){e.commit("setFov",t)},setZoom:function(e,t){e.commit("setZoom",t)},setFilmOffset:function(e,t){e.commit("setFilmOffset",t)},setMapLatitude:function(e,t){var n=new a.default(t);n.validateFloat("latitude"),n.validateMax("latitude",180),n.validateMin("latitude",-180),e.commit("setMapLatitude",n.validatedPayload)},setMapLongitude:function(e,t){var n=new a.default(t);n.validateFloat("longitude"),n.validateMax("longitude",180),n.validateMin("longitude",-180),e.commit("setMapLongitude",n.validatedPayload)},setMapZoom:function(e,t){var n=new a.default(t);n.validateFloat("zoom"),e.commit("setMapZoom",n.validatedPayload)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={snapTolerance:function(e,t,n,i){return.025*Math.abs(e.view.max_x-e.view.min_x)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(89),a=i(r),o=n(92),s=i(o),c=n(90),u=i(c);t.default={namespaced:!0,state:{config:{units:"ft",language:"EN-US",north_axis:0},grid:{visible:!0,x_spacing:1,y_spacing:1},view:{min_x:0,min_y:0,max_x:10,max_y:10,filmOffset:0,fov:75,zoom:1},map:{visible:!1,latitude:39.7653,longitude:-104.9863,zoom:18,elevation:0}},actions:a.default,mutations:s.default,getters:u.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={setUnits:function(e,t){"units"in t&&(e.config.units=t.units)},setLanguage:function(e,t){"language"in t&&(e.config.language=t.language)},setConfigNorthAxis:function(e,t){"north_axis"in t&&(e.config.north_axis=t.north_axis)},setGridVisible:function(e,t){"visible"in t&&(e.grid.visible=t.visible)},setGridXSpacing:function(e,t){"x_spacing"in t&&(e.grid.x_spacing=t.x_spacing)},setGridYSpacing:function(e,t){"y_spacing"in t&&(e.grid.y_spacing=t.y_spacing)},setViewMinX:function(e,t){"min_x"in t&&(e.view.min_x=t.min_x)},setViewMinY:function(e,t){"min_y"in t&&(e.view.min_y=t.min_y)},setViewMaxX:function(e,t){"max_x"in t&&(e.view.max_x=t.max_x)},setViewMaxY:function(e,t){"max_y"in t&&(e.view.max_y=t.max_y)},setFov:function(e,t){"fov"in t&&(e.view.fov=t.fov)},setZoom:function(e,t){"zoom"in t&&(e.view.zoom=t.zoom)},setFilmOffset:function(e,t){"filmOffset"in t&&(e.view.filmOffset=t.filmOffset)},setMapVisible:function(e,t){"visible"in t&&(e.map.visible=t.visible)},setMapLatitude:function(e,t){"latitude"in t&&(e.map.latitude=t.latitude)},setMapLongitude:function(e,t){"longitude"in t&&(e.map.longitude=t.longitude)},setMapZoom:function(e,t){"zoom"in t&&(e.map.zoom=t.zoom)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={application:e.application,project:e.project,stories:e.models.stories,library:e.models.library,images:e.models.images},i=t["geometry/exportData"];return n=JSON.parse((0,u.default)(n)),n.stories.forEach(function(e){e.geometry=i.find(function(t){return t.id===e.geometry_id}),delete e.geometry_id}),a(n),n}function a(e){for(var t in e)"id"!==t&&!~t.indexOf("_id")||"number"!=typeof e[t]||(e[t]=String(e[t])),~t.indexOf("_ids")&&"object"===(0,s.default)(e[t])&&(e[t]=e[t].map(function(e){return String(e)})),null!==e[t]&&"object"===(0,s.default)(e[t])&&a(e[t])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(47),s=i(o),c=n(12),u=i(c);t.default=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),a=i(r);t.default=function(){var e={space:0,building_unit:0,thermal_zone:0,space_type:0};return function(t){return e[t]++,a.default.palette.colors[e[t]%a.default.palette.colors.length]}}()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=JSON.parse((0,c.default)(t.data.stories.map(function(e){return e.geometry}))),i=0;i<n.length;i++)n[i].faces=n[i].faces.map(function(e){return{id:e.id,edgeRefs:e.edge_ids.map(function(t,n){return{edge_id:t,reverse:!e.edge_order[n]}})}}),n[i].edges=n[i].edges.map(function(e){return{id:e.id,v1:e.vertex_ids[0],v2:e.vertex_ids[1]}}),n[i].vertices=n[i].vertices.map(function(e){return{id:e.id,x:e.x,y:e.y,X:e.x,Y:e.y}});t.data.stories.forEach(function(e){e.geometry_id=e.geometry.id,delete e.geometry}),t.data.application.scale.x=l.scaleLinear().domain([0,t.clientWidth]).range([t.data.project.view.min_x,t.data.project.view.max_x]),t.data.application.scale.y=l.scaleLinear().domain([0,t.clientHeight]).range([t.data.project.view.min_y,t.data.project.view.max_y]);var r=t.data.application.currentSelections,a=t.data.stories.find(function(e){return e.id===r.story.id});r.story=a,r.space=r.space?a.spaces.find(function(e){return e.id===r.space.id}):null,r.shading=r.shading?a.shading.find(function(e){return e.id===r.shading.id}):null,r.building_unit=r.building_unit?t.data.library.building_units.find(function(e){return e.id===r.building_unit.id}):null,r.thermal_zone=r.thermal_zone?t.data.library.thermal_zones.find(function(e){return e.id===r.thermal_zone.id}):null,r.space_type=r.space_type?t.data.library.space_types.find(function(e){return e.id===r.space_type.id}):null;var s=0;!function e(t){for(var n in t)t.hasOwnProperty(n)&&(s="id"===n&&Number(t[n])>s?Number(t[n]):s,null!==t[n]&&"object"===(0,o.default)(t[n])&&e(t[n]))}(t),console.log(s),d.default.setId(s),e.commit("importState",{project:t.data.project,application:t.data.application,models:{stories:t.data.stories,images:t.data.images,library:t.data.library},geometry:n})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(47),o=i(a),s=n(12),c=i(s);t.default=r;var u=n(26),d=i(u),l=n(57)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,function(e,t,n){var i,r;n(142),n(143),i=n(61);var a=n(165);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-2a372c9e",e.exports=i},function(e,t,n){var i,r;n(139),i=n(62);var a=n(162);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-0073f876",e.exports=i},function(e,t,n){var i,r;n(141),i=n(63);var a=n(164);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-266f1716",e.exports=i},function(e,t,n){var i,r;n(145),i=n(64);var a=n(167);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-411ce911",e.exports=i},function(e,t,n){var i,r;n(144),i=n(65);var a=n(166);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-3afbad56",e.exports=i},function(e,t,n){var i,r;n(149),i=n(66);var a=n(171);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-f4f49402",e.exports=i},function(e,t,n){var i,r;n(140),i=n(67);var a=n(163);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-21736fdf",e.exports=i},function(e,t,n){var i,r;n(147),i=n(68);var a=n(169);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-7db4da52",e.exports=i},function(e,t,n){var i,r;n(148),i=n(69);var a=n(170);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-9625b82c",e.exports=i},function(e,t,n){var i,r;n(146),i=n(70);var a=n(168);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-73143015",e.exports=i},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"canvas",attrs:{id:"canvas"}})},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",[n("div",{staticClass:"overlay",on:{click:function(t){e.$emit("close")}}}),e._v(" "),n("div",{staticClass:"modal"},[n("header",[n("h2",[e._v("Set Background")]),e._v(" "),n("svg",{staticClass:"close",attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){e.$emit("close")}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"
}})])]),e._v(" "),n("form",[n("div",{attrs:{id:"mode"}},[n("button",{class:e.mapVisible?"active":"",on:{click:function(t){t.preventDefault(),e.setBackground("map")}}},[e._v("Map")]),e._v(" "),n("button",{class:e.imageVisible?"active":"",on:{click:function(t){t.preventDefault(),e.setBackground("image")}}},[e._v("Image")]),e._v(" "),n("button",{class:e.mapVisible||e.imageVisible?"":"active",on:{click:function(t){t.preventDefault(),e.setBackground()}}},[e._v("None")])]),e._v(" "),e.mapVisible?[n("p",[e._v("Enter the map coordinates for the area you'd like to display.")]),e._v(" "),n("div",{attrs:{id:"coordinates"}},[n("div",{staticClass:"input-number"},[n("label",[e._v("latitude")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.latitude,expression:"latitude",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.latitude)},on:{change:function(t){e.latitude=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("longitude")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.longitude,expression:"longitude",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.longitude)},on:{change:function(t){e.longitude=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("zoom")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.zoom,expression:"zoom",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.zoom)},on:{change:function(t){e.zoom=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})])])]:e._e(),e._v(" "),e.imageVisible?[n("p",[e._v("Upload a custom image for this story.")]),e._v(" "),n("input",{ref:"fileInput",attrs:{type:"file"},on:{change:e.uploadImage}}),e._v(" "),n("button",{on:{click:function(t){t.preventDefault(),e.$refs.fileInput.click()}}},[e._v("Upload an Image")])]:e._e()],2)])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"canvas"}},[n("svg",{ref:"grid",attrs:{viewBox:e.viewbox,preserveAspectRatio:"none",id:"svgcanvas"},on:{click:e.addPoint,mousemove:e.highlightSnapTarget}})])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("toolbar",{on:{setBackground:function(t){e.showModal("background")},createObject:function(t){e.showModal("create-object")}}}),e._v(" "),n("main",[n("navigation"),e._v(" "),"3d"===e.tool?n("view-3d"):e._e(),e._v(" "),"3d"!==e.tool?n("canvas-view"):e._e(),e._v(" "),n("inspector",{on:{assignObject:function(t){e.showModal("assign-object",t)}}}),e._v(" "),e.backgroundModalVisible?n("background-modal",{on:{close:function(t){e.backgroundModalVisible=!1}}}):e._e(),e._v(" "),e.assignObjectModalVisible?n("assign-object-modal",{attrs:{type:e.assignObjectType,target:e.assignObjectTarget},on:{close:function(t){e.assignObjectModalVisible=!1}}}):e._e(),e._v(" "),e.createObjectModalVisible?n("create-object-modal",{on:{close:function(t){e.createObjectModalVisible=!1}}}):e._e()],1),e._v(" "),n("library")],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"library"}},[n("header",[n("div",{staticClass:"input-text"},[n("label",[e._v("Search")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],domProps:{value:e._s(e.search)},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"input-select"},[n("label",[e._v("Type")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],on:{change:function(t){e.type=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t})[0]}}},e._l(e.extendedLibrary,function(t,i){return n("option",{domProps:{value:i}},[e._v(e._s(e.displayTypeForType(i)))])})),e._v(" "),n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14",height:"10px"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z",transform:"translate(13) rotate(90)"}})])])]),e._v(" "),n("table",{staticClass:"table"},[n("thead",[n("tr",[e._l(e.columns,function(t){return n("th",{on:{click:function(n){e.sortBy(t)}}},[n("span",[n("span",[e._v(e._s(e.displayNameForKey(t)))]),e._v(" "),n("svg",{directives:[{name:"show",rawName:"v-show",value:t===e.sortKey&&e.sortDescending,expression:"column === sortKey && sortDescending"}],attrs:{viewBox:"0 0 10 3",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 .5l5 5 5-5H0z"}})]),e._v(" "),n("svg",{directives:[{name:"show",rawName:"v-show",value:t===e.sortKey&&!e.sortDescending,expression:"column === sortKey && !sortDescending"}],attrs:{viewBox:"0 0 10 3",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 5.5l5-5 5 5H0z"}})])])])}),e._v(" "),n("th",{staticClass:"destroy"})],2)]),e._v(" "),n("tbody",e._l(e.displayObjects,function(t){return n("tr",{key:t.id,class:e.classForObjectRow(t),style:{"background-color":e.currentObject&&e.currentObject.id===t.id?t.color:""},on:{click:function(n){e.currentObject=t}}},[e._l(e.columns,function(i){return n("td",{on:{mouseover:function(n){e.toggleError(t,i,!0)},mouseout:function(n){e.toggleError(t,i,!1)}}},[e.errorForObjectAndKey(t,i)&&e.errorForObjectAndKey(t,i).visible?n("div",{staticClass:"tooltip-error"},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z"}})]),e._v(" "),n("span",[e._v(e._s(e.errorForObjectAndKey(t,i).message))])]):e._e(),e._v(" "),e.inputTypeForKey(i)?e._e():n("input",{attrs:{readonly:""},domProps:{value:e.valueForKey(t,i)},on:{change:function(n){e.setValueForKey(t,i,n.target.value)}}}),e._v(" "),"text"===e.inputTypeForKey(i)?n("input",{domProps:{value:e.valueForKey(t,i)},on:{change:function(n){e.setValueForKey(t,i,n.target.value)}}}):e._e(),e._v(" "),"color"===e.inputTypeForKey(i)?n("div",{staticClass:"input-color"},["color"===e.inputTypeForKey(i)?n("input",{attrs:{"object-id":t.id},domProps:{value:e.valueForKey(t,i)},on:{change:function(n){e.setValueForKey(t,i,n.target.value)}}}):e._e()]):e._e(),e._v(" "),"select"===e.inputTypeForKey(i)?n("div",{staticClass:"input-select"},[n("select",{on:{change:function(n){e.setValueForKey(t,i,n.target.value)}}},[n("option",{attrs:{value:"null"},domProps:{selected:!e.valueForKey(t,i),value:"null"}},[e._v("None")]),e._v(" "),e._l(e.selectOptionsForObjectAndKey(t,i),function(r,a){return n("option",{domProps:{value:r,selected:e.valueForKey(t,i)===a}},[e._v(e._s(a))])})],2),e._v(" "),n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14",height:"10px"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z",transform:"translate(13) rotate(90)"}})])]):e._e()])}),e._v(" "),n("td",{staticClass:"destroy"},[n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(n){e.destroyObject(t)}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])])],2)}))])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"inspector"}},[n("section",{staticClass:"tabs"},[n("span",{class:{active:"attributes"===e.tab},on:{click:function(t){e.tab="attributes"}}},[e._v("Attributes")]),e._v(" "),n("span",{class:{active:"components"===e.tab},on:{click:function(t){e.tab="components"}}},[e._v("Components")]),e._v(" "),n("span",{class:{active:"geometry"===e.tab},on:{click:function(t){e.tab="geometry"}}},[e._v("Geometry")])]),e._v(" "),"geometry"===e.tab?n("section",{staticClass:"list",attrs:{id:"geometry-list"}},[e._l(e.currentStoryGeometry.faces,function(t){return e.currentSpace||e.currentShading?e._e():[n("header",[n("h3",[e._v("Face "+e._s(t.id))])]),e._v(" "),e._l(t.edgeRefs,function(t){return n("div",{staticClass:"list-item"},[e._v("\r\n                edge "+e._s(t.edge_id)+" "+e._s(t.reverse?"reversed ":"")+" "+e._s(e.edgeForId(t.edge_id).isShared(e.currentStoryGeometry)?"shared":"")+"\r\n                "),n("br"),e._v("startpoint "+e._s(e.startpoint(t))+"\r\n                "),n("br"),e._v("endpoint "+e._s(e.endpoint(t))+"\r\n            ")])})]}),e._v(" "),e.currentSelectionsFace?[n("header",[n("h3",[e._v("Face "+e._s(e.currentSelectionsFace.id)+" on "+e._s(e.currentSpace?e.currentSpace.name:e.currentShading.name))])]),e._v(" "),e._l(e.currentSelectionsFace.edgeRefs,function(t){return n("div",{staticClass:"list-item"},[e._v("\r\n                edge "+e._s(t.edge_id)+" "+e._s(t.reverse?"reversed ":"")+" "+e._s(e.edgeForId(t.edge_id).isShared(e.currentStoryGeometry)?"shared":"")+"\r\n                "),n("br"),e._v("startpoint "+e._s(e.startpoint(t))+"\r\n                "),n("br"),e._v("endpoint "+e._s(e.endpoint(t))+"\r\n            ")])})]:e._e()],2):e._e(),e._v(" "),"attributes"===e.tab?n("section",{staticClass:"list",attrs:{id:"attributes-list"}},[e.currentSpace||e.currentShading?e._e():[n("h3",[e._v(e._s(e.currentStory.name))]),e._v(" "),n("label",[e._v("name")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentStory.name},on:{change:function(t){e.updatecurrentStory("name",t)}}})]),e._v(" "),n("label",[e._v("below_floor_plenum_height")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentStory.below_floor_plenum_height},on:{change:function(t){e.updatecurrentStory("below_floor_plenum_height",t)}}})]),e._v(" "),n("label",[e._v("floor_to_ceiling_height")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentStory.floor_to_ceiling_height},on:{change:function(t){e.updatecurrentStory("floor_to_ceiling_height",t)}}})]),e._v(" "),n("label",[e._v("multiplier")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentStory.multiplier},on:{change:function(t){e.updatecurrentStory("multiplier",t)}}})])],e._v(" "),e.currentSpace?[n("h3",[e._v(e._s(e.currentSpace.name))]),e._v(" "),n("label",[e._v("name")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentSpace.name},on:{change:function(t){e.updatecurrentSpace("name",t)}}})]),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v(e._s(e.displayTypeForType("building_units")))]),e._v(" "),e._l(e.getComponent(e.currentSpace.building_unit_id,"building_units"),function(t,i){return n("span",[e._v("\r\n                    "+e._s(i)+": "+e._s(t)+"\r\n                ")])}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("building_units",e.currentSpace)}}},[e._v("Add "+e._s(e.displayTypeForType("building_units")))])],2),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v(e._s(e.displayTypeForType("thermal_zones")))]),e._v(" "),e._l(e.getComponent(e.currentSpace.thermal_zone_id,"thermal_zones"),function(t,i){return n("span",[e._v("\r\n                    "+e._s(i)+": "+e._s(t)+"\r\n                ")])}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("thermal_zones",e.currentSpace)}}},[e._v("Add "+e._s(e.displayTypeForType("thermal_zones")))])],2),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v(e._s(e.displayTypeForType("space_types")))]),e._v(" "),e._l(e.getComponent(e.currentSpace.space_type_id,"space_types"),function(t,i){return n("span",[e._v("\r\n                    "+e._s(i)+": "+e._s(t)+"\r\n                ")])}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("space_types",e.currentSpace)}}},[e._v("Add "+e._s(e.displayTypeForType("space_types")))])],2),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v(e._s(e.displayTypeForType("construction_sets")))]),e._v(" "),e._l(e.getComponent(e.currentSpace.construction_set_id,"construction_sets"),function(t,i){return n("span",[e._v("\r\n                    "+e._s(i)+": "+e._s(t)+"\r\n                ")])}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("construction_sets",e.currentSpace)}}},[e._v("Add "+e._s(e.displayTypeForType("construction_sets")))])],2)]:e._e(),e._v(" "),e.currentShading?[n("h3",[e._v(e._s(e.currentShading.name))]),e._v(" "),n("label",[e._v("name")]),e._v(" "),n("div",{staticClass:"input-text"},[n("input",{domProps:{value:e.currentShading.name},on:{change:function(t){e.updatecurrentShading("name",t)}}})])]:e._e()],2):e._e(),e._v(" "),"components"===e.tab?n("section",{staticClass:"list",attrs:{id:"components-list"}},[e.currentSpace||e.currentShading?e._e():[n("header",[n("h3",[e._v(e._s(e.currentStory.name))])]),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v("Windows")]),e._v(" "),e._l(e.currentStory.windows,function(t,i){return n("div",[e._l(t,function(t,i){return n("span",[e._v("\r\n                        "+e._s(i)+": "+e._s(t)+"\r\n                    ")])}),e._v(" "),n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){e.destroyWindow(i)}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])],2)}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("windows",e.currentStory)}}},[e._v("Add Window")])],2)],e._v(" "),e.currentSpace?[n("header",[n("h3",[e._v(e._s(e.currentSpace.name))])]),e._v(" "),n("div",{staticClass:"list-item"},[n("h4",[e._v("Daylighting Controls")]),e._v(" "),e._l(e.currentSpace.daylighting_controls,function(t,i){return n("div",[e._l(t,function(t,i){return n("span",[e._v("\r\n                        "+e._s(i)+": "+e._s(t)+"\r\n                    ")])}),e._v(" "),n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){e.destroyDaylightingControl(i)}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])],2)}),e._v(" "),n("button",{on:{click:function(t){e.assignObject("daylighting_controls",e.currentSpace)}}},[e._v("Add "+e._s(e.displayTypeForType("daylighting_controls")))])],2)]:e._e(),e._v(" "),e.currentShading?[n("h3",[e._v(e._s(e.currentShading.name))])]:e._e()],2):e._e()])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{attrs:{id:"toolbar"}},[n("section",{staticClass:"settings"},[n("div",{attrs:{id:"modal-buttons"}},[n("button",{on:{click:function(t){e.$emit("setBackground")}}},[e._v("Import Background")]),e._v(" "),n("button",{on:{click:function(t){e.$emit("createObject")}}},[e._v("Create Object")])]),e._v(" "),"3d"!==e.tool?[n("div",{staticClass:"input-number"},[n("label",[e._v("min_x")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.min_x,expression:"min_x",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.min_x)},on:{change:function(t){e.min_x=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("min_y")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.min_y,expression:"min_y",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.min_y)},on:{change:function(t){e.min_y=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("max_x")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.max_x,expression:"max_x",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.max_x)},on:{change:function(t){e.max_x=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("max_y")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.max_y,expression:"max_y",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.max_y)},on:{change:function(t){e.max_y=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("x_spacing")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.x_spacing,expression:"x_spacing",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.x_spacing)},on:{change:function(t){e.x_spacing=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("y_spacing")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:e.y_spacing,expression:"y_spacing",modifiers:{number:!0,lazy:!0}}],domProps:{value:e._s(e.y_spacing)},on:{change:function(t){e.y_spacing=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-checkbox"},[n("label",[e._v("grid")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.gridVisible,expression:"gridVisible"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.gridVisible)?e._i(e.gridVisible,null)>-1:e.gridVisible},on:{change:function(t){var n=e.gridVisible,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=e._i(n,a);r?o<0&&(e.gridVisible=n.concat(a)):o>-1&&(e.gridVisible=n.slice(0,o).concat(n.slice(o+1)))}else e.gridVisible=r}}})])]:e._e(),e._v(" "),"3d"===e.tool?[n("div",{staticClass:"input-number"},[n("label",[e._v("Field Of View")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.fov,expression:"fov",modifiers:{number:!0}}],domProps:{value:e._s(e.fov)},on:{input:function(t){t.target.composing||(e.fov=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("Film Offset")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.filmOffset,expression:"filmOffset",modifiers:{number:!0}}],domProps:{value:e._s(e.filmOffset)},on:{input:function(t){t.target.composing||(e.filmOffset=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"input-number"},[n("label",[e._v("Zoom")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.zoom,expression:"zoom",modifiers:{number:!0}}],domProps:{value:e._s(e.zoom)},on:{input:function(t){t.target.composing||(e.zoom=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})])]:e._e(),e._v(" "),n("div",{attrs:{id:"import-export"}},[n("input",{ref:"importInput",attrs:{type:"file"},on:{change:e.importData}}),e._v(" "),n("button",{attrs:{id:"import"},on:{click:function(t){e.$refs.importInput.click()}}},[e._v("Import Model")]),e._v(" "),n("button",{attrs:{id:"export"},on:{click:e.exportData}},[e._v("Export Model")])])],2),e._v(" "),n("section",{staticClass:"tools"},e._l(e.availableTools,function(t){return n("button",{class:{active:e.tool===t},on:{click:function(n){e.tool=t}}},[e._v(e._s(t))])}))])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",[n("div",{staticClass:"overlay",on:{click:function(t){e.$emit("close")}}}),e._v(" "),n("div",{staticClass:"modal"},[n("header",[n("h2",[e._v("New Object")]),e._v(" "),n("svg",{staticClass:"close",attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){e.$emit("close")}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])]),e._v(" "),n("form",[n("div",{staticClass:"input-select"},[n("label",[e._v("Type")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.displayType,expression:"displayType"}],on:{change:function(t){e.displayType=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t})[0]}}},e._l(e.library,function(t,i){return n("option",[e._v(e._s(e.displayTypeForType(i)))])})),e._v(" "),n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14",height:"10px"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z",transform:"translate(13) rotate(90)"}})])]),e._v(" "),n("div",{staticClass:"input-text"},[n("label",[e._v("name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.objectName,expression:"objectName"}],domProps:{value:e._s(e.objectName)},on:{input:function(t){t.target.composing||(e.objectName=t.target.value)}}})]),e._v(" "),n("div",{attrs:{id:"add-field"}},[n("h4",[e._v("Additional Fields")]),e._v(" "),n("button",{on:{click:function(t){t.preventDefault(),e.addField()}}},[e._v("Add Field")])]),e._v(" "),e._l(e.fields,function(t){return n("div",[n("div",{staticClass:"input-text additional-field "},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.label,expression:"field.label"}],attrs:{placeholder:"Label"},domProps:{value:e._s(t.label)},on:{input:function(e){e.target.composing||(t.label=e.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],attrs:{placeholder:"Value"},domProps:{value:e._s(t.value)},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])])})],2),e._v(" "),n("footer",[n("button",{on:{click:function(t){e.createObject()}}},[e._v("Save")])])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{attrs:{id:"navigation"}},[n("section",{attrs:{id:"selections"}},[n("div",{staticClass:"input-select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.mode,expression:"mode"}],on:{change:function(t){e.mode=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t})[0]}}},e._l(e.modes,function(t){return n("option",{domProps:{value:t}},[e._v(e._s(e.displayNameForMode(t)))])})),e._v(" "),n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14",height:"10px"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z",transform:"translate(13) rotate(90)"}})])]),e._v(" "),n("button",{on:{click:function(t){e.createItem(e.mode)}}},[n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M208 122h-74V48c0-3.534-2.466-6.4-6-6.4s-6 2.866-6 6.4v74H48c-3.534 0-6.4 2.466-6.4 6s2.866 6 6.4 6h74v74c0 3.534 2.466 6.4 6 6.4s6-2.866 6-6.4v-74h74c3.534 0 6.4-2.466 6.4-6s-2.866-6-6.4-6z"}})]),e._v("\r\n            "+e._s(e.displayNameForMode(e.mode))+"\r\n        ")])]),e._v(" "),n("section",{attrs:{id:"breadcrumbs"}},[n("button",{on:{click:function(t){e.createItem("stories")}}},[n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M208 122h-74V48c0-3.534-2.466-6.4-6-6.4s-6 2.866-6 6.4v74H48c-3.534 0-6.4 2.466-6.4 6s2.866 6 6.4 6h74v74c0 3.534 2.466 6.4 6 6.4s6-2.866 6-6.4v-74h74c3.534 0 6.4-2.466 6.4-6s-2.866-6-6.4-6z"}})]),e._v("\r\n            "+e._s(e.displayNameForMode("stories"))+"\r\n        ")]),e._v(" "),n("span",{on:{click:e.clearSubSelections}},[e._v("\r\n            "+e._s(e.currentStory.name)+"\r\n            "),"stories"!==e.mode&&e.currentSubSelection?[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14"}},[n("path",{attrs:{d:"M.5 0v14l11-7-11-7z"}})]),e._v("\r\n                "+e._s(e.currentSubSelection.name)+"\r\n            ")]:e._e()],2)]),e._v(" "),n("div",{staticClass:"input-text",attrs:{id:"navigation-search"}},[n("label",[e._v("Search")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],domProps:{value:e._s(e.search)},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),n("div",{attrs:{id:"list"}},[n("section",{attrs:{id:"story-list"}},e._l(e.stories,function(t){return n("div",{key:t.id,class:{active:e.currentStory&&e.currentStory.id===t.id},style:{"background-color":t&&t.color},on:{click:function(n){e.selectItem(t,"stories")}}},[e._v("\r\n                "+e._s(t.name)+"\r\n                "),n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(n){e.destroyItem(t)}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])])})),e._v(" "),n("section",{attrs:{id:"subselection-list"}},e._l(e.items,function(t){return n("div",{key:t.id,class:{active:e.currentSubSelection&&e.currentSubSelection.id===t.id},style:{"background-color":t&&e.currentSubSelection&&e.currentSubSelection.id===t.id?t.color:""},on:{click:function(n){e.selectItem(t,e.mode)}}},[n("span",{style:{"background-color":t&&t.color}}),e._v("\r\n                "+e._s(t.name)+"\r\n                "),n("svg",{attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(n){e.destroyItem(t)}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])])}))])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",[n("div",{staticClass:"overlay",on:{click:function(t){e.$emit("close")}}}),e._v(" "),n("div",{staticClass:"modal"},[n("header",[n("h2",[e._v("Select a "+e._s(e.displayType)+" to assign to "+e._s(e.target.name))]),e._v(" "),n("svg",{staticClass:"close",attrs:{viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){e.$emit("close")}}},[n("path",{attrs:{d:"M137.05 128l75.476-75.475c2.5-2.5 2.5-6.55 0-9.05s-6.55-2.5-9.05 0L128 118.948 52.525 43.474c-2.5-2.5-6.55-2.5-9.05 0s-2.5 6.55 0 9.05L118.948 128l-75.476 75.475c-2.5 2.5-2.5 6.55 0 9.05 1.25 1.25 2.888 1.876 4.525 1.876s3.274-.624 4.524-1.874L128 137.05l75.475 75.476c1.25 1.25 2.888 1.875 4.525 1.875s3.275-.624 4.525-1.874c2.5-2.5 2.5-6.55 0-9.05L137.05 128z"}})])]),e._v(" "),n("table",{staticClass:"table"},[n("thead",[n("tr",e._l(e.columns,function(t){return n("th",[n("span",[e._v(e._s(t))])])}))]),e._v(" "),n("tbody",e._l(e.objects,function(t){return n("tr",{class:e.currentObject===t?"active":"",on:{click:function(n){e.currentObject=e.currentObject===t?null:t}}},e._l(e.columns,function(i){return n("td",[n("span",[e._v(e._s(t.hasOwnProperty(i)?t[i]:"--"))])])}))}))]),e._v(" "),n("footer",[n("button",{class:e.currentObject?"active":"disabled",attrs:{id:"saveAssignment"},on:{click:function(t){e.assignObjectToTarget()}}},[e._v("Save")])])])])},staticRenderFns:[]}}]);
//# sourceMappingURL=app.b94ab85c2346f0617a4a.js.map</script>
    </body>
</html>